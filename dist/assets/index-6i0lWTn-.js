function yD(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function WT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var HT={exports:{}},bp={},qT={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu=Symbol.for("react.element"),vD=Symbol.for("react.portal"),xD=Symbol.for("react.fragment"),wD=Symbol.for("react.strict_mode"),_D=Symbol.for("react.profiler"),ED=Symbol.for("react.provider"),kD=Symbol.for("react.context"),bD=Symbol.for("react.forward_ref"),TD=Symbol.for("react.suspense"),SD=Symbol.for("react.memo"),ID=Symbol.for("react.lazy"),s1=Symbol.iterator;function ND(n){return n===null||typeof n!="object"?null:(n=s1&&n[s1]||n["@@iterator"],typeof n=="function"?n:null)}var KT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GT=Object.assign,QT={};function yl(n,e,t){this.props=n,this.context=e,this.refs=QT,this.updater=t||KT}yl.prototype.isReactComponent={};yl.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};yl.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function JT(){}JT.prototype=yl.prototype;function kv(n,e,t){this.props=n,this.context=e,this.refs=QT,this.updater=t||KT}var bv=kv.prototype=new JT;bv.constructor=kv;GT(bv,yl.prototype);bv.isPureReactComponent=!0;var i1=Array.isArray,YT=Object.prototype.hasOwnProperty,Tv={current:null},XT={key:!0,ref:!0,__self:!0,__source:!0};function ZT(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)YT.call(e,r)&&!XT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Mu,type:n,key:i,ref:o,props:s,_owner:Tv.current}}function CD(n,e){return{$$typeof:Mu,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Sv(n){return typeof n=="object"&&n!==null&&n.$$typeof===Mu}function AD(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var o1=/\/+/g;function tg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?AD(""+n.key):e.toString(36)}function oh(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Mu:case vD:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+tg(o,0):r,i1(s)?(t="",n!=null&&(t=n.replace(o1,"$&/")+"/"),oh(s,e,t,"",function(c){return c})):s!=null&&(Sv(s)&&(s=CD(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(o1,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",i1(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+tg(i,a);o+=oh(i,e,t,l,s)}else if(l=ND(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+tg(i,a++),o+=oh(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function kd(n,e,t){if(n==null)return n;var r=[],s=0;return oh(n,r,"","",function(i){return e.call(t,i,s++)}),r}function RD(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var cn={current:null},ah={transition:null},PD={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:ah,ReactCurrentOwner:Tv};function eS(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:kd,forEach:function(n,e,t){kd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return kd(n,function(){e++}),e},toArray:function(n){return kd(n,function(e){return e})||[]},only:function(n){if(!Sv(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};xe.Component=yl;xe.Fragment=xD;xe.Profiler=_D;xe.PureComponent=kv;xe.StrictMode=wD;xe.Suspense=TD;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PD;xe.act=eS;xe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=GT({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Tv.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)YT.call(e,l)&&!XT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Mu,type:n.type,key:s,ref:i,props:r,_owner:o}};xe.createContext=function(n){return n={$$typeof:kD,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:ED,_context:n},n.Consumer=n};xe.createElement=ZT;xe.createFactory=function(n){var e=ZT.bind(null,n);return e.type=n,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(n){return{$$typeof:bD,render:n}};xe.isValidElement=Sv;xe.lazy=function(n){return{$$typeof:ID,_payload:{_status:-1,_result:n},_init:RD}};xe.memo=function(n,e){return{$$typeof:SD,type:n,compare:e===void 0?null:e}};xe.startTransition=function(n){var e=ah.transition;ah.transition={};try{n()}finally{ah.transition=e}};xe.unstable_act=eS;xe.useCallback=function(n,e){return cn.current.useCallback(n,e)};xe.useContext=function(n){return cn.current.useContext(n)};xe.useDebugValue=function(){};xe.useDeferredValue=function(n){return cn.current.useDeferredValue(n)};xe.useEffect=function(n,e){return cn.current.useEffect(n,e)};xe.useId=function(){return cn.current.useId()};xe.useImperativeHandle=function(n,e,t){return cn.current.useImperativeHandle(n,e,t)};xe.useInsertionEffect=function(n,e){return cn.current.useInsertionEffect(n,e)};xe.useLayoutEffect=function(n,e){return cn.current.useLayoutEffect(n,e)};xe.useMemo=function(n,e){return cn.current.useMemo(n,e)};xe.useReducer=function(n,e,t){return cn.current.useReducer(n,e,t)};xe.useRef=function(n){return cn.current.useRef(n)};xe.useState=function(n){return cn.current.useState(n)};xe.useSyncExternalStore=function(n,e,t){return cn.current.useSyncExternalStore(n,e,t)};xe.useTransition=function(){return cn.current.useTransition()};xe.version="18.3.1";qT.exports=xe;var O=qT.exports;const At=WT(O),DD=yD({__proto__:null,default:At},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MD=O,OD=Symbol.for("react.element"),jD=Symbol.for("react.fragment"),VD=Object.prototype.hasOwnProperty,LD=MD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FD={key:!0,ref:!0,__self:!0,__source:!0};function tS(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)VD.call(e,r)&&!FD.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:OD,type:n,key:i,ref:o,props:s,_owner:LD.current}}bp.Fragment=jD;bp.jsx=tS;bp.jsxs=tS;HT.exports=bp;var f=HT.exports,gy={},nS={exports:{}},Mn={},rS={exports:{}},sS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(B,Q){var le=B.length;B.push(Q);e:for(;0<le;){var Ie=le-1>>>1,Ee=B[Ie];if(0<s(Ee,Q))B[Ie]=Q,B[le]=Ee,le=Ie;else break e}}function t(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var Q=B[0],le=B.pop();if(le!==Q){B[0]=le;e:for(var Ie=0,Ee=B.length,ve=Ee>>>1;Ie<ve;){var X=2*(Ie+1)-1,nt=B[X],Gt=X+1,jn=B[Gt];if(0>s(nt,le))Gt<Ee&&0>s(jn,nt)?(B[Ie]=jn,B[Gt]=le,Ie=Gt):(B[Ie]=nt,B[X]=le,Ie=X);else if(Gt<Ee&&0>s(jn,le))B[Ie]=jn,B[Gt]=le,Ie=Gt;else break e}}return Q}function s(B,Q){var le=B.sortIndex-Q.sortIndex;return le!==0?le:B.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,p=3,m=!1,g=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(B){for(var Q=t(c);Q!==null;){if(Q.callback===null)r(c);else if(Q.startTime<=B)r(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=t(c)}}function A(B){if(v=!1,T(B),!g)if(t(l)!==null)g=!0,H(R);else{var Q=t(c);Q!==null&&ee(A,Q.startTime-B)}}function R(B,Q){g=!1,v&&(v=!1,_(E),E=-1),m=!0;var le=p;try{for(T(Q),h=t(l);h!==null&&(!(h.expirationTime>Q)||B&&!M());){var Ie=h.callback;if(typeof Ie=="function"){h.callback=null,p=h.priorityLevel;var Ee=Ie(h.expirationTime<=Q);Q=n.unstable_now(),typeof Ee=="function"?h.callback=Ee:h===t(l)&&r(l),T(Q)}else r(l);h=t(l)}if(h!==null)var ve=!0;else{var X=t(c);X!==null&&ee(A,X.startTime-Q),ve=!1}return ve}finally{h=null,p=le,m=!1}}var D=!1,k=null,E=-1,S=5,C=-1;function M(){return!(n.unstable_now()-C<S)}function P(){if(k!==null){var B=n.unstable_now();C=B;var Q=!0;try{Q=k(!0,B)}finally{Q?N():(D=!1,k=null)}}else D=!1}var N;if(typeof b=="function")N=function(){b(P)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ye=ae.port2;ae.port1.onmessage=P,N=function(){ye.postMessage(null)}}else N=function(){x(P,0)};function H(B){k=B,D||(D=!0,N())}function ee(B,Q){E=x(function(){B(n.unstable_now())},Q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,H(R))},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var le=p;p=Q;try{return B()}finally{p=le}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(B,Q){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var le=p;p=B;try{return Q()}finally{p=le}},n.unstable_scheduleCallback=function(B,Q,le){var Ie=n.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?Ie+le:Ie):le=Ie,B){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=le+Ee,B={id:u++,callback:Q,priorityLevel:B,startTime:le,expirationTime:Ee,sortIndex:-1},le>Ie?(B.sortIndex=le,e(c,B),t(l)===null&&B===t(c)&&(v?(_(E),E=-1):v=!0,ee(A,le-Ie))):(B.sortIndex=Ee,e(l,B),g||m||(g=!0,H(R))),B},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(B){var Q=p;return function(){var le=p;p=Q;try{return B.apply(this,arguments)}finally{p=le}}}})(sS);rS.exports=sS;var BD=rS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UD=O,Pn=BD;function W(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iS=new Set,Wc={};function qo(n,e){Qa(n,e),Qa(n+"Capture",e)}function Qa(n,e){for(Wc[n]=e,n=0;n<e.length;n++)iS.add(e[n])}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yy=Object.prototype.hasOwnProperty,$D=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,a1={},l1={};function zD(n){return yy.call(l1,n)?!0:yy.call(a1,n)?!1:$D.test(n)?l1[n]=!0:(a1[n]=!0,!1)}function WD(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function HD(n,e,t,r){if(e===null||typeof e>"u"||WD(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Mt[n]=new un(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Mt[e]=new un(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Mt[n]=new un(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Mt[n]=new un(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Mt[n]=new un(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Mt[n]=new un(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Mt[n]=new un(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Mt[n]=new un(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Mt[n]=new un(n,5,!1,n.toLowerCase(),null,!1,!1)});var Iv=/[\-:]([a-z])/g;function Nv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Iv,Nv);Mt[e]=new un(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Iv,Nv);Mt[e]=new un(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Iv,Nv);Mt[e]=new un(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Mt[n]=new un(n,1,!1,n.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Mt[n]=new un(n,1,!1,n.toLowerCase(),null,!0,!0)});function Cv(n,e,t,r){var s=Mt.hasOwnProperty(e)?Mt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(HD(e,t,s,r)&&(t=null),r||s===null?zD(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var xs=UD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bd=Symbol.for("react.element"),_a=Symbol.for("react.portal"),Ea=Symbol.for("react.fragment"),Av=Symbol.for("react.strict_mode"),vy=Symbol.for("react.profiler"),oS=Symbol.for("react.provider"),aS=Symbol.for("react.context"),Rv=Symbol.for("react.forward_ref"),xy=Symbol.for("react.suspense"),wy=Symbol.for("react.suspense_list"),Pv=Symbol.for("react.memo"),Ds=Symbol.for("react.lazy"),lS=Symbol.for("react.offscreen"),c1=Symbol.iterator;function Bl(n){return n===null||typeof n!="object"?null:(n=c1&&n[c1]||n["@@iterator"],typeof n=="function"?n:null)}var Ke=Object.assign,ng;function sc(n){if(ng===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);ng=e&&e[1]||""}return`
`+ng+n}var rg=!1;function sg(n,e){if(!n||rg)return"";rg=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{rg=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?sc(n):""}function qD(n){switch(n.tag){case 5:return sc(n.type);case 16:return sc("Lazy");case 13:return sc("Suspense");case 19:return sc("SuspenseList");case 0:case 2:case 15:return n=sg(n.type,!1),n;case 11:return n=sg(n.type.render,!1),n;case 1:return n=sg(n.type,!0),n;default:return""}}function _y(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ea:return"Fragment";case _a:return"Portal";case vy:return"Profiler";case Av:return"StrictMode";case xy:return"Suspense";case wy:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case aS:return(n.displayName||"Context")+".Consumer";case oS:return(n._context.displayName||"Context")+".Provider";case Rv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Pv:return e=n.displayName||null,e!==null?e:_y(n.type)||"Memo";case Ds:e=n._payload,n=n._init;try{return _y(n(e))}catch{}}return null}function KD(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _y(e);case 8:return e===Av?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xi(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function cS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function GD(n){var e=cS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Td(n){n._valueTracker||(n._valueTracker=GD(n))}function uS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=cS(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Lh(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ey(n,e){var t=e.checked;return Ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function u1(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=xi(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function dS(n,e){e=e.checked,e!=null&&Cv(n,"checked",e,!1)}function ky(n,e){dS(n,e);var t=xi(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?by(n,e.type,t):e.hasOwnProperty("defaultValue")&&by(n,e.type,xi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function d1(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function by(n,e,t){(e!=="number"||Lh(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ic=Array.isArray;function Va(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+xi(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function Ty(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ke({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function h1(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(W(92));if(ic(t)){if(1<t.length)throw Error(W(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:xi(t)}}function hS(n,e){var t=xi(e.value),r=xi(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function f1(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function fS(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sy(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?fS(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Sd,pS=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Sd=Sd||document.createElement("div"),Sd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Hc(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var xc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QD=["Webkit","ms","Moz","O"];Object.keys(xc).forEach(function(n){QD.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),xc[e]=xc[n]})});function mS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||xc.hasOwnProperty(n)&&xc[n]?(""+e).trim():e+"px"}function gS(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=mS(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var JD=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Iy(n,e){if(e){if(JD[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Ny(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cy=null;function Dv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ay=null,La=null,Fa=null;function p1(n){if(n=Vu(n)){if(typeof Ay!="function")throw Error(W(280));var e=n.stateNode;e&&(e=Cp(e),Ay(n.stateNode,n.type,e))}}function yS(n){La?Fa?Fa.push(n):Fa=[n]:La=n}function vS(){if(La){var n=La,e=Fa;if(Fa=La=null,p1(n),e)for(n=0;n<e.length;n++)p1(e[n])}}function xS(n,e){return n(e)}function wS(){}var ig=!1;function _S(n,e,t){if(ig)return n(e,t);ig=!0;try{return xS(n,e,t)}finally{ig=!1,(La!==null||Fa!==null)&&(wS(),vS())}}function qc(n,e){var t=n.stateNode;if(t===null)return null;var r=Cp(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(W(231,e,typeof t));return t}var Ry=!1;if(ds)try{var Ul={};Object.defineProperty(Ul,"passive",{get:function(){Ry=!0}}),window.addEventListener("test",Ul,Ul),window.removeEventListener("test",Ul,Ul)}catch{Ry=!1}function YD(n,e,t,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var wc=!1,Fh=null,Bh=!1,Py=null,XD={onError:function(n){wc=!0,Fh=n}};function ZD(n,e,t,r,s,i,o,a,l){wc=!1,Fh=null,YD.apply(XD,arguments)}function eM(n,e,t,r,s,i,o,a,l){if(ZD.apply(this,arguments),wc){if(wc){var c=Fh;wc=!1,Fh=null}else throw Error(W(198));Bh||(Bh=!0,Py=c)}}function Ko(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function ES(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function m1(n){if(Ko(n)!==n)throw Error(W(188))}function tM(n){var e=n.alternate;if(!e){if(e=Ko(n),e===null)throw Error(W(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return m1(s),n;if(i===r)return m1(s),e;i=i.sibling}throw Error(W(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(t.alternate!==r)throw Error(W(190))}if(t.tag!==3)throw Error(W(188));return t.stateNode.current===t?n:e}function kS(n){return n=tM(n),n!==null?bS(n):null}function bS(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=bS(n);if(e!==null)return e;n=n.sibling}return null}var TS=Pn.unstable_scheduleCallback,g1=Pn.unstable_cancelCallback,nM=Pn.unstable_shouldYield,rM=Pn.unstable_requestPaint,Ze=Pn.unstable_now,sM=Pn.unstable_getCurrentPriorityLevel,Mv=Pn.unstable_ImmediatePriority,SS=Pn.unstable_UserBlockingPriority,Uh=Pn.unstable_NormalPriority,iM=Pn.unstable_LowPriority,IS=Pn.unstable_IdlePriority,Tp=null,Nr=null;function oM(n){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Tp,n,void 0,(n.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:cM,aM=Math.log,lM=Math.LN2;function cM(n){return n>>>=0,n===0?32:31-(aM(n)/lM|0)|0}var Id=64,Nd=4194304;function oc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function $h(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=oc(a):(i&=o,i!==0&&(r=oc(i)))}else o=t&~s,o!==0?r=oc(o):i!==0&&(r=oc(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-lr(e),s=1<<t,r|=n[t],e&=~s;return r}function uM(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dM(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-lr(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=uM(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function Dy(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function NS(){var n=Id;return Id<<=1,!(Id&4194240)&&(Id=64),n}function og(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ou(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-lr(e),n[e]=t}function hM(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-lr(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function Ov(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-lr(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Re=0;function CS(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var AS,jv,RS,PS,DS,My=!1,Cd=[],ti=null,ni=null,ri=null,Kc=new Map,Gc=new Map,Ls=[],fM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function y1(n,e){switch(n){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":Kc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(e.pointerId)}}function $l(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Vu(e),e!==null&&jv(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function pM(n,e,t,r,s){switch(e){case"focusin":return ti=$l(ti,n,e,t,r,s),!0;case"dragenter":return ni=$l(ni,n,e,t,r,s),!0;case"mouseover":return ri=$l(ri,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return Kc.set(i,$l(Kc.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Gc.set(i,$l(Gc.get(i)||null,n,e,t,r,s)),!0}return!1}function MS(n){var e=so(n.target);if(e!==null){var t=Ko(e);if(t!==null){if(e=t.tag,e===13){if(e=ES(t),e!==null){n.blockedOn=e,DS(n.priority,function(){RS(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function lh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Oy(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Cy=r,t.target.dispatchEvent(r),Cy=null}else return e=Vu(t),e!==null&&jv(e),n.blockedOn=t,!1;e.shift()}return!0}function v1(n,e,t){lh(n)&&t.delete(e)}function mM(){My=!1,ti!==null&&lh(ti)&&(ti=null),ni!==null&&lh(ni)&&(ni=null),ri!==null&&lh(ri)&&(ri=null),Kc.forEach(v1),Gc.forEach(v1)}function zl(n,e){n.blockedOn===e&&(n.blockedOn=null,My||(My=!0,Pn.unstable_scheduleCallback(Pn.unstable_NormalPriority,mM)))}function Qc(n){function e(s){return zl(s,n)}if(0<Cd.length){zl(Cd[0],n);for(var t=1;t<Cd.length;t++){var r=Cd[t];r.blockedOn===n&&(r.blockedOn=null)}}for(ti!==null&&zl(ti,n),ni!==null&&zl(ni,n),ri!==null&&zl(ri,n),Kc.forEach(e),Gc.forEach(e),t=0;t<Ls.length;t++)r=Ls[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Ls.length&&(t=Ls[0],t.blockedOn===null);)MS(t),t.blockedOn===null&&Ls.shift()}var Ba=xs.ReactCurrentBatchConfig,zh=!0;function gM(n,e,t,r){var s=Re,i=Ba.transition;Ba.transition=null;try{Re=1,Vv(n,e,t,r)}finally{Re=s,Ba.transition=i}}function yM(n,e,t,r){var s=Re,i=Ba.transition;Ba.transition=null;try{Re=4,Vv(n,e,t,r)}finally{Re=s,Ba.transition=i}}function Vv(n,e,t,r){if(zh){var s=Oy(n,e,t,r);if(s===null)gg(n,e,r,Wh,t),y1(n,r);else if(pM(s,n,e,t,r))r.stopPropagation();else if(y1(n,r),e&4&&-1<fM.indexOf(n)){for(;s!==null;){var i=Vu(s);if(i!==null&&AS(i),i=Oy(n,e,t,r),i===null&&gg(n,e,r,Wh,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else gg(n,e,r,null,t)}}var Wh=null;function Oy(n,e,t,r){if(Wh=null,n=Dv(r),n=so(n),n!==null)if(e=Ko(n),e===null)n=null;else if(t=e.tag,t===13){if(n=ES(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Wh=n,null}function OS(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sM()){case Mv:return 1;case SS:return 4;case Uh:case iM:return 16;case IS:return 536870912;default:return 16}default:return 16}}var Gs=null,Lv=null,ch=null;function jS(){if(ch)return ch;var n,e=Lv,t=e.length,r,s="value"in Gs?Gs.value:Gs.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return ch=s.slice(n,1<r?1-r:void 0)}function uh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ad(){return!0}function x1(){return!1}function On(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ad:x1,this.isPropagationStopped=x1,this}return Ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ad)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ad)},persist:function(){},isPersistent:Ad}),e}var vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fv=On(vl),ju=Ke({},vl,{view:0,detail:0}),vM=On(ju),ag,lg,Wl,Sp=Ke({},ju,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Wl&&(Wl&&n.type==="mousemove"?(ag=n.screenX-Wl.screenX,lg=n.screenY-Wl.screenY):lg=ag=0,Wl=n),ag)},movementY:function(n){return"movementY"in n?n.movementY:lg}}),w1=On(Sp),xM=Ke({},Sp,{dataTransfer:0}),wM=On(xM),_M=Ke({},ju,{relatedTarget:0}),cg=On(_M),EM=Ke({},vl,{animationName:0,elapsedTime:0,pseudoElement:0}),kM=On(EM),bM=Ke({},vl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),TM=On(bM),SM=Ke({},vl,{data:0}),_1=On(SM),IM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AM(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=CM[n])?!!e[n]:!1}function Bv(){return AM}var RM=Ke({},ju,{key:function(n){if(n.key){var e=IM[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=uh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?NM[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bv,charCode:function(n){return n.type==="keypress"?uh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?uh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),PM=On(RM),DM=Ke({},Sp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E1=On(DM),MM=Ke({},ju,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bv}),OM=On(MM),jM=Ke({},vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),VM=On(jM),LM=Ke({},Sp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),FM=On(LM),BM=[9,13,27,32],Uv=ds&&"CompositionEvent"in window,_c=null;ds&&"documentMode"in document&&(_c=document.documentMode);var UM=ds&&"TextEvent"in window&&!_c,VS=ds&&(!Uv||_c&&8<_c&&11>=_c),k1=" ",b1=!1;function LS(n,e){switch(n){case"keyup":return BM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FS(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ka=!1;function $M(n,e){switch(n){case"compositionend":return FS(e);case"keypress":return e.which!==32?null:(b1=!0,k1);case"textInput":return n=e.data,n===k1&&b1?null:n;default:return null}}function zM(n,e){if(ka)return n==="compositionend"||!Uv&&LS(n,e)?(n=jS(),ch=Lv=Gs=null,ka=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VS&&e.locale!=="ko"?null:e.data;default:return null}}var WM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function T1(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!WM[n.type]:e==="textarea"}function BS(n,e,t,r){yS(r),e=Hh(e,"onChange"),0<e.length&&(t=new Fv("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Ec=null,Jc=null;function HM(n){YS(n,0)}function Ip(n){var e=Sa(n);if(uS(e))return n}function qM(n,e){if(n==="change")return e}var US=!1;if(ds){var ug;if(ds){var dg="oninput"in document;if(!dg){var S1=document.createElement("div");S1.setAttribute("oninput","return;"),dg=typeof S1.oninput=="function"}ug=dg}else ug=!1;US=ug&&(!document.documentMode||9<document.documentMode)}function I1(){Ec&&(Ec.detachEvent("onpropertychange",$S),Jc=Ec=null)}function $S(n){if(n.propertyName==="value"&&Ip(Jc)){var e=[];BS(e,Jc,n,Dv(n)),_S(HM,e)}}function KM(n,e,t){n==="focusin"?(I1(),Ec=e,Jc=t,Ec.attachEvent("onpropertychange",$S)):n==="focusout"&&I1()}function GM(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ip(Jc)}function QM(n,e){if(n==="click")return Ip(e)}function JM(n,e){if(n==="input"||n==="change")return Ip(e)}function YM(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var dr=typeof Object.is=="function"?Object.is:YM;function Yc(n,e){if(dr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!yy.call(e,s)||!dr(n[s],e[s]))return!1}return!0}function N1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function C1(n,e){var t=N1(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=N1(t)}}function zS(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?zS(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function WS(){for(var n=window,e=Lh();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Lh(n.document)}return e}function $v(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function XM(n){var e=WS(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&zS(t.ownerDocument.documentElement,t)){if(r!==null&&$v(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=C1(t,i);var o=C1(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ZM=ds&&"documentMode"in document&&11>=document.documentMode,ba=null,jy=null,kc=null,Vy=!1;function A1(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Vy||ba==null||ba!==Lh(r)||(r=ba,"selectionStart"in r&&$v(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),kc&&Yc(kc,r)||(kc=r,r=Hh(jy,"onSelect"),0<r.length&&(e=new Fv("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=ba)))}function Rd(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ta={animationend:Rd("Animation","AnimationEnd"),animationiteration:Rd("Animation","AnimationIteration"),animationstart:Rd("Animation","AnimationStart"),transitionend:Rd("Transition","TransitionEnd")},hg={},HS={};ds&&(HS=document.createElement("div").style,"AnimationEvent"in window||(delete Ta.animationend.animation,delete Ta.animationiteration.animation,delete Ta.animationstart.animation),"TransitionEvent"in window||delete Ta.transitionend.transition);function Np(n){if(hg[n])return hg[n];if(!Ta[n])return n;var e=Ta[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in HS)return hg[n]=e[t];return n}var qS=Np("animationend"),KS=Np("animationiteration"),GS=Np("animationstart"),QS=Np("transitionend"),JS=new Map,R1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ci(n,e){JS.set(n,e),qo(e,[n])}for(var fg=0;fg<R1.length;fg++){var pg=R1[fg],eO=pg.toLowerCase(),tO=pg[0].toUpperCase()+pg.slice(1);Ci(eO,"on"+tO)}Ci(qS,"onAnimationEnd");Ci(KS,"onAnimationIteration");Ci(GS,"onAnimationStart");Ci("dblclick","onDoubleClick");Ci("focusin","onFocus");Ci("focusout","onBlur");Ci(QS,"onTransitionEnd");Qa("onMouseEnter",["mouseout","mouseover"]);Qa("onMouseLeave",["mouseout","mouseover"]);Qa("onPointerEnter",["pointerout","pointerover"]);Qa("onPointerLeave",["pointerout","pointerover"]);qo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qo("onBeforeInput",["compositionend","keypress","textInput","paste"]);qo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nO=new Set("cancel close invalid load scroll toggle".split(" ").concat(ac));function P1(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,eM(r,e,void 0,n),n.currentTarget=null}function YS(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;P1(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;P1(s,a,c),i=l}}}if(Bh)throw n=Py,Bh=!1,Py=null,n}function Ve(n,e){var t=e[$y];t===void 0&&(t=e[$y]=new Set);var r=n+"__bubble";t.has(r)||(XS(e,n,2,!1),t.add(r))}function mg(n,e,t){var r=0;e&&(r|=4),XS(t,n,r,e)}var Pd="_reactListening"+Math.random().toString(36).slice(2);function Xc(n){if(!n[Pd]){n[Pd]=!0,iS.forEach(function(t){t!=="selectionchange"&&(nO.has(t)||mg(t,!1,n),mg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Pd]||(e[Pd]=!0,mg("selectionchange",!1,e))}}function XS(n,e,t,r){switch(OS(e)){case 1:var s=gM;break;case 4:s=yM;break;default:s=Vv}t=s.bind(null,e,t,n),s=void 0,!Ry||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function gg(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=so(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}_S(function(){var c=i,u=Dv(t),h=[];e:{var p=JS.get(n);if(p!==void 0){var m=Fv,g=n;switch(n){case"keypress":if(uh(t)===0)break e;case"keydown":case"keyup":m=PM;break;case"focusin":g="focus",m=cg;break;case"focusout":g="blur",m=cg;break;case"beforeblur":case"afterblur":m=cg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=w1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=wM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=OM;break;case qS:case KS:case GS:m=kM;break;case QS:m=VM;break;case"scroll":m=vM;break;case"wheel":m=FM;break;case"copy":case"cut":case"paste":m=TM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=E1}var v=(e&4)!==0,x=!v&&n==="scroll",_=v?p!==null?p+"Capture":null:p;v=[];for(var b=c,T;b!==null;){T=b;var A=T.stateNode;if(T.tag===5&&A!==null&&(T=A,_!==null&&(A=qc(b,_),A!=null&&v.push(Zc(b,A,T)))),x)break;b=b.return}0<v.length&&(p=new m(p,g,null,t,u),h.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==Cy&&(g=t.relatedTarget||t.fromElement)&&(so(g)||g[hs]))break e;if((m||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=c,g=g?so(g):null,g!==null&&(x=Ko(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(v=w1,A="onMouseLeave",_="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(v=E1,A="onPointerLeave",_="onPointerEnter",b="pointer"),x=m==null?p:Sa(m),T=g==null?p:Sa(g),p=new v(A,b+"leave",m,t,u),p.target=x,p.relatedTarget=T,A=null,so(u)===c&&(v=new v(_,b+"enter",g,t,u),v.target=T,v.relatedTarget=x,A=v),x=A,m&&g)t:{for(v=m,_=g,b=0,T=v;T;T=ia(T))b++;for(T=0,A=_;A;A=ia(A))T++;for(;0<b-T;)v=ia(v),b--;for(;0<T-b;)_=ia(_),T--;for(;b--;){if(v===_||_!==null&&v===_.alternate)break t;v=ia(v),_=ia(_)}v=null}else v=null;m!==null&&D1(h,p,m,v,!1),g!==null&&x!==null&&D1(h,x,g,v,!0)}}e:{if(p=c?Sa(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var R=qM;else if(T1(p))if(US)R=JM;else{R=GM;var D=KM}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(R=QM);if(R&&(R=R(n,c))){BS(h,R,t,u);break e}D&&D(n,p,c),n==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&by(p,"number",p.value)}switch(D=c?Sa(c):window,n){case"focusin":(T1(D)||D.contentEditable==="true")&&(ba=D,jy=c,kc=null);break;case"focusout":kc=jy=ba=null;break;case"mousedown":Vy=!0;break;case"contextmenu":case"mouseup":case"dragend":Vy=!1,A1(h,t,u);break;case"selectionchange":if(ZM)break;case"keydown":case"keyup":A1(h,t,u)}var k;if(Uv)e:{switch(n){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ka?LS(n,t)&&(E="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(E="onCompositionStart");E&&(VS&&t.locale!=="ko"&&(ka||E!=="onCompositionStart"?E==="onCompositionEnd"&&ka&&(k=jS()):(Gs=u,Lv="value"in Gs?Gs.value:Gs.textContent,ka=!0)),D=Hh(c,E),0<D.length&&(E=new _1(E,n,null,t,u),h.push({event:E,listeners:D}),k?E.data=k:(k=FS(t),k!==null&&(E.data=k)))),(k=UM?$M(n,t):zM(n,t))&&(c=Hh(c,"onBeforeInput"),0<c.length&&(u=new _1("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=k))}YS(h,e)})}function Zc(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Hh(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qc(n,t),i!=null&&r.unshift(Zc(n,i,s)),i=qc(n,e),i!=null&&r.push(Zc(n,i,s))),n=n.return}return r}function ia(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function D1(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=qc(t,i),l!=null&&o.unshift(Zc(t,l,a))):s||(l=qc(t,i),l!=null&&o.push(Zc(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var rO=/\r\n?/g,sO=/\u0000|\uFFFD/g;function M1(n){return(typeof n=="string"?n:""+n).replace(rO,`
`).replace(sO,"")}function Dd(n,e,t){if(e=M1(e),M1(n)!==e&&t)throw Error(W(425))}function qh(){}var Ly=null,Fy=null;function By(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Uy=typeof setTimeout=="function"?setTimeout:void 0,iO=typeof clearTimeout=="function"?clearTimeout:void 0,O1=typeof Promise=="function"?Promise:void 0,oO=typeof queueMicrotask=="function"?queueMicrotask:typeof O1<"u"?function(n){return O1.resolve(null).then(n).catch(aO)}:Uy;function aO(n){setTimeout(function(){throw n})}function yg(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Qc(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Qc(e)}function si(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function j1(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var xl=Math.random().toString(36).slice(2),Er="__reactFiber$"+xl,eu="__reactProps$"+xl,hs="__reactContainer$"+xl,$y="__reactEvents$"+xl,lO="__reactListeners$"+xl,cO="__reactHandles$"+xl;function so(n){var e=n[Er];if(e)return e;for(var t=n.parentNode;t;){if(e=t[hs]||t[Er]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=j1(n);n!==null;){if(t=n[Er])return t;n=j1(n)}return e}n=t,t=n.parentNode}return null}function Vu(n){return n=n[Er]||n[hs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Sa(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(W(33))}function Cp(n){return n[eu]||null}var zy=[],Ia=-1;function Ai(n){return{current:n}}function Fe(n){0>Ia||(n.current=zy[Ia],zy[Ia]=null,Ia--)}function Oe(n,e){Ia++,zy[Ia]=n.current,n.current=e}var wi={},Ht=Ai(wi),gn=Ai(!1),ko=wi;function Ja(n,e){var t=n.type.contextTypes;if(!t)return wi;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function yn(n){return n=n.childContextTypes,n!=null}function Kh(){Fe(gn),Fe(Ht)}function V1(n,e,t){if(Ht.current!==wi)throw Error(W(168));Oe(Ht,e),Oe(gn,t)}function ZS(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,KD(n)||"Unknown",s));return Ke({},t,r)}function Gh(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||wi,ko=Ht.current,Oe(Ht,n),Oe(gn,gn.current),!0}function L1(n,e,t){var r=n.stateNode;if(!r)throw Error(W(169));t?(n=ZS(n,e,ko),r.__reactInternalMemoizedMergedChildContext=n,Fe(gn),Fe(Ht),Oe(Ht,n)):Fe(gn),Oe(gn,t)}var Yr=null,Ap=!1,vg=!1;function eI(n){Yr===null?Yr=[n]:Yr.push(n)}function uO(n){Ap=!0,eI(n)}function Ri(){if(!vg&&Yr!==null){vg=!0;var n=0,e=Re;try{var t=Yr;for(Re=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Yr=null,Ap=!1}catch(s){throw Yr!==null&&(Yr=Yr.slice(n+1)),TS(Mv,Ri),s}finally{Re=e,vg=!1}}return null}var Na=[],Ca=0,Qh=null,Jh=0,Bn=[],Un=0,bo=null,Xr=1,Zr="";function Ki(n,e){Na[Ca++]=Jh,Na[Ca++]=Qh,Qh=n,Jh=e}function tI(n,e,t){Bn[Un++]=Xr,Bn[Un++]=Zr,Bn[Un++]=bo,bo=n;var r=Xr;n=Zr;var s=32-lr(r)-1;r&=~(1<<s),t+=1;var i=32-lr(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Xr=1<<32-lr(e)+s|t<<s|r,Zr=i+n}else Xr=1<<i|t<<s|r,Zr=n}function zv(n){n.return!==null&&(Ki(n,1),tI(n,1,0))}function Wv(n){for(;n===Qh;)Qh=Na[--Ca],Na[Ca]=null,Jh=Na[--Ca],Na[Ca]=null;for(;n===bo;)bo=Bn[--Un],Bn[Un]=null,Zr=Bn[--Un],Bn[Un]=null,Xr=Bn[--Un],Bn[Un]=null}var An=null,In=null,Ue=!1,ir=null;function nI(n,e){var t=qn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function F1(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,An=n,In=si(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,An=n,In=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=bo!==null?{id:Xr,overflow:Zr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=qn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,An=n,In=null,!0):!1;default:return!1}}function Wy(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Hy(n){if(Ue){var e=In;if(e){var t=e;if(!F1(n,e)){if(Wy(n))throw Error(W(418));e=si(t.nextSibling);var r=An;e&&F1(n,e)?nI(r,t):(n.flags=n.flags&-4097|2,Ue=!1,An=n)}}else{if(Wy(n))throw Error(W(418));n.flags=n.flags&-4097|2,Ue=!1,An=n}}}function B1(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;An=n}function Md(n){if(n!==An)return!1;if(!Ue)return B1(n),Ue=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!By(n.type,n.memoizedProps)),e&&(e=In)){if(Wy(n))throw rI(),Error(W(418));for(;e;)nI(n,e),e=si(e.nextSibling)}if(B1(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(W(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){In=si(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}In=null}}else In=An?si(n.stateNode.nextSibling):null;return!0}function rI(){for(var n=In;n;)n=si(n.nextSibling)}function Ya(){In=An=null,Ue=!1}function Hv(n){ir===null?ir=[n]:ir.push(n)}var dO=xs.ReactCurrentBatchConfig;function Hl(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(W(309));var r=t.stateNode}if(!r)throw Error(W(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(W(284));if(!t._owner)throw Error(W(290,n))}return n}function Od(n,e){throw n=Object.prototype.toString.call(e),Error(W(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function U1(n){var e=n._init;return e(n._payload)}function sI(n){function e(_,b){if(n){var T=_.deletions;T===null?(_.deletions=[b],_.flags|=16):T.push(b)}}function t(_,b){if(!n)return null;for(;b!==null;)e(_,b),b=b.sibling;return null}function r(_,b){for(_=new Map;b!==null;)b.key!==null?_.set(b.key,b):_.set(b.index,b),b=b.sibling;return _}function s(_,b){return _=li(_,b),_.index=0,_.sibling=null,_}function i(_,b,T){return _.index=T,n?(T=_.alternate,T!==null?(T=T.index,T<b?(_.flags|=2,b):T):(_.flags|=2,b)):(_.flags|=1048576,b)}function o(_){return n&&_.alternate===null&&(_.flags|=2),_}function a(_,b,T,A){return b===null||b.tag!==6?(b=Tg(T,_.mode,A),b.return=_,b):(b=s(b,T),b.return=_,b)}function l(_,b,T,A){var R=T.type;return R===Ea?u(_,b,T.props.children,A,T.key):b!==null&&(b.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Ds&&U1(R)===b.type)?(A=s(b,T.props),A.ref=Hl(_,b,T),A.return=_,A):(A=yh(T.type,T.key,T.props,null,_.mode,A),A.ref=Hl(_,b,T),A.return=_,A)}function c(_,b,T,A){return b===null||b.tag!==4||b.stateNode.containerInfo!==T.containerInfo||b.stateNode.implementation!==T.implementation?(b=Sg(T,_.mode,A),b.return=_,b):(b=s(b,T.children||[]),b.return=_,b)}function u(_,b,T,A,R){return b===null||b.tag!==7?(b=fo(T,_.mode,A,R),b.return=_,b):(b=s(b,T),b.return=_,b)}function h(_,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Tg(""+b,_.mode,T),b.return=_,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bd:return T=yh(b.type,b.key,b.props,null,_.mode,T),T.ref=Hl(_,null,b),T.return=_,T;case _a:return b=Sg(b,_.mode,T),b.return=_,b;case Ds:var A=b._init;return h(_,A(b._payload),T)}if(ic(b)||Bl(b))return b=fo(b,_.mode,T,null),b.return=_,b;Od(_,b)}return null}function p(_,b,T,A){var R=b!==null?b.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return R!==null?null:a(_,b,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case bd:return T.key===R?l(_,b,T,A):null;case _a:return T.key===R?c(_,b,T,A):null;case Ds:return R=T._init,p(_,b,R(T._payload),A)}if(ic(T)||Bl(T))return R!==null?null:u(_,b,T,A,null);Od(_,T)}return null}function m(_,b,T,A,R){if(typeof A=="string"&&A!==""||typeof A=="number")return _=_.get(T)||null,a(b,_,""+A,R);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case bd:return _=_.get(A.key===null?T:A.key)||null,l(b,_,A,R);case _a:return _=_.get(A.key===null?T:A.key)||null,c(b,_,A,R);case Ds:var D=A._init;return m(_,b,T,D(A._payload),R)}if(ic(A)||Bl(A))return _=_.get(T)||null,u(b,_,A,R,null);Od(b,A)}return null}function g(_,b,T,A){for(var R=null,D=null,k=b,E=b=0,S=null;k!==null&&E<T.length;E++){k.index>E?(S=k,k=null):S=k.sibling;var C=p(_,k,T[E],A);if(C===null){k===null&&(k=S);break}n&&k&&C.alternate===null&&e(_,k),b=i(C,b,E),D===null?R=C:D.sibling=C,D=C,k=S}if(E===T.length)return t(_,k),Ue&&Ki(_,E),R;if(k===null){for(;E<T.length;E++)k=h(_,T[E],A),k!==null&&(b=i(k,b,E),D===null?R=k:D.sibling=k,D=k);return Ue&&Ki(_,E),R}for(k=r(_,k);E<T.length;E++)S=m(k,_,E,T[E],A),S!==null&&(n&&S.alternate!==null&&k.delete(S.key===null?E:S.key),b=i(S,b,E),D===null?R=S:D.sibling=S,D=S);return n&&k.forEach(function(M){return e(_,M)}),Ue&&Ki(_,E),R}function v(_,b,T,A){var R=Bl(T);if(typeof R!="function")throw Error(W(150));if(T=R.call(T),T==null)throw Error(W(151));for(var D=R=null,k=b,E=b=0,S=null,C=T.next();k!==null&&!C.done;E++,C=T.next()){k.index>E?(S=k,k=null):S=k.sibling;var M=p(_,k,C.value,A);if(M===null){k===null&&(k=S);break}n&&k&&M.alternate===null&&e(_,k),b=i(M,b,E),D===null?R=M:D.sibling=M,D=M,k=S}if(C.done)return t(_,k),Ue&&Ki(_,E),R;if(k===null){for(;!C.done;E++,C=T.next())C=h(_,C.value,A),C!==null&&(b=i(C,b,E),D===null?R=C:D.sibling=C,D=C);return Ue&&Ki(_,E),R}for(k=r(_,k);!C.done;E++,C=T.next())C=m(k,_,E,C.value,A),C!==null&&(n&&C.alternate!==null&&k.delete(C.key===null?E:C.key),b=i(C,b,E),D===null?R=C:D.sibling=C,D=C);return n&&k.forEach(function(P){return e(_,P)}),Ue&&Ki(_,E),R}function x(_,b,T,A){if(typeof T=="object"&&T!==null&&T.type===Ea&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case bd:e:{for(var R=T.key,D=b;D!==null;){if(D.key===R){if(R=T.type,R===Ea){if(D.tag===7){t(_,D.sibling),b=s(D,T.props.children),b.return=_,_=b;break e}}else if(D.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Ds&&U1(R)===D.type){t(_,D.sibling),b=s(D,T.props),b.ref=Hl(_,D,T),b.return=_,_=b;break e}t(_,D);break}else e(_,D);D=D.sibling}T.type===Ea?(b=fo(T.props.children,_.mode,A,T.key),b.return=_,_=b):(A=yh(T.type,T.key,T.props,null,_.mode,A),A.ref=Hl(_,b,T),A.return=_,_=A)}return o(_);case _a:e:{for(D=T.key;b!==null;){if(b.key===D)if(b.tag===4&&b.stateNode.containerInfo===T.containerInfo&&b.stateNode.implementation===T.implementation){t(_,b.sibling),b=s(b,T.children||[]),b.return=_,_=b;break e}else{t(_,b);break}else e(_,b);b=b.sibling}b=Sg(T,_.mode,A),b.return=_,_=b}return o(_);case Ds:return D=T._init,x(_,b,D(T._payload),A)}if(ic(T))return g(_,b,T,A);if(Bl(T))return v(_,b,T,A);Od(_,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,b!==null&&b.tag===6?(t(_,b.sibling),b=s(b,T),b.return=_,_=b):(t(_,b),b=Tg(T,_.mode,A),b.return=_,_=b),o(_)):t(_,b)}return x}var Xa=sI(!0),iI=sI(!1),Yh=Ai(null),Xh=null,Aa=null,qv=null;function Kv(){qv=Aa=Xh=null}function Gv(n){var e=Yh.current;Fe(Yh),n._currentValue=e}function qy(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Ua(n,e){Xh=n,qv=Aa=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(pn=!0),n.firstContext=null)}function Zn(n){var e=n._currentValue;if(qv!==n)if(n={context:n,memoizedValue:e,next:null},Aa===null){if(Xh===null)throw Error(W(308));Aa=n,Xh.dependencies={lanes:0,firstContext:n}}else Aa=Aa.next=n;return e}var io=null;function Qv(n){io===null?io=[n]:io.push(n)}function oI(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,Qv(e)):(t.next=s.next,s.next=t),e.interleaved=t,fs(n,r)}function fs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ms=!1;function Jv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aI(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function as(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ii(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,fs(n,t)}return s=r.interleaved,s===null?(e.next=e,Qv(r)):(e.next=s.next,s.next=e),r.interleaved=e,fs(n,t)}function dh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Ov(n,t)}}function $1(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Zh(n,e,t,r){var s=n.updateQueue;Ms=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var p=a.lane,m=a.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=n,v=a;switch(p=e,m=t,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(m,h,p);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,p=typeof g=="function"?g.call(m,h,p):g,p==null)break e;h=Ke({},h,p);break e;case 2:Ms=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);So|=o,n.lanes=o,n.memoizedState=h}}function z1(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var Lu={},Cr=Ai(Lu),tu=Ai(Lu),nu=Ai(Lu);function oo(n){if(n===Lu)throw Error(W(174));return n}function Yv(n,e){switch(Oe(nu,e),Oe(tu,n),Oe(Cr,Lu),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Sy(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Sy(e,n)}Fe(Cr),Oe(Cr,e)}function Za(){Fe(Cr),Fe(tu),Fe(nu)}function lI(n){oo(nu.current);var e=oo(Cr.current),t=Sy(e,n.type);e!==t&&(Oe(tu,n),Oe(Cr,t))}function Xv(n){tu.current===n&&(Fe(Cr),Fe(tu))}var ze=Ai(0);function ef(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var xg=[];function Zv(){for(var n=0;n<xg.length;n++)xg[n]._workInProgressVersionPrimary=null;xg.length=0}var hh=xs.ReactCurrentDispatcher,wg=xs.ReactCurrentBatchConfig,To=0,He=null,ct=null,yt=null,tf=!1,bc=!1,ru=0,hO=0;function Lt(){throw Error(W(321))}function ex(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!dr(n[t],e[t]))return!1;return!0}function tx(n,e,t,r,s,i){if(To=i,He=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hh.current=n===null||n.memoizedState===null?gO:yO,n=t(r,s),bc){i=0;do{if(bc=!1,ru=0,25<=i)throw Error(W(301));i+=1,yt=ct=null,e.updateQueue=null,hh.current=vO,n=t(r,s)}while(bc)}if(hh.current=nf,e=ct!==null&&ct.next!==null,To=0,yt=ct=He=null,tf=!1,e)throw Error(W(300));return n}function nx(){var n=ru!==0;return ru=0,n}function vr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?He.memoizedState=yt=n:yt=yt.next=n,yt}function er(){if(ct===null){var n=He.alternate;n=n!==null?n.memoizedState:null}else n=ct.next;var e=yt===null?He.memoizedState:yt.next;if(e!==null)yt=e,ct=n;else{if(n===null)throw Error(W(310));ct=n,n={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},yt===null?He.memoizedState=yt=n:yt=yt.next=n}return yt}function su(n,e){return typeof e=="function"?e(n):e}function _g(n){var e=er(),t=e.queue;if(t===null)throw Error(W(311));t.lastRenderedReducer=n;var r=ct,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((To&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,He.lanes|=u,So|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,dr(r,e.memoizedState)||(pn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,He.lanes|=i,So|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Eg(n){var e=er(),t=e.queue;if(t===null)throw Error(W(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);dr(i,e.memoizedState)||(pn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function cI(){}function uI(n,e){var t=He,r=er(),s=e(),i=!dr(r.memoizedState,s);if(i&&(r.memoizedState=s,pn=!0),r=r.queue,rx(fI.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||yt!==null&&yt.memoizedState.tag&1){if(t.flags|=2048,iu(9,hI.bind(null,t,r,s,e),void 0,null),wt===null)throw Error(W(349));To&30||dI(t,e,s)}return s}function dI(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function hI(n,e,t,r){e.value=t,e.getSnapshot=r,pI(e)&&mI(n)}function fI(n,e,t){return t(function(){pI(e)&&mI(n)})}function pI(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!dr(n,t)}catch{return!0}}function mI(n){var e=fs(n,1);e!==null&&cr(e,n,1,-1)}function W1(n){var e=vr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:su,lastRenderedState:n},e.queue=n,n=n.dispatch=mO.bind(null,He,n),[e.memoizedState,n]}function iu(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function gI(){return er().memoizedState}function fh(n,e,t,r){var s=vr();He.flags|=n,s.memoizedState=iu(1|e,t,void 0,r===void 0?null:r)}function Rp(n,e,t,r){var s=er();r=r===void 0?null:r;var i=void 0;if(ct!==null){var o=ct.memoizedState;if(i=o.destroy,r!==null&&ex(r,o.deps)){s.memoizedState=iu(e,t,i,r);return}}He.flags|=n,s.memoizedState=iu(1|e,t,i,r)}function H1(n,e){return fh(8390656,8,n,e)}function rx(n,e){return Rp(2048,8,n,e)}function yI(n,e){return Rp(4,2,n,e)}function vI(n,e){return Rp(4,4,n,e)}function xI(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function wI(n,e,t){return t=t!=null?t.concat([n]):null,Rp(4,4,xI.bind(null,e,n),t)}function sx(){}function _I(n,e){var t=er();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ex(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function EI(n,e){var t=er();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ex(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function kI(n,e,t){return To&21?(dr(t,e)||(t=NS(),He.lanes|=t,So|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,pn=!0),n.memoizedState=t)}function fO(n,e){var t=Re;Re=t!==0&&4>t?t:4,n(!0);var r=wg.transition;wg.transition={};try{n(!1),e()}finally{Re=t,wg.transition=r}}function bI(){return er().memoizedState}function pO(n,e,t){var r=ai(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},TI(n))SI(e,t);else if(t=oI(n,e,t,r),t!==null){var s=tn();cr(t,n,r,s),II(t,e,r)}}function mO(n,e,t){var r=ai(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(TI(n))SI(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,dr(a,o)){var l=e.interleaved;l===null?(s.next=s,Qv(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=oI(n,e,s,r),t!==null&&(s=tn(),cr(t,n,r,s),II(t,e,r))}}function TI(n){var e=n.alternate;return n===He||e!==null&&e===He}function SI(n,e){bc=tf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function II(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Ov(n,t)}}var nf={readContext:Zn,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},gO={readContext:Zn,useCallback:function(n,e){return vr().memoizedState=[n,e===void 0?null:e],n},useContext:Zn,useEffect:H1,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,fh(4194308,4,xI.bind(null,e,n),t)},useLayoutEffect:function(n,e){return fh(4194308,4,n,e)},useInsertionEffect:function(n,e){return fh(4,2,n,e)},useMemo:function(n,e){var t=vr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=vr();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=pO.bind(null,He,n),[r.memoizedState,n]},useRef:function(n){var e=vr();return n={current:n},e.memoizedState=n},useState:W1,useDebugValue:sx,useDeferredValue:function(n){return vr().memoizedState=n},useTransition:function(){var n=W1(!1),e=n[0];return n=fO.bind(null,n[1]),vr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=He,s=vr();if(Ue){if(t===void 0)throw Error(W(407));t=t()}else{if(t=e(),wt===null)throw Error(W(349));To&30||dI(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,H1(fI.bind(null,r,i,n),[n]),r.flags|=2048,iu(9,hI.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=vr(),e=wt.identifierPrefix;if(Ue){var t=Zr,r=Xr;t=(r&~(1<<32-lr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=ru++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=hO++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},yO={readContext:Zn,useCallback:_I,useContext:Zn,useEffect:rx,useImperativeHandle:wI,useInsertionEffect:yI,useLayoutEffect:vI,useMemo:EI,useReducer:_g,useRef:gI,useState:function(){return _g(su)},useDebugValue:sx,useDeferredValue:function(n){var e=er();return kI(e,ct.memoizedState,n)},useTransition:function(){var n=_g(su)[0],e=er().memoizedState;return[n,e]},useMutableSource:cI,useSyncExternalStore:uI,useId:bI,unstable_isNewReconciler:!1},vO={readContext:Zn,useCallback:_I,useContext:Zn,useEffect:rx,useImperativeHandle:wI,useInsertionEffect:yI,useLayoutEffect:vI,useMemo:EI,useReducer:Eg,useRef:gI,useState:function(){return Eg(su)},useDebugValue:sx,useDeferredValue:function(n){var e=er();return ct===null?e.memoizedState=n:kI(e,ct.memoizedState,n)},useTransition:function(){var n=Eg(su)[0],e=er().memoizedState;return[n,e]},useMutableSource:cI,useSyncExternalStore:uI,useId:bI,unstable_isNewReconciler:!1};function rr(n,e){if(n&&n.defaultProps){e=Ke({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Ky(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ke({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Pp={isMounted:function(n){return(n=n._reactInternals)?Ko(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=tn(),s=ai(n),i=as(r,s);i.payload=e,t!=null&&(i.callback=t),e=ii(n,i,s),e!==null&&(cr(e,n,s,r),dh(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=tn(),s=ai(n),i=as(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=ii(n,i,s),e!==null&&(cr(e,n,s,r),dh(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=tn(),r=ai(n),s=as(t,r);s.tag=2,e!=null&&(s.callback=e),e=ii(n,s,r),e!==null&&(cr(e,n,r,t),dh(e,n,r))}};function q1(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Yc(t,r)||!Yc(s,i):!0}function NI(n,e,t){var r=!1,s=wi,i=e.contextType;return typeof i=="object"&&i!==null?i=Zn(i):(s=yn(e)?ko:Ht.current,r=e.contextTypes,i=(r=r!=null)?Ja(n,s):wi),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Pp,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function K1(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Pp.enqueueReplaceState(e,e.state,null)}function Gy(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Jv(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Zn(i):(i=yn(e)?ko:Ht.current,s.context=Ja(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ky(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Pp.enqueueReplaceState(s,s.state,null),Zh(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function el(n,e){try{var t="",r=e;do t+=qD(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function kg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Qy(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var xO=typeof WeakMap=="function"?WeakMap:Map;function CI(n,e,t){t=as(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){sf||(sf=!0,i0=r),Qy(n,e)},t}function AI(n,e,t){t=as(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Qy(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Qy(n,e),typeof r!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function G1(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new xO;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=DO.bind(null,n,e,t),e.then(n,n))}function Q1(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function J1(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=as(-1,1),e.tag=2,ii(t,e,1))),t.lanes|=1),n)}var wO=xs.ReactCurrentOwner,pn=!1;function Yt(n,e,t,r){e.child=n===null?iI(e,null,t,r):Xa(e,n.child,t,r)}function Y1(n,e,t,r,s){t=t.render;var i=e.ref;return Ua(e,s),r=tx(n,e,t,r,i,s),t=nx(),n!==null&&!pn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ps(n,e,s)):(Ue&&t&&zv(e),e.flags|=1,Yt(n,e,r,s),e.child)}function X1(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!hx(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,RI(n,e,i,r,s)):(n=yh(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Yc,t(o,r)&&n.ref===e.ref)return ps(n,e,s)}return e.flags|=1,n=li(i,r),n.ref=e.ref,n.return=e,e.child=n}function RI(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(Yc(i,r)&&n.ref===e.ref)if(pn=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(pn=!0);else return e.lanes=n.lanes,ps(n,e,s)}return Jy(n,e,t,r,s)}function PI(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(Pa,bn),bn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Oe(Pa,bn),bn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Oe(Pa,bn),bn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Oe(Pa,bn),bn|=r;return Yt(n,e,s,t),e.child}function DI(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Jy(n,e,t,r,s){var i=yn(t)?ko:Ht.current;return i=Ja(e,i),Ua(e,s),t=tx(n,e,t,r,i,s),r=nx(),n!==null&&!pn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,ps(n,e,s)):(Ue&&r&&zv(e),e.flags|=1,Yt(n,e,t,s),e.child)}function Z1(n,e,t,r,s){if(yn(t)){var i=!0;Gh(e)}else i=!1;if(Ua(e,s),e.stateNode===null)ph(n,e),NI(e,t,r),Gy(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Zn(c):(c=yn(t)?ko:Ht.current,c=Ja(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&K1(e,o,r,c),Ms=!1;var p=e.memoizedState;o.state=p,Zh(e,r,o,s),l=e.memoizedState,a!==r||p!==l||gn.current||Ms?(typeof u=="function"&&(Ky(e,t,u,r),l=e.memoizedState),(a=Ms||q1(e,t,a,r,p,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,aI(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:rr(e.type,a),o.props=c,h=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Zn(l):(l=yn(t)?ko:Ht.current,l=Ja(e,l));var m=t.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==l)&&K1(e,o,r,l),Ms=!1,p=e.memoizedState,o.state=p,Zh(e,r,o,s);var g=e.memoizedState;a!==h||p!==g||gn.current||Ms?(typeof m=="function"&&(Ky(e,t,m,r),g=e.memoizedState),(c=Ms||q1(e,t,c,r,p,g,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),r=!1)}return Yy(n,e,t,r,i,s)}function Yy(n,e,t,r,s,i){DI(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&L1(e,t,!1),ps(n,e,i);r=e.stateNode,wO.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Xa(e,n.child,null,i),e.child=Xa(e,null,a,i)):Yt(n,e,a,i),e.memoizedState=r.state,s&&L1(e,t,!0),e.child}function MI(n){var e=n.stateNode;e.pendingContext?V1(n,e.pendingContext,e.pendingContext!==e.context):e.context&&V1(n,e.context,!1),Yv(n,e.containerInfo)}function eE(n,e,t,r,s){return Ya(),Hv(s),e.flags|=256,Yt(n,e,t,r),e.child}var Xy={dehydrated:null,treeContext:null,retryLane:0};function Zy(n){return{baseLanes:n,cachePool:null,transitions:null}}function OI(n,e,t){var r=e.pendingProps,s=ze.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Oe(ze,s&1),n===null)return Hy(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Op(o,r,0,null),n=fo(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Zy(t),e.memoizedState=Xy,n):ix(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return _O(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=li(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=li(a,i):(i=fo(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?Zy(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Xy,r}return i=n.child,n=i.sibling,r=li(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function ix(n,e){return e=Op({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function jd(n,e,t,r){return r!==null&&Hv(r),Xa(e,n.child,null,t),n=ix(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function _O(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=kg(Error(W(422))),jd(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Op({mode:"visible",children:r.children},s,0,null),i=fo(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Xa(e,n.child,null,o),e.child.memoizedState=Zy(o),e.memoizedState=Xy,i);if(!(e.mode&1))return jd(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=kg(i,r,void 0),jd(n,e,o,r)}if(a=(o&n.childLanes)!==0,pn||a){if(r=wt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,fs(n,s),cr(r,n,s,-1))}return dx(),r=kg(Error(W(421))),jd(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=MO.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,In=si(s.nextSibling),An=e,Ue=!0,ir=null,n!==null&&(Bn[Un++]=Xr,Bn[Un++]=Zr,Bn[Un++]=bo,Xr=n.id,Zr=n.overflow,bo=e),e=ix(e,r.children),e.flags|=4096,e)}function tE(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),qy(n.return,e,t)}function bg(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function jI(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Yt(n,e,r.children,t),r=ze.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&tE(n,t,e);else if(n.tag===19)tE(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Oe(ze,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&ef(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),bg(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&ef(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}bg(e,!0,t,null,i);break;case"together":bg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ph(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ps(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),So|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(W(153));if(e.child!==null){for(n=e.child,t=li(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=li(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function EO(n,e,t){switch(e.tag){case 3:MI(e),Ya();break;case 5:lI(e);break;case 1:yn(e.type)&&Gh(e);break;case 4:Yv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Oe(Yh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Oe(ze,ze.current&1),e.flags|=128,null):t&e.child.childLanes?OI(n,e,t):(Oe(ze,ze.current&1),n=ps(n,e,t),n!==null?n.sibling:null);Oe(ze,ze.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return jI(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Oe(ze,ze.current),r)break;return null;case 22:case 23:return e.lanes=0,PI(n,e,t)}return ps(n,e,t)}var VI,e0,LI,FI;VI=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};e0=function(){};LI=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,oo(Cr.current);var i=null;switch(t){case"input":s=Ey(n,s),r=Ey(n,r),i=[];break;case"select":s=Ke({},s,{value:void 0}),r=Ke({},r,{value:void 0}),i=[];break;case"textarea":s=Ty(n,s),r=Ty(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=qh)}Iy(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Wc.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Wc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ve("scroll",n),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};FI=function(n,e,t,r){t!==r&&(e.flags|=4)};function ql(n,e){if(!Ue)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Ft(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function kO(n,e,t){var r=e.pendingProps;switch(Wv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return yn(e.type)&&Kh(),Ft(e),null;case 3:return r=e.stateNode,Za(),Fe(gn),Fe(Ht),Zv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Md(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ir!==null&&(l0(ir),ir=null))),e0(n,e),Ft(e),null;case 5:Xv(e);var s=oo(nu.current);if(t=e.type,n!==null&&e.stateNode!=null)LI(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Ft(e),null}if(n=oo(Cr.current),Md(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[Er]=e,r[eu]=i,n=(e.mode&1)!==0,t){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(s=0;s<ac.length;s++)Ve(ac[s],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":u1(r,i),Ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ve("invalid",r);break;case"textarea":h1(r,i),Ve("invalid",r)}Iy(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Dd(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Dd(r.textContent,a,n),s=["children",""+a]):Wc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ve("scroll",r)}switch(t){case"input":Td(r),d1(r,i,!0);break;case"textarea":Td(r),f1(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=qh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=fS(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Er]=e,n[eu]=r,VI(n,e,!1,!1),e.stateNode=n;e:{switch(o=Ny(t,r),t){case"dialog":Ve("cancel",n),Ve("close",n),s=r;break;case"iframe":case"object":case"embed":Ve("load",n),s=r;break;case"video":case"audio":for(s=0;s<ac.length;s++)Ve(ac[s],n);s=r;break;case"source":Ve("error",n),s=r;break;case"img":case"image":case"link":Ve("error",n),Ve("load",n),s=r;break;case"details":Ve("toggle",n),s=r;break;case"input":u1(n,r),s=Ey(n,r),Ve("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Ke({},r,{value:void 0}),Ve("invalid",n);break;case"textarea":h1(n,r),s=Ty(n,r),Ve("invalid",n);break;default:s=r}Iy(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?gS(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&pS(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Hc(n,l):typeof l=="number"&&Hc(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ve("scroll",n):l!=null&&Cv(n,i,l,o))}switch(t){case"input":Td(n),d1(n,r,!1);break;case"textarea":Td(n),f1(n);break;case"option":r.value!=null&&n.setAttribute("value",""+xi(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Va(n,!!r.multiple,i,!1):r.defaultValue!=null&&Va(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=qh)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(n&&e.stateNode!=null)FI(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(t=oo(nu.current),oo(Cr.current),Md(e)){if(r=e.stateNode,t=e.memoizedProps,r[Er]=e,(i=r.nodeValue!==t)&&(n=An,n!==null))switch(n.tag){case 3:Dd(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Dd(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Er]=e,e.stateNode=r}return Ft(e),null;case 13:if(Fe(ze),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ue&&In!==null&&e.mode&1&&!(e.flags&128))rI(),Ya(),e.flags|=98560,i=!1;else if(i=Md(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Er]=e}else Ya(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),i=!1}else ir!==null&&(l0(ir),ir=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||ze.current&1?dt===0&&(dt=3):dx())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return Za(),e0(n,e),n===null&&Xc(e.stateNode.containerInfo),Ft(e),null;case 10:return Gv(e.type._context),Ft(e),null;case 17:return yn(e.type)&&Kh(),Ft(e),null;case 19:if(Fe(ze),i=e.memoizedState,i===null)return Ft(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ql(i,!1);else{if(dt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=ef(n),o!==null){for(e.flags|=128,ql(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Oe(ze,ze.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ze()>tl&&(e.flags|=128,r=!0,ql(i,!1),e.lanes=4194304)}else{if(!r)if(n=ef(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),ql(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ue)return Ft(e),null}else 2*Ze()-i.renderingStartTime>tl&&t!==1073741824&&(e.flags|=128,r=!0,ql(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ze(),e.sibling=null,t=ze.current,Oe(ze,r?t&1|2:t&1),e):(Ft(e),null);case 22:case 23:return ux(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bn&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function bO(n,e){switch(Wv(e),e.tag){case 1:return yn(e.type)&&Kh(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Za(),Fe(gn),Fe(Ht),Zv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Xv(e),null;case 13:if(Fe(ze),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(W(340));Ya()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Fe(ze),null;case 4:return Za(),null;case 10:return Gv(e.type._context),null;case 22:case 23:return ux(),null;case 24:return null;default:return null}}var Vd=!1,$t=!1,TO=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Ra(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Je(n,e,r)}else t.current=null}function t0(n,e,t){try{t()}catch(r){Je(n,e,r)}}var nE=!1;function SO(n,e){if(Ly=zh,n=WS(),$v(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=n,p=null;t:for(;;){for(var m;h!==t||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===n)break t;if(p===t&&++c===s&&(a=o),p===i&&++u===r&&(l=o),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Fy={focusedElem:n,selectionRange:t},zh=!1,Y=e;Y!==null;)if(e=Y,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Y=n;else for(;Y!==null;){e=Y;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,x=g.memoizedState,_=e.stateNode,b=_.getSnapshotBeforeUpdate(e.elementType===e.type?v:rr(e.type,v),x);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(A){Je(e,e.return,A)}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}return g=nE,nE=!1,g}function Tc(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&t0(e,t,i)}s=s.next}while(s!==r)}}function Dp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function n0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function BI(n){var e=n.alternate;e!==null&&(n.alternate=null,BI(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Er],delete e[eu],delete e[$y],delete e[lO],delete e[cO])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function UI(n){return n.tag===5||n.tag===3||n.tag===4}function rE(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||UI(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function r0(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=qh));else if(r!==4&&(n=n.child,n!==null))for(r0(n,e,t),n=n.sibling;n!==null;)r0(n,e,t),n=n.sibling}function s0(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(s0(n,e,t),n=n.sibling;n!==null;)s0(n,e,t),n=n.sibling}var St=null,sr=!1;function Ss(n,e,t){for(t=t.child;t!==null;)$I(n,e,t),t=t.sibling}function $I(n,e,t){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Tp,t)}catch{}switch(t.tag){case 5:$t||Ra(t,e);case 6:var r=St,s=sr;St=null,Ss(n,e,t),St=r,sr=s,St!==null&&(sr?(n=St,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):St.removeChild(t.stateNode));break;case 18:St!==null&&(sr?(n=St,t=t.stateNode,n.nodeType===8?yg(n.parentNode,t):n.nodeType===1&&yg(n,t),Qc(n)):yg(St,t.stateNode));break;case 4:r=St,s=sr,St=t.stateNode.containerInfo,sr=!0,Ss(n,e,t),St=r,sr=s;break;case 0:case 11:case 14:case 15:if(!$t&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&t0(t,e,o),s=s.next}while(s!==r)}Ss(n,e,t);break;case 1:if(!$t&&(Ra(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Je(t,e,a)}Ss(n,e,t);break;case 21:Ss(n,e,t);break;case 22:t.mode&1?($t=(r=$t)||t.memoizedState!==null,Ss(n,e,t),$t=r):Ss(n,e,t);break;default:Ss(n,e,t)}}function sE(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new TO),e.forEach(function(r){var s=OO.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function nr(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:St=a.stateNode,sr=!1;break e;case 3:St=a.stateNode.containerInfo,sr=!0;break e;case 4:St=a.stateNode.containerInfo,sr=!0;break e}a=a.return}if(St===null)throw Error(W(160));$I(i,o,s),St=null,sr=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Je(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)zI(e,n),e=e.sibling}function zI(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(nr(e,n),yr(n),r&4){try{Tc(3,n,n.return),Dp(3,n)}catch(v){Je(n,n.return,v)}try{Tc(5,n,n.return)}catch(v){Je(n,n.return,v)}}break;case 1:nr(e,n),yr(n),r&512&&t!==null&&Ra(t,t.return);break;case 5:if(nr(e,n),yr(n),r&512&&t!==null&&Ra(t,t.return),n.flags&32){var s=n.stateNode;try{Hc(s,"")}catch(v){Je(n,n.return,v)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&dS(s,i),Ny(a,o);var c=Ny(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?gS(s,h):u==="dangerouslySetInnerHTML"?pS(s,h):u==="children"?Hc(s,h):Cv(s,u,h,c)}switch(a){case"input":ky(s,i);break;case"textarea":hS(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Va(s,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?Va(s,!!i.multiple,i.defaultValue,!0):Va(s,!!i.multiple,i.multiple?[]:"",!1))}s[eu]=i}catch(v){Je(n,n.return,v)}}break;case 6:if(nr(e,n),yr(n),r&4){if(n.stateNode===null)throw Error(W(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(v){Je(n,n.return,v)}}break;case 3:if(nr(e,n),yr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Qc(e.containerInfo)}catch(v){Je(n,n.return,v)}break;case 4:nr(e,n),yr(n);break;case 13:nr(e,n),yr(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lx=Ze())),r&4&&sE(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?($t=(c=$t)||u,nr(e,n),$t=c):nr(e,n),yr(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(Y=n,u=n.child;u!==null;){for(h=Y=u;Y!==null;){switch(p=Y,m=p.child,p.tag){case 0:case 11:case 14:case 15:Tc(4,p,p.return);break;case 1:Ra(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){r=p,t=p.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){Je(r,t,v)}}break;case 5:Ra(p,p.return);break;case 22:if(p.memoizedState!==null){oE(h);continue}}m!==null?(m.return=p,Y=m):oE(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=mS("display",o))}catch(v){Je(n,n.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Je(n,n.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:nr(e,n),yr(n),r&4&&sE(n);break;case 21:break;default:nr(e,n),yr(n)}}function yr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(UI(t)){var r=t;break e}t=t.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Hc(s,""),r.flags&=-33);var i=rE(n);s0(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=rE(n);r0(n,a,o);break;default:throw Error(W(161))}}catch(l){Je(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function IO(n,e,t){Y=n,WI(n)}function WI(n,e,t){for(var r=(n.mode&1)!==0;Y!==null;){var s=Y,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Vd;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||$t;a=Vd;var c=$t;if(Vd=o,($t=l)&&!c)for(Y=s;Y!==null;)o=Y,l=o.child,o.tag===22&&o.memoizedState!==null?aE(s):l!==null?(l.return=o,Y=l):aE(s);for(;i!==null;)Y=i,WI(i),i=i.sibling;Y=s,Vd=a,$t=c}iE(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Y=i):iE(n)}}function iE(n){for(;Y!==null;){var e=Y;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$t||Dp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$t)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:rr(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&z1(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}z1(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Qc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}$t||e.flags&512&&n0(e)}catch(p){Je(e,e.return,p)}}if(e===n){Y=null;break}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}}function oE(n){for(;Y!==null;){var e=Y;if(e===n){Y=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Y=t;break}Y=e.return}}function aE(n){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Dp(4,e)}catch(l){Je(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Je(e,s,l)}}var i=e.return;try{n0(e)}catch(l){Je(e,i,l)}break;case 5:var o=e.return;try{n0(e)}catch(l){Je(e,o,l)}}}catch(l){Je(e,e.return,l)}if(e===n){Y=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Y=a;break}Y=e.return}}var NO=Math.ceil,rf=xs.ReactCurrentDispatcher,ox=xs.ReactCurrentOwner,Gn=xs.ReactCurrentBatchConfig,Te=0,wt=null,it=null,Dt=0,bn=0,Pa=Ai(0),dt=0,ou=null,So=0,Mp=0,ax=0,Sc=null,hn=null,lx=0,tl=1/0,Qr=null,sf=!1,i0=null,oi=null,Ld=!1,Qs=null,of=0,Ic=0,o0=null,mh=-1,gh=0;function tn(){return Te&6?Ze():mh!==-1?mh:mh=Ze()}function ai(n){return n.mode&1?Te&2&&Dt!==0?Dt&-Dt:dO.transition!==null?(gh===0&&(gh=NS()),gh):(n=Re,n!==0||(n=window.event,n=n===void 0?16:OS(n.type)),n):1}function cr(n,e,t,r){if(50<Ic)throw Ic=0,o0=null,Error(W(185));Ou(n,t,r),(!(Te&2)||n!==wt)&&(n===wt&&(!(Te&2)&&(Mp|=t),dt===4&&Fs(n,Dt)),vn(n,r),t===1&&Te===0&&!(e.mode&1)&&(tl=Ze()+500,Ap&&Ri()))}function vn(n,e){var t=n.callbackNode;dM(n,e);var r=$h(n,n===wt?Dt:0);if(r===0)t!==null&&g1(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&g1(t),e===1)n.tag===0?uO(lE.bind(null,n)):eI(lE.bind(null,n)),oO(function(){!(Te&6)&&Ri()}),t=null;else{switch(CS(r)){case 1:t=Mv;break;case 4:t=SS;break;case 16:t=Uh;break;case 536870912:t=IS;break;default:t=Uh}t=XI(t,HI.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function HI(n,e){if(mh=-1,gh=0,Te&6)throw Error(W(327));var t=n.callbackNode;if($a()&&n.callbackNode!==t)return null;var r=$h(n,n===wt?Dt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=af(n,r);else{e=r;var s=Te;Te|=2;var i=KI();(wt!==n||Dt!==e)&&(Qr=null,tl=Ze()+500,ho(n,e));do try{RO();break}catch(a){qI(n,a)}while(!0);Kv(),rf.current=i,Te=s,it!==null?e=0:(wt=null,Dt=0,e=dt)}if(e!==0){if(e===2&&(s=Dy(n),s!==0&&(r=s,e=a0(n,s))),e===1)throw t=ou,ho(n,0),Fs(n,r),vn(n,Ze()),t;if(e===6)Fs(n,r);else{if(s=n.current.alternate,!(r&30)&&!CO(s)&&(e=af(n,r),e===2&&(i=Dy(n),i!==0&&(r=i,e=a0(n,i))),e===1))throw t=ou,ho(n,0),Fs(n,r),vn(n,Ze()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:Gi(n,hn,Qr);break;case 3:if(Fs(n,r),(r&130023424)===r&&(e=lx+500-Ze(),10<e)){if($h(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){tn(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=Uy(Gi.bind(null,n,hn,Qr),e);break}Gi(n,hn,Qr);break;case 4:if(Fs(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-lr(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*NO(r/1960))-r,10<r){n.timeoutHandle=Uy(Gi.bind(null,n,hn,Qr),r);break}Gi(n,hn,Qr);break;case 5:Gi(n,hn,Qr);break;default:throw Error(W(329))}}}return vn(n,Ze()),n.callbackNode===t?HI.bind(null,n):null}function a0(n,e){var t=Sc;return n.current.memoizedState.isDehydrated&&(ho(n,e).flags|=256),n=af(n,e),n!==2&&(e=hn,hn=t,e!==null&&l0(e)),n}function l0(n){hn===null?hn=n:hn.push.apply(hn,n)}function CO(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!dr(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fs(n,e){for(e&=~ax,e&=~Mp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-lr(e),r=1<<t;n[t]=-1,e&=~r}}function lE(n){if(Te&6)throw Error(W(327));$a();var e=$h(n,0);if(!(e&1))return vn(n,Ze()),null;var t=af(n,e);if(n.tag!==0&&t===2){var r=Dy(n);r!==0&&(e=r,t=a0(n,r))}if(t===1)throw t=ou,ho(n,0),Fs(n,e),vn(n,Ze()),t;if(t===6)throw Error(W(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Gi(n,hn,Qr),vn(n,Ze()),null}function cx(n,e){var t=Te;Te|=1;try{return n(e)}finally{Te=t,Te===0&&(tl=Ze()+500,Ap&&Ri())}}function Io(n){Qs!==null&&Qs.tag===0&&!(Te&6)&&$a();var e=Te;Te|=1;var t=Gn.transition,r=Re;try{if(Gn.transition=null,Re=1,n)return n()}finally{Re=r,Gn.transition=t,Te=e,!(Te&6)&&Ri()}}function ux(){bn=Pa.current,Fe(Pa)}function ho(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,iO(t)),it!==null)for(t=it.return;t!==null;){var r=t;switch(Wv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Kh();break;case 3:Za(),Fe(gn),Fe(Ht),Zv();break;case 5:Xv(r);break;case 4:Za();break;case 13:Fe(ze);break;case 19:Fe(ze);break;case 10:Gv(r.type._context);break;case 22:case 23:ux()}t=t.return}if(wt=n,it=n=li(n.current,null),Dt=bn=e,dt=0,ou=null,ax=Mp=So=0,hn=Sc=null,io!==null){for(e=0;e<io.length;e++)if(t=io[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}io=null}return n}function qI(n,e){do{var t=it;try{if(Kv(),hh.current=nf,tf){for(var r=He.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}tf=!1}if(To=0,yt=ct=He=null,bc=!1,ru=0,ox.current=null,t===null||t.return===null){dt=1,ou=e,it=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=Dt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=Q1(o);if(m!==null){m.flags&=-257,J1(m,o,a,i,e),m.mode&1&&G1(i,c,e),e=m,l=c;var g=e.updateQueue;if(g===null){var v=new Set;v.add(l),e.updateQueue=v}else g.add(l);break e}else{if(!(e&1)){G1(i,c,e),dx();break e}l=Error(W(426))}}else if(Ue&&a.mode&1){var x=Q1(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),J1(x,o,a,i,e),Hv(el(l,a));break e}}i=l=el(l,a),dt!==4&&(dt=2),Sc===null?Sc=[i]:Sc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=CI(i,l,e);$1(i,_);break e;case 1:a=l;var b=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(oi===null||!oi.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=AI(i,a,e);$1(i,A);break e}}i=i.return}while(i!==null)}QI(t)}catch(R){e=R,it===t&&t!==null&&(it=t=t.return);continue}break}while(!0)}function KI(){var n=rf.current;return rf.current=nf,n===null?nf:n}function dx(){(dt===0||dt===3||dt===2)&&(dt=4),wt===null||!(So&268435455)&&!(Mp&268435455)||Fs(wt,Dt)}function af(n,e){var t=Te;Te|=2;var r=KI();(wt!==n||Dt!==e)&&(Qr=null,ho(n,e));do try{AO();break}catch(s){qI(n,s)}while(!0);if(Kv(),Te=t,rf.current=r,it!==null)throw Error(W(261));return wt=null,Dt=0,dt}function AO(){for(;it!==null;)GI(it)}function RO(){for(;it!==null&&!nM();)GI(it)}function GI(n){var e=YI(n.alternate,n,bn);n.memoizedProps=n.pendingProps,e===null?QI(n):it=e,ox.current=null}function QI(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=bO(t,e),t!==null){t.flags&=32767,it=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{dt=6,it=null;return}}else if(t=kO(t,e,bn),t!==null){it=t;return}if(e=e.sibling,e!==null){it=e;return}it=e=n}while(e!==null);dt===0&&(dt=5)}function Gi(n,e,t){var r=Re,s=Gn.transition;try{Gn.transition=null,Re=1,PO(n,e,t,r)}finally{Gn.transition=s,Re=r}return null}function PO(n,e,t,r){do $a();while(Qs!==null);if(Te&6)throw Error(W(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(W(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(hM(n,i),n===wt&&(it=wt=null,Dt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ld||(Ld=!0,XI(Uh,function(){return $a(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Gn.transition,Gn.transition=null;var o=Re;Re=1;var a=Te;Te|=4,ox.current=null,SO(n,t),zI(t,n),XM(Fy),zh=!!Ly,Fy=Ly=null,n.current=t,IO(t),rM(),Te=a,Re=o,Gn.transition=i}else n.current=t;if(Ld&&(Ld=!1,Qs=n,of=s),i=n.pendingLanes,i===0&&(oi=null),oM(t.stateNode),vn(n,Ze()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(sf)throw sf=!1,n=i0,i0=null,n;return of&1&&n.tag!==0&&$a(),i=n.pendingLanes,i&1?n===o0?Ic++:(Ic=0,o0=n):Ic=0,Ri(),null}function $a(){if(Qs!==null){var n=CS(of),e=Gn.transition,t=Re;try{if(Gn.transition=null,Re=16>n?16:n,Qs===null)var r=!1;else{if(n=Qs,Qs=null,of=0,Te&6)throw Error(W(331));var s=Te;for(Te|=4,Y=n.current;Y!==null;){var i=Y,o=i.child;if(Y.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(Y=c;Y!==null;){var u=Y;switch(u.tag){case 0:case 11:case 15:Tc(8,u,i)}var h=u.child;if(h!==null)h.return=u,Y=h;else for(;Y!==null;){u=Y;var p=u.sibling,m=u.return;if(BI(u),u===c){Y=null;break}if(p!==null){p.return=m,Y=p;break}Y=m}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}Y=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Y=o;else e:for(;Y!==null;){if(i=Y,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Tc(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,Y=_;break e}Y=i.return}}var b=n.current;for(Y=b;Y!==null;){o=Y;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,Y=T;else e:for(o=b;Y!==null;){if(a=Y,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Dp(9,a)}}catch(R){Je(a,a.return,R)}if(a===o){Y=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,Y=A;break e}Y=a.return}}if(Te=s,Ri(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Tp,n)}catch{}r=!0}return r}finally{Re=t,Gn.transition=e}}return!1}function cE(n,e,t){e=el(t,e),e=CI(n,e,1),n=ii(n,e,1),e=tn(),n!==null&&(Ou(n,1,e),vn(n,e))}function Je(n,e,t){if(n.tag===3)cE(n,n,t);else for(;e!==null;){if(e.tag===3){cE(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oi===null||!oi.has(r))){n=el(t,n),n=AI(e,n,1),e=ii(e,n,1),n=tn(),e!==null&&(Ou(e,1,n),vn(e,n));break}}e=e.return}}function DO(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=tn(),n.pingedLanes|=n.suspendedLanes&t,wt===n&&(Dt&t)===t&&(dt===4||dt===3&&(Dt&130023424)===Dt&&500>Ze()-lx?ho(n,0):ax|=t),vn(n,e)}function JI(n,e){e===0&&(n.mode&1?(e=Nd,Nd<<=1,!(Nd&130023424)&&(Nd=4194304)):e=1);var t=tn();n=fs(n,e),n!==null&&(Ou(n,e,t),vn(n,t))}function MO(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),JI(n,t)}function OO(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),JI(n,t)}var YI;YI=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||gn.current)pn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return pn=!1,EO(n,e,t);pn=!!(n.flags&131072)}else pn=!1,Ue&&e.flags&1048576&&tI(e,Jh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ph(n,e),n=e.pendingProps;var s=Ja(e,Ht.current);Ua(e,t),s=tx(null,e,r,n,s,t);var i=nx();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yn(r)?(i=!0,Gh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Jv(e),s.updater=Pp,e.stateNode=s,s._reactInternals=e,Gy(e,r,n,t),e=Yy(null,e,r,!0,i,t)):(e.tag=0,Ue&&i&&zv(e),Yt(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(ph(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=VO(r),n=rr(r,n),s){case 0:e=Jy(null,e,r,n,t);break e;case 1:e=Z1(null,e,r,n,t);break e;case 11:e=Y1(null,e,r,n,t);break e;case 14:e=X1(null,e,r,rr(r.type,n),t);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rr(r,s),Jy(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rr(r,s),Z1(n,e,r,s,t);case 3:e:{if(MI(e),n===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,aI(n,e),Zh(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=el(Error(W(423)),e),e=eE(n,e,r,t,s);break e}else if(r!==s){s=el(Error(W(424)),e),e=eE(n,e,r,t,s);break e}else for(In=si(e.stateNode.containerInfo.firstChild),An=e,Ue=!0,ir=null,t=iI(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ya(),r===s){e=ps(n,e,t);break e}Yt(n,e,r,t)}e=e.child}return e;case 5:return lI(e),n===null&&Hy(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,By(r,s)?o=null:i!==null&&By(r,i)&&(e.flags|=32),DI(n,e),Yt(n,e,o,t),e.child;case 6:return n===null&&Hy(e),null;case 13:return OI(n,e,t);case 4:return Yv(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Xa(e,null,r,t):Yt(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rr(r,s),Y1(n,e,r,s,t);case 7:return Yt(n,e,e.pendingProps,t),e.child;case 8:return Yt(n,e,e.pendingProps.children,t),e.child;case 12:return Yt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Oe(Yh,r._currentValue),r._currentValue=o,i!==null)if(dr(i.value,o)){if(i.children===s.children&&!gn.current){e=ps(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=as(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),qy(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),qy(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Yt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ua(e,t),s=Zn(s),r=r(s),e.flags|=1,Yt(n,e,r,t),e.child;case 14:return r=e.type,s=rr(r,e.pendingProps),s=rr(r.type,s),X1(n,e,r,s,t);case 15:return RI(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:rr(r,s),ph(n,e),e.tag=1,yn(r)?(n=!0,Gh(e)):n=!1,Ua(e,t),NI(e,r,s),Gy(e,r,s,t),Yy(null,e,r,!0,n,t);case 19:return jI(n,e,t);case 22:return PI(n,e,t)}throw Error(W(156,e.tag))};function XI(n,e){return TS(n,e)}function jO(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(n,e,t,r){return new jO(n,e,t,r)}function hx(n){return n=n.prototype,!(!n||!n.isReactComponent)}function VO(n){if(typeof n=="function")return hx(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Rv)return 11;if(n===Pv)return 14}return 2}function li(n,e){var t=n.alternate;return t===null?(t=qn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function yh(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")hx(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Ea:return fo(t.children,s,i,e);case Av:o=8,s|=8;break;case vy:return n=qn(12,t,e,s|2),n.elementType=vy,n.lanes=i,n;case xy:return n=qn(13,t,e,s),n.elementType=xy,n.lanes=i,n;case wy:return n=qn(19,t,e,s),n.elementType=wy,n.lanes=i,n;case lS:return Op(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case oS:o=10;break e;case aS:o=9;break e;case Rv:o=11;break e;case Pv:o=14;break e;case Ds:o=16,r=null;break e}throw Error(W(130,n==null?n:typeof n,""))}return e=qn(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function fo(n,e,t,r){return n=qn(7,n,r,e),n.lanes=t,n}function Op(n,e,t,r){return n=qn(22,n,r,e),n.elementType=lS,n.lanes=t,n.stateNode={isHidden:!1},n}function Tg(n,e,t){return n=qn(6,n,null,e),n.lanes=t,n}function Sg(n,e,t){return e=qn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function LO(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=og(0),this.expirationTimes=og(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=og(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function fx(n,e,t,r,s,i,o,a,l){return n=new LO(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=qn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jv(i),n}function FO(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_a,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function ZI(n){if(!n)return wi;n=n._reactInternals;e:{if(Ko(n)!==n||n.tag!==1)throw Error(W(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(n.tag===1){var t=n.type;if(yn(t))return ZS(n,t,e)}return e}function eN(n,e,t,r,s,i,o,a,l){return n=fx(t,r,!0,n,s,i,o,a,l),n.context=ZI(null),t=n.current,r=tn(),s=ai(t),i=as(r,s),i.callback=e??null,ii(t,i,s),n.current.lanes=s,Ou(n,s,r),vn(n,r),n}function jp(n,e,t,r){var s=e.current,i=tn(),o=ai(s);return t=ZI(t),e.context===null?e.context=t:e.pendingContext=t,e=as(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=ii(s,e,o),n!==null&&(cr(n,s,o,i),dh(n,s,o)),o}function lf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function uE(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function px(n,e){uE(n,e),(n=n.alternate)&&uE(n,e)}function BO(){return null}var tN=typeof reportError=="function"?reportError:function(n){console.error(n)};function mx(n){this._internalRoot=n}Vp.prototype.render=mx.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(W(409));jp(n,e,null,null)};Vp.prototype.unmount=mx.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Io(function(){jp(null,n,null,null)}),e[hs]=null}};function Vp(n){this._internalRoot=n}Vp.prototype.unstable_scheduleHydration=function(n){if(n){var e=PS();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ls.length&&e!==0&&e<Ls[t].priority;t++);Ls.splice(t,0,n),t===0&&MS(n)}};function gx(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Lp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function dE(){}function UO(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=lf(o);i.call(c)}}var o=eN(e,r,n,0,null,!1,!1,"",dE);return n._reactRootContainer=o,n[hs]=o.current,Xc(n.nodeType===8?n.parentNode:n),Io(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=lf(l);a.call(c)}}var l=fx(n,0,!1,null,null,!1,!1,"",dE);return n._reactRootContainer=l,n[hs]=l.current,Xc(n.nodeType===8?n.parentNode:n),Io(function(){jp(e,l,t,r)}),l}function Fp(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=lf(o);a.call(l)}}jp(e,o,n,s)}else o=UO(t,e,n,s,r);return lf(o)}AS=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=oc(e.pendingLanes);t!==0&&(Ov(e,t|1),vn(e,Ze()),!(Te&6)&&(tl=Ze()+500,Ri()))}break;case 13:Io(function(){var r=fs(n,1);if(r!==null){var s=tn();cr(r,n,1,s)}}),px(n,1)}};jv=function(n){if(n.tag===13){var e=fs(n,134217728);if(e!==null){var t=tn();cr(e,n,134217728,t)}px(n,134217728)}};RS=function(n){if(n.tag===13){var e=ai(n),t=fs(n,e);if(t!==null){var r=tn();cr(t,n,e,r)}px(n,e)}};PS=function(){return Re};DS=function(n,e){var t=Re;try{return Re=n,e()}finally{Re=t}};Ay=function(n,e,t){switch(e){case"input":if(ky(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=Cp(r);if(!s)throw Error(W(90));uS(r),ky(r,s)}}}break;case"textarea":hS(n,t);break;case"select":e=t.value,e!=null&&Va(n,!!t.multiple,e,!1)}};xS=cx;wS=Io;var $O={usingClientEntryPoint:!1,Events:[Vu,Sa,Cp,yS,vS,cx]},Kl={findFiberByHostInstance:so,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zO={bundleType:Kl.bundleType,version:Kl.version,rendererPackageName:Kl.rendererPackageName,rendererConfig:Kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xs.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=kS(n),n===null?null:n.stateNode},findFiberByHostInstance:Kl.findFiberByHostInstance||BO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fd.isDisabled&&Fd.supportsFiber)try{Tp=Fd.inject(zO),Nr=Fd}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$O;Mn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gx(e))throw Error(W(200));return FO(n,e,null,t)};Mn.createRoot=function(n,e){if(!gx(n))throw Error(W(299));var t=!1,r="",s=tN;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=fx(n,1,!1,null,null,t,!1,r,s),n[hs]=e.current,Xc(n.nodeType===8?n.parentNode:n),new mx(e)};Mn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(W(188)):(n=Object.keys(n).join(","),Error(W(268,n)));return n=kS(e),n=n===null?null:n.stateNode,n};Mn.flushSync=function(n){return Io(n)};Mn.hydrate=function(n,e,t){if(!Lp(e))throw Error(W(200));return Fp(null,n,e,!0,t)};Mn.hydrateRoot=function(n,e,t){if(!gx(n))throw Error(W(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=tN;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=eN(e,null,n,1,t??null,s,!1,i,o),n[hs]=e.current,Xc(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Vp(e)};Mn.render=function(n,e,t){if(!Lp(e))throw Error(W(200));return Fp(null,n,e,!1,t)};Mn.unmountComponentAtNode=function(n){if(!Lp(n))throw Error(W(40));return n._reactRootContainer?(Io(function(){Fp(null,null,n,!1,function(){n._reactRootContainer=null,n[hs]=null})}),!0):!1};Mn.unstable_batchedUpdates=cx;Mn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Lp(t))throw Error(W(200));if(n==null||n._reactInternals===void 0)throw Error(W(38));return Fp(n,e,t,!1,r)};Mn.version="18.3.1-next-f1338f8080-20240426";function nN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nN)}catch(n){console.error(n)}}nN(),nS.exports=Mn;var rN=nS.exports;const WO=WT(rN);var hE=rN;gy.createRoot=hE.createRoot,gy.hydrateRoot=hE.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function au(){return au=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},au.apply(this,arguments)}var Js;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Js||(Js={}));const fE="popstate";function HO(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return c0("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:cf(s)}return KO(e,t,null,n)}function at(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function sN(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function qO(){return Math.random().toString(36).substr(2,8)}function pE(n,e){return{usr:n.state,key:n.key,idx:e}}function c0(n,e,t,r){return t===void 0&&(t=null),au({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?wl(e):e,{state:t,key:e&&e.key||r||qO()})}function cf(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function wl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function KO(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Js.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(au({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Js.Pop;let x=u(),_=x==null?null:x-c;c=x,l&&l({action:a,location:v.location,delta:_})}function p(x,_){a=Js.Push;let b=c0(v.location,x,_);c=u()+1;let T=pE(b,c),A=v.createHref(b);try{o.pushState(T,"",A)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(A)}i&&l&&l({action:a,location:v.location,delta:1})}function m(x,_){a=Js.Replace;let b=c0(v.location,x,_);c=u();let T=pE(b,c),A=v.createHref(b);o.replaceState(T,"",A),i&&l&&l({action:a,location:v.location,delta:0})}function g(x){let _=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof x=="string"?x:cf(x);return b=b.replace(/ $/,"%20"),at(_,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,_)}let v={get action(){return a},get location(){return n(s,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(fE,h),l=x,()=>{s.removeEventListener(fE,h),l=null}},createHref(x){return e(s,x)},createURL:g,encodeLocation(x){let _=g(x);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:p,replace:m,go(x){return o.go(x)}};return v}var mE;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(mE||(mE={}));function GO(n,e,t){return t===void 0&&(t="/"),QO(n,e,t)}function QO(n,e,t,r){let s=typeof e=="string"?wl(e):e,i=yx(s.pathname||"/",t);if(i==null)return null;let o=iN(n);JO(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=lj(i);a=ij(o[l],c)}return a}function iN(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(at(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=ci([r,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(at(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),iN(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:rj(c,i.index),routesMeta:u})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of oN(i.path))s(i,o,l)}),e}function oN(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=oN(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function JO(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:sj(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const YO=/^:[\w-]+$/,XO=3,ZO=2,ej=1,tj=10,nj=-2,gE=n=>n==="*";function rj(n,e){let t=n.split("/"),r=t.length;return t.some(gE)&&(r+=nj),e&&(r+=ZO),t.filter(s=>!gE(s)).reduce((s,i)=>s+(YO.test(i)?XO:i===""?ej:tj),r)}function sj(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function ij(n,e,t){let{routesMeta:r}=n,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=oj({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:ci([i,h.pathname]),pathnameBase:hj(ci([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=ci([i,h.pathnameBase]))}return o}function oj(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=aj(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:p,isOptional:m}=u;if(p==="*"){let v=a[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=a[h];return m&&!g?c[p]=void 0:c[p]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:n}}function aj(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),sN(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function lj(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return sN(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function yx(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function cj(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?wl(n):n;return{pathname:t?t.startsWith("/")?t:uj(t,e):e,search:fj(r),hash:pj(s)}}function uj(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Ig(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dj(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function aN(n,e){let t=dj(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function lN(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=wl(n):(s=au({},n),at(!s.pathname||!s.pathname.includes("?"),Ig("?","pathname","search",s)),at(!s.pathname||!s.pathname.includes("#"),Ig("#","pathname","hash",s)),at(!s.search||!s.search.includes("#"),Ig("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;s.pathname=p.join("/")}a=h>=0?e[h]:"/"}let l=cj(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ci=n=>n.join("/").replace(/\/\/+/g,"/"),hj=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),fj=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,pj=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function mj(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const cN=["post","put","patch","delete"];new Set(cN);const gj=["get",...cN];new Set(gj);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lu(){return lu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},lu.apply(this,arguments)}const vx=O.createContext(null),yj=O.createContext(null),Go=O.createContext(null),Bp=O.createContext(null),Pi=O.createContext({outlet:null,matches:[],isDataRoute:!1}),uN=O.createContext(null);function vj(n,e){let{relative:t}=e===void 0?{}:e;Fu()||at(!1);let{basename:r,navigator:s}=O.useContext(Go),{hash:i,pathname:o,search:a}=hN(n,{relative:t}),l=o;return r!=="/"&&(l=o==="/"?r:ci([r,o])),s.createHref({pathname:l,search:a,hash:i})}function Fu(){return O.useContext(Bp)!=null}function Bu(){return Fu()||at(!1),O.useContext(Bp).location}function dN(n){O.useContext(Go).static||O.useLayoutEffect(n)}function xj(){let{isDataRoute:n}=O.useContext(Pi);return n?Dj():wj()}function wj(){Fu()||at(!1);let n=O.useContext(vx),{basename:e,future:t,navigator:r}=O.useContext(Go),{matches:s}=O.useContext(Pi),{pathname:i}=Bu(),o=JSON.stringify(aN(s,t.v7_relativeSplatPath)),a=O.useRef(!1);return dN(()=>{a.current=!0}),O.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=lN(c,JSON.parse(o),i,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ci([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,n])}function _j(){let{matches:n}=O.useContext(Pi),e=n[n.length-1];return e?e.params:{}}function hN(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=O.useContext(Go),{matches:s}=O.useContext(Pi),{pathname:i}=Bu(),o=JSON.stringify(aN(s,r.v7_relativeSplatPath));return O.useMemo(()=>lN(n,JSON.parse(o),i,t==="path"),[n,o,i,t])}function Ej(n,e){return kj(n,e)}function kj(n,e,t,r){Fu()||at(!1);let{navigator:s}=O.useContext(Go),{matches:i}=O.useContext(Pi),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=Bu(),u;if(e){var h;let x=typeof e=="string"?wl(e):e;l==="/"||(h=x.pathname)!=null&&h.startsWith(l)||at(!1),u=x}else u=c;let p=u.pathname||"/",m=p;if(l!=="/"){let x=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=GO(n,{pathname:m}),v=Nj(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},a,x.params),pathname:ci([l,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:ci([l,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,t,r);return e&&v?O.createElement(Bp.Provider,{value:{location:lu({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Js.Pop}},v):v}function bj(){let n=Pj(),e=mj(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),t?O.createElement("pre",{style:s},t):null,null)}const Tj=O.createElement(bj,null);class Sj extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?O.createElement(Pi.Provider,{value:this.props.routeContext},O.createElement(uN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ij(n){let{routeContext:e,match:t,children:r}=n,s=O.useContext(vx);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),O.createElement(Pi.Provider,{value:e},r)}function Nj(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||at(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:p,errors:m}=t,g=h.route.loader&&p[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,p)=>{let m,g=!1,v=null,x=null;t&&(m=a&&h.route.id?a[h.route.id]:void 0,v=h.route.errorElement||Tj,l&&(c<0&&p===0?(Mj("route-fallback"),g=!0,x=null):c===p&&(g=!0,x=h.route.hydrateFallbackElement||null)));let _=e.concat(o.slice(0,p+1)),b=()=>{let T;return m?T=v:g?T=x:h.route.Component?T=O.createElement(h.route.Component,null):h.route.element?T=h.route.element:T=u,O.createElement(Ij,{match:h,routeContext:{outlet:u,matches:_,isDataRoute:t!=null},children:T})};return t&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?O.createElement(Sj,{location:t.location,revalidation:t.revalidation,component:v,error:m,children:b(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):b()},null)}var fN=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(fN||{}),pN=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(pN||{});function Cj(n){let e=O.useContext(vx);return e||at(!1),e}function Aj(n){let e=O.useContext(yj);return e||at(!1),e}function Rj(n){let e=O.useContext(Pi);return e||at(!1),e}function mN(n){let e=Rj(),t=e.matches[e.matches.length-1];return t.route.id||at(!1),t.route.id}function Pj(){var n;let e=O.useContext(uN),t=Aj(),r=mN();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Dj(){let{router:n}=Cj(fN.UseNavigateStable),e=mN(pN.UseNavigateStable),t=O.useRef(!1);return dN(()=>{t.current=!0}),O.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,lu({fromRouteId:e},i)))},[n,e])}const yE={};function Mj(n,e,t){yE[n]||(yE[n]=!0)}function Oj(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Kr(n){at(!1)}function jj(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Js.Pop,navigator:i,static:o=!1,future:a}=n;Fu()&&at(!1);let l=e.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:i,static:o,future:lu({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=wl(r));let{pathname:u="/",search:h="",hash:p="",state:m=null,key:g="default"}=r,v=O.useMemo(()=>{let x=yx(u,l);return x==null?null:{location:{pathname:x,search:h,hash:p,state:m,key:g},navigationType:s}},[l,u,h,p,m,g,s]);return v==null?null:O.createElement(Go.Provider,{value:c},O.createElement(Bp.Provider,{children:t,value:v}))}function Vj(n){let{children:e,location:t}=n;return Ej(u0(e),t)}new Promise(()=>{});function u0(n,e){e===void 0&&(e=[]);let t=[];return O.Children.forEach(n,(r,s)=>{if(!O.isValidElement(r))return;let i=[...e,s];if(r.type===O.Fragment){t.push.apply(t,u0(r.props.children,i));return}r.type!==Kr&&at(!1),!r.props.index||!r.props.children||at(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=u0(r.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function d0(){return d0=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},d0.apply(this,arguments)}function Lj(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Fj(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Bj(n,e){return n.button===0&&(!e||e==="_self")&&!Fj(n)}const Uj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],$j="6";try{window.__reactRouterVersion=$j}catch{}const zj="startTransition",vE=DD[zj];function Wj(n){let{basename:e,children:t,future:r,window:s}=n,i=O.useRef();i.current==null&&(i.current=HO({window:s,v5Compat:!0}));let o=i.current,[a,l]=O.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=O.useCallback(h=>{c&&vE?vE(()=>l(h)):l(h)},[l,c]);return O.useLayoutEffect(()=>o.listen(u),[o,u]),O.useEffect(()=>Oj(r),[r]),O.createElement(jj,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}const Hj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tn=O.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,p=Lj(e,Uj),{basename:m}=O.useContext(Go),g,v=!1;if(typeof c=="string"&&qj.test(c)&&(g=c,Hj))try{let T=new URL(window.location.href),A=c.startsWith("//")?new URL(T.protocol+c):new URL(c),R=yx(A.pathname,m);A.origin===T.origin&&R!=null?c=R+A.search+A.hash:v=!0}catch{}let x=vj(c,{relative:s}),_=Kj(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function b(T){r&&r(T),T.defaultPrevented||_(T)}return O.createElement("a",d0({},p,{href:g||x,onClick:v||i?r:b,ref:t,target:l}))});var xE;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(xE||(xE={}));var wE;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(wE||(wE={}));function Kj(n,e){let{target:t,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=xj(),c=Bu(),u=hN(n,{relative:o});return O.useCallback(h=>{if(Bj(h,t)){h.preventDefault();let p=r!==void 0?r:cf(c)===cf(u);l(n,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,r,s,t,n,i,o,a])}let Gj={data:""},Qj=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||Gj},Jj=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Yj=/\/\*[^]*?\*\/|  +/g,_E=/\n+/g,Bs=(n,e)=>{let t="",r="",s="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":r+=i[1]=="f"?Bs(o,i):i+"{"+Bs(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=Bs(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Bs.p?Bs.p(i,o):i+":"+o+";")}return t+(e&&s?e+"{"+s+"}":s)+r},zr={},gN=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+gN(n[t]);return e}return n},Xj=(n,e,t,r,s)=>{let i=gN(n),o=zr[i]||(zr[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!zr[o]){let l=i!==n?n:(c=>{let u,h,p=[{}];for(;u=Jj.exec(c.replace(Yj,""));)u[4]?p.shift():u[3]?(h=u[3].replace(_E," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][u[1]]=u[2].replace(_E," ").trim();return p[0]})(n);zr[o]=Bs(s?{["@keyframes "+o]:l}:l,t?"":"."+o)}let a=t&&zr.g?zr.g:null;return t&&(zr.g=zr[o]),((l,c,u,h)=>{h?c.data=c.data.replace(h,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(zr[o],e,r,a),o},Zj=(n,e,t)=>n.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(t),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Bs(a,""):a===!1?"":a}return r+s+(o??"")},"");function Up(n){let e=this||{},t=n.call?n(e.p):n;return Xj(t.unshift?t.raw?Zj(t,[].slice.call(arguments,1),e.p):t.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):t,Qj(e.target),e.g,e.o,e.k)}let yN,h0,f0;Up.bind({g:1});let ms=Up.bind({k:1});function eV(n,e,t,r){Bs.p=e,yN=n,h0=t,f0=r}function Di(n,e){let t=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;t.p=Object.assign({theme:h0&&h0()},a),t.o=/ *go\d+/.test(l),a.className=Up.apply(t,r)+(l?" "+l:"");let c=n;return n[0]&&(c=a.as||n,delete a.as),f0&&c[0]&&f0(a),yN(c,a)}return s}}var tV=n=>typeof n=="function",uf=(n,e)=>tV(n)?n(e):n,nV=(()=>{let n=0;return()=>(++n).toString()})(),vN=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),rV=20,xx="default",xN=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return xN(n,{type:n.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...n,toasts:n.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},vh=[],wN={toasts:[],pausedAt:void 0,settings:{toastLimit:rV}},kr={},_N=(n,e=xx)=>{kr[e]=xN(kr[e]||wN,n),vh.forEach(([t,r])=>{t===e&&r(kr[e])})},EN=n=>Object.keys(kr).forEach(e=>_N(n,e)),sV=n=>Object.keys(kr).find(e=>kr[e].toasts.some(t=>t.id===n)),$p=(n=xx)=>e=>{_N(e,n)},iV={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},oV=(n={},e=xx)=>{let[t,r]=O.useState(kr[e]||wN),s=O.useRef(kr[e]);O.useEffect(()=>(s.current!==kr[e]&&r(kr[e]),vh.push([e,r]),()=>{let o=vh.findIndex(([a])=>a===e);o>-1&&vh.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var a,l,c;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((a=n[o.type])==null?void 0:a.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((l=n[o.type])==null?void 0:l.duration)||(n==null?void 0:n.duration)||iV[o.type],style:{...n.style,...(c=n[o.type])==null?void 0:c.style,...o.style}}});return{...t,toasts:i}},aV=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||nV()}),Uu=n=>(e,t)=>{let r=aV(e,n,t);return $p(r.toasterId||sV(r.id))({type:2,toast:r}),r.id},ut=(n,e)=>Uu("blank")(n,e);ut.error=Uu("error");ut.success=Uu("success");ut.loading=Uu("loading");ut.custom=Uu("custom");ut.dismiss=(n,e)=>{let t={type:3,toastId:n};e?$p(e)(t):EN(t)};ut.dismissAll=n=>ut.dismiss(void 0,n);ut.remove=(n,e)=>{let t={type:4,toastId:n};e?$p(e)(t):EN(t)};ut.removeAll=n=>ut.remove(void 0,n);ut.promise=(n,e,t)=>{let r=ut.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(s=>{let i=e.success?uf(e.success,s):void 0;return i?ut.success(i,{id:r,...t,...t==null?void 0:t.success}):ut.dismiss(r),s}).catch(s=>{let i=e.error?uf(e.error,s):void 0;i?ut.error(i,{id:r,...t,...t==null?void 0:t.error}):ut.dismiss(r)}),n};var lV=1e3,cV=(n,e="default")=>{let{toasts:t,pausedAt:r}=oV(n,e),s=O.useRef(new Map).current,i=O.useCallback((h,p=lV)=>{if(s.has(h))return;let m=setTimeout(()=>{s.delete(h),o({type:4,toastId:h})},p);s.set(h,m)},[]);O.useEffect(()=>{if(r)return;let h=Date.now(),p=t.map(m=>{if(m.duration===1/0)return;let g=(m.duration||0)+m.pauseDuration-(h-m.createdAt);if(g<0){m.visible&&ut.dismiss(m.id);return}return setTimeout(()=>ut.dismiss(m.id,e),g)});return()=>{p.forEach(m=>m&&clearTimeout(m))}},[t,r,e]);let o=O.useCallback($p(e),[e]),a=O.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=O.useCallback((h,p)=>{o({type:1,toast:{id:h,height:p}})},[o]),c=O.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=O.useCallback((h,p)=>{let{reverseOrder:m=!1,gutter:g=8,defaultPosition:v}=p||{},x=t.filter(T=>(T.position||v)===(h.position||v)&&T.height),_=x.findIndex(T=>T.id===h.id),b=x.filter((T,A)=>A<_&&T.visible).length;return x.filter(T=>T.visible).slice(...m?[b+1]:[0,b]).reduce((T,A)=>T+(A.height||0)+g,0)},[t]);return O.useEffect(()=>{t.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=s.get(h.id);p&&(clearTimeout(p),s.delete(h.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:l,startPause:a,endPause:c,calculateOffset:u}}},uV=ms`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,dV=ms`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,hV=ms`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,fV=Di("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${dV} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${hV} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,pV=ms`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,mV=Di("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${pV} 1s linear infinite;
`,gV=ms`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,yV=ms`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,vV=Di("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${gV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${yV} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,xV=Di("div")`
  position: absolute;
`,wV=Di("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,_V=ms`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,EV=Di("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${_V} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,kV=({toast:n})=>{let{icon:e,type:t,iconTheme:r}=n;return e!==void 0?typeof e=="string"?O.createElement(EV,null,e):e:t==="blank"?null:O.createElement(wV,null,O.createElement(mV,{...r}),t!=="loading"&&O.createElement(xV,null,t==="error"?O.createElement(fV,{...r}):O.createElement(vV,{...r})))},bV=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,TV=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,SV="0%{opacity:0;} 100%{opacity:1;}",IV="0%{opacity:1;} 100%{opacity:0;}",NV=Di("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,CV=Di("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,AV=(n,e)=>{let t=n.includes("top")?1:-1,[r,s]=vN()?[SV,IV]:[bV(t),TV(t)];return{animation:e?`${ms(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ms(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},RV=O.memo(({toast:n,position:e,style:t,children:r})=>{let s=n.height?AV(n.position||e||"top-center",n.visible):{opacity:0},i=O.createElement(kV,{toast:n}),o=O.createElement(CV,{...n.ariaProps},uf(n.message,n));return O.createElement(NV,{className:n.className,style:{...s,...t,...n.style}},typeof r=="function"?r({icon:i,message:o}):O.createElement(O.Fragment,null,i,o))});eV(O.createElement);var PV=({id:n,className:e,style:t,onHeightUpdate:r,children:s})=>{let i=O.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;r(n,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,r]);return O.createElement("div",{ref:i,className:e,style:t},s)},DV=(n,e)=>{let t=n.includes("top"),r=t?{top:0}:{bottom:0},s=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:vN()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...s}},MV=Up`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Bd=16,OV=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:l,handlers:c}=cV(t,i);return O.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Bd,left:Bd,right:Bd,bottom:Bd,pointerEvents:"none",...o},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let h=u.position||e,p=c.calculateOffset(u,{reverseOrder:n,gutter:r,defaultPosition:e}),m=DV(h,p);return O.createElement(PV,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?MV:"",style:m},u.type==="custom"?uf(u.message,u):s?s(u):O.createElement(RV,{toast:u,position:h}))}))},oe=ut,EE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},jV=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},bN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(p=64)),r.push(t[u],t[h],t[p],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(kN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):jV(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new VV;const p=i<<2|a>>4;if(r.push(p),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const g=c<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class VV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LV=function(n){const e=kN(n);return bN.encodeByteArray(e,!0)},df=function(n){return LV(n).replace(/\./g,"")},TN=function(n){try{return bN.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FV(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=()=>FV().__FIREBASE_DEFAULTS__,UV=()=>{if(typeof process>"u"||typeof EE>"u")return;const n=EE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$V=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&TN(n[1]);return e&&JSON.parse(e)},zp=()=>{try{return BV()||UV()||$V()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},SN=n=>{var e,t;return(t=(e=zp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},IN=n=>{const e=SN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},NN=()=>{var n;return(n=zp())===null||n===void 0?void 0:n.config},CN=n=>{var e;return(e=zp())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[df(JSON.stringify(t)),df(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function WV(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ht())}function HV(){var n;const e=(n=zp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KV(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function GV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function QV(){const n=ht();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function RN(){return!HV()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PN(){try{return typeof indexedDB=="object"}catch{return!1}}function JV(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV="FirebaseError";class Fr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=YV,Object.setPrototypeOf(this,Fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$u.prototype.create)}}class $u{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?XV(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Fr(s,a,r)}}function XV(n,e){return n.replace(ZV,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const ZV=/\{\$([^}]+)}/g;function eL(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function hf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(kE(i)&&kE(o)){if(!hf(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function kE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function cc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function tL(n,e){const t=new nL(n,e);return t.subscribe.bind(t)}class nL{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");rL(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Ng),s.error===void 0&&(s.error=Ng),s.complete===void 0&&(s.complete=Ng);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rL(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ng(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(n){return n&&n._delegate?n._delegate:n}class _i{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new zV;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oL(e))try{this.getOrInitializeService({instanceIdentifier:Qi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Qi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qi){return this.instances.has(e)}getOptions(e=Qi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:iL(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Qi){return this.component?this.component.multipleInstances?e:Qi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iL(n){return n===Qi?void 0:n}function oL(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new sL(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(we||(we={}));const lL={debug:we.DEBUG,verbose:we.VERBOSE,info:we.INFO,warn:we.WARN,error:we.ERROR,silent:we.SILENT},cL=we.INFO,uL={[we.DEBUG]:"log",[we.VERBOSE]:"log",[we.INFO]:"info",[we.WARN]:"warn",[we.ERROR]:"error"},dL=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=uL[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wx{constructor(e){this.name=e,this._logLevel=cL,this._logHandler=dL,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in we))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,we.DEBUG,...e),this._logHandler(this,we.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,we.VERBOSE,...e),this._logHandler(this,we.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,we.INFO,...e),this._logHandler(this,we.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,we.WARN,...e),this._logHandler(this,we.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,we.ERROR,...e),this._logHandler(this,we.ERROR,...e)}}const hL=(n,e)=>e.some(t=>n instanceof t);let bE,TE;function fL(){return bE||(bE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pL(){return TE||(TE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DN=new WeakMap,p0=new WeakMap,MN=new WeakMap,Cg=new WeakMap,_x=new WeakMap;function mL(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(ui(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&DN.set(t,n)}).catch(()=>{}),_x.set(e,n),e}function gL(n){if(p0.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});p0.set(n,e)}let m0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return p0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||MN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ui(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function yL(n){m0=n(m0)}function vL(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Ag(this),e,...t);return MN.set(r,e.sort?e.sort():[e]),ui(r)}:pL().includes(n)?function(...e){return n.apply(Ag(this),e),ui(DN.get(this))}:function(...e){return ui(n.apply(Ag(this),e))}}function xL(n){return typeof n=="function"?vL(n):(n instanceof IDBTransaction&&gL(n),hL(n,fL())?new Proxy(n,m0):n)}function ui(n){if(n instanceof IDBRequest)return mL(n);if(Cg.has(n))return Cg.get(n);const e=xL(n);return e!==n&&(Cg.set(n,e),_x.set(e,n)),e}const Ag=n=>_x.get(n);function wL(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=ui(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ui(o.result),l.oldVersion,l.newVersion,ui(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const _L=["get","getKey","getAll","getAllKeys","count"],EL=["put","add","delete","clear"],Rg=new Map;function SE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rg.get(e))return Rg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=EL.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||_L.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Rg.set(e,i),i}yL(n=>({...n,get:(e,t,r)=>SE(e,t)||n.get(e,t,r),has:(e,t)=>!!SE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(bL(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function bL(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const g0="@firebase/app",IE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new wx("@firebase/app"),TL="@firebase/app-compat",SL="@firebase/analytics-compat",IL="@firebase/analytics",NL="@firebase/app-check-compat",CL="@firebase/app-check",AL="@firebase/auth",RL="@firebase/auth-compat",PL="@firebase/database",DL="@firebase/data-connect",ML="@firebase/database-compat",OL="@firebase/functions",jL="@firebase/functions-compat",VL="@firebase/installations",LL="@firebase/installations-compat",FL="@firebase/messaging",BL="@firebase/messaging-compat",UL="@firebase/performance",$L="@firebase/performance-compat",zL="@firebase/remote-config",WL="@firebase/remote-config-compat",HL="@firebase/storage",qL="@firebase/storage-compat",KL="@firebase/firestore",GL="@firebase/vertexai-preview",QL="@firebase/firestore-compat",JL="firebase",YL="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="[DEFAULT]",XL={[g0]:"fire-core",[TL]:"fire-core-compat",[IL]:"fire-analytics",[SL]:"fire-analytics-compat",[CL]:"fire-app-check",[NL]:"fire-app-check-compat",[AL]:"fire-auth",[RL]:"fire-auth-compat",[PL]:"fire-rtdb",[DL]:"fire-data-connect",[ML]:"fire-rtdb-compat",[OL]:"fire-fn",[jL]:"fire-fn-compat",[VL]:"fire-iid",[LL]:"fire-iid-compat",[FL]:"fire-fcm",[BL]:"fire-fcm-compat",[UL]:"fire-perf",[$L]:"fire-perf-compat",[zL]:"fire-rc",[WL]:"fire-rc-compat",[HL]:"fire-gcs",[qL]:"fire-gcs-compat",[KL]:"fire-fst",[QL]:"fire-fst-compat",[GL]:"fire-vertex","fire-js":"fire-js",[JL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff=new Map,ZL=new Map,v0=new Map;function NE(n,e){try{n.container.addComponent(e)}catch(t){gs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function No(n){const e=n.name;if(v0.has(e))return gs.debug(`There were multiple attempts to register component ${e}.`),!1;v0.set(e,n);for(const t of ff.values())NE(t,n);for(const t of ZL.values())NE(t,n);return!0}function Wp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function br(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},di=new $u("app","Firebase",e4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _i("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw di.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=YL;function ON(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:y0,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw di.create("bad-app-name",{appName:String(s)});if(t||(t=NN()),!t)throw di.create("no-options");const i=ff.get(s);if(i){if(hf(t,i.options)&&hf(r,i.config))return i;throw di.create("duplicate-app",{appName:s})}const o=new aL(s);for(const l of v0.values())o.addComponent(l);const a=new t4(t,r,o);return ff.set(s,a),a}function Ex(n=y0){const e=ff.get(n);if(!e&&n===y0&&NN())return ON();if(!e)throw di.create("no-app",{appName:n});return e}function Ar(n,e,t){var r;let s=(r=XL[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gs.warn(a.join(" "));return}No(new _i(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4="firebase-heartbeat-database",r4=1,cu="firebase-heartbeat-store";let Pg=null;function jN(){return Pg||(Pg=wL(n4,r4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(cu)}catch(t){console.warn(t)}}}}).catch(n=>{throw di.create("idb-open",{originalErrorMessage:n.message})})),Pg}async function s4(n){try{const t=(await jN()).transaction(cu),r=await t.objectStore(cu).get(VN(n));return await t.done,r}catch(e){if(e instanceof Fr)gs.warn(e.message);else{const t=di.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gs.warn(t.message)}}}async function CE(n,e){try{const r=(await jN()).transaction(cu,"readwrite");await r.objectStore(cu).put(e,VN(n)),await r.done}catch(t){if(t instanceof Fr)gs.warn(t.message);else{const r=di.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});gs.warn(r.message)}}}function VN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=1024,o4=30*24*60*60*1e3;class a4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new c4(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=AE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=o4}),this._storage.overwrite(this._heartbeatsCache))}catch(r){gs.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=AE(),{heartbeatsToSend:r,unsentEntries:s}=l4(this._heartbeatsCache.heartbeats),i=df(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return gs.warn(t),""}}}function AE(){return new Date().toISOString().substring(0,10)}function l4(n,e=i4){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),RE(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),RE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class c4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PN()?JV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await s4(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return CE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return CE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function RE(n){return df(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u4(n){No(new _i("platform-logger",e=>new kL(e),"PRIVATE")),No(new _i("heartbeat",e=>new a4(e),"PRIVATE")),Ar(g0,IE,n),Ar(g0,IE,"esm2017"),Ar("fire-js","")}u4("");function kx(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function LN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const d4=LN,FN=new $u("auth","Firebase",LN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf=new wx("@firebase/auth");function h4(n,...e){pf.logLevel<=we.WARN&&pf.warn(`Auth (${Qo}): ${n}`,...e)}function xh(n,...e){pf.logLevel<=we.ERROR&&pf.error(`Auth (${Qo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(n,...e){throw bx(n,...e)}function Rr(n,...e){return bx(n,...e)}function BN(n,e,t){const r=Object.assign(Object.assign({},d4()),{[e]:t});return new $u("auth","Firebase",r).create(e,{appName:n.name})}function ls(n){return BN(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bx(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return FN.create(n,...e)}function ce(n,e,...t){if(!n)throw bx(e,...t)}function es(n){const e="INTERNAL ASSERTION FAILED: "+n;throw xh(e),new Error(e)}function ys(n,e){n||es(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function f4(){return PE()==="http:"||PE()==="https:"}function PE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(f4()||KV()||"connection"in navigator)?navigator.onLine:!0}function m4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ys(t>e,"Short delay should be less than long delay!"),this.isMobile=WV()||GV()}get(){return p4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(n,e){ys(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;es("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;es("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;es("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4=new Wu(3e4,6e4);function ws(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function _s(n,e,t,r,s={}){return $N(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=zu(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return qV()||(c.referrerPolicy="no-referrer"),UN.fetch()(zN(n,n.config.apiHost,t,a),c)})}async function $N(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},g4),e);try{const s=new x4(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ud(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ud(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ud(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ud(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw BN(n,u,c);hr(n,u)}}catch(s){if(s instanceof Fr)throw s;hr(n,"network-request-failed",{message:String(s)})}}async function Hu(n,e,t,r,s={}){const i=await _s(n,e,t,r,s);return"mfaPendingCredential"in i&&hr(n,"multi-factor-auth-required",{_serverResponse:i}),i}function zN(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?Tx(n.config,s):`${n.config.apiScheme}://${s}`}function v4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class x4{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Rr(this.auth,"network-request-failed")),y4.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ud(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Rr(n,e,r);return s.customData._tokenResponse=t,s}function DE(n){return n!==void 0&&n.enterprise!==void 0}class w4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return v4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function _4(n,e){return _s(n,"GET","/v2/recaptchaConfig",ws(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4(n,e){return _s(n,"POST","/v1/accounts:delete",e)}async function WN(n,e){return _s(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k4(n,e=!1){const t=ft(n),r=await t.getIdToken(e),s=Sx(r);ce(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Nc(Dg(s.auth_time)),issuedAtTime:Nc(Dg(s.iat)),expirationTime:Nc(Dg(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Dg(n){return Number(n)*1e3}function Sx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return xh("JWT malformed, contained fewer than 3 sections"),null;try{const s=TN(t);return s?JSON.parse(s):(xh("Failed to decode base64 JWT payload"),null)}catch(s){return xh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function ME(n){const e=Sx(n);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uu(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Fr&&b4(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function b4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nc(this.lastLoginAt),this.creationTime=Nc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mf(n){var e;const t=n.auth,r=await n.getIdToken(),s=await uu(n,WN(t,{idToken:r}));ce(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?HN(i.providerUserInfo):[],a=I4(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new w0(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function S4(n){const e=ft(n);await mf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function I4(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function HN(n){return n.map(e=>{var{providerId:t}=e,r=kx(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N4(n,e){const t=await $N(n,{},async()=>{const r=zu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=zN(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",UN.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function C4(n,e){return _s(n,"POST","/v2/accounts:revokeToken",ws(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ME(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const t=ME(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await N4(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new za;return r&&(ce(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ce(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ce(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new za,this.toJSON())}_performRefresh(){return es("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(n,e){ce(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ts{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=kx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new T4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new w0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await uu(this,this.stsTokenManager.getToken(this.auth,e));return ce(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k4(this,e)}reload(){return S4(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ts(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await mf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(br(this.auth.app))return Promise.reject(ls(this.auth));const e=await this.getIdToken();return await uu(this,E4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,u;const h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(s=t.email)!==null&&s!==void 0?s:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=t.photoURL)!==null&&o!==void 0?o:void 0,v=(a=t.tenantId)!==null&&a!==void 0?a:void 0,x=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,_=(c=t.createdAt)!==null&&c!==void 0?c:void 0,b=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:T,emailVerified:A,isAnonymous:R,providerData:D,stsTokenManager:k}=t;ce(T&&k,e,"internal-error");const E=za.fromJSON(this.name,k);ce(typeof T=="string",e,"internal-error"),Is(h,e.name),Is(p,e.name),ce(typeof A=="boolean",e,"internal-error"),ce(typeof R=="boolean",e,"internal-error"),Is(m,e.name),Is(g,e.name),Is(v,e.name),Is(x,e.name),Is(_,e.name),Is(b,e.name);const S=new ts({uid:T,auth:e,email:p,emailVerified:A,displayName:h,isAnonymous:R,photoURL:g,phoneNumber:m,tenantId:v,stsTokenManager:E,createdAt:_,lastLoginAt:b});return D&&Array.isArray(D)&&(S.providerData=D.map(C=>Object.assign({},C))),x&&(S._redirectEventId=x),S}static async _fromIdTokenResponse(e,t,r=!1){const s=new za;s.updateFromServerResponse(t);const i=new ts({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await mf(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ce(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?HN(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new za;a.updateFromIdToken(r);const l=new ts({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new w0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE=new Map;function ns(n){ys(n instanceof Function,"Expected a class definition");let e=OE.get(n);return e?(ys(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,OE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}qN.type="NONE";const jE=qN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(n,e,t){return`firebase:${n}:${e}:${t}`}class Wa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=wh(this.userKey,s.apiKey,i),this.fullPersistenceKey=wh("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ts._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Wa(ns(jE),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||ns(jE);const o=wh(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){const h=ts._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Wa(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Wa(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(JN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(KN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XN(e))return"Blackberry";if(ZN(e))return"Webos";if(GN(e))return"Safari";if((e.includes("chrome/")||QN(e))&&!e.includes("edge/"))return"Chrome";if(YN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function KN(n=ht()){return/firefox\//i.test(n)}function GN(n=ht()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function QN(n=ht()){return/crios\//i.test(n)}function JN(n=ht()){return/iemobile/i.test(n)}function YN(n=ht()){return/android/i.test(n)}function XN(n=ht()){return/blackberry/i.test(n)}function ZN(n=ht()){return/webos/i.test(n)}function Ix(n=ht()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function A4(n=ht()){var e;return Ix(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function R4(){return QV()&&document.documentMode===10}function eC(n=ht()){return Ix(n)||YN(n)||ZN(n)||XN(n)||/windows phone/i.test(n)||JN(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(n,e=[]){let t;switch(n){case"Browser":t=VE(ht());break;case"Worker":t=`${VE(ht())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Qo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D4(n,e={}){return _s(n,"GET","/v2/passwordPolicy",ws(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4=6;class O4{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:M4,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new LE(this),this.idTokenSubscription=new LE(this),this.beforeStateQueue=new P4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ns(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Wa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await WN(this,{idToken:e}),r=await ts._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(br(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=m4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(br(this.app))return Promise.reject(ls(this));const t=e?ft(e):null;return t&&ce(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return br(this.app)?Promise.reject(ls(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return br(this.app)?Promise.reject(ls(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await D4(this),t=new O4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $u("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await C4(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ns(e)||this._popupRedirectResolver;ce(t,this,"argument-error"),this.redirectPersistenceManager=await Wa.create(this,[ns(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&h4(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Mi(n){return ft(n)}class LE{constructor(e){this.auth=e,this.observer=null,this.addObserver=tL(t=>this.observer=t)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hp={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V4(n){Hp=n}function nC(n){return Hp.loadJS(n)}function L4(){return Hp.recaptchaEnterpriseScript}function F4(){return Hp.gapiScript}function B4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const U4="recaptcha-enterprise",$4="NO_RECAPTCHA";class z4{constructor(e){this.type=U4,this.auth=Mi(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{_4(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new w4(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;DE(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o($4)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&DE(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=L4();l.length!==0&&(l+=a),nC(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function FE(n,e,t,r=!1){const s=new z4(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function gf(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await FE(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await FE(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W4(n,e){const t=Wp(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(hf(i,e??{}))return s;hr(s,"already-initialized")}return t.initialize({options:e})}function H4(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ns);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function q4(n,e,t){const r=Mi(n);ce(r._canInitEmulator,r,"emulator-config-failed"),ce(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=rC(e),{host:o,port:a}=K4(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),G4()}function rC(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function K4(n){const e=rC(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:BE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:BE(o)}}}function BE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function G4(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return es("not implemented")}_getIdTokenResponse(e){return es("not implemented")}_linkToIdToken(e,t){return es("not implemented")}_getReauthenticationResolver(e){return es("not implemented")}}async function Q4(n,e){return _s(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(n,e){return Hu(n,"POST","/v1/accounts:signInWithPassword",ws(n,e))}async function Y4(n,e){return _s(n,"POST","/v1/accounts:sendOobCode",ws(n,e))}async function X4(n,e){return Y4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z4(n,e){return Hu(n,"POST","/v1/accounts:signInWithEmailLink",ws(n,e))}async function eF(n,e){return Hu(n,"POST","/v1/accounts:signInWithEmailLink",ws(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends Nx{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new du(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new du(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gf(e,t,"signInWithPassword",J4);case"emailLink":return Z4(e,{email:this._email,oobCode:this._password});default:hr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gf(e,r,"signUpPassword",Q4);case"emailLink":return eF(e,{idToken:t,email:this._email,oobCode:this._password});default:hr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ha(n,e){return Hu(n,"POST","/v1/accounts:signInWithIdp",ws(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tF="http://localhost";class Co extends Nx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=kx(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Co(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ha(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ha(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ha(e,t)}buildRequest(){const e={requestUri:tF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=zu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rF(n){const e=lc(cc(n)).link,t=e?lc(cc(e)).deep_link_id:null,r=lc(cc(n)).deep_link_id;return(r?lc(cc(r)).link:null)||r||t||e||n}class Cx{constructor(e){var t,r,s,i,o,a;const l=lc(cc(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(r=l.oobCode)!==null&&r!==void 0?r:null,h=nF((s=l.mode)!==null&&s!==void 0?s:null);ce(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=rF(e);try{return new Cx(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(){this.providerId=_l.PROVIDER_ID}static credential(e,t){return du._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Cx.parseLink(t);return ce(r,"argument-error"),du._fromEmailAndCode(e,r.code,r.tenantId)}}_l.PROVIDER_ID="password";_l.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_l.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu extends sC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends qu{constructor(){super("facebook.com")}static credential(e){return Co._fromParams({providerId:Us.PROVIDER_ID,signInMethod:Us.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Us.credentialFromTaggedObject(e)}static credentialFromError(e){return Us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Us.credential(e.oauthAccessToken)}catch{return null}}}Us.FACEBOOK_SIGN_IN_METHOD="facebook.com";Us.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends qu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Co._fromParams({providerId:$s.PROVIDER_ID,signInMethod:$s.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return $s.credentialFromTaggedObject(e)}static credentialFromError(e){return $s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return $s.credential(t,r)}catch{return null}}}$s.GOOGLE_SIGN_IN_METHOD="google.com";$s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs extends qu{constructor(){super("github.com")}static credential(e){return Co._fromParams({providerId:zs.PROVIDER_ID,signInMethod:zs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zs.credentialFromTaggedObject(e)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zs.credential(e.oauthAccessToken)}catch{return null}}}zs.GITHUB_SIGN_IN_METHOD="github.com";zs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws extends qu{constructor(){super("twitter.com")}static credential(e,t){return Co._fromParams({providerId:Ws.PROVIDER_ID,signInMethod:Ws.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ws.credentialFromTaggedObject(e)}static credentialFromError(e){return Ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ws.credential(t,r)}catch{return null}}}Ws.TWITTER_SIGN_IN_METHOD="twitter.com";Ws.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sF(n,e){return Hu(n,"POST","/v1/accounts:signUp",ws(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ts._fromIdTokenResponse(e,r,s),o=UE(r);return new Ao({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=UE(r);return new Ao({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function UE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf extends Fr{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,yf.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new yf(e,t,r,s)}}function iC(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?yf._fromErrorAndOperation(n,i,e,r):i})}async function iF(n,e,t=!1){const r=await uu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ao._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oF(n,e,t=!1){const{auth:r}=n;if(br(r.app))return Promise.reject(ls(r));const s="reauthenticate";try{const i=await uu(n,iC(r,s,e,n),t);ce(i.idToken,r,"internal-error");const o=Sx(i.idToken);ce(o,r,"internal-error");const{sub:a}=o;return ce(n.uid===a,r,"user-mismatch"),Ao._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&hr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oC(n,e,t=!1){if(br(n.app))return Promise.reject(ls(n));const r="signIn",s=await iC(n,r,e),i=await Ao._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function aF(n,e){return oC(Mi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aC(n){const e=Mi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lF(n,e,t){const r=Mi(n);await gf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",X4)}async function cF(n,e,t){if(br(n.app))return Promise.reject(ls(n));const r=Mi(n),o=await gf(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",sF).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&aC(n),l}),a=await Ao._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function uF(n,e,t){return br(n.app)?Promise.reject(ls(n)):aF(ft(n),_l.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&aC(n),r})}function dF(n,e,t,r){return ft(n).onIdTokenChanged(e,t,r)}function hF(n,e,t){return ft(n).beforeAuthStateChanged(e,t)}function fF(n,e,t,r){return ft(n).onAuthStateChanged(e,t,r)}function pF(n){return ft(n).signOut()}const vf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vf,"1"),this.storage.removeItem(vf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mF=1e3,gF=10;class cC extends lC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);R4()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,gF):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},mF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}cC.type="LOCAL";const yF=cC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC extends lC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}uC.type="SESSION";const dC=uC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new qp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await vF(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}qp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=Ax("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(){return window}function wF(n){Pr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function _F(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function EF(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function kF(){return hC()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="firebaseLocalStorageDb",bF=1,xf="firebaseLocalStorage",pC="fbase_key";class Ku{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kp(n,e){return n.transaction([xf],e?"readwrite":"readonly").objectStore(xf)}function TF(){const n=indexedDB.deleteDatabase(fC);return new Ku(n).toPromise()}function _0(){const n=indexedDB.open(fC,bF);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(xf,{keyPath:pC})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(xf)?e(r):(r.close(),await TF(),e(await _0()))})})}async function $E(n,e,t){const r=Kp(n,!0).put({[pC]:e,value:t});return new Ku(r).toPromise()}async function SF(n,e){const t=Kp(n,!1).get(e),r=await new Ku(t).toPromise();return r===void 0?null:r.value}function zE(n,e){const t=Kp(n,!0).delete(e);return new Ku(t).toPromise()}const IF=800,NF=3;class mC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>NF)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=qp._getInstance(kF()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await _F(),!this.activeServiceWorker)return;this.sender=new xF(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||EF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _0();return await $E(e,vf,"1"),await zE(e,vf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>$E(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>SF(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>zE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Kp(s,!1).getAll();return new Ku(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mC.type="LOCAL";const CF=mC;new Wu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AF(n,e){return e?ns(e):(ce(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx extends Nx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ha(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ha(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ha(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function RF(n){return oC(n.auth,new Rx(n),n.bypassAuthState)}function PF(n){const{auth:e,user:t}=n;return ce(t,e,"internal-error"),oF(t,new Rx(n),n.bypassAuthState)}async function DF(n){const{auth:e,user:t}=n;return ce(t,e,"internal-error"),iF(t,new Rx(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RF;case"linkViaPopup":case"linkViaRedirect":return DF;case"reauthViaPopup":case"reauthViaRedirect":return PF;default:hr(this.auth,"internal-error")}}resolve(e){ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ys(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF=new Wu(2e3,1e4);class Da extends gC{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Da.currentPopupAction&&Da.currentPopupAction.cancel(),Da.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){ys(this.filter.length===1,"Popup operations only handle one event");const e=Ax();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Rr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Da.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Rr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MF.get())};e()}}Da.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF="pendingRedirect",_h=new Map;class jF extends gC{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=_h.get(this.auth._key());if(!e){try{const r=await VF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}_h.set(this.auth._key(),e)}return this.bypassAuthState||_h.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VF(n,e){const t=BF(e),r=FF(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function LF(n,e){_h.set(n._key(),e)}function FF(n){return ns(n._redirectPersistence)}function BF(n){return wh(OF,n.config.apiKey,n.name)}async function UF(n,e,t=!1){if(br(n.app))return Promise.reject(ls(n));const r=Mi(n),s=AF(r,e),o=await new jF(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $F=10*60*1e3;class zF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!WF(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!yC(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Rr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$F&&this.cachedEventUids.clear(),this.cachedEventUids.has(WE(e))}saveEventToCache(e){this.cachedEventUids.add(WE(e)),this.lastProcessedEventTime=Date.now()}}function WE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function yC({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function WF(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yC(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HF(n,e={}){return _s(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KF=/^https?/;async function GF(n){if(n.config.emulator)return;const{authorizedDomains:e}=await HF(n);for(const t of e)try{if(QF(t))return}catch{}hr(n,"unauthorized-domain")}function QF(n){const e=x0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!KF.test(t))return!1;if(qF.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=new Wu(3e4,6e4);function HE(){const n=Pr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function YF(n){return new Promise((e,t)=>{var r,s,i;function o(){HE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{HE(),t(Rr(n,"network-request-failed"))},timeout:JF.get()})}if(!((s=(r=Pr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Pr().gapi)===null||i===void 0)&&i.load)o();else{const a=B4("iframefcb");return Pr()[a]=()=>{gapi.load?o():t(Rr(n,"network-request-failed"))},nC(`${F4()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Eh=null,e})}let Eh=null;function XF(n){return Eh=Eh||YF(n),Eh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=new Wu(5e3,15e3),e3="__/auth/iframe",t3="emulator/auth/iframe",n3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},r3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s3(n){const e=n.config;ce(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Tx(e,t3):`https://${n.config.authDomain}/${e3}`,r={apiKey:e.apiKey,appName:n.name,v:Qo},s=r3.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${zu(r).slice(1)}`}async function i3(n){const e=await XF(n),t=Pr().gapi;return ce(t,n,"internal-error"),e.open({where:document.body,url:s3(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:n3,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Rr(n,"network-request-failed"),a=Pr().setTimeout(()=>{i(o)},ZF.get());function l(){Pr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},a3=500,l3=600,c3="_blank",u3="http://localhost";class qE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function d3(n,e,t,r=a3,s=l3){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},o3),{width:r.toString(),height:s.toString(),top:i,left:o}),c=ht().toLowerCase();t&&(a=QN(c)?c3:t),KN(c)&&(e=e||u3,l.scrollbars="yes");const u=Object.entries(l).reduce((p,[m,g])=>`${p}${m}=${g},`,"");if(A4(c)&&a!=="_self")return h3(e||"",a),new qE(null);const h=window.open(e||"",a,u);ce(h,n,"popup-blocked");try{h.focus()}catch{}return new qE(h)}function h3(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3="__/auth/handler",p3="emulator/auth/handler",m3=encodeURIComponent("fac");async function KE(n,e,t,r,s,i){ce(n.config.authDomain,n,"auth-domain-config-required"),ce(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Qo,eventId:s};if(e instanceof sC){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",eL(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof qu){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${m3}=${encodeURIComponent(l)}`:"";return`${g3(n)}?${zu(a).slice(1)}${c}`}function g3({config:n}){return n.emulator?Tx(n,p3):`https://${n.authDomain}/${f3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="webStorageSupport";class y3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dC,this._completeRedirectFn=UF,this._overrideRedirectResult=LF}async _openPopup(e,t,r,s){var i;ys((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await KE(e,t,r,x0(),s);return d3(e,o,Ax())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await KE(e,t,r,x0(),s);return wF(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ys(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await i3(e),r=new zF(e);return t.register("authEvent",s=>(ce(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mg,{type:Mg},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Mg];o!==void 0&&t(!!o),hr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=GF(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eC()||GN()||Ix()}}const v3=y3;var GE="@firebase/auth",QE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _3(n){No(new _i("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ce(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tC(n)},c=new j4(r,s,i,l);return H4(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),No(new _i("auth-internal",e=>{const t=Mi(e.getProvider("auth").getImmediate());return(r=>new x3(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ar(GE,QE,w3(n)),Ar(GE,QE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=5*60,k3=CN("authIdTokenMaxAge")||E3;let JE=null;const b3=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>k3)return;const s=t==null?void 0:t.token;JE!==s&&(JE=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function T3(n=Ex()){const e=Wp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=W4(n,{popupRedirectResolver:v3,persistence:[CF,yF,dC]}),r=CN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=b3(i.toString());hF(t,o,()=>o(t.currentUser)),dF(t,a=>o(a))}}const s=SN("auth");return s&&q4(t,`http://${s}`),t}function S3(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}V4({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Rr("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",S3().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_3("Browser");var I3="firebase",N3="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar(I3,N3,"app");var YE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var po,vC;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,E){function S(){}S.prototype=E.prototype,k.D=E.prototype,k.prototype=new S,k.prototype.constructor=k,k.C=function(C,M,P){for(var N=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)N[ae-2]=arguments[ae];return E.prototype[M].apply(C,N)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,E,S){S||(S=0);var C=Array(16);if(typeof E=="string")for(var M=0;16>M;++M)C[M]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(M=0;16>M;++M)C[M]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=k.g[0],S=k.g[1],M=k.g[2];var P=k.g[3],N=E+(P^S&(M^P))+C[0]+3614090360&4294967295;E=S+(N<<7&4294967295|N>>>25),N=P+(M^E&(S^M))+C[1]+3905402710&4294967295,P=E+(N<<12&4294967295|N>>>20),N=M+(S^P&(E^S))+C[2]+606105819&4294967295,M=P+(N<<17&4294967295|N>>>15),N=S+(E^M&(P^E))+C[3]+3250441966&4294967295,S=M+(N<<22&4294967295|N>>>10),N=E+(P^S&(M^P))+C[4]+4118548399&4294967295,E=S+(N<<7&4294967295|N>>>25),N=P+(M^E&(S^M))+C[5]+1200080426&4294967295,P=E+(N<<12&4294967295|N>>>20),N=M+(S^P&(E^S))+C[6]+2821735955&4294967295,M=P+(N<<17&4294967295|N>>>15),N=S+(E^M&(P^E))+C[7]+4249261313&4294967295,S=M+(N<<22&4294967295|N>>>10),N=E+(P^S&(M^P))+C[8]+1770035416&4294967295,E=S+(N<<7&4294967295|N>>>25),N=P+(M^E&(S^M))+C[9]+2336552879&4294967295,P=E+(N<<12&4294967295|N>>>20),N=M+(S^P&(E^S))+C[10]+4294925233&4294967295,M=P+(N<<17&4294967295|N>>>15),N=S+(E^M&(P^E))+C[11]+2304563134&4294967295,S=M+(N<<22&4294967295|N>>>10),N=E+(P^S&(M^P))+C[12]+1804603682&4294967295,E=S+(N<<7&4294967295|N>>>25),N=P+(M^E&(S^M))+C[13]+4254626195&4294967295,P=E+(N<<12&4294967295|N>>>20),N=M+(S^P&(E^S))+C[14]+2792965006&4294967295,M=P+(N<<17&4294967295|N>>>15),N=S+(E^M&(P^E))+C[15]+1236535329&4294967295,S=M+(N<<22&4294967295|N>>>10),N=E+(M^P&(S^M))+C[1]+4129170786&4294967295,E=S+(N<<5&4294967295|N>>>27),N=P+(S^M&(E^S))+C[6]+3225465664&4294967295,P=E+(N<<9&4294967295|N>>>23),N=M+(E^S&(P^E))+C[11]+643717713&4294967295,M=P+(N<<14&4294967295|N>>>18),N=S+(P^E&(M^P))+C[0]+3921069994&4294967295,S=M+(N<<20&4294967295|N>>>12),N=E+(M^P&(S^M))+C[5]+3593408605&4294967295,E=S+(N<<5&4294967295|N>>>27),N=P+(S^M&(E^S))+C[10]+38016083&4294967295,P=E+(N<<9&4294967295|N>>>23),N=M+(E^S&(P^E))+C[15]+3634488961&4294967295,M=P+(N<<14&4294967295|N>>>18),N=S+(P^E&(M^P))+C[4]+3889429448&4294967295,S=M+(N<<20&4294967295|N>>>12),N=E+(M^P&(S^M))+C[9]+568446438&4294967295,E=S+(N<<5&4294967295|N>>>27),N=P+(S^M&(E^S))+C[14]+3275163606&4294967295,P=E+(N<<9&4294967295|N>>>23),N=M+(E^S&(P^E))+C[3]+4107603335&4294967295,M=P+(N<<14&4294967295|N>>>18),N=S+(P^E&(M^P))+C[8]+1163531501&4294967295,S=M+(N<<20&4294967295|N>>>12),N=E+(M^P&(S^M))+C[13]+2850285829&4294967295,E=S+(N<<5&4294967295|N>>>27),N=P+(S^M&(E^S))+C[2]+4243563512&4294967295,P=E+(N<<9&4294967295|N>>>23),N=M+(E^S&(P^E))+C[7]+1735328473&4294967295,M=P+(N<<14&4294967295|N>>>18),N=S+(P^E&(M^P))+C[12]+2368359562&4294967295,S=M+(N<<20&4294967295|N>>>12),N=E+(S^M^P)+C[5]+4294588738&4294967295,E=S+(N<<4&4294967295|N>>>28),N=P+(E^S^M)+C[8]+2272392833&4294967295,P=E+(N<<11&4294967295|N>>>21),N=M+(P^E^S)+C[11]+1839030562&4294967295,M=P+(N<<16&4294967295|N>>>16),N=S+(M^P^E)+C[14]+4259657740&4294967295,S=M+(N<<23&4294967295|N>>>9),N=E+(S^M^P)+C[1]+2763975236&4294967295,E=S+(N<<4&4294967295|N>>>28),N=P+(E^S^M)+C[4]+1272893353&4294967295,P=E+(N<<11&4294967295|N>>>21),N=M+(P^E^S)+C[7]+4139469664&4294967295,M=P+(N<<16&4294967295|N>>>16),N=S+(M^P^E)+C[10]+3200236656&4294967295,S=M+(N<<23&4294967295|N>>>9),N=E+(S^M^P)+C[13]+681279174&4294967295,E=S+(N<<4&4294967295|N>>>28),N=P+(E^S^M)+C[0]+3936430074&4294967295,P=E+(N<<11&4294967295|N>>>21),N=M+(P^E^S)+C[3]+3572445317&4294967295,M=P+(N<<16&4294967295|N>>>16),N=S+(M^P^E)+C[6]+76029189&4294967295,S=M+(N<<23&4294967295|N>>>9),N=E+(S^M^P)+C[9]+3654602809&4294967295,E=S+(N<<4&4294967295|N>>>28),N=P+(E^S^M)+C[12]+3873151461&4294967295,P=E+(N<<11&4294967295|N>>>21),N=M+(P^E^S)+C[15]+530742520&4294967295,M=P+(N<<16&4294967295|N>>>16),N=S+(M^P^E)+C[2]+3299628645&4294967295,S=M+(N<<23&4294967295|N>>>9),N=E+(M^(S|~P))+C[0]+4096336452&4294967295,E=S+(N<<6&4294967295|N>>>26),N=P+(S^(E|~M))+C[7]+1126891415&4294967295,P=E+(N<<10&4294967295|N>>>22),N=M+(E^(P|~S))+C[14]+2878612391&4294967295,M=P+(N<<15&4294967295|N>>>17),N=S+(P^(M|~E))+C[5]+4237533241&4294967295,S=M+(N<<21&4294967295|N>>>11),N=E+(M^(S|~P))+C[12]+1700485571&4294967295,E=S+(N<<6&4294967295|N>>>26),N=P+(S^(E|~M))+C[3]+2399980690&4294967295,P=E+(N<<10&4294967295|N>>>22),N=M+(E^(P|~S))+C[10]+4293915773&4294967295,M=P+(N<<15&4294967295|N>>>17),N=S+(P^(M|~E))+C[1]+2240044497&4294967295,S=M+(N<<21&4294967295|N>>>11),N=E+(M^(S|~P))+C[8]+1873313359&4294967295,E=S+(N<<6&4294967295|N>>>26),N=P+(S^(E|~M))+C[15]+4264355552&4294967295,P=E+(N<<10&4294967295|N>>>22),N=M+(E^(P|~S))+C[6]+2734768916&4294967295,M=P+(N<<15&4294967295|N>>>17),N=S+(P^(M|~E))+C[13]+1309151649&4294967295,S=M+(N<<21&4294967295|N>>>11),N=E+(M^(S|~P))+C[4]+4149444226&4294967295,E=S+(N<<6&4294967295|N>>>26),N=P+(S^(E|~M))+C[11]+3174756917&4294967295,P=E+(N<<10&4294967295|N>>>22),N=M+(E^(P|~S))+C[2]+718787259&4294967295,M=P+(N<<15&4294967295|N>>>17),N=S+(P^(M|~E))+C[9]+3951481745&4294967295,k.g[0]=k.g[0]+E&4294967295,k.g[1]=k.g[1]+(M+(N<<21&4294967295|N>>>11))&4294967295,k.g[2]=k.g[2]+M&4294967295,k.g[3]=k.g[3]+P&4294967295}r.prototype.u=function(k,E){E===void 0&&(E=k.length);for(var S=E-this.blockSize,C=this.B,M=this.h,P=0;P<E;){if(M==0)for(;P<=S;)s(this,k,P),P+=this.blockSize;if(typeof k=="string"){for(;P<E;)if(C[M++]=k.charCodeAt(P++),M==this.blockSize){s(this,C),M=0;break}}else for(;P<E;)if(C[M++]=k[P++],M==this.blockSize){s(this,C),M=0;break}}this.h=M,this.o+=E},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var E=1;E<k.length-8;++E)k[E]=0;var S=8*this.o;for(E=k.length-8;E<k.length;++E)k[E]=S&255,S/=256;for(this.u(k),k=Array(16),E=S=0;4>E;++E)for(var C=0;32>C;C+=8)k[S++]=this.g[E]>>>C&255;return k};function i(k,E){var S=a;return Object.prototype.hasOwnProperty.call(S,k)?S[k]:S[k]=E(k)}function o(k,E){this.h=E;for(var S=[],C=!0,M=k.length-1;0<=M;M--){var P=k[M]|0;C&&P==E||(S[M]=P,C=!1)}this.g=S}var a={};function l(k){return-128<=k&&128>k?i(k,function(E){return new o([E|0],0>E?-1:0)}):new o([k|0],0>k?-1:0)}function c(k){if(isNaN(k)||!isFinite(k))return h;if(0>k)return x(c(-k));for(var E=[],S=1,C=0;k>=S;C++)E[C]=k/S|0,S*=4294967296;return new o(E,0)}function u(k,E){if(k.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(k.charAt(0)=="-")return x(u(k.substring(1),E));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(E,8)),C=h,M=0;M<k.length;M+=8){var P=Math.min(8,k.length-M),N=parseInt(k.substring(M,M+P),E);8>P?(P=c(Math.pow(E,P)),C=C.j(P).add(c(N))):(C=C.j(S),C=C.add(c(N)))}return C}var h=l(0),p=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(v(this))return-x(this).m();for(var k=0,E=1,S=0;S<this.g.length;S++){var C=this.i(S);k+=(0<=C?C:4294967296+C)*E,E*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(g(this))return"0";if(v(this))return"-"+x(this).toString(k);for(var E=c(Math.pow(k,6)),S=this,C="";;){var M=A(S,E).g;S=_(S,M.j(E));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(k);if(S=M,g(S))return P+C;for(;6>P.length;)P="0"+P;C=P+C}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function g(k){if(k.h!=0)return!1;for(var E=0;E<k.g.length;E++)if(k.g[E]!=0)return!1;return!0}function v(k){return k.h==-1}n.l=function(k){return k=_(this,k),v(k)?-1:g(k)?0:1};function x(k){for(var E=k.g.length,S=[],C=0;C<E;C++)S[C]=~k.g[C];return new o(S,~k.h).add(p)}n.abs=function(){return v(this)?x(this):this},n.add=function(k){for(var E=Math.max(this.g.length,k.g.length),S=[],C=0,M=0;M<=E;M++){var P=C+(this.i(M)&65535)+(k.i(M)&65535),N=(P>>>16)+(this.i(M)>>>16)+(k.i(M)>>>16);C=N>>>16,P&=65535,N&=65535,S[M]=N<<16|P}return new o(S,S[S.length-1]&-2147483648?-1:0)};function _(k,E){return k.add(x(E))}n.j=function(k){if(g(this)||g(k))return h;if(v(this))return v(k)?x(this).j(x(k)):x(x(this).j(k));if(v(k))return x(this.j(x(k)));if(0>this.l(m)&&0>k.l(m))return c(this.m()*k.m());for(var E=this.g.length+k.g.length,S=[],C=0;C<2*E;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var M=0;M<k.g.length;M++){var P=this.i(C)>>>16,N=this.i(C)&65535,ae=k.i(M)>>>16,ye=k.i(M)&65535;S[2*C+2*M]+=N*ye,b(S,2*C+2*M),S[2*C+2*M+1]+=P*ye,b(S,2*C+2*M+1),S[2*C+2*M+1]+=N*ae,b(S,2*C+2*M+1),S[2*C+2*M+2]+=P*ae,b(S,2*C+2*M+2)}for(C=0;C<E;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=E;C<2*E;C++)S[C]=0;return new o(S,0)};function b(k,E){for(;(k[E]&65535)!=k[E];)k[E+1]+=k[E]>>>16,k[E]&=65535,E++}function T(k,E){this.g=k,this.h=E}function A(k,E){if(g(E))throw Error("division by zero");if(g(k))return new T(h,h);if(v(k))return E=A(x(k),E),new T(x(E.g),x(E.h));if(v(E))return E=A(k,x(E)),new T(x(E.g),E.h);if(30<k.g.length){if(v(k)||v(E))throw Error("slowDivide_ only works with positive integers.");for(var S=p,C=E;0>=C.l(k);)S=R(S),C=R(C);var M=D(S,1),P=D(C,1);for(C=D(C,2),S=D(S,2);!g(C);){var N=P.add(C);0>=N.l(k)&&(M=M.add(S),P=N),C=D(C,1),S=D(S,1)}return E=_(k,M.j(E)),new T(M,E)}for(M=h;0<=k.l(E);){for(S=Math.max(1,Math.floor(k.m()/E.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),P=c(S),N=P.j(E);v(N)||0<N.l(k);)S-=C,P=c(S),N=P.j(E);g(P)&&(P=p),M=M.add(P),k=_(k,N)}return new T(M,k)}n.A=function(k){return A(this,k).h},n.and=function(k){for(var E=Math.max(this.g.length,k.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)&k.i(C);return new o(S,this.h&k.h)},n.or=function(k){for(var E=Math.max(this.g.length,k.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)|k.i(C);return new o(S,this.h|k.h)},n.xor=function(k){for(var E=Math.max(this.g.length,k.g.length),S=[],C=0;C<E;C++)S[C]=this.i(C)^k.i(C);return new o(S,this.h^k.h)};function R(k){for(var E=k.g.length+1,S=[],C=0;C<E;C++)S[C]=k.i(C)<<1|k.i(C-1)>>>31;return new o(S,k.h)}function D(k,E){var S=E>>5;E%=32;for(var C=k.g.length-S,M=[],P=0;P<C;P++)M[P]=0<E?k.i(P+S)>>>E|k.i(P+S+1)<<32-E:k.i(P+S);return new o(M,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,vC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,po=o}).apply(typeof YE<"u"?YE:typeof self<"u"?self:typeof window<"u"?window:{});var $d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xC,uc,wC,kh,E0,_C,EC,kC;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,y,w){return d==Array.prototype||d==Object.prototype||(d[y]=w.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof $d=="object"&&$d];for(var y=0;y<d.length;++y){var w=d[y];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function s(d,y){if(y)e:{var w=r;d=d.split(".");for(var I=0;I<d.length-1;I++){var j=d[I];if(!(j in w))break e;w=w[j]}d=d[d.length-1],I=w[d],y=y(I),y!=I&&y!=null&&e(w,d,{configurable:!0,writable:!0,value:y})}}function i(d,y){d instanceof String&&(d+="");var w=0,I=!1,j={next:function(){if(!I&&w<d.length){var L=w++;return{value:y(L,d[L]),done:!1}}return I=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(d){return d||function(){return i(this,function(y,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(d){var y=typeof d;return y=y!="object"?y:d?Array.isArray(d)?"array":y:"null",y=="array"||y=="object"&&typeof d.length=="number"}function c(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function u(d,y,w){return d.call.apply(d.bind,arguments)}function h(d,y,w){if(!d)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,I),d.apply(y,j)}}return function(){return d.apply(y,arguments)}}function p(d,y,w){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,p.apply(null,arguments)}function m(d,y){var w=Array.prototype.slice.call(arguments,1);return function(){var I=w.slice();return I.push.apply(I,arguments),d.apply(this,I)}}function g(d,y){function w(){}w.prototype=y.prototype,d.aa=y.prototype,d.prototype=new w,d.prototype.constructor=d,d.Qb=function(I,j,L){for(var q=Array(arguments.length-2),De=2;De<arguments.length;De++)q[De-2]=arguments[De];return y.prototype[j].apply(I,q)}}function v(d){const y=d.length;if(0<y){const w=Array(y);for(let I=0;I<y;I++)w[I]=d[I];return w}return[]}function x(d,y){for(let w=1;w<arguments.length;w++){const I=arguments[w];if(l(I)){const j=d.length||0,L=I.length||0;d.length=j+L;for(let q=0;q<L;q++)d[j+q]=I[q]}else d.push(I)}}class _{constructor(y,w){this.i=y,this.j=w,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function b(d){return/^[\s\xa0]*$/.test(d)}function T(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function A(d){return A[" "](d),d}A[" "]=function(){};var R=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function D(d,y,w){for(const I in d)y.call(w,d[I],I,d)}function k(d,y){for(const w in d)y.call(void 0,d[w],w,d)}function E(d){const y={};for(const w in d)y[w]=d[w];return y}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(d,y){let w,I;for(let j=1;j<arguments.length;j++){I=arguments[j];for(w in I)d[w]=I[w];for(let L=0;L<S.length;L++)w=S[L],Object.prototype.hasOwnProperty.call(I,w)&&(d[w]=I[w])}}function M(d){var y=1;d=d.split(":");const w=[];for(;0<y&&d.length;)w.push(d.shift()),y--;return d.length&&w.push(d.join(":")),w}function P(d){a.setTimeout(()=>{throw d},0)}function N(){var d=Q;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class ae{constructor(){this.h=this.g=null}add(y,w){const I=ye.get();I.set(y,w),this.h?this.h.next=I:this.g=I,this.h=I}}var ye=new _(()=>new H,d=>d.reset());class H{constructor(){this.next=this.g=this.h=null}set(y,w){this.h=y,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,B=!1,Q=new ae,le=()=>{const d=a.Promise.resolve(void 0);ee=()=>{d.then(Ie)}};var Ie=()=>{for(var d;d=N();){try{d.h.call(d.g)}catch(w){P(w)}var y=ye;y.j(d),100>y.h&&(y.h++,d.next=y.g,y.g=d)}B=!1};function Ee(){this.s=this.s,this.C=this.C}Ee.prototype.s=!1,Ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const w=()=>{};a.addEventListener("test",w,y),a.removeEventListener("test",w,y)}catch{}return d}();function nt(d,y){if(ve.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var w=this.type=d.type,I=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget){if(R){e:{try{A(y.nodeName);var j=!0;break e}catch{}j=!1}j||(y=null)}}else w=="mouseover"?y=d.fromElement:w=="mouseout"&&(y=d.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Gt[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&nt.aa.h.call(this)}}g(nt,ve);var Gt={2:"touch",3:"pen",4:"mouse"};nt.prototype.h=function(){nt.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var jn="closure_listenable_"+(1e6*Math.random()|0),B2=0;function U2(d,y,w,I,j){this.listener=d,this.proxy=null,this.src=y,this.type=w,this.capture=!!I,this.ha=j,this.key=++B2,this.da=this.fa=!1}function id(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function od(d){this.src=d,this.g={},this.h=0}od.prototype.add=function(d,y,w,I,j){var L=d.toString();d=this.g[L],d||(d=this.g[L]=[],this.h++);var q=Dm(d,y,I,j);return-1<q?(y=d[q],w||(y.fa=!1)):(y=new U2(y,this.src,L,!!I,j),y.fa=w,d.push(y)),y};function Pm(d,y){var w=y.type;if(w in d.g){var I=d.g[w],j=Array.prototype.indexOf.call(I,y,void 0),L;(L=0<=j)&&Array.prototype.splice.call(I,j,1),L&&(id(y),d.g[w].length==0&&(delete d.g[w],d.h--))}}function Dm(d,y,w,I){for(var j=0;j<d.length;++j){var L=d[j];if(!L.da&&L.listener==y&&L.capture==!!w&&L.ha==I)return j}return-1}var Mm="closure_lm_"+(1e6*Math.random()|0),Om={};function i_(d,y,w,I,j){if(Array.isArray(y)){for(var L=0;L<y.length;L++)i_(d,y[L],w,I,j);return null}return w=l_(w),d&&d[jn]?d.K(y,w,c(I)?!!I.capture:!1,j):$2(d,y,w,!1,I,j)}function $2(d,y,w,I,j,L){if(!y)throw Error("Invalid event type");var q=c(j)?!!j.capture:!!j,De=Vm(d);if(De||(d[Mm]=De=new od(d)),w=De.add(y,w,I,q,L),w.proxy)return w;if(I=z2(),w.proxy=I,I.src=d,I.listener=w,d.addEventListener)X||(j=q),j===void 0&&(j=!1),d.addEventListener(y.toString(),I,j);else if(d.attachEvent)d.attachEvent(a_(y.toString()),I);else if(d.addListener&&d.removeListener)d.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return w}function z2(){function d(w){return y.call(d.src,d.listener,w)}const y=W2;return d}function o_(d,y,w,I,j){if(Array.isArray(y))for(var L=0;L<y.length;L++)o_(d,y[L],w,I,j);else I=c(I)?!!I.capture:!!I,w=l_(w),d&&d[jn]?(d=d.i,y=String(y).toString(),y in d.g&&(L=d.g[y],w=Dm(L,w,I,j),-1<w&&(id(L[w]),Array.prototype.splice.call(L,w,1),L.length==0&&(delete d.g[y],d.h--)))):d&&(d=Vm(d))&&(y=d.g[y.toString()],d=-1,y&&(d=Dm(y,w,I,j)),(w=-1<d?y[d]:null)&&jm(w))}function jm(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[jn])Pm(y.i,d);else{var w=d.type,I=d.proxy;y.removeEventListener?y.removeEventListener(w,I,d.capture):y.detachEvent?y.detachEvent(a_(w),I):y.addListener&&y.removeListener&&y.removeListener(I),(w=Vm(y))?(Pm(w,d),w.h==0&&(w.src=null,y[Mm]=null)):id(d)}}}function a_(d){return d in Om?Om[d]:Om[d]="on"+d}function W2(d,y){if(d.da)d=!0;else{y=new nt(y,this);var w=d.listener,I=d.ha||d.src;d.fa&&jm(d),d=w.call(I,y)}return d}function Vm(d){return d=d[Mm],d instanceof od?d:null}var Lm="__closure_events_fn_"+(1e9*Math.random()>>>0);function l_(d){return typeof d=="function"?d:(d[Lm]||(d[Lm]=function(y){return d.handleEvent(y)}),d[Lm])}function Ot(){Ee.call(this),this.i=new od(this),this.M=this,this.F=null}g(Ot,Ee),Ot.prototype[jn]=!0,Ot.prototype.removeEventListener=function(d,y,w,I){o_(this,d,y,w,I)};function Qt(d,y){var w,I=d.F;if(I)for(w=[];I;I=I.F)w.push(I);if(d=d.M,I=y.type||y,typeof y=="string")y=new ve(y,d);else if(y instanceof ve)y.target=y.target||d;else{var j=y;y=new ve(I,d),C(y,j)}if(j=!0,w)for(var L=w.length-1;0<=L;L--){var q=y.g=w[L];j=ad(q,I,!0,y)&&j}if(q=y.g=d,j=ad(q,I,!0,y)&&j,j=ad(q,I,!1,y)&&j,w)for(L=0;L<w.length;L++)q=y.g=w[L],j=ad(q,I,!1,y)&&j}Ot.prototype.N=function(){if(Ot.aa.N.call(this),this.i){var d=this.i,y;for(y in d.g){for(var w=d.g[y],I=0;I<w.length;I++)id(w[I]);delete d.g[y],d.h--}}this.F=null},Ot.prototype.K=function(d,y,w,I){return this.i.add(String(d),y,!1,w,I)},Ot.prototype.L=function(d,y,w,I){return this.i.add(String(d),y,!0,w,I)};function ad(d,y,w,I){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();for(var j=!0,L=0;L<y.length;++L){var q=y[L];if(q&&!q.da&&q.capture==w){var De=q.listener,Tt=q.ha||q.src;q.fa&&Pm(d.i,q),j=De.call(Tt,I)!==!1&&j}}return j&&!I.defaultPrevented}function c_(d,y,w){if(typeof d=="function")w&&(d=p(d,w));else if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:a.setTimeout(d,y||0)}function u_(d){d.g=c_(()=>{d.g=null,d.i&&(d.i=!1,u_(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class H2 extends Ee{constructor(y,w){super(),this.m=y,this.l=w,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:u_(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Il(d){Ee.call(this),this.h=d,this.g={}}g(Il,Ee);var d_=[];function h_(d){D(d.g,function(y,w){this.g.hasOwnProperty(w)&&jm(y)},d),d.g={}}Il.prototype.N=function(){Il.aa.N.call(this),h_(this)},Il.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fm=a.JSON.stringify,q2=a.JSON.parse,K2=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function Bm(){}Bm.prototype.h=null;function f_(d){return d.h||(d.h=d.i())}function p_(){}var Nl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Um(){ve.call(this,"d")}g(Um,ve);function $m(){ve.call(this,"c")}g($m,ve);var Ui={},m_=null;function ld(){return m_=m_||new Ot}Ui.La="serverreachability";function g_(d){ve.call(this,Ui.La,d)}g(g_,ve);function Cl(d){const y=ld();Qt(y,new g_(y))}Ui.STAT_EVENT="statevent";function y_(d,y){ve.call(this,Ui.STAT_EVENT,d),this.stat=y}g(y_,ve);function Jt(d){const y=ld();Qt(y,new y_(y,d))}Ui.Ma="timingevent";function v_(d,y){ve.call(this,Ui.Ma,d),this.size=y}g(v_,ve);function Al(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},y)}function Rl(){this.g=!0}Rl.prototype.xa=function(){this.g=!1};function G2(d,y,w,I,j,L){d.info(function(){if(d.g)if(L)for(var q="",De=L.split("&"),Tt=0;Tt<De.length;Tt++){var Se=De[Tt].split("=");if(1<Se.length){var jt=Se[0];Se=Se[1];var Vt=jt.split("_");q=2<=Vt.length&&Vt[1]=="type"?q+(jt+"="+Se+"&"):q+(jt+"=redacted&")}}else q=null;else q=L;return"XMLHTTP REQ ("+I+") [attempt "+j+"]: "+y+`
`+w+`
`+q})}function Q2(d,y,w,I,j,L,q){d.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+j+"]: "+y+`
`+w+`
`+L+" "+q})}function ta(d,y,w,I){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+Y2(d,w)+(I?" "+I:"")})}function J2(d,y){d.info(function(){return"TIMEOUT: "+y})}Rl.prototype.info=function(){};function Y2(d,y){if(!d.g)return y;if(!y)return null;try{var w=JSON.parse(y);if(w){for(d=0;d<w.length;d++)if(Array.isArray(w[d])){var I=w[d];if(!(2>I.length)){var j=I[1];if(Array.isArray(j)&&!(1>j.length)){var L=j[0];if(L!="noop"&&L!="stop"&&L!="close")for(var q=1;q<j.length;q++)j[q]=""}}}}return Fm(w)}catch{return y}}var cd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},x_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zm;function ud(){}g(ud,Bm),ud.prototype.g=function(){return new XMLHttpRequest},ud.prototype.i=function(){return{}},zm=new ud;function ks(d,y,w,I){this.j=d,this.i=y,this.l=w,this.R=I||1,this.U=new Il(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new w_}function w_(){this.i=null,this.g="",this.h=!1}var __={},Wm={};function Hm(d,y,w){d.L=1,d.v=pd(Ur(y)),d.m=w,d.P=!0,E_(d,null)}function E_(d,y){d.F=Date.now(),dd(d),d.A=Ur(d.v);var w=d.A,I=d.R;Array.isArray(I)||(I=[String(I)]),j_(w.i,"t",I),d.C=0,w=d.j.J,d.h=new w_,d.g=e1(d.j,w?y:null,!d.m),0<d.O&&(d.M=new H2(p(d.Y,d,d.g),d.O)),y=d.U,w=d.g,I=d.ca;var j="readystatechange";Array.isArray(j)||(j&&(d_[0]=j.toString()),j=d_);for(var L=0;L<j.length;L++){var q=i_(w,j[L],I||y.handleEvent,!1,y.h||y);if(!q)break;y.g[q.key]=q}y=d.H?E(d.H):{},d.m?(d.u||(d.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,y)):(d.u="GET",d.g.ea(d.A,d.u,null,y)),Cl(),G2(d.i,d.u,d.A,d.l,d.R,d.m)}ks.prototype.ca=function(d){d=d.target;const y=this.M;y&&$r(d)==3?y.j():this.Y(d)},ks.prototype.Y=function(d){try{if(d==this.g)e:{const Vt=$r(this.g);var y=this.g.Ba();const sa=this.g.Z();if(!(3>Vt)&&(Vt!=3||this.g&&(this.h.h||this.g.oa()||z_(this.g)))){this.J||Vt!=4||y==7||(y==8||0>=sa?Cl(3):Cl(2)),qm(this);var w=this.g.Z();this.X=w;t:if(k_(this)){var I=z_(this.g);d="";var j=I.length,L=$r(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$i(this),Pl(this);var q="";break t}this.h.i=new a.TextDecoder}for(y=0;y<j;y++)this.h.h=!0,d+=this.h.i.decode(I[y],{stream:!(L&&y==j-1)});I.length=0,this.h.g+=d,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=w==200,Q2(this.i,this.u,this.A,this.l,this.R,Vt,w),this.o){if(this.T&&!this.K){t:{if(this.g){var De,Tt=this.g;if((De=Tt.g?Tt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(De)){var Se=De;break t}}Se=null}if(w=Se)ta(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Km(this,w);else{this.o=!1,this.s=3,Jt(12),$i(this),Pl(this);break e}}if(this.P){w=!0;let tr;for(;!this.J&&this.C<q.length;)if(tr=X2(this,q),tr==Wm){Vt==4&&(this.s=4,Jt(14),w=!1),ta(this.i,this.l,null,"[Incomplete Response]");break}else if(tr==__){this.s=4,Jt(15),ta(this.i,this.l,q,"[Invalid Chunk]"),w=!1;break}else ta(this.i,this.l,tr,null),Km(this,tr);if(k_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vt!=4||q.length!=0||this.h.h||(this.s=1,Jt(16),w=!1),this.o=this.o&&w,!w)ta(this.i,this.l,q,"[Invalid Chunked Response]"),$i(this),Pl(this);else if(0<q.length&&!this.W){this.W=!0;var jt=this.j;jt.g==this&&jt.ba&&!jt.M&&(jt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),Zm(jt),jt.M=!0,Jt(11))}}else ta(this.i,this.l,q,null),Km(this,q);Vt==4&&$i(this),this.o&&!this.J&&(Vt==4?J_(this.j,this):(this.o=!1,dd(this)))}else mD(this.g),w==400&&0<q.indexOf("Unknown SID")?(this.s=3,Jt(12)):(this.s=0,Jt(13)),$i(this),Pl(this)}}}catch{}finally{}};function k_(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function X2(d,y){var w=d.C,I=y.indexOf(`
`,w);return I==-1?Wm:(w=Number(y.substring(w,I)),isNaN(w)?__:(I+=1,I+w>y.length?Wm:(y=y.slice(I,I+w),d.C=I+w,y)))}ks.prototype.cancel=function(){this.J=!0,$i(this)};function dd(d){d.S=Date.now()+d.I,b_(d,d.I)}function b_(d,y){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Al(p(d.ba,d),y)}function qm(d){d.B&&(a.clearTimeout(d.B),d.B=null)}ks.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(J2(this.i,this.A),this.L!=2&&(Cl(),Jt(17)),$i(this),this.s=2,Pl(this)):b_(this,this.S-d)};function Pl(d){d.j.G==0||d.J||J_(d.j,d)}function $i(d){qm(d);var y=d.M;y&&typeof y.ma=="function"&&y.ma(),d.M=null,h_(d.U),d.g&&(y=d.g,d.g=null,y.abort(),y.ma())}function Km(d,y){try{var w=d.j;if(w.G!=0&&(w.g==d||Gm(w.h,d))){if(!d.K&&Gm(w.h,d)&&w.G==3){try{var I=w.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var j=I;if(j[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<d.F)wd(w),vd(w);else break e;Xm(w),Jt(18)}}else w.za=j[1],0<w.za-w.T&&37500>j[2]&&w.F&&w.v==0&&!w.C&&(w.C=Al(p(w.Za,w),6e3));if(1>=I_(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Wi(w,11)}else if((d.K||w.g==d)&&wd(w),!b(y))for(j=w.Da.g.parse(y),y=0;y<j.length;y++){let Se=j[y];if(w.T=Se[0],Se=Se[1],w.G==2)if(Se[0]=="c"){w.K=Se[1],w.ia=Se[2];const jt=Se[3];jt!=null&&(w.la=jt,w.j.info("VER="+w.la));const Vt=Se[4];Vt!=null&&(w.Aa=Vt,w.j.info("SVER="+w.Aa));const sa=Se[5];sa!=null&&typeof sa=="number"&&0<sa&&(I=1.5*sa,w.L=I,w.j.info("backChannelRequestTimeoutMs_="+I)),I=w;const tr=d.g;if(tr){const Ed=tr.g?tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ed){var L=I.h;L.g||Ed.indexOf("spdy")==-1&&Ed.indexOf("quic")==-1&&Ed.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Qm(L,L.h),L.h=null))}if(I.D){const eg=tr.g?tr.g.getResponseHeader("X-HTTP-Session-Id"):null;eg&&(I.ya=eg,je(I.I,I.D,eg))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-d.F,w.j.info("Handshake RTT: "+w.R+"ms")),I=w;var q=d;if(I.qa=Z_(I,I.J?I.ia:null,I.W),q.K){N_(I.h,q);var De=q,Tt=I.L;Tt&&(De.I=Tt),De.B&&(qm(De),dd(De)),I.g=q}else G_(I);0<w.i.length&&xd(w)}else Se[0]!="stop"&&Se[0]!="close"||Wi(w,7);else w.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?Wi(w,7):Ym(w):Se[0]!="noop"&&w.l&&w.l.ta(Se),w.v=0)}}Cl(4)}catch{}}var Z2=class{constructor(d,y){this.g=d,this.map=y}};function T_(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function S_(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function I_(d){return d.h?1:d.g?d.g.size:0}function Gm(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function Qm(d,y){d.g?d.g.add(y):d.h=y}function N_(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}T_.prototype.cancel=function(){if(this.i=C_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function C_(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const w of d.g.values())y=y.concat(w.D);return y}return v(d.i)}function eD(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var y=[],w=d.length,I=0;I<w;I++)y.push(d[I]);return y}y=[],w=0;for(I in d)y[w++]=d[I];return y}function tD(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var y=[];d=d.length;for(var w=0;w<d;w++)y.push(w);return y}y=[],w=0;for(const I in d)y[w++]=I;return y}}}function A_(d,y){if(d.forEach&&typeof d.forEach=="function")d.forEach(y,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,y,void 0);else for(var w=tD(d),I=eD(d),j=I.length,L=0;L<j;L++)y.call(void 0,I[L],w&&w[L],d)}var R_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nD(d,y){if(d){d=d.split("&");for(var w=0;w<d.length;w++){var I=d[w].indexOf("="),j=null;if(0<=I){var L=d[w].substring(0,I);j=d[w].substring(I+1)}else L=d[w];y(L,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function zi(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof zi){this.h=d.h,hd(this,d.j),this.o=d.o,this.g=d.g,fd(this,d.s),this.l=d.l;var y=d.i,w=new Ol;w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),P_(this,w),this.m=d.m}else d&&(y=String(d).match(R_))?(this.h=!1,hd(this,y[1]||"",!0),this.o=Dl(y[2]||""),this.g=Dl(y[3]||"",!0),fd(this,y[4]),this.l=Dl(y[5]||"",!0),P_(this,y[6]||"",!0),this.m=Dl(y[7]||"")):(this.h=!1,this.i=new Ol(null,this.h))}zi.prototype.toString=function(){var d=[],y=this.j;y&&d.push(Ml(y,D_,!0),":");var w=this.g;return(w||y=="file")&&(d.push("//"),(y=this.o)&&d.push(Ml(y,D_,!0),"@"),d.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&d.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&d.push("/"),d.push(Ml(w,w.charAt(0)=="/"?iD:sD,!0))),(w=this.i.toString())&&d.push("?",w),(w=this.m)&&d.push("#",Ml(w,aD)),d.join("")};function Ur(d){return new zi(d)}function hd(d,y,w){d.j=w?Dl(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function fd(d,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);d.s=y}else d.s=null}function P_(d,y,w){y instanceof Ol?(d.i=y,lD(d.i,d.h)):(w||(y=Ml(y,oD)),d.i=new Ol(y,d.h))}function je(d,y,w){d.i.set(y,w)}function pd(d){return je(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Dl(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Ml(d,y,w){return typeof d=="string"?(d=encodeURI(d).replace(y,rD),w&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function rD(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var D_=/[#\/\?@]/g,sD=/[#\?:]/g,iD=/[#\?]/g,oD=/[#\?@]/g,aD=/#/g;function Ol(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function bs(d){d.g||(d.g=new Map,d.h=0,d.i&&nD(d.i,function(y,w){d.add(decodeURIComponent(y.replace(/\+/g," ")),w)}))}n=Ol.prototype,n.add=function(d,y){bs(this),this.i=null,d=na(this,d);var w=this.g.get(d);return w||this.g.set(d,w=[]),w.push(y),this.h+=1,this};function M_(d,y){bs(d),y=na(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function O_(d,y){return bs(d),y=na(d,y),d.g.has(y)}n.forEach=function(d,y){bs(this),this.g.forEach(function(w,I){w.forEach(function(j){d.call(y,j,I,this)},this)},this)},n.na=function(){bs(this);const d=Array.from(this.g.values()),y=Array.from(this.g.keys()),w=[];for(let I=0;I<y.length;I++){const j=d[I];for(let L=0;L<j.length;L++)w.push(y[I])}return w},n.V=function(d){bs(this);let y=[];if(typeof d=="string")O_(this,d)&&(y=y.concat(this.g.get(na(this,d))));else{d=Array.from(this.g.values());for(let w=0;w<d.length;w++)y=y.concat(d[w])}return y},n.set=function(d,y){return bs(this),this.i=null,d=na(this,d),O_(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},n.get=function(d,y){return d?(d=this.V(d),0<d.length?String(d[0]):y):y};function j_(d,y,w){M_(d,y),0<w.length&&(d.i=null,d.g.set(na(d,y),v(w)),d.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(var w=0;w<y.length;w++){var I=y[w];const L=encodeURIComponent(String(I)),q=this.V(I);for(I=0;I<q.length;I++){var j=L;q[I]!==""&&(j+="="+encodeURIComponent(String(q[I]))),d.push(j)}}return this.i=d.join("&")};function na(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function lD(d,y){y&&!d.j&&(bs(d),d.i=null,d.g.forEach(function(w,I){var j=I.toLowerCase();I!=j&&(M_(this,I),j_(this,j,w))},d)),d.j=y}function cD(d,y){const w=new Rl;if(a.Image){const I=new Image;I.onload=m(Ts,w,"TestLoadImage: loaded",!0,y,I),I.onerror=m(Ts,w,"TestLoadImage: error",!1,y,I),I.onabort=m(Ts,w,"TestLoadImage: abort",!1,y,I),I.ontimeout=m(Ts,w,"TestLoadImage: timeout",!1,y,I),a.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=d}else y(!1)}function uD(d,y){const w=new Rl,I=new AbortController,j=setTimeout(()=>{I.abort(),Ts(w,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:I.signal}).then(L=>{clearTimeout(j),L.ok?Ts(w,"TestPingServer: ok",!0,y):Ts(w,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(j),Ts(w,"TestPingServer: error",!1,y)})}function Ts(d,y,w,I,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),I(w)}catch{}}function dD(){this.g=new K2}function hD(d,y,w){const I=w||"";try{A_(d,function(j,L){let q=j;c(j)&&(q=Fm(j)),y.push(I+L+"="+encodeURIComponent(q))})}catch(j){throw y.push(I+"type="+encodeURIComponent("_badmap")),j}}function md(d){this.l=d.Ub||null,this.j=d.eb||!1}g(md,Bm),md.prototype.g=function(){return new gd(this.l,this.j)},md.prototype.i=function(d){return function(){return d}}({});function gd(d,y){Ot.call(this),this.D=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(gd,Ot),n=gd.prototype,n.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=y,this.readyState=1,Vl(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(y.body=d),(this.D||a).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,jl(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Vl(this)),this.g&&(this.readyState=3,Vl(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;V_(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function V_(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?jl(this):Vl(this),this.readyState==3&&V_(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,jl(this))},n.Qa=function(d){this.g&&(this.response=d,jl(this))},n.ga=function(){this.g&&jl(this)};function jl(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Vl(d)}n.setRequestHeader=function(d,y){this.u.append(d,y)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var w=y.next();!w.done;)w=w.value,d.push(w[0]+": "+w[1]),w=y.next();return d.join(`\r
`)};function Vl(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(gd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function L_(d){let y="";return D(d,function(w,I){y+=I,y+=":",y+=w,y+=`\r
`}),y}function Jm(d,y,w){e:{for(I in w){var I=!1;break e}I=!0}I||(w=L_(w),typeof d=="string"?w!=null&&encodeURIComponent(String(w)):je(d,y,w))}function Ge(d){Ot.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Ge,Ot);var fD=/^https?$/i,pD=["POST","PUT"];n=Ge.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,y,w,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zm.g(),this.v=this.o?f_(this.o):f_(zm),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(L){F_(this,L);return}if(d=w||"",w=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var j in I)w.set(j,I[j]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const L of I.keys())w.set(L,I.get(L));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(w.keys()).find(L=>L.toLowerCase()=="content-type"),j=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(pD,y,void 0))||I||j||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,q]of w)this.g.setRequestHeader(L,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$_(this),this.u=!0,this.g.send(d),this.u=!1}catch(L){F_(this,L)}};function F_(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.m=5,B_(d),yd(d)}function B_(d){d.A||(d.A=!0,Qt(d,"complete"),Qt(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Qt(this,"complete"),Qt(this,"abort"),yd(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yd(this,!0)),Ge.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?U_(this):this.bb())},n.bb=function(){U_(this)};function U_(d){if(d.h&&typeof o<"u"&&(!d.v[1]||$r(d)!=4||d.Z()!=2)){if(d.u&&$r(d)==4)c_(d.Ea,0,d);else if(Qt(d,"readystatechange"),$r(d)==4){d.h=!1;try{const q=d.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var w;if(!(w=y)){var I;if(I=q===0){var j=String(d.D).match(R_)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),I=!fD.test(j?j.toLowerCase():"")}w=I}if(w)Qt(d,"complete"),Qt(d,"success");else{d.m=6;try{var L=2<$r(d)?d.g.statusText:""}catch{L=""}d.l=L+" ["+d.Z()+"]",B_(d)}}finally{yd(d)}}}}function yd(d,y){if(d.g){$_(d);const w=d.g,I=d.v[0]?()=>{}:null;d.g=null,d.v=null,y||Qt(d,"ready");try{w.onreadystatechange=I}catch{}}}function $_(d){d.I&&(a.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function $r(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<$r(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),q2(y)}};function z_(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function mD(d){const y={};d=(d.g&&2<=$r(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<d.length;I++){if(b(d[I]))continue;var w=M(d[I]);const j=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const L=y[j]||[];y[j]=L,L.push(w)}k(y,function(I){return I.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ll(d,y,w){return w&&w.internalChannelParams&&w.internalChannelParams[d]||y}function W_(d){this.Aa=0,this.i=[],this.j=new Rl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ll("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ll("baseRetryDelayMs",5e3,d),this.cb=Ll("retryDelaySeedMs",1e4,d),this.Wa=Ll("forwardChannelMaxRetries",2,d),this.wa=Ll("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new T_(d&&d.concurrentRequestLimit),this.Da=new dD,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=W_.prototype,n.la=8,n.G=1,n.connect=function(d,y,w,I){Jt(0),this.W=d,this.H=y||{},w&&I!==void 0&&(this.H.OSID=w,this.H.OAID=I),this.F=this.X,this.I=Z_(this,null,this.W),xd(this)};function Ym(d){if(H_(d),d.G==3){var y=d.U++,w=Ur(d.I);if(je(w,"SID",d.K),je(w,"RID",y),je(w,"TYPE","terminate"),Fl(d,w),y=new ks(d,d.j,y),y.L=2,y.v=pd(Ur(w)),w=!1,a.navigator&&a.navigator.sendBeacon)try{w=a.navigator.sendBeacon(y.v.toString(),"")}catch{}!w&&a.Image&&(new Image().src=y.v,w=!0),w||(y.g=e1(y.j,null),y.g.ea(y.v)),y.F=Date.now(),dd(y)}X_(d)}function vd(d){d.g&&(Zm(d),d.g.cancel(),d.g=null)}function H_(d){vd(d),d.u&&(a.clearTimeout(d.u),d.u=null),wd(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function xd(d){if(!S_(d.h)&&!d.s){d.s=!0;var y=d.Ga;ee||le(),B||(ee(),B=!0),Q.add(y,d),d.B=0}}function gD(d,y){return I_(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=y.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Al(p(d.Ga,d,y),Y_(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const j=new ks(this,this.j,d);let L=this.o;if(this.S&&(L?(L=E(L),C(L,this.S)):L=this.S),this.m!==null||this.O||(j.H=L,L=null),this.P)e:{for(var y=0,w=0;w<this.i.length;w++){t:{var I=this.i[w];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=w;break e}if(y===4096||w===this.i.length-1){y=w+1;break e}}y=1e3}else y=1e3;y=K_(this,j,y),w=Ur(this.I),je(w,"RID",d),je(w,"CVER",22),this.D&&je(w,"X-HTTP-Session-Id",this.D),Fl(this,w),L&&(this.O?y="headers="+encodeURIComponent(String(L_(L)))+"&"+y:this.m&&Jm(w,this.m,L)),Qm(this.h,j),this.Ua&&je(w,"TYPE","init"),this.P?(je(w,"$req",y),je(w,"SID","null"),j.T=!0,Hm(j,w,null)):Hm(j,w,y),this.G=2}}else this.G==3&&(d?q_(this,d):this.i.length==0||S_(this.h)||q_(this))};function q_(d,y){var w;y?w=y.l:w=d.U++;const I=Ur(d.I);je(I,"SID",d.K),je(I,"RID",w),je(I,"AID",d.T),Fl(d,I),d.m&&d.o&&Jm(I,d.m,d.o),w=new ks(d,d.j,w,d.B+1),d.m===null&&(w.H=d.o),y&&(d.i=y.D.concat(d.i)),y=K_(d,w,1e3),w.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Qm(d.h,w),Hm(w,I,y)}function Fl(d,y){d.H&&D(d.H,function(w,I){je(y,I,w)}),d.l&&A_({},function(w,I){je(y,I,w)})}function K_(d,y,w){w=Math.min(d.i.length,w);var I=d.l?p(d.l.Na,d.l,d):null;e:{var j=d.i;let L=-1;for(;;){const q=["count="+w];L==-1?0<w?(L=j[0].g,q.push("ofs="+L)):L=0:q.push("ofs="+L);let De=!0;for(let Tt=0;Tt<w;Tt++){let Se=j[Tt].g;const jt=j[Tt].map;if(Se-=L,0>Se)L=Math.max(0,j[Tt].g-100),De=!1;else try{hD(jt,q,"req"+Se+"_")}catch{I&&I(jt)}}if(De){I=q.join("&");break e}}}return d=d.i.splice(0,w),y.D=d,I}function G_(d){if(!d.g&&!d.u){d.Y=1;var y=d.Fa;ee||le(),B||(ee(),B=!0),Q.add(y,d),d.v=0}}function Xm(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Al(p(d.Fa,d),Y_(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,Q_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Al(p(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Jt(10),vd(this),Q_(this))};function Zm(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function Q_(d){d.g=new ks(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var y=Ur(d.qa);je(y,"RID","rpc"),je(y,"SID",d.K),je(y,"AID",d.T),je(y,"CI",d.F?"0":"1"),!d.F&&d.ja&&je(y,"TO",d.ja),je(y,"TYPE","xmlhttp"),Fl(d,y),d.m&&d.o&&Jm(y,d.m,d.o),d.L&&(d.g.I=d.L);var w=d.g;d=d.ia,w.L=1,w.v=pd(Ur(y)),w.m=null,w.P=!0,E_(w,d)}n.Za=function(){this.C!=null&&(this.C=null,vd(this),Xm(this),Jt(19))};function wd(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function J_(d,y){var w=null;if(d.g==y){wd(d),Zm(d),d.g=null;var I=2}else if(Gm(d.h,y))w=y.D,N_(d.h,y),I=1;else return;if(d.G!=0){if(y.o)if(I==1){w=y.m?y.m.length:0,y=Date.now()-y.F;var j=d.B;I=ld(),Qt(I,new v_(I,w)),xd(d)}else G_(d);else if(j=y.s,j==3||j==0&&0<y.X||!(I==1&&gD(d,y)||I==2&&Xm(d)))switch(w&&0<w.length&&(y=d.h,y.i=y.i.concat(w)),j){case 1:Wi(d,5);break;case 4:Wi(d,10);break;case 3:Wi(d,6);break;default:Wi(d,2)}}}function Y_(d,y){let w=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(w*=2),w*y}function Wi(d,y){if(d.j.info("Error code "+y),y==2){var w=p(d.fb,d),I=d.Xa;const j=!I;I=new zi(I||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||hd(I,"https"),pd(I),j?cD(I.toString(),w):uD(I.toString(),w)}else Jt(2);d.G=0,d.l&&d.l.sa(y),X_(d),H_(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Jt(2)):(this.j.info("Failed to ping google.com"),Jt(1))};function X_(d){if(d.G=0,d.ka=[],d.l){const y=C_(d.h);(y.length!=0||d.i.length!=0)&&(x(d.ka,y),x(d.ka,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.ra()}}function Z_(d,y,w){var I=w instanceof zi?Ur(w):new zi(w);if(I.g!="")y&&(I.g=y+"."+I.g),fd(I,I.s);else{var j=a.location;I=j.protocol,y=y?y+"."+j.hostname:j.hostname,j=+j.port;var L=new zi(null);I&&hd(L,I),y&&(L.g=y),j&&fd(L,j),w&&(L.l=w),I=L}return w=d.D,y=d.ya,w&&y&&je(I,w,y),je(I,"VER",d.la),Fl(d,I),I}function e1(d,y,w){if(y&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Ca&&!d.pa?new Ge(new md({eb:w})):new Ge(d.pa),y.Ha(d.J),y}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function t1(){}n=t1.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function _d(){}_d.prototype.g=function(d,y){return new kn(d,y)};function kn(d,y){Ot.call(this),this.g=new W_(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(d?d["X-WebChannel-Client-Profile"]=y.va:d={"X-WebChannel-Client-Profile":y.va}),this.g.S=d,(d=y&&y.Sb)&&!b(d)&&(this.g.m=d),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!b(y)&&(this.g.D=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new ra(this)}g(kn,Ot),kn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){Ym(this.g)},kn.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var w={};w.__data__=d,d=w}else this.u&&(w={},w.__data__=Fm(d),d=w);y.i.push(new Z2(y.Ya++,d)),y.G==3&&xd(y)},kn.prototype.N=function(){this.g.l=null,delete this.j,Ym(this.g),delete this.g,kn.aa.N.call(this)};function n1(d){Um.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const w in y){d=w;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}g(n1,Um);function r1(){$m.call(this),this.status=1}g(r1,$m);function ra(d){this.g=d}g(ra,t1),ra.prototype.ua=function(){Qt(this.g,"a")},ra.prototype.ta=function(d){Qt(this.g,new n1(d))},ra.prototype.sa=function(d){Qt(this.g,new r1)},ra.prototype.ra=function(){Qt(this.g,"b")},_d.prototype.createWebChannel=_d.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,kC=function(){return new _d},EC=function(){return ld()},_C=Ui,E0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cd.NO_ERROR=0,cd.TIMEOUT=8,cd.HTTP_ERROR=6,kh=cd,x_.COMPLETE="complete",wC=x_,p_.EventType=Nl,Nl.OPEN="a",Nl.CLOSE="b",Nl.ERROR="c",Nl.MESSAGE="d",Ot.prototype.listen=Ot.prototype.K,uc=p_,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,xC=Ge}).apply(typeof $d<"u"?$d:typeof self<"u"?self:typeof window<"u"?window:{});const XE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Nt.UNAUTHENTICATED=new Nt(null),Nt.GOOGLE_CREDENTIALS=new Nt("google-credentials-uid"),Nt.FIRST_PARTY=new Nt("first-party-uid"),Nt.MOCK_USER=new Nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro=new wx("@firebase/firestore");function fa(){return Ro.logLevel}function $(n,...e){if(Ro.logLevel<=we.DEBUG){const t=e.map(Px);Ro.debug(`Firestore (${El}): ${n}`,...t)}}function Xt(n,...e){if(Ro.logLevel<=we.ERROR){const t=e.map(Px);Ro.error(`Firestore (${El}): ${n}`,...t)}}function Po(n,...e){if(Ro.logLevel<=we.WARN){const t=e.map(Px);Ro.warn(`Firestore (${El}): ${n}`,...t)}}function Px(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(n="Unexpected state"){const e=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: `+n;throw Xt(e),new Error(e)}function re(n,e){n||te()}function de(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends Fr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Nt.UNAUTHENTICATED))}shutdown(){}}class A3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class R3{constructor(e){this.t=e,this.currentUser=Nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){re(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Dr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Dr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):($("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Dr)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?($("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(re(typeof r.accessToken=="string"),new bC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return re(e===null||typeof e=="string"),new Nt(e)}}class P3{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Nt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class D3{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new P3(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class M3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){re(this.o===void 0);const r=i=>{i.error!=null&&$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,$("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(re(typeof t.token=="string"),this.R=t.token,new M3(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=j3(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function he(n,e){return n<e?-1:n>e?1:0}function nl(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function SC(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new qe(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ie(e)}static min(){return new ie(new qe(0,0))}static max(){return new ie(new qe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,t,r){t===void 0?t=0:t>e.length&&te(),r===void 0?r=e.length-t:r>e.length-t&&te(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return hu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof hu?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ne extends hu{construct(e,t,r){return new Ne(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Ne(t)}static emptyPath(){return new Ne([])}}const V3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class We extends hu{construct(e,t,r){return new We(e,t,r)}static isValidIdentifier(e){return V3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),We.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new We(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new K(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new K(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new K(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new We(t)}static emptyPath(){return new We([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.path=e}static fromPath(e){return new G(Ne.fromString(e))}static fromName(e){return new G(Ne.fromString(e).popFirst(5))}static empty(){return new G(Ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ne.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ne.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new Ne(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function k0(n){return n.fields.find(e=>e.kind===2)}function Ji(n){return n.fields.filter(e=>e.kind!==2)}wf.UNKNOWN_ID=-1;class bh{constructor(e,t){this.fieldPath=e,this.kind=t}}class fu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new fu(0,Dn.min())}}function L3(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ie.fromTimestamp(r===1e9?new qe(t+1,0):new qe(t,r));return new Dn(s,G.empty(),e)}function IC(n){return new Dn(n.readTime,n.key,-1)}class Dn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Dn(ie.min(),G.empty(),-1)}static max(){return new Dn(ie.max(),G.empty(),-1)}}function Dx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=G.comparator(n.documentKey,e.documentKey),t!==0?t:he(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==NC)throw n;$("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&te(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,r)=>{t(e)})}static reject(e){return new V((t,r)=>{r(e)})}static waitFor(e){return new V((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next(s=>s?V.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,t){return new V((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Dr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Cc(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=Mx(r.target.error);this.V.reject(new Cc(e,s))}}static open(e,t,r,s){try{return new Gp(t,e.transaction(s,r))}catch(i){throw new Cc(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||($("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new B3(t)}}class hi{constructor(e,t,r){this.name=e,this.version=t,this.p=r,hi.S(ht())===12.2&&Xt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return $("SimpleDb","Removing database:",e),Xi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!PN())return!1;if(hi.v())return!0;const e=ht(),t=hi.S(e),r=0<t&&t<10,s=AC(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||($("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new Cc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new K(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new K(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Cc(e,o))},s.onupgradeneeded=i=>{$("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{$("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Gp.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),V.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if($("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function AC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class F3{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Xi(this.B.delete())}}class Cc extends K{constructor(e,t){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Oi(n){return n.name==="IndexedDbTransactionError"}class B3{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?($("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):($("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Xi(r)}add(e){return $("SimpleDb","ADD",this.store.name,e,e),Xi(this.store.add(e))}get(e){return Xi(this.store.get(e)).next(t=>(t===void 0&&(t=null),$("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return $("SimpleDb","DELETE",this.store.name,e),Xi(this.store.delete(e))}count(){return $("SimpleDb","COUNT",this.store.name),Xi(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){$("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new V((r,s)=>{t.onerror=i=>{const o=Mx(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new F3(a),c=t(a.primaryKey,a.value,l);if(c instanceof V){const u=c.catch(h=>(l.done(),V.reject(h)));r.push(u)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>V.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Xi(n){return new V((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=Mx(r.target.error);t(s)}})}let ZE=!1;function Mx(n){const e=hi.S(ht());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new K("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ZE||(ZE=!0,setTimeout(()=>{throw r},0)),r}}return n}class U3{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){$("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{$("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Oi(t)?$("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Jo(t)}await this.X(6e4)})}}class $3{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return $("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>($("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=IC(i);Dx(o,r)>0&&(r=o)}),new Dn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Kn.oe=-1;function Qp(n){return n==null}function pu(n){return n===0&&1/n==-1/0}function z3(n){return typeof n=="number"&&Number.isInteger(n)&&!pu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ek(e)),e=W3(n.get(t),e);return ek(e)}function W3(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function ek(n){return n+""}function Tr(n){const e=n.length;if(re(e>=2),e===2)return re(n.charAt(0)===""&&n.charAt(1)===""),Ne.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&te(),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:te()}i=o+2}return new Ne(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(n,e){return[n,nn(e)]}function RC(n,e,t){return[n,nn(e),t]}const H3={},q3=["prefixPath","collectionGroup","readTime","documentId"],K3=["prefixPath","collectionGroup","documentId"],G3=["collectionGroup","readTime","prefixPath","documentId"],Q3=["canonicalId","targetId"],J3=["targetId","path"],Y3=["path","targetId"],X3=["collectionId","parent"],Z3=["indexId","uid"],e6=["uid","sequenceNumber"],t6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],n6=["indexId","uid","orderedDocumentKey"],r6=["userId","collectionPath","documentId"],s6=["userId","collectionPath","largestBatchId"],i6=["userId","collectionGroup","largestBatchId"],PC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],o6=[...PC,"documentOverlays"],DC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],MC=DC,Ox=[...MC,"indexConfiguration","indexState","indexEntries"],a6=Ox,l6=[...Ox,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0 extends CC{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function mt(n,e){const t=de(n);return hi.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function OC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,t){this.comparator=e,this.root=t||Ct.EMPTY}insert(e,t){return new $e(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ct.BLACK,null,null))}remove(e){return new $e(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ct.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new zd(this.root,e,this.comparator,!0)}}class zd{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ct{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Ct.RED,this.left=s??Ct.EMPTY,this.right=i??Ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Ct(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Ct.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw te();const e=this.left.check();if(e!==this.right.check())throw te();return e+(this.isRed()?0:1)}}Ct.EMPTY=null,Ct.RED=!0,Ct.BLACK=!1;Ct.EMPTY=new class{constructor(){this.size=0}get key(){throw te()}get value(){throw te()}get color(){throw te()}get left(){throw te()}get right(){throw te()}copy(e,t,r,s,i){return this}insert(e,t,r){return new Ct(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.comparator=e,this.data=new $e(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rk(this.data.getIterator())}getIteratorFrom(e){return new rk(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Pe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Pe(this.comparator);return t.data=e,t}}class rk{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function oa(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.fields=e,e.sort(We.comparator)}static empty(){return new mn([])}unionWith(e){let t=new Pe(We.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new mn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return nl(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new jC("Invalid base64 string: "+i):i}}(e);return new lt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new lt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lt.EMPTY_BYTE_STRING=new lt("");const c6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vs(n){if(re(!!n),typeof n=="string"){let e=0;const t=c6.exec(n);if(re(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(n.seconds),nanos:Be(n.nanos)}}function Be(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ei(n){return typeof n=="string"?lt.fromBase64String(n):lt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Vx(n){const e=n.mapValue.fields.__previous_value__;return jx(e)?Vx(e):e}function mu(n){const e=vs(n.mapValue.fields.__local_write_time__.timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Do{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Do("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Do&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Sh={nullValue:"NULL_VALUE"};function Mo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jx(n)?4:VC(n)?9007199254740991:Jp(n)?10:11:te()}function Or(n,e){if(n===e)return!0;const t=Mo(n);if(t!==Mo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return mu(n).isEqual(mu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=vs(s.timestampValue),a=vs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Ei(s.bytesValue).isEqual(Ei(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Be(s.geoPointValue.latitude)===Be(i.geoPointValue.latitude)&&Be(s.geoPointValue.longitude)===Be(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Be(s.integerValue)===Be(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Be(s.doubleValue),a=Be(i.doubleValue);return o===a?pu(o)===pu(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return nl(n.arrayValue.values||[],e.arrayValue.values||[],Or);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(nk(o)!==nk(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Or(o[l],a[l])))return!1;return!0}(n,e);default:return te()}}function gu(n,e){return(n.values||[]).find(t=>Or(t,e))!==void 0}function ki(n,e){if(n===e)return 0;const t=Mo(n),r=Mo(e);if(t!==r)return he(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return he(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Be(i.integerValue||i.doubleValue),l=Be(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return sk(n.timestampValue,e.timestampValue);case 4:return sk(mu(n),mu(e));case 5:return he(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Ei(i),l=Ei(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=he(a[c],l[c]);if(u!==0)return u}return he(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=he(Be(i.latitude),Be(o.latitude));return a!==0?a:he(Be(i.longitude),Be(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return ik(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,u;const h=i.fields||{},p=o.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,g=(l=p.value)===null||l===void 0?void 0:l.arrayValue,v=he(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:ik(m,g)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ys.mapValue&&o===Ys.mapValue)return 0;if(i===Ys.mapValue)return 1;if(o===Ys.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const p=he(l[h],u[h]);if(p!==0)return p;const m=ki(a[l[h]],c[u[h]]);if(m!==0)return m}return he(l.length,u.length)}(n.mapValue,e.mapValue);default:throw te()}}function sk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return he(n,e);const t=vs(n),r=vs(e),s=he(t.seconds,r.seconds);return s!==0?s:he(t.nanos,r.nanos)}function ik(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=ki(t[s],r[s]);if(i)return i}return he(t.length,r.length)}function rl(n){return T0(n)}function T0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=vs(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ei(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return G.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=T0(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${T0(t.fields[o])}`;return s+"}"}(n.mapValue):te()}function yu(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function S0(n){return!!n&&"integerValue"in n}function vu(n){return!!n&&"arrayValue"in n}function ok(n){return!!n&&"nullValue"in n}function ak(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ih(n){return!!n&&"mapValue"in n}function Jp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Ac(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Yo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ac(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ac(n.arrayValue.values[t]);return e}return Object.assign({},n)}function VC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const LC={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function d6(n){return"nullValue"in n?Sh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?yu(Do.empty(),G.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Jp(n)?LC:{mapValue:{}}:te()}function h6(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?yu(Do.empty(),G.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?LC:"mapValue"in n?Jp(n)?{mapValue:{}}:Ys:te()}function lk(n,e){const t=ki(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function ck(n,e){const t=ki(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.value=e}static empty(){return new zt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ih(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ac(t)}setAll(e){let t=We.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Ac(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Ih(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Or(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Ih(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Yo(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new zt(Ac(this.value))}}function FC(n){const e=[];return Yo(n.fields,(t,r)=>{const s=new We([t]);if(Ih(r)){const i=FC(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new mn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Xe(e,0,ie.min(),ie.min(),ie.min(),zt.empty(),0)}static newFoundDocument(e,t,r,s){return new Xe(e,1,t,ie.min(),r,s,0)}static newNoDocument(e,t){return new Xe(e,2,t,ie.min(),ie.min(),zt.empty(),0)}static newUnknownDocument(e,t){return new Xe(e,3,t,ie.min(),ie.min(),zt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,t){this.position=e,this.inclusive=t}}function uk(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),t.key):r=ki(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function dk(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Or(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,t="asc"){this.field=e,this.dir=t}}function f6(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{}class _e extends BC{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new p6(e,t,r):t==="array-contains"?new y6(e,r):t==="in"?new qC(e,r):t==="not-in"?new v6(e,r):t==="array-contains-any"?new x6(e,r):new _e(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new m6(e,r):new g6(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ki(t,this.value)):t!==null&&Mo(this.value)===Mo(t)&&this.matchesComparison(ki(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ae extends BC{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ae(e,t)}matches(e){return il(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function il(n){return n.op==="and"}function I0(n){return n.op==="or"}function Lx(n){return UC(n)&&il(n)}function UC(n){for(const e of n.filters)if(e instanceof Ae)return!1;return!0}function N0(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+rl(n.value);if(Lx(n))return n.filters.map(e=>N0(e)).join(",");{const e=n.filters.map(t=>N0(t)).join(",");return`${n.op}(${e})`}}function $C(n,e){return n instanceof _e?function(r,s){return s instanceof _e&&r.op===s.op&&r.field.isEqual(s.field)&&Or(r.value,s.value)}(n,e):n instanceof Ae?function(r,s){return s instanceof Ae&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&$C(o,s.filters[a]),!0):!1}(n,e):void te()}function zC(n,e){const t=n.filters.concat(e);return Ae.create(t,n.op)}function WC(n){return n instanceof _e?function(t){return`${t.field.canonicalString()} ${t.op} ${rl(t.value)}`}(n):n instanceof Ae?function(t){return t.op.toString()+" {"+t.getFilters().map(WC).join(" ,")+"}"}(n):"Filter"}class p6 extends _e{constructor(e,t,r){super(e,t,r),this.key=G.fromName(r.referenceValue)}matches(e){const t=G.comparator(e.key,this.key);return this.matchesComparison(t)}}class m6 extends _e{constructor(e,t){super(e,"in",t),this.keys=HC("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class g6 extends _e{constructor(e,t){super(e,"not-in",t),this.keys=HC("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function HC(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>G.fromName(r.referenceValue))}class y6 extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return vu(t)&&gu(t.arrayValue,this.value)}}class qC extends _e{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&gu(this.value.arrayValue,t)}}class v6 extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(gu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!gu(this.value.arrayValue,t)}}class x6 extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!vu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>gu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function C0(n,e=null,t=[],r=[],s=null,i=null,o=null){return new w6(n,e,t,r,s,i,o)}function Oo(n){const e=de(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>N0(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Qp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>rl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>rl(r)).join(",")),e.ue=t}return e.ue}function Gu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!f6(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!$C(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!dk(n.startAt,e.startAt)&&dk(n.endAt,e.endAt)}function _f(n){return G.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ef(n,e){return n.filters.filter(t=>t instanceof _e&&t.field.isEqual(e))}function hk(n,e,t){let r=Sh,s=!0;for(const i of Ef(n,e)){let o=Sh,a=!0;switch(i.op){case"<":case"<=":o=d6(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Sh}lk({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];lk({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function fk(n,e,t){let r=Ys,s=!0;for(const i of Ef(n,e)){let o=Ys,a=!0;switch(i.op){case">=":case">":o=h6(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ys}ck({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];ck({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function _6(n,e,t,r,s,i,o,a){return new kl(n,e,t,r,s,i,o,a)}function Yp(n){return new kl(n)}function pk(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function KC(n){return n.collectionGroup!==null}function Rc(n){const e=de(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Pe(We.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new xu(i,r))}),t.has(We.keyField().canonicalString())||e.ce.push(new xu(We.keyField(),r))}return e.ce}function Qn(n){const e=de(n);return e.le||(e.le=E6(e,Rc(n))),e.le}function E6(n,e){if(n.limitType==="F")return C0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new xu(s.field,i)});const t=n.endAt?new sl(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new sl(n.startAt.position,n.startAt.inclusive):null;return C0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function A0(n,e){const t=n.filters.concat([e]);return new kl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function kf(n,e,t){return new kl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xp(n,e){return Gu(Qn(n),Qn(e))&&n.limitType===e.limitType}function GC(n){return`${Oo(Qn(n))}|lt:${n.limitType}`}function pa(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>WC(s)).join(", ")}]`),Qp(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>rl(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>rl(s)).join(",")),`Target(${r})`}(Qn(n))}; limitType=${n.limitType})`}function Qu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):G.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Rc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=uk(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Rc(r),s)||r.endAt&&!function(o,a,l){const c=uk(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Rc(r),s))}(n,e)}function k6(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function QC(n){return(e,t)=>{let r=!1;for(const s of Rc(n)){const i=b6(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function b6(n,e,t){const r=n.field.isKeyField()?G.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?ki(l,c):te()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return te()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Yo(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return OC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=new $e(G.comparator);function Nn(){return T6}const JC=new $e(G.comparator);function dc(...n){let e=JC;for(const t of n)e=e.insert(t.key,t);return e}function YC(n){let e=JC;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Sr(){return Pc()}function XC(){return Pc()}function Pc(){return new ji(n=>n.toString(),(n,e)=>n.isEqual(e))}const S6=new $e(G.comparator),I6=new Pe(G.comparator);function ge(...n){let e=I6;for(const t of n)e=e.add(t);return e}const N6=new Pe(he);function C6(){return N6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pu(e)?"-0":e}}function ZC(n){return{integerValue:""+n}}function A6(n,e){return z3(e)?ZC(e):Fx(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(){this._=void 0}}function R6(n,e,t){return n instanceof ol?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&jx(i)&&(i=Vx(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof al?tA(n,e):n instanceof ll?nA(n,e):function(s,i){const o=eA(s,i),a=mk(o)+mk(s.Pe);return S0(o)&&S0(s.Pe)?ZC(a):Fx(s.serializer,a)}(n,e)}function P6(n,e,t){return n instanceof al?tA(n,e):n instanceof ll?nA(n,e):t}function eA(n,e){return n instanceof wu?function(r){return S0(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ol extends Zp{}class al extends Zp{constructor(e){super(),this.elements=e}}function tA(n,e){const t=rA(e);for(const r of n.elements)t.some(s=>Or(s,r))||t.push(r);return{arrayValue:{values:t}}}class ll extends Zp{constructor(e){super(),this.elements=e}}function nA(n,e){let t=rA(e);for(const r of n.elements)t=t.filter(s=>!Or(s,r));return{arrayValue:{values:t}}}class wu extends Zp{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function mk(n){return Be(n.integerValue||n.doubleValue)}function rA(n){return vu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e,t){this.field=e,this.transform=t}}function D6(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof al&&s instanceof al||r instanceof ll&&s instanceof ll?nl(r.elements,s.elements,Or):r instanceof wu&&s instanceof wu?Or(r.Pe,s.Pe):r instanceof ol&&s instanceof ol}(n.transform,e.transform)}class M6{constructor(e,t){this.version=e,this.transformResults=t}}class en{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new en}static exists(e){return new en(void 0,e)}static updateTime(e){return new en(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class em{}function iA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new tm(n.key,en.none()):new bl(n.key,n.data,en.none());{const t=n.data,r=zt.empty();let s=new Pe(We.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Es(n.key,r,new mn(s.toArray()),en.none())}}function O6(n,e,t){n instanceof bl?function(s,i,o){const a=s.value.clone(),l=yk(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Es?function(s,i,o){if(!Nh(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=yk(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(oA(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Dc(n,e,t,r){return n instanceof bl?function(i,o,a,l){if(!Nh(i.precondition,o))return a;const c=i.value.clone(),u=vk(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Es?function(i,o,a,l){if(!Nh(i.precondition,o))return a;const c=vk(i.fieldTransforms,l,o),u=o.data;return u.setAll(oA(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(i,o,a){return Nh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function j6(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=eA(r.transform,s||null);i!=null&&(t===null&&(t=zt.empty()),t.set(r.field,i))}return t||null}function gk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&nl(r,s,(i,o)=>D6(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class bl extends em{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Es extends em{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function oA(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function yk(n,e,t){const r=new Map;re(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,P6(o,a,t[s]))}return r}function vk(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,R6(i,o,e))}return r}class tm extends em{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aA extends em{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&O6(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Dc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Dc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=XC();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=iA(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ge())}isEqual(e){return this.batchId===e.batchId&&nl(this.mutations,e.mutations,(t,r)=>gk(t,r))&&nl(this.baseMutations,e.baseMutations,(t,r)=>gk(t,r))}}class Ux{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){re(e.mutations.length===r.length);let s=function(){return S6}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ux(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rt,ke;function L6(n){switch(n){default:return te();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function lA(n){if(n===void 0)return Xt("GRPC error has no .code"),F.UNKNOWN;switch(n){case rt.OK:return F.OK;case rt.CANCELLED:return F.CANCELLED;case rt.UNKNOWN:return F.UNKNOWN;case rt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case rt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case rt.INTERNAL:return F.INTERNAL;case rt.UNAVAILABLE:return F.UNAVAILABLE;case rt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case rt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case rt.NOT_FOUND:return F.NOT_FOUND;case rt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case rt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case rt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case rt.ABORTED:return F.ABORTED;case rt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case rt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case rt.DATA_LOSS:return F.DATA_LOSS;default:return te()}}(ke=rt||(rt={}))[ke.OK=0]="OK",ke[ke.CANCELLED=1]="CANCELLED",ke[ke.UNKNOWN=2]="UNKNOWN",ke[ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ke[ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ke[ke.NOT_FOUND=5]="NOT_FOUND",ke[ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",ke[ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",ke[ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",ke[ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ke[ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ke[ke.ABORTED=10]="ABORTED",ke[ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",ke[ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",ke[ke.INTERNAL=13]="INTERNAL",ke[ke.UNAVAILABLE=14]="UNAVAILABLE",ke[ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F6(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B6=new po([4294967295,4294967295],0);function xk(n){const e=F6().encode(n),t=new vC;return t.update(e),new Uint8Array(t.digest())}function wk(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new po([t,r],0),new po([s,i],0)]}class zx{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new hc(`Invalid padding: ${t}`);if(r<0)throw new hc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new hc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new hc(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=po.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(po.fromNumber(r)));return s.compare(B6)===1&&(s=new po([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=xk(e),[r,s]=wk(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new zx(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=xk(e),[r,s]=wk(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class hc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ju.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nm(ie.min(),s,new $e(he),Nn(),ge())}}class Ju{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ju(r,t,ge(),ge(),ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class cA{constructor(e,t){this.targetId=e,this.me=t}}class uA{constructor(e,t,r=lt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class _k{constructor(){this.fe=0,this.ge=kk(),this.pe=lt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ge(),t=ge(),r=ge();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:te()}}),new Ju(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=kk()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,re(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class U6{constructor(e){this.Le=e,this.Be=new Map,this.ke=Nn(),this.qe=Ek(),this.Qe=new $e(he)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:te()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(_f(i))if(r===0){const o=new G(i.path);this.Ue(t,o,Xe.newNoDocument(o,ie.min()))}else re(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Ei(r).toUint8Array()}catch(l){if(l instanceof jC)return Po("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new zx(o,s,i)}catch(l){return Po(l instanceof hc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&_f(a.target)){const l=new G(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Xe.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=ge();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new nm(e,t,this.Qe,this.ke,r);return this.ke=Nn(),this.qe=Ek(),this.Qe=new $e(he),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new _k,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Pe(he),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||$("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new _k),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Ek(){return new $e(G.comparator)}function kk(){return new $e(G.comparator)}const $6={asc:"ASCENDING",desc:"DESCENDING"},z6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},W6={and:"AND",or:"OR"};class H6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function R0(n,e){return n.useProto3Json||Qp(e)?e:{value:e}}function cl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function q6(n,e){return cl(n,e.toTimestamp())}function rn(n){return re(!!n),ie.fromTimestamp(function(t){const r=vs(t);return new qe(r.seconds,r.nanos)}(n))}function Wx(n,e){return P0(n,e).canonicalString()}function P0(n,e){const t=function(s){return new Ne(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function hA(n){const e=Ne.fromString(n);return re(_A(e)),e}function bf(n,e){return Wx(n.databaseId,e.path)}function mo(n,e){const t=hA(e);if(t.get(1)!==n.databaseId.projectId)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new K(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new G(mA(t))}function fA(n,e){return Wx(n.databaseId,e)}function pA(n){const e=hA(n);return e.length===4?Ne.emptyPath():mA(e)}function D0(n){return new Ne(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function mA(n){return re(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function bk(n,e,t){return{name:bf(n,e),fields:t.value.mapValue.fields}}function K6(n,e,t){const r=mo(n,e.name),s=rn(e.updateTime),i=e.createTime?rn(e.createTime):ie.min(),o=new zt({mapValue:{fields:e.fields}}),a=Xe.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function G6(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:te()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(re(u===void 0||typeof u=="string"),lt.fromBase64String(u||"")):(re(u===void 0||u instanceof Buffer||u instanceof Uint8Array),lt.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?F.UNKNOWN:lA(c.code);return new K(u,c.message||"")}(o);t=new uA(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=mo(n,r.document.name),i=rn(r.document.updateTime),o=r.document.createTime?rn(r.document.createTime):ie.min(),a=new zt({mapValue:{fields:r.document.fields}}),l=Xe.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Ch(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=mo(n,r.document),i=r.readTime?rn(r.readTime):ie.min(),o=Xe.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Ch([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=mo(n,r.document),i=r.removedTargetIds||[];t=new Ch([],i,s,null)}else{if(!("filter"in e))return te();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new V6(s,i),a=r.targetId;t=new cA(a,o)}}return t}function Tf(n,e){let t;if(e instanceof bl)t={update:bk(n,e.key,e.value)};else if(e instanceof tm)t={delete:bf(n,e.key)};else if(e instanceof Es)t={update:bk(n,e.key,e.data),updateMask:e5(e.fieldMask)};else{if(!(e instanceof aA))return te();t={verify:bf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ol)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof al)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ll)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wu)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw te()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:q6(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te()}(n,e.precondition)),t}function M0(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?en.updateTime(rn(i.updateTime)):i.exists!==void 0?en.exists(i.exists):en.none()}(e.currentDocument):en.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)re(a.setToServerValue==="REQUEST_TIME"),l=new ol;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new al(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new ll(u)}else"increment"in a?l=new wu(o,a.increment):te();const c=We.fromServerFormat(a.fieldPath);return new sA(c,l)}(n,s)):[];if(e.update){e.update.name;const s=mo(n,e.update.name),i=new zt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new mn(c.map(u=>We.fromServerFormat(u)))}(e.updateMask);return new Es(s,i,o,t,r)}return new bl(s,i,t,r)}if(e.delete){const s=mo(n,e.delete);return new tm(s,t)}if(e.verify){const s=mo(n,e.verify);return new aA(s,t)}return te()}function Q6(n,e){return n&&n.length>0?(re(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?rn(s.updateTime):rn(i);return o.isEqual(ie.min())&&(o=rn(i)),new M6(o,s.transformResults||[])}(t,e))):[]}function gA(n,e){return{documents:[fA(n,e.path)]}}function yA(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=fA(n,s);const i=function(c){if(c.length!==0)return wA(Ae.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(p){return{field:ma(p.field),direction:Y6(p.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=R0(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function vA(n){let e=pA(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){re(r===1);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(h){const p=xA(h);return p instanceof Ae&&Lx(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(g){return new xu(ga(g.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Qp(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new sl(m,p)}(t.startAt));let c=null;return t.endAt&&(c=function(h){const p=!h.before,m=h.values||[];return new sl(m,p)}(t.endAt)),_6(e,s,o,i,a,"F",l,c)}function J6(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xA(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ga(t.unaryFilter.field);return _e.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ga(t.unaryFilter.field);return _e.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ga(t.unaryFilter.field);return _e.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ga(t.unaryFilter.field);return _e.create(o,"!=",{nullValue:"NULL_VALUE"});default:return te()}}(n):n.fieldFilter!==void 0?function(t){return _e.create(ga(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return te()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ae.create(t.compositeFilter.filters.map(r=>xA(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te()}}(t.compositeFilter.op))}(n):te()}function Y6(n){return $6[n]}function X6(n){return z6[n]}function Z6(n){return W6[n]}function ma(n){return{fieldPath:n.canonicalString()}}function ga(n){return We.fromServerFormat(n.fieldPath)}function wA(n){return n instanceof _e?function(t){if(t.op==="=="){if(ak(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NAN"}};if(ok(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ak(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NOT_NAN"}};if(ok(t.value))return{unaryFilter:{field:ma(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ma(t.field),op:X6(t.op),value:t.value}}}(n):n instanceof Ae?function(t){const r=t.getFilters().map(s=>wA(s));return r.length===1?r[0]:{compositeFilter:{op:Z6(t.op),filters:r}}}(n):te()}function e5(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function _A(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t,r,s,i=ie.min(),o=ie.min(),a=lt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new rs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new rs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(e){this.ct=e}}function t5(n,e){let t;if(e.document)t=K6(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=G.fromSegments(e.noDocument.path),s=Vo(e.noDocument.readTime);t=Xe.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return te();{const r=G.fromSegments(e.unknownDocument.path),s=Vo(e.unknownDocument.version);t=Xe.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new qe(s[0],s[1]);return ie.fromTimestamp(i)}(e.readTime)),t}function Tk(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Sf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:bf(i,o.key),fields:o.data.value.mapValue.fields,updateTime:cl(i,o.version.toTimestamp()),createTime:cl(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:jo(e.version)};else{if(!e.isUnknownDocument())return te();r.unknownDocument={path:t.path.toArray(),version:jo(e.version)}}return r}function Sf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function jo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Vo(n){const e=new qe(n.seconds,n.nanoseconds);return ie.fromTimestamp(e)}function Zi(n,e){const t=(e.baseMutations||[]).map(i=>M0(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>M0(n.ct,i)),s=qe.fromMillis(e.localWriteTimeMs);return new Bx(e.batchId,s,t,r)}function fc(n){const e=Vo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Vo(n.lastLimboFreeSnapshotVersion):ie.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return re(i.documents.length===1),Qn(Yp(pA(i.documents[0])))}(n.query):function(i){return Qn(vA(i))}(n.query),new rs(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,lt.fromBase64String(n.resumeToken))}function kA(n,e){const t=jo(e.snapshotVersion),r=jo(e.lastLimboFreeSnapshotVersion);let s;s=_f(e.target)?gA(n.ct,e.target):yA(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Oo(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function bA(n){const e=vA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?kf(e,e.limit,"L"):e}function Og(n,e){return new $x(e.largestBatchId,M0(n.ct,e.overlayMutation))}function Sk(n,e){const t=e.path.lastSegment();return[n,nn(e.path.popLast()),t]}function Ik(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:jo(r.readTime),documentKey:nn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{getBundleMetadata(e,t){return Nk(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Vo(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return Nk(e).put(function(s){return{bundleId:s.id,createTime:jo(rn(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return Ck(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:bA(i.bundledQuery),readTime:Vo(i.readTime)}}(r)})}saveNamedQuery(e,t){return Ck(e).put(function(s){return{name:s.name,readTime:jo(rn(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function Nk(n){return mt(n,"bundles")}function Ck(n){return mt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new rm(e,r)}getOverlay(e,t){return Gl(e).get(Sk(this.userId,t)).next(r=>r?Og(this.serializer,r):null)}getOverlays(e,t){const r=Sr();return V.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new $x(t,o);s.push(this.ht(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(nn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Gl(e).j("collectionPathOverlayIndex",a))}),V.waitFor(i)}getOverlaysForCollection(e,t,r){const s=Sr(),i=nn(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Gl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Og(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=Sr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Gl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,u)=>{const h=Og(this.serializer,c);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ht(e,t){return Gl(e).put(function(s,i,o){const[a,l,c]=Sk(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Tf(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Gl(n){return mt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{Pt(e){return mt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?lt.fromUint8Array(r):lt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Be(e.integerValue));else if("doubleValue"in e){const r=Be(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),pu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=vs(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ei(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?VC(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Jp(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):te()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Be(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),G.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}eo.vt=new eo;function s5(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Ak(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=s5(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class i5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=Ak(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=Ak(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class o5{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class a5{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Ql{constructor(){this.jt=new i5,this.Ht=new o5(this.jt),this.Jt=new a5(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new to(this.indexId,this.documentKey,this.arrayValue,r)}}function Ns(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Rk(n.arrayValue,e.arrayValue),t!==0?t:(t=Rk(n.directionalValue,e.directionalValue),t!==0?t:G.comparator(n.documentKey,e.documentKey)))}function Rk(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.Xt=new Pe((t,r)=>We.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(re(e.collectionGroup===this.collectionId),this.nn)return!1;const t=k0(e);if(t!==void 0&&!this.sn(t))return!1;const r=Ji(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Pe(We.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new bh(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new bh(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new bh(r.field,r.dir==="asc"?0:1)));return new wf(wf.UNKNOWN_ID,this.collectionId,t,fu.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(n){var e,t;if(re(n instanceof _e||n instanceof Ae),n instanceof _e){if(n instanceof qC){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>_e.create(n.field,"==",i)))||[];return Ae.create(s,"or")}return n}const r=n.filters.map(s=>TA(s));return Ae.create(r,n.op)}function l5(n){if(n.getFilters().length===0)return[];const e=V0(TA(n));return re(SA(e)),O0(e)||j0(e)?[e]:e.getFilters()}function O0(n){return n instanceof _e}function j0(n){return n instanceof Ae&&Lx(n)}function SA(n){return O0(n)||j0(n)||function(t){if(t instanceof Ae&&I0(t)){for(const r of t.getFilters())if(!O0(r)&&!j0(r))return!1;return!0}return!1}(n)}function V0(n){if(re(n instanceof _e||n instanceof Ae),n instanceof _e)return n;if(n.filters.length===1)return V0(n.filters[0]);const e=n.filters.map(r=>V0(r));let t=Ae.create(e,n.op);return t=If(t),SA(t)?t:(re(t instanceof Ae),re(il(t)),re(t.filters.length>1),t.filters.reduce((r,s)=>Hx(r,s)))}function Hx(n,e){let t;return re(n instanceof _e||n instanceof Ae),re(e instanceof _e||e instanceof Ae),t=n instanceof _e?e instanceof _e?function(s,i){return Ae.create([s,i],"and")}(n,e):Dk(n,e):e instanceof _e?Dk(e,n):function(s,i){if(re(s.filters.length>0&&i.filters.length>0),il(s)&&il(i))return zC(s,i.getFilters());const o=I0(s)?s:i,a=I0(s)?i:s,l=o.filters.map(c=>Hx(c,a));return Ae.create(l,"or")}(n,e),If(t)}function Dk(n,e){if(il(e))return zC(e,n.getFilters());{const t=e.filters.map(r=>Hx(n,r));return Ae.create(t,"or")}}function If(n){if(re(n instanceof _e||n instanceof Ae),n instanceof _e)return n;const e=n.getFilters();if(e.length===1)return If(e[0]);if(UC(n))return n;const t=e.map(s=>If(s)),r=[];return t.forEach(s=>{s instanceof _e?r.push(s):s instanceof Ae&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ae.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(){this.un=new qx}addToCollectionParentIndex(e,t){return this.un.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Dn.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Dn.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class qx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Pe(Ne.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Pe(Ne.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=new Uint8Array(0);class u5{constructor(e,t){this.databaseId=t,this.cn=new qx,this.ln=new ji(r=>Oo(r),(r,s)=>Gu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:nn(s)};return Mk(e).put(i)}return V.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[SC(t),""],!1,!0);return Mk(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,t){const r=Jl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=la(e);return i.next(a=>{o.put(Ik(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Jl(e),s=la(e),i=aa(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Jl(e),r=aa(e),s=la(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return V.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Pk(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=aa(e);let s=!0;const i=new Map;return V.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ge();const a=[];return V.forEach(i,(l,c)=>{$("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(A=>`${A.fieldPath}:${A.kind}`).join(",")}`}(l)} to execute ${Oo(t)}`);const u=function(T,A){const R=k0(A);if(R===void 0)return null;for(const D of Ef(T,R.fieldPath))switch(D.op){case"array-contains-any":return D.value.arrayValue.values||[];case"array-contains":return[D.value]}return null}(c,l),h=function(T,A){const R=new Map;for(const D of Ji(A))for(const k of Ef(T,D.fieldPath))switch(k.op){case"==":case"in":R.set(D.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return R.set(D.fieldPath.canonicalString(),k.value),Array.from(R.values())}return null}(c,l),p=function(T,A){const R=[];let D=!0;for(const k of Ji(A)){const E=k.kind===0?hk(T,k.fieldPath,T.startAt):fk(T,k.fieldPath,T.startAt);R.push(E.value),D&&(D=E.inclusive)}return new sl(R,D)}(c,l),m=function(T,A){const R=[];let D=!0;for(const k of Ji(A)){const E=k.kind===0?fk(T,k.fieldPath,T.endAt):hk(T,k.fieldPath,T.endAt);R.push(E.value),D&&(D=E.inclusive)}return new sl(R,D)}(c,l),g=this.In(l,c,p),v=this.In(l,c,m),x=this.Tn(l,c,h),_=this.En(l.indexId,u,g,p.inclusive,v,m.inclusive,x);return V.forEach(_,b=>r.G(b,t.limit).next(T=>{T.forEach(A=>{const R=G.fromSegments(A.documentKey);o.has(R)||(o=o.add(R),a.push(R))})}))}).next(()=>a)}return V.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=l5(Ae.create(e.filters,"and")).map(r=>C0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),c=l/(t!=null?t.length:1),u=[];for(let h=0;h<l;++h){const p=t?this.dn(t[h/c]):Wd,m=this.An(e,p,r[h%c],s),g=this.Rn(e,p,i[h%c],o),v=a.map(x=>this.An(e,p,x,!0));u.push(...this.createRange(m,g,v))}return u}An(e,t,r,s){const i=new to(e,G.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new to(e,G.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new Pk(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return V.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new Pe(We.comparator),u=!1;for(const h of l.filters)for(const p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?u=!0:c=c.add(p.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new Ql;for(const s of Ji(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);eo.vt.It(i,o)}return r.zt()}dn(e){const t=new Ql;return eo.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Ql;return eo.vt.It(yu(this.databaseId,t),r.Yt(function(i){const o=Ji(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new Ql);let i=0;for(const o of Ji(e)){const a=r[i++];for(const l of s)if(this.fn(t,o.fieldPath)&&vu(a))s=this.gn(s,o,a);else{const c=l.Yt(o.kind);eo.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Ql;l.seed(a.zt()),eo.vt.It(o,l.Yt(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof _e&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Jl(e),s=la(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(u,h){const p=h?new fu(h.sequenceNumber,new Dn(Vo(h.readTime),new G(Tr(h.documentKey)),h.largestBatchId)):fu.empty(),m=u.fields.map(([g,v])=>new bh(We.fromServerFormat(g),v));return new wf(u.indexId,u.collectionGroup,m,p)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:he(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Jl(e),i=la(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>V.forEach(a,l=>i.put(Ik(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return V.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,l=>this.wn(e,s,l).next(c=>{const u=this.Sn(i,l);return c.isEqual(u)?V.resolve():this.bn(e,i,l,c,u)}))))})}Dn(e,t,r,s){return aa(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return aa(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=aa(e);let i=new Pe(Ns);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new to(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new Pe(Ns);const s=this.Vn(t,e);if(s==null)return r;const i=k0(t);if(i!=null){const o=e.data.field(i.fieldPath);if(vu(o))for(const a of o.arrayValue.values||[])r=r.add(new to(t.indexId,e.key,this.dn(a),s))}else r=r.add(new to(t.indexId,e.key,Wd,s));return r}bn(e,t,r,s,i){$("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,c,u,h,p){const m=l.getIterator(),g=c.getIterator();let v=oa(m),x=oa(g);for(;v||x;){let _=!1,b=!1;if(v&&x){const T=u(v,x);T<0?b=!0:T>0&&(_=!0)}else v!=null?b=!0:_=!0;_?(h(x),x=oa(g)):b?(p(v),v=oa(m)):(v=oa(m),x=oa(g))}}(s,i,Ns,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),V.waitFor(o)}yn(e){let t=1;return la(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Ns(o,a)).filter((o,a,l)=>!a||Ns(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Ns(o,e),l=Ns(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Wd,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Wd,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,t){return Ns(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ok)}getMinOffset(e,t){return V.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||te())).next(Ok)}}function Mk(n){return mt(n,"collectionParents")}function aa(n){return mt(n,"indexEntries")}function Jl(n){return mt(n,"indexConfiguration")}function la(n){return mt(n,"indexState")}function Ok(n){re(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Dx(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Dn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class dn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new dn(e,dn.DEFAULT_COLLECTION_PERCENTILE,dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(u,h,p)=>(a++,p.delete()));i.push(l.next(()=>{re(a===1)}));const c=[];for(const u of t.mutations){const h=RC(e,u.key.path,t.batchId);i.push(s.delete(h)),c.push(u.key)}return V.waitFor(i).next(()=>c)}function Nf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw te();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dn.DEFAULT_COLLECTION_PERCENTILE=10,dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dn.DEFAULT=new dn(41943040,dn.DEFAULT_COLLECTION_PERCENTILE,dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dn.DISABLED=new dn(-1,0,0);class sm{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){re(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new sm(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cs(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=ya(e),o=Cs(e);return o.add({}).next(a=>{re(typeof a=="number");const l=new Bx(a,t,r,s),c=function(m,g,v){const x=v.baseMutations.map(b=>Tf(m.ct,b)),_=v.mutations.map(b=>Tf(m.ct,b));return{userId:g,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:x,mutations:_}}(this.serializer,this.userId,l),u=[];let h=new Pe((p,m)=>he(p.canonicalString(),m.canonicalString()));for(const p of s){const m=RC(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),u.push(o.put(c)),u.push(i.put(m,H3))}return h.forEach(p=>{u.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),V.waitFor(u).next(()=>l)})}lookupMutationBatch(e,t){return Cs(e).get(t).next(r=>r?(re(r.userId===this.userId),Zi(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?V.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Cs(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(re(a.batchId>=r),i=Zi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Cs(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cs(e).U("userMutationsIndex",t).next(r=>r.map(s=>Zi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Th(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return ya(e).J({range:s},(o,a,l)=>{const[c,u,h]=o,p=Tr(u);if(c===this.userId&&t.path.isEqual(p))return Cs(e).get(h).next(m=>{if(!m)throw te();re(m.userId===this.userId),i.push(Zi(this.serializer,m))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pe(he);const s=[];return t.forEach(i=>{const o=Th(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=ya(e).J({range:a},(c,u,h)=>{const[p,m,g]=c,v=Tr(m);p===this.userId&&i.path.isEqual(v)?r=r.add(g):h.done()});s.push(l)}),V.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Th(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Pe(he);return ya(e).J({range:o},(l,c,u)=>{const[h,p,m]=l,g=Tr(p);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(a=a.add(m)):u.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(Cs(e).get(i).next(o=>{if(o===null)throw te();re(o.userId===this.userId),r.push(Zi(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return IA(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ya(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=Tr(i[1]);s.push(l)}else a.done()}).next(()=>{re(s.length===0)})})}containsKey(e,t){return NA(e,this.userId,t)}Nn(e){return CA(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function NA(n,e,t){const r=Th(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ya(n).J({range:i,H:!0},(a,l,c)=>{const[u,h,p]=a;u===e&&h===s&&(o=!0),c.done()}).next(()=>o)}function Cs(n){return mt(n,"mutations")}function ya(n){return mt(n,"documentMutations")}function CA(n){return mt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Lo(0)}static kn(){return new Lo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new Lo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ie.fromTimestamp(new qe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ca(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(re(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return ca(e).J((o,a)=>{const l=fc(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,t){return ca(e).J((r,s)=>{const i=fc(s);t(i)})}qn(e){return Vk(e).get("targetGlobalKey").next(t=>(re(t!==null),t))}Qn(e,t){return Vk(e).put("targetGlobalKey",t)}Kn(e,t){return ca(e).put(kA(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Oo(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return ca(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const c=fc(a);Gu(t,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=Hs(e);return t.forEach(o=>{const a=nn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,t,r){const s=Hs(e);return V.forEach(t,i=>{const o=nn(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=Hs(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Hs(e);let i=ge();return s.J({range:r,H:!0},(o,a,l)=>{const c=Tr(o[1]),u=new G(c);i=i.add(u)}).next(()=>i)}containsKey(e,t){const r=nn(t.path),s=IDBKeyRange.bound([r],[SC(r)],!1,!0);let i=0;return Hs(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return ca(e).get(t).next(r=>r?fc(r):null)}}function ca(n){return mt(n,"targets")}function Vk(n){return mt(n,"targetGlobal")}function Hs(n){return mt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk([n,e],[t,r]){const s=he(n,t);return s===0?he(e,r):s}class h5{constructor(e){this.Un=e,this.buffer=new Pe(Lk),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Lk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class f5{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){$("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Oi(t)?$("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Jo(t)}await this.Hn(3e5)})}}class p5{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return V.resolve(Kn.oe);const r=new h5(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?($("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(jk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?($("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jk):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?($("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),fa()<=we.DEBUG&&$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function m5(n,e){return new p5(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e,t){this.db=e,this.garbageCollector=m5(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return Hd(e,r)}removeReference(e,t,r){return Hd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Hd(e,t)}nr(e,t){return function(s,i){let o=!1;return CA(s).Y(a=>NA(s,a,i).next(l=>(l&&(o=!0),V.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ie.min()),Hs(e).delete(function(h){return[0,nn(h.path)]}(o))))});s.push(l)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Hd(e,t)}tr(e,t){const r=Hs(e);let s,i=Kn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==Kn.oe&&t(new G(Tr(s)),i),i=c,s=l):i=Kn.oe}).next(()=>{i!==Kn.oe&&t(new G(Tr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Hd(n,e){return Hs(n).put(function(r,s){return{targetId:0,path:nn(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(){this.changes=new ji(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Hi(e).put(r)}removeEntry(e,t,r){return Hi(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Sf(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Xe.newInvalidDocument(t);return Hi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Yl(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:Xe.newInvalidDocument(t)};return Hi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Yl(t))},(s,i)=>{r={document:this.ir(t,i),size:Nf(i)}}).next(()=>r)}getEntries(e,t){let r=Nn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=Nn(),s=new $e(G.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Nf(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return V.resolve();let s=new Pe(Uk);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Yl(s.first()),Yl(s.last())),o=s.getIterator();let a=o.getNext();return Hi(e).J({index:"documentKeyIndex",range:i},(l,c,u)=>{const h=G.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&Uk(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.$(Yl(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Sf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hi(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let u=Nn();for(const h of c){const p=this.ir(G.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(Qu(t,p)||s.has(p.key))&&(u=u.insert(p.key,p))}return u})}getAllFromCollectionGroup(e,t,r,s){let i=Nn();const o=Bk(t,r),a=Bk(t,Dn.max());return Hi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const h=this.ir(G.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new v5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Fk(e).get("remoteDocumentGlobalKey").next(t=>(re(!!t),t))}rr(e,t){return Fk(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=t5(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ie.min())))return r}return Xe.newInvalidDocument(e)}}function RA(n){return new y5(n)}class v5 extends AA{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new ji(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new Pe((i,o)=>he(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=Tk(this.cr.serializer,o);s=s.add(i.path.popLast());const c=Nf(l);r+=c-a.size,t.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=Tk(this.cr.serializer,o.convertToNoDocument(ie.min()));t.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),V.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Fk(n){return mt(n,"remoteDocumentGlobal")}function Hi(n){return mt(n,"remoteDocumentsV14")}function Yl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Bk(n,e){const t=e.documentKey.path.toArray();return[n,Sf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Uk(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=he(t[i],r[i]),s)return s;return s=he(t.length,r.length),s||(s=he(t[t.length-2],r[r.length-2]),s||he(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Dc(r.mutation,s,mn.empty(),qe.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ge()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ge()){const s=Sr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=dc();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Sr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ge()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Nn();const o=Pc(),a=function(){return Pc()}();return t.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Es)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Dc(u.mutation,c,u.mutation.getFieldMask(),qe.now())):o.set(c.key,mn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var h;return a.set(c,new x5(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Pc();let s=new $e((o,a)=>o-a),i=ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||mn.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||ge()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=XC();u.forEach(p=>{if(!i.has(p)){const m=iA(t.get(p),r.get(p));m!==null&&h.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):KC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):V.resolve(Sr());let a=-1,l=i;return o.next(c=>V.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?V.resolve():this.remoteDocumentCache.getEntry(e,u).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,ge())).next(u=>({batchId:a,changes:YC(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(r=>{let s=dc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=dc();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,l=>{const c=function(h,p){return new kl(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Xe.newInvalidDocument(u)))});let a=dc();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&Dc(u.mutation,c,mn.empty(),qe.now()),Qu(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return V.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:rn(s.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:bA(s.bundledQuery),readTime:rn(s.readTime)}}(t)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(){this.overlays=new $e(G.comparator),this.Ir=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Sr();return V.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),V.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const s=Sr(),i=t.length+1,o=new G(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return V.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new $e((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=Sr(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Sr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return V.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new $x(t,r));let i=this.Ir.get(t);i===void 0&&(i=ge(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(){this.sessionToken=lt.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(){this.Tr=new Pe(gt.Er),this.dr=new Pe(gt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new gt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new gt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new G(new Ne([])),r=new gt(t,e),s=new gt(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new G(new Ne([])),r=new gt(t,e),s=new gt(t,e+1);let i=ge();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new gt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class gt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return G.comparator(e.key,t.key)||he(e.wr,t.wr)}static Ar(e,t){return he(e.wr,t.wr)||G.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Pe(gt.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Bx(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new gt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new gt(t,0),s=new gt(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pe(he);return t.forEach(s=>{const i=new gt(s,0),o=new gt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;G.isDocumentKey(i)||(i=i.child(""));const o=new gt(new G(i),0);let a=new Pe(he);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.wr)),!0)},o),V.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){re(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(t.mutations,s=>{const i=new gt(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new gt(t,0),s=this.br.firstAfterOrEqual(r);return V.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e){this.Mr=e,this.docs=function(){return new $e(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():Xe.newInvalidDocument(t))}getEntries(e,t){let r=Nn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Xe.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Nn();const o=t.path,a=new G(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Dx(IC(u),r)<=0||(s.has(u.key)||Qu(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,t,r,s){te()}Or(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new T5(this)}getSize(e){return V.resolve(this.size)}}class T5 extends AA{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e){this.persistence=e,this.Nr=new ji(t=>Oo(t),Gu),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Kx,this.targetCount=0,this.kr=Lo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),V.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Lo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Kn(t),V.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Kn(0),this.Kr=!1,this.Kr=!0,this.$r=new E5,this.referenceDelegate=e(this),this.Ur=new S5(this),this.indexManager=new c5,this.remoteDocumentCache=function(s){return new b5(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new EA(t),this.Gr=new w5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _5,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new k5(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){$("MemoryPersistence","Starting transaction:",e);const s=new I5(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class I5 extends CC{constructor(e){super(),this.currentSequenceNumber=e}}class im{constructor(e){this.persistence=e,this.Jr=new Kx,this.Yr=null}static Zr(e){return new im(e)}get Xr(){if(this.Yr)return this.Yr;throw te()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{const s=G.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,ie.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return V.or([()=>V.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e){this.serializer=e}O(e,t,r,s){const i=new Gp("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",tk,{unique:!0}),l.createObjectStore("documentMutations")}(e),$k(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),$k(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ie.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(u=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",tk,{unique:!0});const h=c.store("mutations"),p=u.map(m=>h.put(m));return V.waitFor(p)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:r6});c.createIndex("collectionPathOverlayIndex",s6,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",i6,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:q3});c.createIndex("documentKeyIndex",K3),c.createIndex("collectionGroupIndex",G3)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:Z3}).createIndex("sequenceNumberIndex",e6,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:t6}).createIndex("documentKeyIndex",n6,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Nf(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>V.forEach(a,l=>{re(l.userId===i.userId);const c=Zi(this.serializer,l);return IA(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new Ne(o),c=function(h){return[0,nn(h)]}(l);i.push(t.get(c).next(u=>u?V.resolve():(h=>t.put({targetId:0,path:nn(h),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>V.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:X3});const r=t.store("collectionParents"),s=new qx,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:nn(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Ne(o);return i(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],c)=>{const u=Tr(a);return i(u.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=fc(s),o=kA(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),l=function(h){return h.document?new G(Ne.fromString(h.document.name).popFirst(5)):h.noDocument?G.fromSegments(h.noDocument.path):h.unknownDocument?G.fromSegments(h.unknownDocument.path):te()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>V.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=RA(this.serializer),i=new DA(im.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let u=(c=a.get(l.userId))!==null&&c!==void 0?c:ge();Zi(this.serializer,l).keys().forEach(h=>u=u.add(h)),a.set(l.userId,u)}),V.forEach(a,(l,c)=>{const u=new Nt(c),h=rm.lt(this.serializer,u),p=i.getIndexManager(u),m=sm.lt(u,this.serializer,p,i.referenceDelegate);return new PA(s,m,h,p).recalculateAndSaveOverlaysForDocumentKeys(new b0(t,Kn.oe),l).next()})})}}function $k(n){n.createObjectStore("targetDocuments",{keyPath:J3}).createIndex("documentTargetsIndex",Y3,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Q3,{unique:!0}),n.createObjectStore("targetGlobal")}const jg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Gx{constructor(e,t,r,s,i,o,a,l,c,u,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=u,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=p=>Promise.resolve(),!Gx.D())throw new K(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new g5(this,s),this.Ai=t+"main",this.serializer=new EA(l),this.Ri=new hi(this.Ai,this.hi,new N5(this.serializer)),this.$r=new r5,this.Ur=new d5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=RA(this.serializer),this.Gr=new n5,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Xt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new K(F.FAILED_PRECONDITION,jg);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Kn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>qd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Oi(e))return $("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return $("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Xl(e).get("owner").next(t=>V.resolve(this.vi(t)))}Ci(e){return qd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=mt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?V.resolve(!0):Xl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new K(F.FAILED_PRECONDITION,jg);return!1}}return!(!this.networkEnabled||!this.inForeground)||qd(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&$("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new b0(e,Kn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>qd(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return sm.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new u5(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return rm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){$("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===17?l6:l===16?a6:l===15?Ox:l===14?MC:l===13?DC:l===12?o6:l===11?PC:void te()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new b0(a,this.Qr?this.Qr.next():Kn.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Xt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new K(F.FAILED_PRECONDITION,NC);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Xl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new K(F.FAILED_PRECONDITION,jg)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xl(e).put("owner",t)}static D(){return hi.D()}bi(e){const t=Xl(e);return t.get("owner").next(r=>this.vi(r)?($("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Xt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;RN()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return $("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Xt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Xt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Xl(n){return mt(n,"owner")}function qd(n){return mt(n,"clientMetadata")}function C5(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=ge(),s=ge();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Qx(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return RN()?8:AC(ht())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new A5;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(fa()<=we.DEBUG&&$("QueryEngine","SDK will not create cache indexes for query:",pa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(fa()<=we.DEBUG&&$("QueryEngine","Query:",pa(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(fa()<=we.DEBUG&&$("QueryEngine","The SDK decides to create cache indexes for query:",pa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qn(t))):V.resolve())}Yi(e,t){if(pk(t))return V.resolve(null);let r=Qn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=kf(t,null,"F"),r=Qn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ge(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,o,l.readTime)?this.Yi(e,kf(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,s){return pk(t)||s.isEqual(ie.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?V.resolve(null):(fa()<=we.DEBUG&&$("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),pa(t)),this.rs(e,o,t,L3(s,-1)).next(a=>a))})}ts(e,t){let r=new Pe(QC(e));return t.forEach((s,i)=>{Qu(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return fa()<=we.DEBUG&&$("QueryEngine","Using full collection scan to execute query:",pa(t)),this.Ji.getDocumentsMatchingQuery(e,t,Dn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new $e(he),this._s=new ji(i=>Oo(i),Gu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function OA(n,e,t,r){return new R5(n,e,t,r)}async function jA(n,e){const t=de(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=ge();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function P5(n,e){const t=de(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,p=h.keys();let m=V.resolve();return p.forEach(g=>{m=m.next(()=>u.getEntry(l,g)).next(v=>{const x=c.docVersions.get(g);re(x!==null),v.version.compareTo(x)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ge();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function VA(n){const e=de(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function D5(n,e){const t=de(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((u,h)=>{const p=s.get(h);if(!p)return;a.push(t.Ur.removeMatchingKeys(i,u.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(i,u.addedDocuments,h)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(lt.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,r)),s=s.insert(h,m),function(v,x,_){return v.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(p,m,u)&&a.push(t.Ur.updateTargetData(i,m))});let l=Nn(),c=ge();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(M5(i,o,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!r.isEqual(ie.min())){const u=t.Ur.getLastRemoteSnapshotVersion(i).next(h=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.os=s,i))}function M5(n,e,t){let r=ge(),s=ge();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Nn();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ie.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):$("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function O5(n,e){const t=de(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function j5(n,e){const t=de(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new rs(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function L0(n,e,t){const r=de(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Oi(o))throw o;$("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function zk(n,e,t){const r=de(n);let s=ie.min(),i=ge();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=de(l),p=h._s.get(u);return p!==void 0?V.resolve(h.os.get(p)):h.Ur.getTargetData(c,u)}(r,o,Qn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:ie.min(),t?i:ge())).next(a=>(V5(r,k6(e),a),{documents:a,Ts:i})))}function V5(n,e,t){let r=n.us.get(e)||ie.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}class Wk{constructor(){this.activeTargetIds=C6()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class LA{constructor(){this.so=new Wk,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Wk,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){$("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){$("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kd=null;function Vg(){return Kd===null?Kd=function(){return 268435456+Math.round(2147483648*Math.random())}():Kd++,"0x"+Kd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt="WebChannelConnection";class U5 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Vg(),l=this.xo(t,r.toUriEncodedString());$("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,l,c,s).then(u=>($("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw Po("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+El}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=F5[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Vg();return new Promise((o,a)=>{const l=new xC;l.setWithCredentials(!0),l.listenOnce(wC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case kh.NO_ERROR:const u=l.getResponseJson();$(Bt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case kh.TIMEOUT:$(Bt,`RPC '${e}' ${i} timed out`),a(new K(F.DEADLINE_EXCEEDED,"Request time out"));break;case kh.HTTP_ERROR:const h=l.getStatus();if($(Bt,`RPC '${e}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const g=function(x){const _=x.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(_)>=0?_:F.UNKNOWN}(m.status);a(new K(g,m.message))}else a(new K(F.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new K(F.UNAVAILABLE,"Connection failed."));break;default:te()}}finally{$(Bt,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);$(Bt,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=Vg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kC(),a=EC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=i.join("");$(Bt,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);let p=!1,m=!1;const g=new B5({Io:x=>{m?$(Bt,`Not sending because RPC '${e}' stream ${s} is closed:`,x):(p||($(Bt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),p=!0),$(Bt,`RPC '${e}' stream ${s} sending:`,x),h.send(x))},To:()=>h.close()}),v=(x,_,b)=>{x.listen(_,T=>{try{b(T)}catch(A){setTimeout(()=>{throw A},0)}})};return v(h,uc.EventType.OPEN,()=>{m||($(Bt,`RPC '${e}' stream ${s} transport opened.`),g.yo())}),v(h,uc.EventType.CLOSE,()=>{m||(m=!0,$(Bt,`RPC '${e}' stream ${s} transport closed`),g.So())}),v(h,uc.EventType.ERROR,x=>{m||(m=!0,Po(Bt,`RPC '${e}' stream ${s} transport errored:`,x),g.So(new K(F.UNAVAILABLE,"The operation could not be completed")))}),v(h,uc.EventType.MESSAGE,x=>{var _;if(!m){const b=x.data[0];re(!!b);const T=b,A=T.error||((_=T[0])===null||_===void 0?void 0:_.error);if(A){$(Bt,`RPC '${e}' stream ${s} received error:`,A);const R=A.status;let D=function(S){const C=rt[S];if(C!==void 0)return lA(C)}(R),k=A.message;D===void 0&&(D=F.INTERNAL,k="Unknown error status: "+R+" with message "+A.message),m=!0,g.So(new K(D,k)),h.close()}else $(Bt,`RPC '${e}' stream ${s} received:`,b),g.bo(b)}}),v(a,_C.STAT_EVENT,x=>{x.stat===E0.PROXY?$(Bt,`RPC '${e}' stream ${s} detected buffering proxy`):x.stat===E0.NOPROXY&&$(Bt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(){return typeof window<"u"?window:null}function Ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function om(n){return new H6(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&$("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new FA(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Xt(t.toString()),Xt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new K(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return $("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():($("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class z5 extends BA{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=G6(this.serializer,e),r=function(i){if(!("targetChange"in i))return ie.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ie.min():o.readTime?rn(o.readTime):ie.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=D0(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=_f(l)?{documents:gA(i,l)}:{query:yA(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=dA(i,o.resumeToken);const c=R0(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ie.min())>0){a.readTime=cl(i,o.snapshotVersion.toTimestamp());const c=R0(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=J6(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=D0(this.serializer),t.removeTarget=e,this.a_(t)}}class W5 extends BA{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return re(!!e.streamToken),this.lastStreamToken=e.streamToken,re(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=Q6(e.writeResults,e.commitTime),r=rn(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=D0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Tf(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5 extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,P0(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new K(F.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,P0(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new K(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class q5{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Xt(t),this.D_=!1):$("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K5{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Xo(this)&&($("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=de(l);c.L_.add(4),await Yu(c),c.q_.set("Unknown"),c.L_.delete(4),await am(c)}(this))})}),this.q_=new q5(r,s)}}async function am(n){if(Xo(n))for(const e of n.B_)await e(!0)}async function Yu(n){for(const e of n.B_)await e(!1)}function UA(n,e){const t=de(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Zx(t)?Xx(t):Tl(t).r_()&&Yx(t,e))}function Jx(n,e){const t=de(n),r=Tl(t);t.N_.delete(e),r.r_()&&$A(t,e),t.N_.size===0&&(r.r_()?r.o_():Xo(t)&&t.q_.set("Unknown"))}function Yx(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Tl(n).A_(e)}function $A(n,e){n.Q_.xe(e),Tl(n).R_(e)}function Xx(n){n.Q_=new U6({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Tl(n).start(),n.q_.v_()}function Zx(n){return Xo(n)&&!Tl(n).n_()&&n.N_.size>0}function Xo(n){return de(n).L_.size===0}function zA(n){n.Q_=void 0}async function G5(n){n.q_.set("Online")}async function Q5(n){n.N_.forEach((e,t)=>{Yx(n,e)})}async function J5(n,e){zA(n),Zx(n)?(n.q_.M_(e),Xx(n)):n.q_.set("Unknown")}async function Y5(n,e,t){if(n.q_.set("Online"),e instanceof uA&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){$("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Cf(n,r)}else if(e instanceof Ch?n.Q_.Ke(e):e instanceof cA?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ie.min()))try{const r=await VA(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(lt.EMPTY_BYTE_STRING,u.snapshotVersion)),$A(i,l);const h=new rs(u.target,l,c,u.sequenceNumber);Yx(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){$("RemoteStore","Failed to raise snapshot:",r),await Cf(n,r)}}async function Cf(n,e,t){if(!Oi(e))throw e;n.L_.add(1),await Yu(n),n.q_.set("Offline"),t||(t=()=>VA(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{$("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await am(n)})}function WA(n,e){return e().catch(t=>Cf(n,t,e))}async function Xu(n){const e=de(n),t=bi(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;X5(e);)try{const s=await O5(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,Z5(e,s)}catch(s){await Cf(e,s)}HA(e)&&qA(e)}function X5(n){return Xo(n)&&n.O_.length<10}function Z5(n,e){n.O_.push(e);const t=bi(n);t.r_()&&t.V_&&t.m_(e.mutations)}function HA(n){return Xo(n)&&!bi(n).n_()&&n.O_.length>0}function qA(n){bi(n).start()}async function eB(n){bi(n).p_()}async function tB(n){const e=bi(n);for(const t of n.O_)e.m_(t.mutations)}async function nB(n,e,t){const r=n.O_.shift(),s=Ux.from(r,e,t);await WA(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Xu(n)}async function rB(n,e){e&&bi(n).V_&&await async function(r,s){if(function(o){return L6(o)&&o!==F.ABORTED}(s.code)){const i=r.O_.shift();bi(r).s_(),await WA(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Xu(r)}}(n,e),HA(n)&&qA(n)}async function qk(n,e){const t=de(n);t.asyncQueue.verifyOperationInProgress(),$("RemoteStore","RemoteStore received new credentials");const r=Xo(t);t.L_.add(3),await Yu(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await am(t)}async function sB(n,e){const t=de(n);e?(t.L_.delete(2),await am(t)):e||(t.L_.add(2),await Yu(t),t.q_.set("Unknown"))}function Tl(n){return n.K_||(n.K_=function(t,r,s){const i=de(t);return i.w_(),new z5(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:G5.bind(null,n),Ro:Q5.bind(null,n),mo:J5.bind(null,n),d_:Y5.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Zx(n)?Xx(n):n.q_.set("Unknown")):(await n.K_.stop(),zA(n))})),n.K_}function bi(n){return n.U_||(n.U_=function(t,r,s){const i=de(t);return i.w_(),new W5(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:eB.bind(null,n),mo:rB.bind(null,n),f_:tB.bind(null,n),g_:nB.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Xu(n)):(await n.U_.stop(),n.O_.length>0&&($("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Dr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new ew(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tw(n,e){if(Xt("AsyncQueue",`${e}: ${n}`),Oi(n))return new K(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e){this.comparator=e?(t,r)=>e(t,r)||G.comparator(t.key,r.key):(t,r)=>G.comparator(t.key,r.key),this.keyedMap=dc(),this.sortedSet=new $e(this.comparator)}static emptySet(e){return new qa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new qa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(){this.W_=new $e(G.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):te():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class ul{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new ul(e,t,qa.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class oB{constructor(){this.queries=Gk(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=de(t),i=s.queries;s.queries=Gk(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new K(F.ABORTED,"Firestore shutting down"))}}function Gk(){return new ji(n=>GC(n),Xp)}async function KA(n,e){const t=de(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new iB,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=tw(o,`Initialization of query '${pa(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&nw(t)}async function GA(n,e){const t=de(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function aB(n,e){const t=de(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&nw(t)}function lB(n,e,t){const r=de(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function nw(n){n.Y_.forEach(e=>{e.next()})}var F0,Qk;(Qk=F0||(F0={})).ea="default",Qk.Cache="cache";class QA{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ul(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ul.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==F0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e){this.key=e}}class YA{constructor(e){this.key=e}}class cB{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ge(),this.mutatedKeys=ge(),this.Aa=QC(e),this.Ra=new qa(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new Kk,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const p=s.get(u),m=Qu(this.query,h)?h:null,g=!!p&&this.mutatedKeys.has(p.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;p&&m?p.data.isEqual(m.data)?g!==v&&(r.track({type:3,doc:m}),x=!0):this.ga(p,m)||(r.track({type:2,doc:m}),x=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(a=!0)):!p&&m?(r.track({type:0,doc:m}),x=!0):p&&!m&&(r.track({type:1,doc:p}),x=!0,(l||c)&&(a=!0)),x&&(m?(o=o.add(m),i=v?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,h)=>function(m,g){const v=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te()}};return v(m)-v(g)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new ul(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Kk,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ge(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new YA(r))}),this.da.forEach(r=>{e.has(r)||t.push(new JA(r))}),t}ba(e){this.Ta=e.Ts,this.da=ge();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ul.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class uB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class dB{constructor(e){this.key=e,this.va=!1}}class hB{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new ji(a=>GC(a),Xp),this.Ma=new Map,this.xa=new Set,this.Oa=new $e(G.comparator),this.Na=new Map,this.La=new Kx,this.Ba={},this.ka=new Map,this.qa=Lo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function fB(n,e,t=!0){const r=rR(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await XA(r,e,t,!0),s}async function pB(n,e){const t=rR(n);await XA(t,e,!0,!1)}async function XA(n,e,t,r){const s=await j5(n.localStore,Qn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await mB(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&UA(n.remoteStore,s),a}async function mB(n,e,t,r,s){n.Ka=(h,p,m)=>async function(v,x,_,b){let T=x.view.ma(_);T.ns&&(T=await zk(v.localStore,x.query,!1).then(({documents:k})=>x.view.ma(k,T)));const A=b&&b.targetChanges.get(x.targetId),R=b&&b.targetMismatches.get(x.targetId)!=null,D=x.view.applyChanges(T,v.isPrimaryClient,A,R);return Yk(v,x.targetId,D.wa),D.snapshot}(n,h,p,m);const i=await zk(n.localStore,e,!0),o=new cB(e,i.Ts),a=o.ma(i.documents),l=Ju.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);Yk(n,t,c.wa);const u=new uB(e,t,o);return n.Fa.set(e,u),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function gB(n,e,t){const r=de(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Xp(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await L0(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Jx(r.remoteStore,s.targetId),B0(r,s.targetId)}).catch(Jo)):(B0(r,s.targetId),await L0(r.localStore,s.targetId,!0))}async function yB(n,e){const t=de(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Jx(t.remoteStore,r.targetId))}async function vB(n,e,t){const r=sR(n);try{const s=await function(o,a){const l=de(o),c=qe.now(),u=a.reduce((m,g)=>m.add(g.key),ge());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Nn(),v=ge();return l.cs.getEntries(m,u).next(x=>{g=x,g.forEach((_,b)=>{b.isValidDocument()||(v=v.add(_))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,g)).next(x=>{h=x;const _=[];for(const b of a){const T=j6(b,h.get(b.key).overlayedDocument);T!=null&&_.push(new Es(b.key,T,FC(T.value.mapValue),en.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,_,a)}).next(x=>{p=x;const _=x.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(m,x.batchId,_)})}).then(()=>({batchId:p.batchId,changes:YC(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new $e(he)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await Zu(r,s.changes),await Xu(r.remoteStore)}catch(s){const i=tw(s,"Failed to persist write");t.reject(i)}}async function ZA(n,e){const t=de(n);try{const r=await D5(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(re(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?re(o.va):s.removedDocuments.size>0&&(re(o.va),o.va=!1))}),await Zu(t,r,e)}catch(r){await Jo(r)}}function Jk(n,e,t){const r=de(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=de(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const p of h.j_)p.Z_(a)&&(c=!0)}),c&&nw(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xB(n,e,t){const r=de(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new $e(G.comparator);o=o.insert(i,Xe.newNoDocument(i,ie.min()));const a=ge().add(i),l=new nm(ie.min(),new Map,new $e(he),o,a);await ZA(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),rw(r)}else await L0(r.localStore,e,!1).then(()=>B0(r,e,t)).catch(Jo)}async function wB(n,e){const t=de(n),r=e.batch.batchId;try{const s=await P5(t.localStore,e);tR(t,r,null),eR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Zu(t,s)}catch(s){await Jo(s)}}async function _B(n,e,t){const r=de(n);try{const s=await function(o,a){const l=de(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(re(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);tR(r,e,t),eR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Zu(r,s)}catch(s){await Jo(s)}}function eR(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function tR(n,e,t){const r=de(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function B0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||nR(n,r)})}function nR(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Jx(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),rw(n))}function Yk(n,e,t){for(const r of t)r instanceof JA?(n.La.addReference(r.key,e),EB(n,r)):r instanceof YA?($("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||nR(n,r.key)):te()}function EB(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||($("SyncEngine","New document in limbo: "+t),n.xa.add(r),rw(n))}function rw(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new G(Ne.fromString(e)),r=n.qa.next();n.Na.set(r,new dB(t)),n.Oa=n.Oa.insert(t,r),UA(n.remoteStore,new rs(Qn(Yp(t.path)),r,"TargetPurposeLimboResolution",Kn.oe))}}async function Zu(n,e,t){const r=de(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(c=>{var u;if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=Qx.Wi(l.targetId,c);i.push(h)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,c){const u=de(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>V.forEach(c,p=>V.forEach(p.$i,m=>u.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>V.forEach(p.Ui,m=>u.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!Oi(h))throw h;$("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const m=u.os.get(p),g=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(p,v)}}}(r.localStore,i))}async function kB(n,e){const t=de(n);if(!t.currentUser.isEqual(e)){$("SyncEngine","User change. New user:",e.toKey());const r=await jA(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new K(F.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Zu(t,r.hs)}}function bB(n,e){const t=de(n),r=t.Na.get(e);if(r&&r.va)return ge().add(r.key);{let s=ge();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}function rR(n){const e=de(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ZA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xB.bind(null,e),e.Ca.d_=aB.bind(null,e.eventManager),e.Ca.$a=lB.bind(null,e.eventManager),e}function sR(n){const e=de(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_B.bind(null,e),e}class _u{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=om(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return OA(this.persistence,new MA,e.initialUser,this.serializer)}Ga(e){return new DA(im.Zr,this.serializer)}Wa(e){return new LA}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_u.provider={build:()=>new _u};class TB extends _u{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await sR(this.Ja.syncEngine),await Xu(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return OA(this.persistence,new MA,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new f5(r,e.asyncQueue,t)}Ha(e,t){const r=new $3(t,this.persistence);return new U3(e.asyncQueue,r)}Ga(e){const t=C5(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?dn.withCacheSize(this.cacheSizeBytes):dn.DEFAULT;return new Gx(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,$5(),Ah(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new LA}}class Af{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kB.bind(null,this.syncEngine),await sB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new oB}()}createDatastore(e){const t=om(e.databaseInfo.databaseId),r=function(i){return new U5(i)}(e.databaseInfo);return function(i,o,a,l){return new H5(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new K5(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Jk(this.syncEngine,t,0),function(){return Hk.D()?new Hk:new L5}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,u){const h=new hB(s,i,o,a,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=de(s);$("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Yu(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Af.provider={build:()=>new Af};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Xt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Nt.UNAUTHENTICATED,this.clientId=TC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{$("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>($("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=tw(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Lg(n,e){n.asyncQueue.verifyOperationInProgress(),$("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await jA(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Xk(n,e){n.asyncQueue.verifyOperationInProgress();const t=await IB(n);$("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>qk(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>qk(e.remoteStore,s)),n._onlineComponents=e}async function IB(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){$("FirestoreClient","Using user provided OfflineComponentProvider");try{await Lg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Po("Error using user provided cache. Falling back to memory cache: "+t),await Lg(n,new _u)}}else $("FirestoreClient","Using default OfflineComponentProvider"),await Lg(n,new _u);return n._offlineComponents}async function oR(n){return n._onlineComponents||(n._uninitializedComponentsProvider?($("FirestoreClient","Using user provided OnlineComponentProvider"),await Xk(n,n._uninitializedComponentsProvider._online)):($("FirestoreClient","Using default OnlineComponentProvider"),await Xk(n,new Af))),n._onlineComponents}function NB(n){return oR(n).then(e=>e.syncEngine)}async function aR(n){const e=await oR(n),t=e.eventManager;return t.onListen=fB.bind(null,e.syncEngine),t.onUnlisten=gB.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pB.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=yB.bind(null,e.syncEngine),t}function CB(n,e,t={}){const r=new Dr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new iR({next:p=>{u.Za(),o.enqueueAndForget(()=>GA(i,h));const m=p.docs.has(a);!m&&p.fromCache?c.reject(new K(F.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new K(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new QA(Yp(a.path),u,{includeMetadataChanges:!0,_a:!0});return KA(i,h)}(await aR(n),n.asyncQueue,e,t,r)),r.promise}function AB(n,e,t={}){const r=new Dr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new iR({next:p=>{u.Za(),o.enqueueAndForget(()=>GA(i,h)),p.fromCache&&l.source==="server"?c.reject(new K(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new QA(a,u,{includeMetadataChanges:!0,_a:!0});return KA(i,h)}(await aR(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(n,e,t){if(!t)throw new K(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function RB(n,e,t,r){if(e===!0&&r===!0)throw new K(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function eb(n){if(!G.isDocumentKey(n))throw new K(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function tb(n){if(G.isDocumentKey(n))throw new K(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function lm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":te()}function fr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new K(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lm(n);throw new K(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function PB(n,e){if(e<=0)throw new K(F.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new K(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new K(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cm{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nb(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new C3;switch(r.type){case"firstParty":return new D3(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=Zk.get(t);r&&($("ComponentProvider","Removing Datastore"),Zk.delete(t),r.terminate())}(this),Promise.resolve()}}function DB(n,e,t,r={}){var s;const i=(n=fr(n,cm))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Po("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Nt.MOCK_USER;else{a=AN(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new K(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Nt(c)}n._authCredentials=new A3(new bC(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vi(this.firestore,e,this._query)}}class sn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new sn(this.firestore,e,this._key)}}class fi extends Vi{constructor(e,t,r){super(e,t,Yp(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new sn(this.firestore,null,new G(e))}withConverter(e){return new fi(this.firestore,e,this._path)}}function $n(n,e,...t){if(n=ft(n),cR("collection","path",e),n instanceof cm){const r=Ne.fromString(e,...t);return tb(r),new fi(n,null,r)}{if(!(n instanceof sn||n instanceof fi))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ne.fromString(e,...t));return tb(r),new fi(n.firestore,null,r)}}function et(n,e,...t){if(n=ft(n),arguments.length===1&&(e=TC.newId()),cR("doc","path",e),n instanceof cm){const r=Ne.fromString(e,...t);return eb(r),new sn(n,null,new G(r))}{if(!(n instanceof sn||n instanceof fi))throw new K(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ne.fromString(e,...t));return eb(r),new sn(n.firestore,n instanceof fi?n.converter:null,new G(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new FA(this,"async_queue_retry"),this.Vu=()=>{const r=Ah();r&&$("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Ah();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Ah();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Dr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Oi(e))throw e;$("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Xt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=ew.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&te()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Zo extends cm{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new rb,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rb(e),this._firestoreClient=void 0,await e}}}function MB(n,e){const t=typeof n=="object"?n:Ex(),r=typeof n=="string"?n:"(default)",s=Wp(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=IN("firestore");i&&DB(s,...i)}return s}function sw(n){if(n._terminated)throw new K(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||uR(n),n._firestoreClient}function uR(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,u){return new u6(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,lR(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new SB(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function OB(n,e){Po("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return jB(n,Af.provider,{build:r=>new TB(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function jB(n,e,t){if((n=fr(n,Zo))._firestoreClient||n._terminated)throw new K(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new K(F.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},uR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dl(lt.fromBase64String(e))}catch(t){throw new K(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new dl(lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new K(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new We(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VB=/^__.*__$/;class LB{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Es(e,this.data,this.fieldMask,t,this.fieldTransforms):new bl(e,this.data,t,this.fieldTransforms)}}class dR{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Es(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te()}}class aw{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new aw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Rf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(hR(this.Cu)&&VB.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class FB{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||om(e)}Qu(e,t,r,s=!1){return new aw({Cu:e,methodName:t,qu:r,path:We.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lw(n){const e=n._freezeSettings(),t=om(n._databaseId);return new FB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function BB(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);uw("Data must be an object, but it was:",o,r);const a=fR(r,o);let l,c;if(i.merge)l=new mn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const p=U0(e,h,t);if(!o.contains(p))throw new K(F.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);mR(u,p)||u.push(p)}l=new mn(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new LB(new zt(a),l,c)}class hm extends dm{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hm}}class cw extends dm{_toFieldTransform(e){return new sA(e.path,new ol)}isEqual(e){return e instanceof cw}}function UB(n,e,t,r){const s=n.Qu(1,e,t);uw("Data must be an object, but it was:",s,r);const i=[],o=zt.empty();Yo(r,(l,c)=>{const u=dw(e,l,t);c=ft(c);const h=s.Nu(u);if(c instanceof hm)i.push(u);else{const p=ed(c,h);p!=null&&(i.push(u),o.set(u,p))}});const a=new mn(i);return new dR(o,a,s.fieldTransforms)}function $B(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[U0(e,r,t)],l=[s];if(i.length%2!=0)throw new K(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(U0(e,i[p])),l.push(i[p+1]);const c=[],u=zt.empty();for(let p=a.length-1;p>=0;--p)if(!mR(c,a[p])){const m=a[p];let g=l[p];g=ft(g);const v=o.Nu(m);if(g instanceof hm)c.push(m);else{const x=ed(g,v);x!=null&&(c.push(m),u.set(m,x))}}const h=new mn(c);return new dR(u,h,o.fieldTransforms)}function zB(n,e,t,r=!1){return ed(t,n.Qu(r?4:3,e))}function ed(n,e){if(pR(n=ft(n)))return uw("Unsupported field value:",e,n),fR(n,e);if(n instanceof dm)return function(r,s){if(!hR(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=ed(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=ft(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return A6(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=qe.fromDate(r);return{timestampValue:cl(s.serializer,i)}}if(r instanceof qe){const i=new qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:cl(s.serializer,i)}}if(r instanceof iw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dl)return{bytesValue:dA(s.serializer,r._byteString)};if(r instanceof sn){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Wx(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof ow)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Fx(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${lm(r)}`)}(n,e)}function fR(n,e){const t={};return OC(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yo(n,(r,s)=>{const i=ed(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function pR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qe||n instanceof iw||n instanceof dl||n instanceof sn||n instanceof dm||n instanceof ow)}function uw(n,e,t){if(!pR(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=lm(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function U0(n,e,t){if((e=ft(e))instanceof um)return e._internalPath;if(typeof e=="string")return dw(n,e);throw Rf("Field path arguments must be of type string or ",n,!1,void 0,t)}const WB=new RegExp("[~\\*/\\[\\]]");function dw(n,e,t){if(e.search(WB)>=0)throw Rf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new um(...e.split("."))._internalPath}catch{throw Rf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Rf(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new K(F.INVALID_ARGUMENT,a+n+l)}function mR(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new sn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new HB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class HB extends gR{data(){return super.data()}}function fm(n,e){return typeof e=="string"?dw(n,e):e instanceof um?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new K(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hw{}class fw extends hw{}function zn(n,e,...t){let r=[];e instanceof hw&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof pw).length,a=i.filter(l=>l instanceof pm).length;if(o>1||o>0&&a>0)throw new K(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class pm extends fw{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new pm(e,t,r)}_apply(e){const t=this._parse(e);return yR(e._query,t),new Vi(e.firestore,e.converter,A0(e._query,t))}_parse(e){const t=lw(e.firestore);return function(i,o,a,l,c,u,h){let p;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new K(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){ob(h,u);const m=[];for(const g of h)m.push(ib(l,i,g));p={arrayValue:{values:m}}}else p=ib(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||ob(h,u),p=zB(a,o,h,u==="in"||u==="not-in");return _e.create(c,u,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vt(n,e,t){const r=e,s=fm("where",n);return pm._create(s,r,t)}class pw extends hw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pw(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ae.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)yR(o,l),o=A0(o,l)}(e._query,t),new Vi(e.firestore,e.converter,A0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class mw extends fw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new mw(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new K(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new K(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xu(i,o)}(e._query,this._field,this._direction);return new Vi(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new kl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function ss(n,e="asc"){const t=e,r=fm("orderBy",n);return mw._create(r,t)}class gw extends fw{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new gw(e,t,r)}_apply(e){return new Vi(e.firestore,e.converter,kf(e._query,this._limit,this._limitType))}}function sb(n){return PB("limit",n),gw._create("limit",n,"F")}function ib(n,e,t){if(typeof(t=ft(t))=="string"){if(t==="")throw new K(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!KC(e)&&t.indexOf("/")!==-1)throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ne.fromString(t));if(!G.isDocumentKey(r))throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yu(n,new G(r))}if(t instanceof sn)return yu(n,t._key);throw new K(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lm(t)}.`)}function ob(n,e){if(!Array.isArray(n)||n.length===0)throw new K(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yR(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class KB{convertValue(e,t="none"){switch(Mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw te()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Yo(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Be(o.doubleValue));return new ow(i)}convertGeoPoint(e){return new iw(Be(e.latitude),Be(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Vx(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(mu(e));default:return null}}convertTimestamp(e){const t=vs(e);return new qe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ne.fromString(e);re(_A(r));const s=new Do(r.get(1),r.get(3)),i=new G(r.popFirst(5));return s.isEqual(t)||Xt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GB(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vR extends gR{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(fm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Rh extends vR{data(e={}){return super.data(e)}}class QB{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new pc(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Rh(this._firestore,this._userDataWriter,r.key,r,new pc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new K(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Rh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new pc(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Rh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new pc(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:JB(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function JB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(n){n=fr(n,sn);const e=fr(n.firestore,Zo);return CB(sw(e),n._key).then(t=>YB(e,n,t))}class xR extends KB{constructor(e){super(),this.firestore=e}convertBytes(e){return new dl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new sn(this.firestore,null,t)}}function Wn(n){n=fr(n,Vi);const e=fr(n.firestore,Zo),t=sw(e),r=new xR(e);return qB(n._query),AB(t,n._query).then(s=>new QB(e,r,n,s))}function Mr(n,e,t){n=fr(n,sn);const r=fr(n.firestore,Zo),s=GB(n.converter,e,t);return vw(r,[BB(lw(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,en.none())])}function wR(n,e,t,...r){n=fr(n,sn);const s=fr(n.firestore,Zo),i=lw(s);let o;return o=typeof(e=ft(e))=="string"||e instanceof um?$B(i,"updateDoc",n._key,e,t,r):UB(i,"updateDoc",n._key,e),vw(s,[o.toMutation(n._key,en.exists(!0))])}function hl(n){return vw(fr(n.firestore,Zo),[new tm(n._key,en.none())])}function vw(n,e){return function(r,s){const i=new Dr;return r.asyncQueue.enqueueAndForget(async()=>vB(await NB(r),s,i)),i.promise}(sw(n),e)}function YB(n,e,t){const r=t.docs.get(e._key),s=new xR(n);return new vR(n,s,e._key,r,new pc(t.hasPendingWrites,t.fromCache),e.converter)}function ur(){return new cw("serverTimestamp")}(function(e,t=!0){(function(s){El=s})(Qo),No(new _i("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Zo(new R3(r.getProvider("auth-internal")),new O3(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new K(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Do(c.options.projectId,u)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Ar(XE,"4.7.3",e),Ar(XE,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="firebasestorage.googleapis.com",XB="storageBucket",ZB=2*60*1e3,eU=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br extends Fr{constructor(e,t,r=0){super(Fg(e),`Firebase Storage: ${t} (${Fg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Br.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Fg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jr;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jr||(jr={}));function Fg(n){return"storage/"+n}function tU(){const n="An unknown error occurred, please check the error payload for server response.";return new Br(jr.UNKNOWN,n)}function nU(){return new Br(jr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rU(){return new Br(jr.CANCELED,"User canceled the upload/download.")}function sU(n){return new Br(jr.INVALID_URL,"Invalid URL '"+n+"'.")}function iU(n){return new Br(jr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function ab(n){return new Br(jr.INVALID_ARGUMENT,n)}function ER(){return new Br(jr.APP_DELETED,"The Firebase app was deleted.")}function oU(n){return new Br(jr.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=ar.makeFromUrl(e,t)}catch{return new ar(e,"")}if(r.path==="")return r;throw iU(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(A){A.path_=decodeURIComponent(A.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${s}/o${p}`,"i"),g={bucket:1,path:3},v=t===_R?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",_=new RegExp(`^https?://${v}/${s}/${x}`,"i"),T=[{regex:a,indices:l,postModify:i},{regex:m,indices:g,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let A=0;A<T.length;A++){const R=T[A],D=R.regex.exec(e);if(D){const k=D[R.indices.bucket];let E=D[R.indices.path];E||(E=""),r=new ar(k,E),R.postModify(r);break}}if(r==null)throw sU(e);return r}}class aU{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lU(n,e,t){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...x){c||(c=!0,e.apply(null,x))}function h(x){s=setTimeout(()=>{s=null,n(m,l())},x)}function p(){i&&clearTimeout(i)}function m(x,..._){if(c){p();return}if(x){p(),u.call(null,x,..._);return}if(l()||o){p(),u.call(null,x,..._);return}r<64&&(r*=2);let T;a===1?(a=2,T=0):T=(r+Math.random())*1e3,h(T)}let g=!1;function v(x){g||(g=!0,p(),!c&&(s!==null?(x||(a=2),clearTimeout(s),h(0)):x||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function cU(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(n){return n!==void 0}function lb(n,e,t,r){if(r<e)throw ab(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw ab(`Invalid value for '${n}'. Expected ${t} or less.`)}function dU(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var Pf;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Pf||(Pf={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hU(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fU{constructor(e,t,r,s,i,o,a,l,c,u,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,g)=>{this.resolve_=m,this.reject_=g,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Gd(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Pf.NO_ERROR,l=i.getStatus();if(!a||hU(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Pf.ABORT;r(!1,new Gd(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Gd(c,i))})},t=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());uU(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=tU();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?ER():rU();o(l)}else{const l=nU();o(l)}};this.canceled_?t(!1,new Gd(!1,null,!0)):this.backoffId_=lU(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&cU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gd{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function pU(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function mU(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function gU(n,e){e&&(n["X-Firebase-GMPID"]=e)}function yU(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function vU(n,e,t,r,s,i,o=!0){const a=dU(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return gU(c,e),pU(c,t),mU(c,i),yU(c,r),new fU(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xU(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function wU(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,t){this._service=e,t instanceof ar?this._location=t:this._location=ar.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Df(e,t)}get root(){const e=new ar(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wU(this._location.path)}get storage(){return this._service}get parent(){const e=xU(this._location.path);if(e===null)return null;const t=new ar(this._location.bucket,e);return new Df(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw oU(e)}}function cb(n,e){const t=e==null?void 0:e[XB];return t==null?null:ar.makeFromBucketSpec(t,n)}function _U(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:AN(s,n.app.options.projectId))}class EU{constructor(e,t,r,s,i){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=_R,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ZB,this._maxUploadRetryTime=eU,this._requests=new Set,s!=null?this._bucket=ar.makeFromBucketSpec(s,this._host):this._bucket=cb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ar.makeFromBucketSpec(this._url,e):this._bucket=cb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){lb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){lb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Df(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new aU(ER());{const o=vU(e,this._appId,r,s,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const ub="@firebase/storage",db="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="storage";function kU(n=Ex(),e){n=ft(n);const r=Wp(n,kR).getImmediate({identifier:e}),s=IN("storage");return s&&bU(r,...s),r}function bU(n,e,t,r={}){_U(n,e,t,r)}function TU(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new EU(t,r,s,e,Qo)}function SU(){No(new _i(kR,TU,"PUBLIC").setMultipleInstances(!0)),Ar(ub,db,""),Ar(ub,db,"esm2017")}SU();const IU={apiKey:"AIzaSyA27iKEalAwT1wgZFkfYNzqTpyIh7DfL10",authDomain:"personal-development-d15b5.firebaseapp.com",projectId:"personal-development-d15b5",storageBucket:"personal-development-d15b5.firebasestorage.app",messagingSenderId:"926131095327",appId:"1:926131095327:web:f11083575d57529d3a522a"},xw=ON(IU),Zl=T3(xw),be=MB(xw);kU(xw);OB(be).catch(n=>{n.code==="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):n.code==="unimplemented"&&console.warn("The current browser does not support offline persistence.")});const NU=["pmdunn78@gmail.com"],bR=O.createContext({}),_n=()=>{const n=O.useContext(bR);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},CU=({children:n})=>{const[e,t]=O.useState(null),[r,s]=O.useState(!0),[i,o]=O.useState(null),a=async(g,v)=>{if(!NU.includes(g.toLowerCase()))throw new Error("This email is not authorized to create an account.");try{const{user:x}=await cF(Zl,g,v);await Mr(et(be,"users",x.uid),{email:x.email,createdAt:ur(),settings:{theme:"light",emailNotifications:!0,journalReminders:!1}});const _=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"];for(const b of _)await Mr(et(be,"lifeSubsections",`${x.uid}_${b}`),{name:b,userId:x.uid,winState:{description:"",targetValue:0,currentValue:0,unit:"",metrics:[]},createdAt:ur()});return oe.success("Account created successfully!"),x}catch(x){throw console.error("Signup error:",x),oe.error(x.message),x}},l=async(g,v)=>{try{const{user:x}=await uF(Zl,g,v);return oe.success("Welcome back!"),x}catch(x){throw console.error("Login error:",x),oe.error("Invalid email or password"),x}},c=async()=>{try{await pF(Zl),oe.success("Logged out successfully")}catch(g){throw console.error("Logout error:",g),oe.error("Error logging out"),g}},u=async g=>{try{await lF(Zl,g),oe.success("Password reset email sent!")}catch(v){throw console.error("Password reset error:",v),oe.error("Error sending password reset email"),v}},h=async g=>{try{const v=await yw(et(be,"users",g));v.exists()&&o({id:v.id,...v.data()})}catch(v){console.error("Error fetching user profile:",v)}},p=async g=>{if(e)try{const v={settings:{theme:g.theme,emailNotifications:g.emailNotifications,journalReminders:g.journalReminders,goalDeadlineAlerts:g.goalDeadlineAlerts,weeklyReports:g.weeklyReports}};g.displayName!==void 0&&(v.displayName=g.displayName),await Mr(et(be,"users",e.uid),v,{merge:!0}),o(x=>({...x,...v})),oe.success("Settings updated")}catch(v){throw console.error("Error updating settings:",v),oe.error("Failed to update settings"),v}};O.useEffect(()=>fF(Zl,async v=>{t(v),v?await h(v.uid):o(null),s(!1)}),[]);const m={currentUser:e,userProfile:i,signup:a,login:l,logout:c,resetPassword:u,updateUserSettings:p,loading:r};return f.jsx(bR.Provider,{value:m,children:n})},TR=O.createContext({}),SR=()=>{const n=O.useContext(TR);if(!n)throw new Error("useTheme must be used within a ThemeProvider");return n},AU=({children:n})=>{const[e,t]=O.useState(()=>{const a=localStorage.getItem("theme");return a||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});O.useEffect(()=>{const a=window.document.documentElement;a.classList.remove("light","dark"),a.classList.add(e),localStorage.setItem("theme",e)},[e]);const o={theme:e,toggleTheme:()=>{t(a=>a==="light"?"dark":"light")},setLightTheme:()=>t("light"),setDarkTheme:()=>t("dark"),isDark:e==="dark",isLight:e==="light"};return f.jsx(TR.Provider,{value:o,children:n})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RU=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),PU=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),hb=n=>{const e=PU(n);return e.charAt(0).toUpperCase()+e.slice(1)},IR=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),DU=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var MU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OU=O.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>O.createElement("svg",{ref:l,...MU,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:IR("lucide",s),...!i&&!DU(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>O.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=(n,e)=>{const t=O.forwardRef(({className:r,...s},i)=>O.createElement(OU,{ref:i,iconNode:e,className:IR(`lucide-${RU(hb(n))}`,`lucide-${n}`,r),...s}));return t.displayName=hb(n),t};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jU=[["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 18h18",key:"1h113x"}],["path",{d:"M3 6h18",key:"d0wm0j"}]],VU=ne("align-justify",jU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],FU=ne("award",LU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BU=[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]],UU=ne("bed",BU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $U=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],zU=ne("bell",$U);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WU=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],HU=ne("bold",WU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qU=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],go=ne("book-open",qU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Fo=ne("calendar",KU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],mm=ne("chevron-down",GU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QU=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],$0=ne("chevron-right",QU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],NR=ne("chevron-up",JU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],XU=ne("circle-check",YU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],e$=ne("circle",ZU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],CR=ne("clock",t$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n$=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],r$=ne("coffee",n$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],i$=ne("dollar-sign",s$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o$=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],AR=ne("download",o$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],l$=ne("eye-off",a$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],u$=ne("eye",c$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],h$=ne("flag",d$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],p$=ne("grid-3x3",f$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m$=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],g$=ne("heading-1",m$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y$=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],v$=ne("heading-2",y$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x$=[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]],w$=ne("highlighter",x$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _$=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],E$=ne("italic",_$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k$=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Bg=ne("link-2",k$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b$=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],T$=ne("list-ordered",b$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S$=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],RR=ne("list",S$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I$=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],z0=ne("loader-circle",I$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N$=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],C$=ne("lock",N$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A$=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],W0=ne("log-out",A$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R$=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],H0=ne("mail",R$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P$=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],D$=ne("menu",P$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M$=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],ww=ne("moon",M$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O$=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],gm=ne("pen",O$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j$=[["path",{d:"M13 4v16",key:"8vvj80"}],["path",{d:"M17 4v16",key:"7dpous"}],["path",{d:"M19 4H9.5a4.5 4.5 0 0 0 0 9H13",key:"sh4n9v"}]],V$=ne("pilcrow",j$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L$=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],pr=ne("plus",L$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F$=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],B$=ne("quote",F$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U$=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],$$=ne("redo",U$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z$=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],yo=ne("save",z$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W$=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],H$=ne("search",W$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q$=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],K$=ne("settings",q$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G$=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Q$=ne("shield",G$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J$=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],PR=ne("square-check-big",J$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],X$=ne("square",Y$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z$=[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]],ez=ne("strikethrough",Z$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Mf=ne("sun",tz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],rz=ne("sunrise",nz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],iz=ne("sunset",sz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],q0=ne("tag",oz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ti=ne("target",az);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Bo=ne("trash-2",lz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],uz=ne("trending-down",cz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],_w=ne("trending-up",dz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],fz=ne("triangle-alert",hz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],mz=ne("trophy",pz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],yz=ne("type",gz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],xz=ne("underline",vz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],_z=ne("undo",wz);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],DR=ne("user",Ez);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Jn=ne("x",kz),bz=()=>{const[n,e]=O.useState(""),[t,r]=O.useState(""),[s,i]=O.useState(!1),[o,a]=O.useState(!1),[l,c]=O.useState(!1),[u,h]=O.useState(!1),{login:p,signup:m,resetPassword:g}=_n(),v=async _=>{if(_.preventDefault(),!n||!t){oe.error("Please fill in all fields");return}c(!0);try{o?await m(n,t):await p(n,t)}catch(b){console.error("Auth error:",b)}finally{c(!1)}},x=async _=>{if(_.preventDefault(),!n){oe.error("Please enter your email address");return}c(!0);try{await g(n),h(!1)}catch(b){console.error("Reset password error:",b)}finally{c(!1)}};return u?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-4",children:f.jsx("div",{className:"max-w-md w-full",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Reset Password"}),f.jsxs("form",{onSubmit:x,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"email",value:n,onChange:_=>e(_.target.value),className:"input pl-10",placeholder:"you@example.com",disabled:l}),f.jsx(H0,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),f.jsx("button",{type:"submit",disabled:l,className:"w-full btn-primary flex items-center justify-center",children:l?f.jsx(z0,{className:"h-5 w-5 animate-spin"}):"Send Reset Email"}),f.jsx("button",{type:"button",onClick:()=>h(!1),className:"w-full text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:"Back to login"})]})]})})}):f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-4",children:f.jsx("div",{className:"max-w-md w-full",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:o?"Create Account":"Welcome Back"}),f.jsxs("form",{onSubmit:v,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"email",value:n,onChange:_=>e(_.target.value),className:"input pl-10",placeholder:"you@example.com",disabled:l}),f.jsx(H0,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:s?"text":"password",value:t,onChange:_=>r(_.target.value),className:"input pl-10 pr-10",placeholder:"",disabled:l}),f.jsx(C$,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),f.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-2.5",children:s?f.jsx(l$,{className:"h-5 w-5 text-gray-400"}):f.jsx(u$,{className:"h-5 w-5 text-gray-400"})})]})]}),!o&&f.jsx("div",{className:"text-right",children:f.jsx("button",{type:"button",onClick:()=>h(!0),className:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:"Forgot password?"})}),f.jsx("button",{type:"submit",disabled:l,className:"w-full btn-primary flex items-center justify-center",children:l?f.jsx(z0,{className:"h-5 w-5 animate-spin"}):o?"Sign Up":"Sign In"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("button",{onClick:()=>a(!o),className:"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:o?"Already have an account? Sign in":"Don't have an account? Sign up"})}),o&&f.jsx("div",{className:"mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:f.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200",children:"Note: Only whitelisted emails can create accounts. Contact the administrator if you need access."})})]})})})},Tz=({children:n})=>{const{currentUser:e,loading:t}=_n();return t?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:f.jsxs("div",{className:"text-center",children:[f.jsx(z0,{className:"h-12 w-12 animate-spin text-primary-600 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})}):e?f.jsx(f.Fragment,{children:n}):f.jsx(bz,{})},Sz=()=>{var m;const{currentUser:n,userProfile:e,logout:t}=_n(),{theme:r,toggleTheme:s}=SR(),[i,o]=O.useState(!1),[a,l]=O.useState(!1),c=Bu(),u=[{name:"Dashboard",href:"/"},{name:"Journal",href:"/journal"},{name:"Goals",href:"/goals"},{name:"My Week",href:"/my-week"},{name:"Expenses",href:"/expenses"},{name:"Stats",href:"/stats"}],h=[{name:"Finances",href:"/subsection/finances"},{name:"Fitness",href:"/subsection/fitness"},{name:"Jiu Jitsu",href:"/subsection/jiu-jitsu"},{name:"Women",href:"/subsection/women"},{name:"Attractiveness",href:"/subsection/attractiveness"},{name:"Nutrition",href:"/subsection/nutrition"},{name:"Philosophy",href:"/subsection/philosophy"},{name:"Languages",href:"/subsection/languages"}],p=g=>c.pathname===g;return f.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50",children:f.jsxs("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"flex justify-between h-16",children:[f.jsxs("div",{className:"flex",children:[f.jsx("div",{className:"flex-shrink-0 flex items-center",children:f.jsxs(Tn,{to:"/",className:"flex items-center space-x-2",children:[f.jsx(Ti,{className:"h-8 w-8 text-primary-600"}),f.jsx("span",{className:"font-bold text-xl text-gray-900 dark:text-white hidden sm:block",children:"PDT"})]})}),f.jsxs("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:[u.map(g=>f.jsx(Tn,{to:g.href,className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors ${p(g.href)?"text-primary-600 bg-primary-50 dark:text-primary-400 dark:bg-primary-900/20":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:g.name},g.name)),f.jsxs("div",{className:"relative group inline-flex",children:[f.jsxs("button",{className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:["Life Areas",f.jsx(mm,{className:"ml-1 h-4 w-4"})]}),f.jsx("div",{className:"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200",children:f.jsx("div",{className:"py-1",children:h.map(g=>f.jsx(Tn,{to:g.href,className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:g.name},g.name))})})]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("button",{onClick:s,className:"p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Toggle theme",children:r==="light"?f.jsx(ww,{className:"h-5 w-5"}):f.jsx(Mf,{className:"h-5 w-5"})}),f.jsxs("div",{className:"hidden md:block relative",children:[f.jsxs("button",{onClick:()=>l(!a),className:"flex items-center space-x-2 p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[f.jsx(DR,{className:"h-5 w-5"}),f.jsx("span",{className:"text-sm",children:(e==null?void 0:e.displayName)||((m=n==null?void 0:n.email)==null?void 0:m.split("@")[0])})]}),a&&f.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5",children:f.jsxs("div",{className:"py-1",children:[f.jsxs(Tn,{to:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>l(!1),children:[f.jsx(K$,{className:"h-4 w-4 mr-2"}),"Settings"]}),f.jsxs("button",{onClick:()=>{t(),l(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[f.jsx(W0,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})})]}),f.jsx("button",{onClick:()=>o(!i),className:"md:hidden p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:i?f.jsx(Jn,{className:"h-6 w-6"}):f.jsx(D$,{className:"h-6 w-6"})})]})]}),i&&f.jsx("div",{className:"md:hidden py-4 border-t border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"space-y-1",children:[u.map(g=>f.jsx(Tn,{to:g.href,className:`block px-3 py-2 rounded-md text-base font-medium ${p(g.href)?"text-primary-600 bg-primary-50 dark:text-primary-400 dark:bg-primary-900/20":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:()=>o(!1),children:g.name},g.name)),f.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-2 mt-2",children:[f.jsx("p",{className:"px-3 py-1 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Life Areas"}),h.map(g=>f.jsx(Tn,{to:g.href,className:"block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>o(!1),children:g.name},g.name))]}),f.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-2 mt-2",children:[f.jsx(Tn,{to:"/settings",className:"block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>o(!1),children:"Settings"}),f.jsx("button",{onClick:()=>{t(),o(!1)},className:"block w-full text-left px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700",children:"Sign Out"})]})]})})]})})};function tt(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function mr(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function K0(n,e){const t=tt(n);return isNaN(e)?mr(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function Iz(n,e){const t=tt(n);if(isNaN(e))return mr(n,NaN);if(!e)return t;const r=t.getDate(),s=mr(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const i=s.getDate();return r>=i?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const MR=6048e5,Nz=864e5;let Cz={};function td(){return Cz}function Si(n,e){var a,l,c,u;const t=td(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=tt(n),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Of(n){return Si(n,{weekStartsOn:1})}function OR(n){const e=tt(n),t=e.getFullYear(),r=mr(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=Of(r),i=mr(n,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const o=Of(i);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function fb(n){const e=tt(n);return e.setHours(0,0,0,0),e}function pb(n){const e=tt(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Az(n,e){const t=fb(n),r=fb(e),s=+t-pb(t),i=+r-pb(r);return Math.round((s-i)/Nz)}function Rz(n){const e=OR(n),t=mr(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),Of(t)}function Ew(n){return mr(n,Date.now())}function Pz(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function Dz(n){if(!Pz(n)&&typeof n!="number")return!1;const e=tt(n);return!isNaN(Number(e))}function jf(n){const e=tt(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Vf(n){const e=tt(n);return e.setDate(1),e.setHours(0,0,0,0),e}function Mz(n){const e=tt(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function jR(n){const e=tt(n),t=mr(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Oz(n,e){var a,l;const t=td(),r=t.weekStartsOn??((l=(a=t.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??0,s=tt(n),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const jz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Vz=(n,e,t)=>{let r;const s=jz[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Ug(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const Lz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Fz={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Bz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Uz={date:Ug({formats:Lz,defaultWidth:"full"}),time:Ug({formats:Fz,defaultWidth:"full"}),dateTime:Ug({formats:Bz,defaultWidth:"full"})},$z={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},zz=(n,e,t,r)=>$z[n];function ec(n){return(e,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=t!=null&&t.width?String(t.width):o;s=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=t!=null&&t.width?String(t.width):n.defaultWidth;s=n.values[a]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(e):e;return s[i]}}const Wz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Hz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},qz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Kz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Gz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Qz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Jz=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Yz={ordinalNumber:Jz,era:ec({values:Wz,defaultWidth:"wide"}),quarter:ec({values:Hz,defaultWidth:"wide",argumentCallback:n=>n-1}),month:ec({values:qz,defaultWidth:"wide"}),day:ec({values:Kz,defaultWidth:"wide"}),dayPeriod:ec({values:Gz,defaultWidth:"wide",formattingValues:Qz,defaultFormattingWidth:"wide"})};function tc(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(a)?Zz(a,h=>h.test(o)):Xz(a,h=>h.test(o));let c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function Xz(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function Zz(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function e9(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],i=e.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const t9=/^(\d+)(th|st|nd|rd)?/i,n9=/\d+/i,r9={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},s9={any:[/^b/i,/^(a|c)/i]},i9={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},o9={any:[/1/i,/2/i,/3/i,/4/i]},a9={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},l9={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},c9={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},u9={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},d9={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},h9={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},f9={ordinalNumber:e9({matchPattern:t9,parsePattern:n9,valueCallback:n=>parseInt(n,10)}),era:tc({matchPatterns:r9,defaultMatchWidth:"wide",parsePatterns:s9,defaultParseWidth:"any"}),quarter:tc({matchPatterns:i9,defaultMatchWidth:"wide",parsePatterns:o9,defaultParseWidth:"any",valueCallback:n=>n+1}),month:tc({matchPatterns:a9,defaultMatchWidth:"wide",parsePatterns:l9,defaultParseWidth:"any"}),day:tc({matchPatterns:c9,defaultMatchWidth:"wide",parsePatterns:u9,defaultParseWidth:"any"}),dayPeriod:tc({matchPatterns:d9,defaultMatchWidth:"any",parsePatterns:h9,defaultParseWidth:"any"})},p9={code:"en-US",formatDistance:Vz,formatLong:Uz,formatRelative:zz,localize:Yz,match:f9,options:{weekStartsOn:0,firstWeekContainsDate:1}};function m9(n){const e=tt(n);return Az(e,jR(e))+1}function g9(n){const e=tt(n),t=+Of(e)-+Rz(e);return Math.round(t/MR)+1}function VR(n,e){var u,h,p,m;const t=tt(n),r=t.getFullYear(),s=td(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(p=s.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,o=mr(n,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=Si(o,e),l=mr(n,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=Si(l,e);return t.getTime()>=a.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function y9(n,e){var a,l,c,u;const t=td(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=VR(n,e),i=mr(n,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),Si(i,e)}function v9(n,e){const t=tt(n),r=+Si(t,e)-+y9(t,e);return Math.round(r/MR)+1}function Ce(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const As={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return Ce(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Ce(t+1,2)},d(n,e){return Ce(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Ce(n.getHours()%12||12,e.length)},H(n,e){return Ce(n.getHours(),e.length)},m(n,e){return Ce(n.getMinutes(),e.length)},s(n,e){return Ce(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return Ce(s,e.length)}},ua={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},mb={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return As.y(n,e)},Y:function(n,e,t,r){const s=VR(n,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return Ce(o,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):Ce(i,e.length)},R:function(n,e){const t=OR(n);return Ce(t,e.length)},u:function(n,e){const t=n.getFullYear();return Ce(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Ce(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Ce(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return As.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return Ce(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=v9(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):Ce(s,e.length)},I:function(n,e,t){const r=g9(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):Ce(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):As.d(n,e)},D:function(n,e,t){const r=m9(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Ce(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Ce(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Ce(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return Ce(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=ua.noon:r===0?s=ua.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=ua.evening:r>=12?s=ua.afternoon:r>=4?s=ua.morning:s=ua.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return As.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):As.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Ce(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):Ce(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):As.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):As.s(n,e)},S:function(n,e){return As.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return yb(r);case"XXXX":case"XX":return Yi(r);case"XXXXX":case"XXX":default:return Yi(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return yb(r);case"xxxx":case"xx":return Yi(r);case"xxxxx":case"xxx":default:return Yi(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+gb(r,":");case"OOOO":default:return"GMT"+Yi(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+gb(r,":");case"zzzz":default:return"GMT"+Yi(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return Ce(r,e.length)},T:function(n,e,t){const r=n.getTime();return Ce(r,e.length)}};function gb(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),i=r%60;return i===0?t+String(s):t+String(s)+e+Ce(i,2)}function yb(n,e){return n%60===0?(n>0?"-":"+")+Ce(Math.abs(n)/60,2):Yi(n,e)}function Yi(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Ce(Math.trunc(r/60),2),i=Ce(r%60,2);return t+s+e+i}const vb=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},LR=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},x9=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return vb(n,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",vb(r,e)).replace("{{time}}",LR(s,e))},w9={p:LR,P:x9},_9=/^D+$/,E9=/^Y+$/,k9=["D","DD","YY","YYYY"];function b9(n){return _9.test(n)}function T9(n){return E9.test(n)}function S9(n,e,t){const r=I9(n,e,t);if(console.warn(r),k9.includes(n))throw new RangeError(r)}function I9(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const N9=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,C9=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,A9=/^'([^]*?)'?$/,R9=/''/g,P9=/[a-zA-Z]/;function Zt(n,e,t){var u,h,p,m;const r=td(),s=r.locale??p9,i=r.firstWeekContainsDate??((h=(u=r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,o=r.weekStartsOn??((m=(p=r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??0,a=tt(n);if(!Dz(a))throw new RangeError("Invalid time value");let l=e.match(C9).map(g=>{const v=g[0];if(v==="p"||v==="P"){const x=w9[v];return x(g,s.formatLong)}return g}).join("").match(N9).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const v=g[0];if(v==="'")return{isToken:!1,value:D9(g)};if(mb[v])return{isToken:!0,value:g};if(v.match(P9))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:g}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(g=>{if(!g.isToken)return g.value;const v=g.value;(T9(v)||b9(v))&&S9(v,e,String(n));const x=mb[v[0]];return x(a,v,s.localize,c)}).join("")}function D9(n){const e=n.match(A9);return e?e[1].replace(R9,"'"):n}function M9(n,e,t){const r=Si(n,t),s=Si(e,t);return+r==+s}function O9(n,e){const t=tt(n),r=tt(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function j9(n,e){const t=tt(n),r=tt(e);return t.getFullYear()===r.getFullYear()}function V9(n){return O9(n,Ew(n))}function L9(n,e){return M9(n,Ew(n),e)}function F9(n){return j9(n,Ew(n))}function xb(n,e){return K0(n,-e)}function Ph(n,e){return Iz(n,-e)}const wb=({todos:n,title:e,onAddTodo:t,onToggleTodo:r,onDeleteTodo:s,showDate:i=!0,compact:o=!1})=>{const[a,l]=O.useState(!1),[c,u]=O.useState(""),h=p=>{p.preventDefault(),c.trim()&&(t(c.trim()),u(""),l(!1))};return f.jsxs("div",{className:o?"":"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e}),!a&&f.jsx("button",{onClick:()=>l(!0),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:f.jsx(pr,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})})]}),a&&f.jsxs("form",{onSubmit:h,className:"flex items-center space-x-2 mb-3",children:[f.jsx("input",{type:"text",value:c,onChange:p=>u(p.target.value),placeholder:"Add a todo...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-primary-500",autoFocus:!0}),f.jsx("button",{type:"submit",className:"p-2 bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:f.jsx(pr,{className:"h-4 w-4"})}),f.jsx("button",{type:"button",onClick:()=>{l(!1),u("")},className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:f.jsx(Jn,{className:"h-4 w-4"})})]}),f.jsx("div",{className:`space-y-${o?"1":"2"}`,children:n.length===0?f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No todos yet"}):n.map(p=>f.jsxs("div",{className:`flex items-center space-x-2 ${o?"py-1":"p-2 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg"} transition-colors cursor-pointer group`,onClick:()=>r(p.id),children:[p.completed?f.jsx(PR,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0"}):f.jsx(X$,{className:"h-5 w-5 text-gray-400 dark:text-gray-600 flex-shrink-0"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:`text-sm ${p.completed?"line-through text-gray-500 dark:text-gray-500":"text-gray-900 dark:text-white"}`,children:p.text}),i&&p.createdAt&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Added"," ",Zt(p.createdAt.toDate?p.createdAt.toDate():new Date(p.createdAt),"MMM d")]})]}),p.priority&&f.jsx(h$,{className:`h-4 w-4 flex-shrink-0 ${p.priority==="high"?"text-red-500":p.priority==="medium"?"text-yellow-500":"text-gray-400"}`}),f.jsx("button",{onClick:m=>{m.stopPropagation(),s(p.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-all",children:f.jsx(Jn,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})})]},p.id))})]})},B9=()=>{var D;const{currentUser:n,userProfile:e}=_n(),[t,r]=O.useState([]),[s,i]=O.useState([]),[o,a]=O.useState([]),[l,c]=O.useState([]),[u,h]=O.useState({totalGoals:0,completedGoals:0,journalStreak:0,weeklyProgress:0}),[p,m]=O.useState(!0),g=[{id:"finances",name:"Finances",icon:"",color:"bg-green-500"},{id:"fitness",name:"Fitness",icon:"",color:"bg-blue-500"},{id:"jiu-jitsu",name:"Jiu Jitsu",icon:"",color:"bg-purple-500"},{id:"women",name:"Women",icon:"",color:"bg-pink-500"},{id:"attractiveness",name:"Attractiveness",icon:"",color:"bg-yellow-500"},{id:"nutrition",name:"Nutrition",icon:"",color:"bg-green-400"},{id:"philosophy",name:"Philosophy",icon:"",color:"bg-indigo-500"},{id:"languages",name:"Languages",icon:"",color:"bg-teal-500"}];O.useEffect(()=>{v()},[n]);const v=async()=>{if(n)try{const k=zn($n(be,"goals"),vt("userId","==",n.uid),vt("status","==","active"),ss("createdAt","desc"),sb(5)),S=(await Wn(k)).docs.map(ve=>({id:ve.id,...ve.data()}));r(S);const C=zn($n(be,"journalEntries"),vt("userId","==",n.uid),ss("createdAt","desc"),sb(3)),P=(await Wn(C)).docs.map(ve=>({id:ve.id,...ve.data()}));i(P);const N=zn($n(be,"todos"),vt("userId","==",n.uid),vt("type","==","today"),ss("createdAt","desc")),ye=(await Wn(N)).docs.map(ve=>({id:ve.id.replace(`${n.uid}_`,""),...ve.data()}));a(ye);const H=zn($n(be,"todos"),vt("userId","==",n.uid),vt("type","==","weekly"),ss("createdAt","desc")),B=(await Wn(H)).docs.map(ve=>({id:ve.id.replace(`${n.uid}_`,""),...ve.data()}));c(B);const Q=zn($n(be,"goals"),vt("userId","==",n.uid)),le=await Wn(Q),Ie=le.size,Ee=le.docs.filter(ve=>ve.data().status==="completed").length;h({totalGoals:Ie,completedGoals:Ee,journalStreak:x(P),weeklyProgress:_(S)})}catch(k){console.error("Error fetching dashboard data:",k)}finally{m(!1)}},x=k=>{var M;if(k.length===0)return 0;const E=new Date,S=((M=k[0].createdAt)==null?void 0:M.toDate())||new Date;return Math.floor((E-S)/(1e3*60*60*24))===0?1:0},_=k=>{if(k.length===0)return 0;const E=k.reduce((S,C)=>S+(C.progress||0),0);return Math.round(E/k.length)},b=async(k,E)=>{if(!n)return;const S=`todo_${Date.now()}`,C={text:k,type:E,completed:!1,userId:n.uid,createdAt:ur()};try{await Mr(et(be,"todos",`${n.uid}_${S}`),C);const M={id:S,...C,createdAt:{toDate:()=>new Date}};E==="today"?a([M,...o]):c([M,...l])}catch(M){console.error("Error adding todo:",M)}},T=async(k,E)=>{if(!n)return;const S=E==="today"?o:l,C=S.find(M=>M.id===k);if(C)try{await wR(et(be,"todos",`${n.uid}_${k}`),{completed:!C.completed});const M=S.map(P=>P.id===k?{...P,completed:!P.completed}:P);E==="today"?a(M):c(M)}catch(M){console.error("Error toggling todo:",M)}},A=async(k,E)=>{if(n)try{await hl(et(be,"todos",`${n.uid}_${k}`)),E==="today"?a(o.filter(S=>S.id!==k)):c(l.filter(S=>S.id!==k))}catch(S){console.error("Error deleting todo:",S)}},R=async k=>{const E=k==="today"?o:l,S=`Are you sure you want to clear all ${k==="today"?"today's":"weekly"} todos? This cannot be undone.`;if(E.length!==0&&confirm(S))try{const C=E.map(M=>hl(et(be,"todos",`${n.uid}_${M.id}`)));await Promise.all(C),k==="today"?a([]):c([]),oe.success(`All ${k==="today"?"today's":"weekly"} todos cleared`)}catch(C){console.error("Error clearing todos:",C),oe.error("Failed to clear todos")}};return p?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg p-6 text-white",children:[f.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome back,"," ",(e==null?void 0:e.displayName)||((D=n==null?void 0:n.email)==null?void 0:D.split("@")[0]),"!"]}),f.jsx("p",{className:"opacity-90",children:Zt(new Date,"EEEE, MMMM d, yyyy")})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Active Goals"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.length})]}),f.jsx(Ti,{className:"h-8 w-8 text-primary-600"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Completed"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u.completedGoals})]}),f.jsx(FU,{className:"h-8 w-8 text-green-600"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Journal Streak"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[u.journalStreak," days"]})]}),f.jsx(go,{className:"h-8 w-8 text-purple-600"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Weekly Progress"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[u.weeklyProgress,"%"]})]}),f.jsx(_w,{className:"h-8 w-8 text-blue-600"})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[f.jsx(PR,{className:"h-5 w-5 mr-2 text-blue-600"}),"Today's Todos"]}),o.length>0&&f.jsxs("button",{onClick:()=>R("today"),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",title:"Clear all today's todos",children:[f.jsx(Bo,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),f.jsx(wb,{todos:o,title:"",onAddTodo:k=>b(k,"today"),onToggleTodo:k=>T(k,"today"),onDeleteTodo:k=>A(k,"today"),showDate:!1,compact:!0})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[f.jsx(Fo,{className:"h-5 w-5 mr-2 text-purple-600"}),"Weekly Todos"]}),l.length>0&&f.jsxs("button",{onClick:()=>R("weekly"),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",title:"Clear all weekly todos",children:[f.jsx(Bo,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),f.jsx(wb,{todos:l,title:"",onAddTodo:k=>b(k,"weekly"),onToggleTodo:k=>T(k,"weekly"),onDeleteTodo:k=>A(k,"weekly"),showDate:!1,compact:!0})]})]}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Life Areas"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:g.map(k=>f.jsx(Tn,{to:`/subsection/${k.id}`,className:"card hover:scale-105 transition-transform duration-200",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:`w-16 h-16 ${k.color} rounded-full flex items-center justify-center text-2xl mb-3`,children:k.icon}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:k.name})]})},k.id))})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Active Goals"}),f.jsxs(Tn,{to:"/goals",className:"text-primary-600 hover:text-primary-700 flex items-center text-sm",children:["View all",f.jsx($0,{className:"h-4 w-4 ml-1"})]})]}),t.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(Ti,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No active goals yet"}),f.jsxs(Tn,{to:"/goals",className:"btn-primary inline-flex items-center",children:[f.jsx(pr,{className:"h-4 w-4 mr-2"}),"Create Goal"]})]}):f.jsx("div",{className:"space-y-3",children:t.map(k=>f.jsxs("div",{className:"border-l-4 border-primary-500 pl-4 py-2",children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:k.title}),f.jsxs("div",{className:"flex items-center justify-between mt-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.timeframe}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-24 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:f.jsx("div",{className:"h-full bg-primary-500 rounded-full",style:{width:`${k.progress||0}%`}})}),f.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[k.progress||0,"%"]})]})]})]},k.id))})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Recent Journal Entries"}),f.jsxs(Tn,{to:"/journal",className:"text-primary-600 hover:text-primary-700 flex items-center text-sm",children:["View all",f.jsx($0,{className:"h-4 w-4 ml-1"})]})]}),s.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(go,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No journal entries yet"}),f.jsxs(Tn,{to:"/journal",className:"btn-primary inline-flex items-center",children:[f.jsx(pr,{className:"h-4 w-4 mr-2"}),"Write Entry"]})]}):f.jsx("div",{className:"space-y-3",children:s.map(k=>{var E;return f.jsxs("div",{className:"border-l-4 border-purple-500 pl-4 py-2",children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:k.title||"Untitled Entry"}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:[(E=k.content)==null?void 0:E.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),f.jsxs("div",{className:"flex items-center mt-2 text-xs text-gray-500 dark:text-gray-400",children:[f.jsx(CR,{className:"h-3 w-3 mr-1"}),k.createdAt&&Zt(k.createdAt.toDate(),"MMM d, yyyy")]})]},k.id)})})]})]})]})};function It(n){this.content=n}It.prototype={constructor:It,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new It(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new It(t)},addToStart:function(n,e){return new It([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new It(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new It(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=It.from(n),n.size?new It(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=It.from(n),n.size?new It(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=It.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};It.from=function(n){if(n instanceof It)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new It(e)};function FR(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=FR(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function BR(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=BR(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class U{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new U(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new U(r,s)}cutByIndex(e,t){return e==t?U.empty:e==0&&t==this.content.length?this:new U(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new U(s,i)}addToStart(e){return new U([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new U(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return FR(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return BR(this,e,t,r)}findIndex(e){if(e==0)return Qd(0,e);if(e==this.size)return Qd(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let s=this.child(t),i=r+s.nodeSize;if(i>=e)return i==e?Qd(t+1,i):Qd(t,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return U.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new U(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return U.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new U(t||e,r)}static from(e){if(!e)return U.empty;if(e instanceof U)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new U([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}U.empty=new U([],0);const $g={index:0,offset:0};function Qd(n,e){return $g.index=n,$g.offset=e,$g}function Lf(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Lf(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Lf(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Me=class G0{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Lf(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return G0.none;if(e instanceof G0)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Me.none=[];class Ff extends Error{}class J{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=$R(this.content,e+this.openStart,t);return r&&new J(r,this.openStart,this.openEnd)}removeBetween(e,t){return new J(UR(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return J.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new J(U.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new J(e,r,s)}}J.empty=new J(U.empty,0,0);function UR(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(UR(i.content,e-s-1,t-s-1)))}function $R(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=$R(o.content,e-i-1,t,o);return a&&n.replaceChild(s,o.copy(a))}function U9(n,e,t){if(t.openStart>n.depth)throw new Ff("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Ff("Inconsistent open depths");return zR(n,e,t,0)}function zR(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=zR(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return xo(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=$9(t,n);return xo(i,HR(n,o,a,e,r))}else return xo(i,Bf(n,e,r))}function WR(n,e){if(!e.type.compatibleContent(n.type))throw new Ff("Cannot join "+e.type.name+" onto "+n.type.name)}function Q0(n,e,t){let r=n.node(t);return WR(r,e.node(t)),r}function vo(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Mc(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(vo(n.nodeAfter,r),i++));for(let a=i;a<o;a++)vo(s.child(a),r);e&&e.depth==t&&e.textOffset&&vo(e.nodeBefore,r)}function xo(n,e){return n.type.checkContent(e),n.copy(e)}function HR(n,e,t,r,s){let i=n.depth>s&&Q0(n,e,s+1),o=r.depth>s&&Q0(t,r,s+1),a=[];return Mc(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(WR(i,o),vo(xo(i,HR(n,e,t,r,s+1)),a)):(i&&vo(xo(i,Bf(n,e,s+1)),a),Mc(e,t,s,a),o&&vo(xo(o,Bf(t,r,s+1)),a)),Mc(r,null,s,a),new U(a)}function Bf(n,e,t){let r=[];if(Mc(null,n,t,r),n.depth>t){let s=Q0(n,e,t+1);vo(xo(s,Bf(n,e,t+1)),r)}return Mc(e,null,t,r),new U(r)}function $9(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(U.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class Eu{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Me.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Uf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new Eu(t,r,i)}static resolveCached(e,t){let r=_b.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==t)return o}else _b.set(e,r=new z9);let s=r.elts[r.i]=Eu.resolve(e,t);return r.i=(r.i+1)%W9,s}}class z9{constructor(){this.elts=[],this.i=0}}const W9=12,_b=new WeakMap;class Uf{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const H9=Object.create(null);let pi=class J0{constructor(e,t,r,s=Me.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||U.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Lf(this.attrs,t||e.defaultAttrs||H9)&&Me.sameSet(this.marks,r||Me.none)}copy(e=null){return e==this.content?this:new J0(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new J0(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return J.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new J(c,s.depth-o,i.depth-o)}replace(e,t,r){return U9(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return Eu.resolveCached(this,e)}resolveNoCache(e){return Eu.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),qR(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=U.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Me.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Me.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=U.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};pi.prototype.text=void 0;class $f extends pi{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):qR(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new $f(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new $f(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function qR(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Uo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new q9(e,t);if(r.next==null)return Uo.empty;let s=KR(r);r.next&&r.err("Unexpected trailing text");let i=Z9(X9(s));return e7(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return U.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:h}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(h)==-1){s.push(h);let p=i(h,a.concat(u));if(p)return p}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Uo.empty=new Uo(!0);class q9{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function KR(n){let e=[];do e.push(K9(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function K9(n){let e=[];do e.push(G9(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function G9(n){let e=Y9(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=Q9(n,e);else break;return e}function Eb(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function Q9(n,e){let t=Eb(n),r=t;return n.eat(",")&&(n.next!="}"?r=Eb(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function J9(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function Y9(n){if(n.eat("(")){let e=KR(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=J9(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function X9(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function GR(n,e){return e-n}function kb(n,e){let t=[];return r(e),t.sort(GR);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function Z9(n){let e=Object.create(null);return t(kb(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);kb(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new Uo(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(GR);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function e7(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function QR(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function JR(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function YR(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let i=n[s];i.validate&&i.validate(e[s])}}function XR(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new n7(n,r,e[r]);return t}let bb=class ZR{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=XR(e,r.attrs),this.defaultAttrs=QR(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Uo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:JR(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new pi(this,this.computeAttrs(e),U.from(t),Me.setFrom(r))}createChecked(e=null,t,r){return t=U.from(t),this.checkContent(t),new pi(this,this.computeAttrs(e),t,Me.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=U.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(U.empty,!0);return i?new pi(this,e,t.append(i),Me.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){YR(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Me.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new ZR(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function t7(n,e,t){let r=t.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${i}`)}}class n7{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?t7(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ym{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=XR(e,s.attrs),this.excluded=null;let i=QR(this.attrs);this.instance=i?new Me(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Me(this,JR(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new ym(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){YR(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class eP{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=It.from(e.nodes),t.marks=It.from(e.marks||{}),this.nodes=bb.compile(this.spec.nodes,this),this.marks=ym.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Uo.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?Tb(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:Tb(this,o.split(" "))}this.nodeFromJSON=s=>pi.fromJSON(this,s),this.markFromJSON=s=>Me.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof bb){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new $f(r,r.defaultAttrs,e,Me.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Tb(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function r7(n){return n.tag!=null}function s7(n){return n.style!=null}class mi{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(r7(s))this.tags.push(s);else if(s7(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Ib(this,t,!1);return r.addAll(e,Me.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Ib(this,t,!0);return r.addAll(e,Me.none,t.from,t.to),J.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(a7(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Nb(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Nb(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new mi(e,mi.schemaRules(e)))}}const tP={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},i7={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nP={ol:!0,ul:!0},ku=1,Y0=2,Oc=4;function Sb(n,e,t){return e!=null?(e?ku:0)|(e==="full"?Y0:0):n&&n.whitespace=="pre"?ku|Y0:t&~Oc}class Jd{constructor(e,t,r,s,i,o){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=Me.none,this.match=i||(o&Oc?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(U.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ku)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=U.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(U.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!tP.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Ib{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,i,o=Sb(null,t.preserveWhitespace,0)|(r?Oc:0);s?i=new Jd(s.type,s.attrs,Me.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new Jd(null,null,Me.none,!0,null,o):i=new Jd(e.schema.topNodeType,null,Me.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,i=s.options&Y0?"full":this.localPreserveWS||(s.options&ku)>0,{schema:o}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(o.linebreakReplacement.create(),t,!0),a[l]&&this.insertNode(o.text(a[l]),t,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=s.content[s.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;nP.hasOwnProperty(o)&&this.parser.normalizeLists&&o7(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:i7.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(tP.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let h=l&&l.skip?t:this.readStyles(e,t);h&&this.addAll(e,h),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,s){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(o,t.attrs||null,r,t.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)t=this.enterInner(s[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Me.none;for(let a of s.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):Cb(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,s){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,s)),i}enterInner(e,t,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=Sb(e,i,o.options);o.options&Oc&&o.content.length==0&&(a|=Oc);let l=Me.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):Cb(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Jd(e,t,l,s,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=ku)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function o7(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&nP.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function a7(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Nb(n){let e={};for(let t in n)e[t]=n[t];return e}function Cb(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class ea{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=zg(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=Dh(zg(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&Dh(zg(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return Dh(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new ea(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Ab(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Ab(e.marks)}}function Ab(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function zg(n){return n.document||window.document}const Rb=new WeakMap;function l7(n){let e=Rb.get(n);return e===void 0&&Rb.set(n,e=c7(n)),e}function c7(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function Dh(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=l7(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(t=s.slice(0,o),s=s.slice(o+1));let a,l=t?n.createElementNS(t,s):n.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let h in c)if(c[h]!=null){let p=h.indexOf(" ");p>0?l.setAttributeNS(h.slice(0,p),h.slice(p+1),c[h]):h=="style"&&l.style?l.style.cssText=c[h]:l.setAttribute(h,c[h])}}for(let h=u;h<e.length;h++){let p=e[h];if(p===0){if(h<e.length-1||h>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:m,contentDOM:g}=Dh(n,p,t,r);if(l.appendChild(m),g){if(a)throw new RangeError("Multiple content holes");a=g}}}return{dom:l,contentDOM:a}}const rP=65535,sP=Math.pow(2,16);function u7(n,e){return n+e*sP}function Pb(n){return n&rP}function d7(n){return(n-(n&rP))/sP}const iP=1,oP=2,Mh=4,aP=8;class X0{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&aP)>0}get deletedBefore(){return(this.delInfo&(iP|Mh))>0}get deletedAfter(){return(this.delInfo&(oP|Mh))>0}get deletedAcross(){return(this.delInfo&Mh)>0}}class Sn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Sn.empty)return Sn.empty}recover(e){let t=0,r=Pb(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+d7(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],h=l+c;if(e<=h){let p=c?e==l?-1:e==h?1:t:t,m=l+s+(p<0?0:u);if(r)return m;let g=e==(t<0?l:h)?null:u7(a/3,e-l),v=e==l?oP:e==h?iP:Mh;return(t<0?e!=l:e!=h)&&(v|=aP),new X0(m,v,g)}s+=u-c}return r?e+s:new X0(e+s,0,null)}touches(e,t){let r=0,s=Pb(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],u=this.ranges[s+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new Sn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Sn.empty:new Sn(e<0?[0,-e,0]:[0,0,e])}}Sn.empty=new Sn([]);class bu{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new bu(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new bu;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new X0(e,s,null)}}const Wg=Object.create(null);class Kt{getMap(){return Sn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Wg[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Wg)throw new RangeError("Duplicate use of step JSON ID "+e);return Wg[e]=t,t.prototype.jsonID=e,t}}class ot{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ot(e,null)}static fail(e){return new ot(null,e)}static fromReplace(e,t,r,s){try{return ot.ok(e.replace(t,r,s))}catch(i){if(i instanceof Ff)return ot.fail(i.message);throw i}}}function kw(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(kw(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return U.fromArray(r)}class Xs extends Kt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new J(kw(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return ot.fromReplace(e,this.from,this.to,i)}invert(){return new Ir(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Xs(t.pos,r.pos,this.mark)}merge(e){return e instanceof Xs&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Xs(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Xs(t.from,t.to,e.markFromJSON(t.mark))}}Kt.jsonID("addMark",Xs);class Ir extends Kt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new J(kw(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return ot.fromReplace(e,this.from,this.to,r)}invert(){return new Xs(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ir(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ir&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ir(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ir(t.from,t.to,e.markFromJSON(t.mark))}}Kt.jsonID("removeMark",Ir);class Zs extends Kt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ot.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ot.fromReplace(e,this.pos,this.pos+1,new J(U.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new Zs(this.pos,t.marks[s]);return new Zs(this.pos,this.mark)}}return new $o(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Zs(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Zs(t.pos,e.markFromJSON(t.mark))}}Kt.jsonID("addNodeMark",Zs);class $o extends Kt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ot.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ot.fromReplace(e,this.pos,this.pos+1,new J(U.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Zs(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new $o(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new $o(t.pos,e.markFromJSON(t.mark))}}Kt.jsonID("removeNodeMark",$o);class xt extends Kt{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&Z0(e,this.from,this.to)?ot.fail("Structure replace would overwrite content"):ot.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Sn([this.from,this.to-this.from,this.slice.size])}invert(e){return new xt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new xt(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof xt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?J.empty:new J(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new xt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?J.empty:new J(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new xt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new xt(t.from,t.to,J.fromJSON(e,t.slice),!!t.structure)}}Kt.jsonID("replace",xt);class _t extends Kt{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Z0(e,this.from,this.gapFrom)||Z0(e,this.gapTo,this.to)))return ot.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ot.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ot.fromReplace(e,this.from,this.to,r):ot.fail("Content does not fit in gap")}getMap(){return new Sn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new _t(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new _t(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new _t(t.from,t.to,t.gapFrom,t.gapTo,J.fromJSON(e,t.slice),t.insert,!!t.structure)}}Kt.jsonID("replaceAround",_t);function Z0(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function h7(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let h=l.marks;if(!r.isInSet(h)&&u.type.allowsMarkType(r.type)){let p=Math.max(c,e),m=Math.min(c+l.nodeSize,t),g=r.addToSet(h);for(let v=0;v<h.length;v++)h[v].isInSet(g)||(o&&o.to==p&&o.mark.eq(h[v])?o.to=m:s.push(o=new Ir(p,m,h[v])));a&&a.to==p?a.to=m:i.push(a=new Xs(p,m,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function f7(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof ym){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let h=l[u],p;for(let m=0;m<s.length;m++){let g=s[m];g.step==i-1&&h.eq(s[m].style)&&(p=g)}p?(p.to=c,p.step=i):s.push({style:h,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new Ir(o.from,o.to,o.style)))}function bw(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,h=r.matchType(c.type);if(!h)o.push(new xt(a,u,J.empty));else{r=h;for(let p=0;p<c.marks.length;p++)t.allowsMarkType(c.marks[p].type)||n.step(new Ir(a,u,c.marks[p]));if(s&&c.isText&&t.whitespace!="pre"){let p,m=/\r?\n|\r/g,g;for(;p=m.exec(c.text);)g||(g=new J(U.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new xt(a+p.index,a+p.index+p[0].length,g))}}a=u}if(!r.validEnd){let l=r.fillBefore(U.empty,!0);n.replace(a,a,new J(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function p7(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Sl(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!p7(s,i,o))break}return null}function m7(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=U.empty,h=0;for(let g=i,v=!1;g>t;g--)v||r.index(g)>0?(v=!0,u=U.from(r.node(g).copy(u)),h++):l--;let p=U.empty,m=0;for(let g=i,v=!1;g>t;g--)v||s.after(g+1)<s.end(g)?(v=!0,p=U.from(s.node(g).copy(p)),m++):c++;n.step(new _t(l,c,o,a,new J(u.append(p),h,m),u.size-h,!0))}function Tw(n,e,t=null,r=n){let s=g7(n,e),i=s&&y7(r,e);return i?s.map(Db).concat({type:e,attrs:t}).concat(i.map(Db)):null}function Db(n){return{type:n,attrs:null}}function g7(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function y7(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function v7(n,e,t){let r=U.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=U.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new _t(s,i,s,i,new J(r,0,0),t.length,!0))}function x7(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&w7(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let m=r.whitespace=="pre",g=!!r.contentMatch.matchType(r.schema.linebreakReplacement);m&&!g?c=!1:!m&&g&&(c=!0)}c===!1&&cP(n,o,a,i),bw(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let u=n.mapping.slice(i),h=u.map(a,1),p=u.map(a+o.nodeSize,1);return n.step(new _t(h,p,h+1,p-1,new J(U.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&lP(n,o,a,i),!1}})}function lP(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function cP(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function w7(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function _7(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new _t(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new J(U.from(o),0,0),1,!0))}function cs(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>i;c--,u--){let h=s.node(c),p=s.index(c);if(h.type.spec.isolating)return!1;let m=h.content.cutByIndex(p,h.childCount),g=r&&r[u+1];g&&(m=m.replaceChild(0,g.type.create(g.attrs)));let v=r&&r[u]||h;if(!h.canReplace(p+1,h.childCount)||!v.type.validContent(m))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function E7(n,e,t=1,r){let s=n.doc.resolve(e),i=U.empty,o=U.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=U.from(s.node(a).copy(i));let u=r&&r[c];o=U.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}n.step(new xt(e,e,new J(i.append(o),t,t),!0))}function Li(n,e){let t=n.resolve(e),r=t.index();return uP(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function k7(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function uP(n,e){return!!(n&&e&&!n.isLeaf&&k7(n,e))}function vm(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&uP(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function b7(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",h=!!o.contentMatch.matchType(s);u&&!h?r=!1:!u&&h&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);cP(n,u.node(),u.before(),a)}o.inlineContent&&bw(n,e+t-1,o,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new xt(c,l.map(e+t,-1),J.empty,!0)),r===!0){let u=n.doc.resolve(c);lP(n,u.node(),u.before(),n.steps.length)}return n}function T7(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function dP(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let h=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=h&&c.canReplaceWith(l,l,h[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function xm(n,e,t=e,r=J.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return hP(s,i,r)?new xt(e,t,r):new S7(s,i,r).fit()}function hP(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class S7{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=U.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=U.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new J(i,o,a);return e>-1?new _t(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new xt(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Hg(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,h=null;if(t==1&&(o?c.matchType(o.type)||(h=c.fillBefore(U.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:h};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Hg(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new J(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Hg(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new J(mc(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new J(mc(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let v=0;v<i.length;v++)this.openFrontierNode(i[v]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:h,type:p}=this.frontier[t];if(s){for(let v=0;v<s.childCount;v++)u.push(s.child(v));h=h.matchFragment(s)}let m=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let v=a.child(c),x=h.matchType(v.type);if(!x)break;c++,(c>1||l==0||v.content.size)&&(h=x,u.push(fP(v.mark(p.allowedMarks(v.marks)),c==1?l:0,c==a.childCount?m:-1)))}let g=c==a.childCount;g||(m=-1),this.placed=gc(this.placed,t,U.from(u)),this.frontier[t].match=h,g&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,x=a;v<m;v++){let _=x.lastChild;this.frontier.push({type:_.type,match:_.contentMatchAt(_.childCount)}),x=_.content}this.unplaced=g?e==0?J.empty:new J(mc(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new J(mc(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!qg(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=qg(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=qg(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=gc(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=gc(this.placed,this.depth,U.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(U.empty,!0);t.childCount&&(this.placed=gc(this.placed,this.frontier.length,t))}}function mc(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(mc(n.firstChild.content,e-1,t)))}function gc(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(gc(n.lastChild.content,e-1,t)))}function Hg(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function fP(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,fP(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(U.empty,!0)))),n.copy(r)}function qg(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!I7(t,i.content,o)?a:null}function I7(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function N7(n){return n.spec.defining||n.spec.definingForContent}function C7(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if(hP(s,i,r))return n.step(new xt(e,t,r));let o=mP(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let p=s.depth,m=s.pos-1;p>0;p--,m--){let g=s.node(p).type.spec;if(g.defining||g.definingAsContext||g.isolating)break;o.indexOf(p)>-1?a=p:s.before(p)==m&&o.splice(1,0,-p)}let l=o.indexOf(a),c=[],u=r.openStart;for(let p=r.content,m=0;;m++){let g=p.firstChild;if(c.push(g),m==r.openStart)break;p=g.content}for(let p=u-1;p>=0;p--){let m=c[p],g=N7(m.type);if(g&&!m.sameMarkup(s.node(Math.abs(a)-1)))u=p;else if(g||!m.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let m=(p+u+1)%(r.openStart+1),g=c[m];if(g)for(let v=0;v<o.length;v++){let x=o[(v+l)%o.length],_=!0;x<0&&(_=!1,x=-x);let b=s.node(x-1),T=s.index(x-1);if(b.canReplaceWith(T,T,g.type,g.marks))return n.replace(s.before(x),_?i.after(x):t,new J(pP(r.content,0,r.openStart,m),m,r.openEnd))}}let h=n.steps.length;for(let p=o.length-1;p>=0&&(n.replace(e,t,r),!(n.steps.length>h));p--){let m=o[p];m<0||(e=s.before(m),t=i.after(m))}}function pP(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(pP(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(U.empty,!0))}return n}function A7(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=T7(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new J(U.from(r),0,0))}function R7(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=mP(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function mP(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Ka extends Kt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ot.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return ot.fromReplace(e,this.pos,this.pos+1,new J(U.from(s),0,t.isLeaf?0:1))}getMap(){return Sn.empty}invert(e){return new Ka(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ka(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ka(t.pos,t.attr,t.value)}}Kt.jsonID("attr",Ka);class Tu extends Kt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return ot.ok(r)}getMap(){return Sn.empty}invert(e){return new Tu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Tu(t.attr,t.value)}}Kt.jsonID("docAttr",Tu);let fl=class extends Error{};fl=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};fl.prototype=Object.create(Error.prototype);fl.prototype.constructor=fl;fl.prototype.name="TransformError";class gP{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new bu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new fl(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=J.empty){let s=xm(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new J(U.from(r),0,0))}delete(e,t){return this.replace(e,t,J.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return C7(this,e,t,r),this}replaceRangeWith(e,t,r){return A7(this,e,t,r),this}deleteRange(e,t){return R7(this,e,t),this}lift(e,t){return m7(this,e,t),this}join(e,t=1){return b7(this,e,t),this}wrap(e,t){return v7(this,e,t),this}setBlockType(e,t=e,r,s=null){return x7(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return _7(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Ka(e,t,r)),this}setDocAttribute(e,t){return this.step(new Tu(e,t)),this}addNodeMark(e,t){return this.step(new Zs(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Me)t.isInSet(r.marks)&&this.step(new $o(e,t));else{let s=r.marks,i,o=[];for(;i=t.isInSet(s);)o.push(new $o(e,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,t=1,r){return E7(this,e,t,r),this}addMark(e,t,r){return h7(this,e,t,r),this}removeMark(e,t,r){return f7(this,e,t,r),this}clearIncompatible(e,t,r){return bw(this,e,t,r),this}}const Kg=Object.create(null);class pe{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new P7(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=J.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?J.empty:t),a==0&&jb(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),jb(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ue(e):va(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?va(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):va(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Rn(e.node(0))}static atStart(e){return va(e,e,0,0,1)||new Rn(e)}static atEnd(e){return va(e,e,e.content.size,e.childCount,-1)||new Rn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Kg[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Kg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Kg[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ue.between(this.$anchor,this.$head).getBookmark()}}pe.prototype.visible=!0;class P7{constructor(e,t){this.$from=e,this.$to=t}}let Mb=!1;function Ob(n){!Mb&&!n.parent.inlineContent&&(Mb=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ue extends pe{constructor(e,t=e){Ob(e),Ob(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return pe.near(r);let s=e.resolve(t.map(this.anchor));return new ue(s.parent.inlineContent?s:r,r)}replace(e,t=J.empty){if(super.replace(e,t),t==J.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ue&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new wm(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ue(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=pe.findFrom(t,r,!0)||pe.findFrom(t,-r,!0);if(i)t=i.$head;else return pe.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(pe.findFrom(e,-r,!0)||pe.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ue(e,t)}}pe.jsonID("text",ue);class wm{constructor(e,t){this.anchor=e,this.head=t}map(e){return new wm(e.map(this.anchor),e.map(this.head))}resolve(e){return ue.between(e.resolve(this.anchor),e.resolve(this.head))}}class se extends pe{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?pe.near(i):new se(i)}content(){return new J(U.from(this.node),0,0)}eq(e){return e instanceof se&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Sw(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new se(e.resolve(t.anchor))}static create(e,t){return new se(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}se.prototype.visible=!1;pe.jsonID("node",se);class Sw{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new wm(r,r):new Sw(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&se.isSelectable(r)?new se(t):pe.near(t)}}class Rn extends pe{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=J.empty){if(t==J.empty){e.delete(0,e.doc.content.size);let r=pe.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Rn(e)}map(e){return new Rn(e)}eq(e){return e instanceof Rn}getBookmark(){return D7}}pe.jsonID("all",Rn);const D7={map(){return this},resolve(n){return new Rn(n)}};function va(n,e,t,r,s,i=!1){if(e.inlineContent)return ue.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&se.isSelectable(a))return se.create(n,t-(s<0?a.nodeSize:0))}else{let l=va(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function jb(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof xt||s instanceof _t))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(pe.near(n.doc.resolve(o),t))}const Vb=1,Yd=2,Lb=4;class M7 extends gP{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Vb)&~Yd,this.storedMarks=null,this}get selectionSet(){return(this.updated&Vb)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Yd,this}ensureMarks(e){return Me.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Yd)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Yd,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Me.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),!this.selection.empty&&this.selection.to==t+e.length&&this.setSelection(pe.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Lb,this}get scrolledIntoView(){return(this.updated&Lb)>0}}function Fb(n,e){return!e||!n?n:n.bind(e)}class yc{constructor(e,t,r){this.name=e,this.init=Fb(t.init,r),this.apply=Fb(t.apply,r)}}const O7=[new yc("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new yc("selection",{init(n,e){return n.selection||pe.atStart(e.doc)},apply(n){return n.selection}}),new yc("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new yc("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Gg{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=O7.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new yc(r.key,r.spec.state,r))})}}class Ma{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let h=0;h<this.config.plugins.length;h++)s.push(h<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Ma(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new M7(this)}static create(e){let t=new Gg(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ma(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new Gg(this.schema,e.plugins),r=t.fields,s=new Ma(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Gg(e.schema,e.plugins),i=new Ma(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=pi.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=pe.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function yP(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=yP(s,e,{})),t[r]=s}return t}class bt{constructor(e){this.spec=e,this.props={},e.props&&yP(e.props,this,this.props),this.key=e.key?e.key.key:vP("plugin")}getState(e){return e[this.key]}}const Qg=Object.create(null);function vP(n){return n in Qg?n+"$"+ ++Qg[n]:(Qg[n]=0,n+"$")}class En{constructor(e="key"){this.key=vP(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Rt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},pl=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let ev=null;const Jr=function(n,e,t){let r=ev||(ev=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},j7=function(){ev=null},zo=function(n,e,t,r){return t&&(Bb(n,e,t,r,-1)||Bb(n,e,t,r,1))},V7=/^(img|br|input|textarea|hr)$/i;function Bb(n,e,t,r,s){for(var i;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Hn(n))){let o=n.parentNode;if(!o||o.nodeType!=1||nd(n)||V7.test(n.nodeName)||n.contentEditable=="false")return!1;e=Rt(n)+(s<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else n=o,e=s<0?Hn(n):0}else return!1}}function Hn(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function L7(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Hn(n)}else if(n.parentNode&&!nd(n))e=Rt(n),n=n.parentNode;else return null}}function F7(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!nd(n))e=Rt(n)+1,n=n.parentNode;else return null}}function B7(n,e,t){for(let r=e==0,s=e==Hn(n);r||s;){if(n==t)return!0;let i=Rt(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==Hn(n)}}function nd(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const _m=function(n){return n.focusNode&&zo(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function no(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function U7(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function $7(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(Hn(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(Hn(r.startContainer),r.startOffset)}}}const Vr=typeof navigator<"u"?navigator:null,Ub=typeof document<"u"?document:null,Fi=Vr&&Vr.userAgent||"",tv=/Edge\/(\d+)/.exec(Fi),xP=/MSIE \d/.exec(Fi),nv=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fi),xn=!!(xP||nv||tv),gi=xP?document.documentMode:nv?+nv[1]:tv?+tv[1]:0,Yn=!xn&&/gecko\/(\d+)/i.test(Fi);Yn&&+(/Firefox\/(\d+)/.exec(Fi)||[0,0])[1];const rv=!xn&&/Chrome\/(\d+)/.exec(Fi),Wt=!!rv,wP=rv?+rv[1]:0,on=!xn&&!!Vr&&/Apple Computer/.test(Vr.vendor),ml=on&&(/Mobile\/\w+/.test(Fi)||!!Vr&&Vr.maxTouchPoints>2),Fn=ml||(Vr?/Mac/.test(Vr.platform):!1),z7=Vr?/Win/.test(Vr.platform):!1,is=/Android \d/.test(Fi),rd=!!Ub&&"webkitFontSmoothing"in Ub.documentElement.style,W7=rd?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function H7(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Wr(n,e){return typeof n=="number"?n:n[e]}function q7(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function $b(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=pl(o);continue}let a=o,l=a==i.body,c=l?H7(i):q7(a),u=0,h=0;if(e.top<c.top+Wr(r,"top")?h=-(c.top-e.top+Wr(s,"top")):e.bottom>c.bottom-Wr(r,"bottom")&&(h=e.bottom-e.top>c.bottom-c.top?e.top+Wr(s,"top")-c.top:e.bottom-c.bottom+Wr(s,"bottom")),e.left<c.left+Wr(r,"left")?u=-(c.left-e.left+Wr(s,"left")):e.right>c.right-Wr(r,"right")&&(u=e.right-c.right+Wr(s,"right")),u||h)if(l)i.defaultView.scrollBy(u,h);else{let m=a.scrollLeft,g=a.scrollTop;h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u);let v=a.scrollLeft-m,x=a.scrollTop-g;e={left:e.left-v,top:e.top-x,right:e.right-v,bottom:e.bottom-x}}let p=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(p))break;o=p=="absolute"?o.offsetParent:pl(o)}}function K7(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:_P(n.dom)}}function _P(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=pl(r));return e}function G7({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;EP(t,r==0?0:r-e)}function EP(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let da=null;function Q7(n){if(n.setActive)return n.setActive();if(da)return n.focus(da);let e=_P(n);n.focus(da==null?{get preventScroll(){return da={preventScroll:!0},!0}}:void 0),da||(da=!1,EP(e,0))}function kP(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,h=0;u;u=u.nextSibling,h++){let p;if(u.nodeType==1)p=u.getClientRects();else if(u.nodeType==3)p=Jr(u).getClientRects();else continue;for(let m=0;m<p.length;m++){let g=p[m];if(g.top<=o&&g.bottom>=a){o=Math.max(g.bottom,o),a=Math.min(g.top,a);let v=g.left>e.left?g.left-e.left:g.right<e.left?e.left-g.right:0;if(v<r){t=u,r=v,s=v&&t.nodeType==3?{left:g.right<e.left?g.right:g.left,top:e.top}:e,u.nodeType==1&&v&&(i=h+(e.left>=(g.left+g.right)/2?1:0));continue}}else g.top>e.top&&!l&&g.left<=e.left&&g.right>=e.left&&(l=u,c={left:Math.max(g.left,Math.min(g.right,e.left)),top:g.top});!t&&(e.left>=g.right&&e.top>=g.top||e.left>=g.left&&e.top>=g.bottom)&&(i=h+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?J7(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:kP(t,s)}function J7(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=Ps(r,1);if(i.top!=i.bottom&&Iw(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function Iw(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function Y7(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function X7(n,e,t){let{node:r,offset:s}=kP(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function Z7(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function bP(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Iw(e,c))return bP(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function eW(n,e){let t=n.dom.ownerDocument,r,s=0,i=$7(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!Iw(e,c)||(o=bP(n.dom,e,c),!o))return null}if(on)for(let c=o;r&&c;c=pl(c))c.draggable&&(r=void 0);if(o=Y7(o,e),r){if(Yn&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],h;u.nodeName=="IMG"&&(h=u.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&s++}let c;rd&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=Z7(n,r,s,e))}a==null&&(a=X7(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function zb(n){return n.top<n.bottom||n.left<n.right}function Ps(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(zb(r))return r}return Array.prototype.find.call(t,zb)||n.getBoundingClientRect()}const tW=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function TP(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=rd||Yn;if(r.nodeType==3)if(o&&(tW.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=Ps(Jr(r,s,s),t);if(Yn&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=Ps(Jr(r,s-1,s-1),-1);if(c.top==l.top){let u=Ps(Jr(r,s,s+1),-1);if(u.top!=l.top)return nc(u,u.left<c.left)}}return l}else{let l=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(l--,u=1):t<0?l--:c++,nc(Ps(Jr(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==Hn(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return Jg(l.getBoundingClientRect(),!1)}if(i==null&&s<Hn(r)){let l=r.childNodes[s];if(l.nodeType==1)return Jg(l.getBoundingClientRect(),!0)}return Jg(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==Hn(r))){let l=r.childNodes[s-1],c=l.nodeType==3?Jr(l,Hn(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return nc(Ps(c,1),!1)}if(i==null&&s<Hn(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Jr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return nc(Ps(c,-1),!0)}return nc(Ps(r.nodeType==3?Jr(r):r,-t),t>=0)}function nc(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Jg(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function SP(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function nW(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return SP(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=TP(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Jr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const rW=/[\u0590-\u08ac]/;function sW(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return a?!rW.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:SP(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:h}=n.domSelectionRange(),p=a.caretBidiLevel;a.modify("move",t,"character");let m=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:g,focusOffset:v}=n.domSelectionRange(),x=g&&!m.contains(g.nodeType==1?g:g.parentNode)||l==g&&c==v;try{a.collapse(u,h),l&&(l!=u||c!=h)&&a.extend&&a.extend(l,c)}catch{}return p!=null&&(a.caretBidiLevel=p),x}):r.pos==r.start()||r.pos==r.end()}let Wb=null,Hb=null,qb=!1;function iW(n,e,t){return Wb==e&&Hb==t?qb:(Wb=e,Hb=t,qb=t=="up"||t=="down"?nW(n,e,t):sW(n,e,t))}const Xn=0,Kb=1,ao=2,Lr=3;class sd{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=Xn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>Rt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof NP){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof IP&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Rt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Rt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let h=a;h>0;h--){let p=this.children[h-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){s=Rt(p.dom)+1;break}e-=p.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let h=this.children[u];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){i=Rt(h.dom);break}t+=h.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let m=0,g=0;m<this.children.length;m++){let v=this.children[m],x=g+v.size;if(i>g&&o<x)return v.setSelection(e-g-v.border,t-g-v.border,r,s);g=x}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),h=!1;if((Yn||on)&&e==t){let{node:m,offset:g}=a;if(m.nodeType==3){if(h=!!(g&&m.nodeValue[g-1]==`
`),h&&g==m.nodeValue.length)for(let v=m,x;v;v=v.parentNode){if(x=v.nextSibling){x.nodeName=="BR"&&(a=l={node:x.parentNode,offset:Rt(x)+1});break}let _=v.pmViewDesc;if(_&&_.node&&_.node.isBlock)break}}else{let v=m.childNodes[g-1];h=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(Yn&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let m=u.focusNode.childNodes[u.focusOffset];m&&m.contentEditable=="false"&&(s=!0)}if(!(s||h&&on)&&zo(a.node,a.offset,u.anchorNode,u.anchorOffset)&&zo(l.node,l.offset,u.focusNode,u.focusOffset))return;let p=!1;if((c.extend||e==t)&&!(h&&Yn)){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),p=!0}catch{}}if(!p){if(e>t){let g=a;a=l,l=g}let m=document.createRange();m.setEnd(l.node,l.offset),m.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?ao:Kb,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Lr:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?ao:Lr}r=o}this.dirty=ao}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?ao:Kb;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class IP extends sd{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==Xn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class oW extends sd{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Wo extends sd{constructor(e,t,r,s,i){super(e,[],r,s),this.mark=t,this.spec=i}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=ea.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Wo(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Lr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Lr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Xn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Xn}}slice(e,t,r){let s=Wo.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=iv(i,t,o,r)),e>0&&(i=iv(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class yi extends sd{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,h=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:h}=ea.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!h&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let p=u;return u=RP(u,r,t),c?l=new aW(e,t,r,s,u,h||null,p,c,i,o+1):t.isText?new Em(e,t,r,s,u,p,i):new yi(e,t,r,s,u,h||null,p,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>U.empty)}return e}matchesNode(e,t,r){return this.dirty==Xn&&e.eq(this.node)&&zf(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new cW(this,o&&o.node,e);hW(this.node,this.innerDeco,(c,u,h)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!h&&l.syncToMarks(u==this.node.childCount?Me.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,h,p)=>{l.syncToMarks(c.marks,r,e);let m;l.findNodeMatch(c,u,h,p)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(m=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,h,m,e)||l.updateNextNode(c,u,h,e,p,s)||l.addNode(c,u,h,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==ao)&&(o&&this.protectLocalComposition(e,o),CP(this.contentDOM,this.children,e),ml&&fW(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ue)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=pW(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new oW(this,i,t,s);e.input.compositionNodes.push(o),this.children=iv(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==Lr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Xn}updateOuterDeco(e){if(zf(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=AP(this.dom,this.nodeDOM,sv(this.outerDeco,this.node,t),sv(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Gb(n,e,t,r,s){RP(r,e,n);let i=new yi(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Em extends yi{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==Lr||this.dirty!=Xn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Xn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Xn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new Em(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Lr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class NP extends sd{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Xn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class aW extends yi{constructor(e,t,r,s,i,o,a,l,c,u){super(e,t,r,s,i,o,a,c,u),this.spec=l}update(e,t,r,s){if(this.dirty==Lr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function CP(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=Qb(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof Wo){let l=r?r.previousSibling:n.lastChild;CP(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=Qb(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const jc=function(n){n&&(this.nodeName=n)};jc.prototype=Object.create(null);const lo=[new jc];function sv(n,e,t){if(n.length==0)return lo;let r=t?lo[0]:new jc,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new jc(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new jc(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function AP(n,e,t,r){if(t==lo&&r==lo)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=lo[0]),s=l}lW(s,a||lo[0],o)}return s}function lW(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function RP(n,e,t){return AP(n,n,lo,sv(e,t,n.nodeType!=1))}function zf(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Qb(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class cW{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=uW(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=Xn,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Wo.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==Lr&&o.dom==o.contentDOM&&(o.dirty=ao),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof yi){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,h,p=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Lr&&zf(t,l.outerDeco));if(!p&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!p&&(h=this.recreateWrapper(l,e,t,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=ao,h.updateChildren(s,o+1),h.dirty=Xn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!zf(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=yi.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=yi.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new IP(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Wo;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Em)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((on||Wt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new NP(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function uW(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Wo)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function dW(n,e){return n.type.side-e.type.side}function hW(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,h;for(;o<s.length&&s[o].to==i;){let x=s[o++];x.widget&&(u?(h||(h=[u])).push(x):u=x)}if(u)if(h){h.sort(dW);for(let x=0;x<h.length;x++)t(h[x],c,!!l)}else t(u,c,!!l);let p,m;if(l)m=-1,p=l,l=null;else if(c<n.childCount)m=c,p=n.child(c++);else break;for(let x=0;x<a.length;x++)a[x].to<=i&&a.splice(x--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let g=i+p.nodeSize;if(p.isText){let x=g;o<s.length&&s[o].from<x&&(x=s[o].from);for(let _=0;_<a.length;_++)a[_].to<x&&(x=a[_].to);x<g&&(l=p.cut(x-i),p=p.cut(0,x-i),g=x,m=-1)}else for(;o<s.length&&s[o].to<g;)o++;let v=p.isInline&&!p.isLeaf?a.filter(x=>!x.inline):a.slice();r(p,v,e.forChild(i,p),m),i=g}}function fW(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function pW(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function iv(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function Nw(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(_m(t)){for(l=o;s&&!s.node;)s=s.parent;let h=s.node;if(s&&h.isAtom&&se.isSelectable(h)&&s.parent&&!(h.isInline&&B7(t.focusNode,t.focusOffset,s.dom))){let p=s.posBefore;c=new se(o==p?a:r.resolve(p))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let h=o,p=o;for(let m=0;m<t.rangeCount;m++){let g=t.getRangeAt(m);h=Math.min(h,n.docView.posFromDOM(g.startContainer,g.startOffset,1)),p=Math.max(p,n.docView.posFromDOM(g.endContainer,g.endOffset,-1))}if(h<0)return null;[l,o]=p==n.state.selection.anchor?[p,h]:[h,p],a=r.resolve(o)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let h=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=Cw(n,u,a,h)}return c}function PP(n){return n.editable?n.hasFocus():MP(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function us(n,e=!1){let t=n.state.selection;if(DP(n,t),!!PP(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Wt){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&zo(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)gW(n);else{let{anchor:r,head:s}=t,i,o;Jb&&!(t instanceof ue)&&(t.$from.parent.inlineContent||(i=Yb(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=Yb(n,t.to))),n.docView.setSelection(r,s,n,e),Jb&&(i&&Xb(i),o&&Xb(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&mW(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Jb=on||Wt&&wP<63;function Yb(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(on&&s&&s.contentEditable=="false")return Yg(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return Yg(s);if(i)return Yg(i)}}function Yg(n){return n.contentEditable="true",on&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Xb(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function mW(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!PP(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function gW(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,Rt(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&xn&&gi<=11&&(t.disabled=!0,t.disabled=!1)}function DP(n,e){if(e instanceof se){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Zb(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Zb(n)}function Zb(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Cw(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ue.between(e,t,r)}function eT(n){return n.editable&&!n.hasFocus()?!1:MP(n)}function MP(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function yW(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return zo(e.node,e.offset,t.anchorNode,t.anchorOffset)}function ov(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&pe.findFrom(i,e)}function Os(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function tT(n,e,t){let r=n.state.selection;if(r instanceof ue)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Os(n,new ue(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=ov(n.state,e);return s&&s instanceof se?Os(n,s):!1}else if(!(Fn&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?se.isSelectable(i)?Os(n,new se(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):rd?Os(n,new ue(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof se&&r.node.isInline)return Os(n,new ue(e>0?r.$to:r.$from));{let s=ov(n.state,e);return s?Os(n,s):!1}}}function Wf(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Vc(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function ha(n,e){return e<0?vW(n):xW(n)}function vW(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(Yn&&t.nodeType==1&&r<Wf(t)&&Vc(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Vc(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(OP(t))break;{let a=t.previousSibling;for(;a&&Vc(a,-1);)s=t.parentNode,i=Rt(a),a=a.previousSibling;if(a)t=a,r=Wf(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?av(n,t,r):s&&av(n,s,i)}function xW(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=Wf(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Vc(a,1))i=t,o=++r;else break}else{if(OP(t))break;{let a=t.nextSibling;for(;a&&Vc(a,1);)i=a.parentNode,o=Rt(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=Wf(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&av(n,i,o)}function OP(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function wW(n,e){for(;n&&e==n.childNodes.length&&!nd(n);)e=Rt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function _W(n,e){for(;n&&!e&&!nd(n);)e=Rt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function av(n,e,t){if(e.nodeType!=3){let i,o;(o=wW(e,t))?(e=o,t=0):(i=_W(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(_m(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&us(n)},50)}function nT(n,e){let t=n.state.doc.resolve(e);if(!(Wt||z7)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function rT(n,e,t){let r=n.state.selection;if(r instanceof ue&&!r.empty||t.indexOf("s")>-1||Fn&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=ov(n.state,e);if(o&&o instanceof se)return Os(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof Rn?pe.near(o,e):pe.findFrom(o,e);return a?Os(n,a):!1}return!1}function sT(n,e){if(!(n.state.selection instanceof ue))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function iT(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function EW(n){if(!on||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;iT(n,r,"true"),setTimeout(()=>iT(n,r,"false"),20)}return!1}function kW(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function bW(n,e){let t=e.keyCode,r=kW(e);if(t==8||Fn&&t==72&&r=="c")return sT(n,-1)||ha(n,-1);if(t==46&&!e.shiftKey||Fn&&t==68&&r=="c")return sT(n,1)||ha(n,1);if(t==13||t==27)return!0;if(t==37||Fn&&t==66&&r=="c"){let s=t==37?nT(n,n.state.selection.from)=="ltr"?-1:1:-1;return tT(n,s,r)||ha(n,s)}else if(t==39||Fn&&t==70&&r=="c"){let s=t==39?nT(n,n.state.selection.from)=="ltr"?1:-1:1;return tT(n,s,r)||ha(n,s)}else{if(t==38||Fn&&t==80&&r=="c")return rT(n,-1,r)||ha(n,-1);if(t==40||Fn&&t==78&&r=="c")return EW(n)||rT(n,1,r)||ha(n,1);if(r==(Fn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Aw(n,e){n.someProp("transformCopied",m=>{e=m(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=n.someProp("clipboardSerializer")||ea.fromSchema(n.state.schema),a=UP(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,h=0;for(;c&&c.nodeType==1&&(u=BP[c.nodeName.toLowerCase()]);){for(let m=u.length-1;m>=0;m--){let g=a.createElement(u[m]);for(;l.firstChild;)g.appendChild(l.firstChild);l.appendChild(g),h++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${h?` -${h}`:""} ${JSON.stringify(t)}`);let p=n.someProp("clipboardTextSerializer",m=>m(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:p,slice:e}}function jP(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=!!e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",p=>{e=p(e,i||r,n)}),i)return a=new J(U.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",p=>{a=p(a,n,!0)}),a;let h=n.someProp("clipboardTextParser",p=>p(e,s,r,n));if(h)a=h;else{let p=s.marks(),{schema:m}=n.state,g=ea.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let x=o.appendChild(document.createElement("p"));v&&x.appendChild(g.serializeNode(m.text(v,p)))})}}else n.someProp("transformPastedHTML",h=>{t=h(t,n)}),o=NW(t),rd&&CW(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||mi.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!TW.test(p.parentNode.nodeName)?{ignore:!0}:null}})),u)a=AW(oT(a,+u[1],+u[2]),u[4]);else if(a=J.maxOpen(SW(a.content,s),!0),a.openStart||a.openEnd){let h=0,p=0;for(let m=a.content.firstChild;h<a.openStart&&!m.type.spec.isolating;h++,m=m.firstChild);for(let m=a.content.lastChild;p<a.openEnd&&!m.type.spec.isolating;p++,m=m.lastChild);a=oT(a,h,p)}return n.someProp("transformPasted",h=>{a=h(a,n,l)}),a}const TW=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function SW(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&LP(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=FP(o[o.length-1],i.length));let u=VP(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return U.from(o)}return n}function VP(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,U.from(n));return n}function LP(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=LP(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(U.from(VP(t,n,s+1))))}}function FP(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,FP(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(U.empty,!0);return n.copy(t.append(r))}function lv(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=lv(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(U.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function oT(n,e,t){return e<n.openStart&&(n=new J(lv(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new J(lv(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const BP={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let aT=null;function UP(){return aT||(aT=document.implementation.createHTMLDocument("title"))}let Xg=null;function IW(n){let e=window.trustedTypes;return e?(Xg||(Xg=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Xg.createHTML(n)):n}function NW(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=UP().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&BP[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=IW(n),s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function CW(n){let e=n.querySelectorAll(Wt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function AW(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=U.from(l.create(r[a+1],s)),i++,o++}return new J(s,i,o)}const an={},ln={},RW={touchstart:!0,touchmove:!0};class PW{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function DW(n){for(let e in an){let t=an[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{OW(n,r)&&!Rw(n,r)&&(n.editable||!(r.type in ln))&&t(n,r)},RW[e]?{passive:!0}:void 0)}on&&n.dom.addEventListener("input",()=>null),cv(n)}function ei(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function MW(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function cv(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Rw(n,r))})}function Rw(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function OW(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function jW(n,e){!Rw(n,e)&&an[e.type]&&(n.editable||!(e.type in ln))&&an[e.type](n,e)}ln.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!zP(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(is&&Wt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),ml&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,no(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||bW(n,t)?t.preventDefault():ei(n,"key")};ln.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};ln.keypress=(n,e)=>{let t=e;if(zP(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Fn&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ue)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode),i=()=>n.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,s,i))&&n.dispatch(i()),t.preventDefault()}};function km(n){return{left:n.clientX,top:n.clientY}}function VW(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Pw(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Ga(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function LW(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&se.isSelectable(r)?(Ga(n,new se(t)),!0):!1}function FW(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof se&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(se.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Ga(n,se.create(n.state.doc,s)),!0):!1}function BW(n,e,t,r,s){return Pw(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?FW(n,t):LW(n,t))}function UW(n,e,t,r){return Pw(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function $W(n,e,t,r){return Pw(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||zW(n,t,r)}function zW(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Ga(n,ue.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Ga(n,ue.create(r,a+1,a+1+o.content.size));else if(se.isSelectable(o))Ga(n,se.create(r,a));else continue;return!0}}function Dw(n){return Hf(n)}const $P=Fn?"metaKey":"ctrlKey";an.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Dw(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&VW(t,n.input.lastClick)&&!t[$P]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i,button:t.button};let o=n.posAtCoords(km(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new WW(n,o,t,!!r)):(i=="doubleClick"?UW:$W)(n,o.pos,o.inside,t)?t.preventDefault():ei(n,"pointer"))};class WW{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[$P],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof se&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Yn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ei(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>us(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(km(e))),this.updateAllowDefault(e),this.allowDefault||!t?ei(this.view,"pointer"):BW(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||on&&this.mightDrag&&!this.mightDrag.node.isAtom||Wt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ga(this.view,pe.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):ei(this.view,"pointer")}move(e){this.updateAllowDefault(e),ei(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}an.touchstart=n=>{n.input.lastTouch=Date.now(),Dw(n),ei(n,"pointer")};an.touchmove=n=>{n.input.lastTouch=Date.now(),ei(n,"pointer")};an.contextmenu=n=>Dw(n);function zP(n,e){return n.composing?!0:on&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const HW=is?5e3:-1;ln.compositionstart=ln.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof ue&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Hf(n,!0),n.markCursor=null;else if(Hf(n,!e.selection.empty),Yn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}WP(n,HW)};ln.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,WP(n,20))};function WP(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Hf(n),e))}function HP(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=KW());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function qW(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=L7(e.focusNode,e.focusOffset),r=F7(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function KW(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Hf(n,e=!1){if(!(is&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),HP(n),e||n.docView&&n.docView.dirty){let t=Nw(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function GW(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Su=xn&&gi<15||ml&&W7<604;an.copy=ln.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=Su?null:t.clipboardData,o=r.content(),{dom:a,text:l}=Aw(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):GW(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function QW(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function JW(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Iu(n,r.value,null,s,e):Iu(n,r.textContent,r.innerHTML,s,e)},50)}function Iu(n,e,t,r,s){let i=jP(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||J.empty)))return!0;if(!i)return!1;let o=QW(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function qP(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}ln.paste=(n,e)=>{let t=e;if(n.composing&&!is)return;let r=Su?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Iu(n,qP(r),r.getData("text/html"),s,t)?t.preventDefault():JW(n,t)};class KP{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const YW=Fn?"altKey":"ctrlKey";function GP(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[YW]}an.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(km(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof se?s.to-1:s.to))){if(r&&r.mightDrag)o=se.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let h=n.docView.nearestDesc(t.target,!0);h&&h.node.type.spec.draggable&&h!=n.docView&&(o=se.create(n.state.doc,h.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=Aw(n,a);(!t.dataTransfer.files.length||!Wt||wP>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Su?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Su||t.dataTransfer.setData("text/plain",c),n.dragging=new KP(u,GP(n,t),o)};an.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};ln.dragover=ln.dragenter=(n,e)=>e.preventDefault();ln.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(km(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",g=>{o=g(o,n,!1)}):o=jP(n,qP(t.dataTransfer),Su?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&GP(n,t));if(n.someProp("handleDrop",g=>g(n,t,o||J.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?dP(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:g}=r;g?g.replace(c):c.deleteSelection()}let u=c.mapping.map(l),h=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=c.doc;if(h?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(p))return;let m=c.doc.resolve(u);if(h&&se.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new se(m));else{let g=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,x,_,b)=>g=b),c.setSelection(Cw(n,m,c.doc.resolve(g)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};an.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&us(n)},20))};an.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};an.beforeinput=(n,e)=>{if(Wt&&is&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,no(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in ln)an[n]=ln[n];function Nu(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class qf{constructor(e,t){this.toDOM=e,this.spec=t||wo,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new Cn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof qf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Nu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class vi{constructor(e,t){this.attrs=e,this.spec=t||wo}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Cn(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof vi&&Nu(this.attrs,e.attrs)&&Nu(this.spec,e.spec)}static is(e){return e.type instanceof vi}destroy(){}}class Mw{constructor(e,t){this.attrs=e,this.spec=t||wo}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Cn(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof Mw&&Nu(this.attrs,e.attrs)&&Nu(this.spec,e.spec)}destroy(){}}class Cn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Cn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Cn(e,e,new qf(t,r))}static inline(e,t,r,s){return new Cn(e,t,new vi(r,s))}static node(e,t,r,s){return new Cn(e,t,new Mw(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof vi}get widget(){return this.type instanceof qf}}const xa=[],wo={};class st{constructor(e,t){this.local=e.length?e:xa,this.children=t.length?t:xa}static create(e,t){return t.length?Kf(t,e,0,wo):Ut}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==Ut||e.maps.length==0?this:this.mapInner(e,t,0,0,r||wo)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?XW(this.children,o||[],e,t,r,s,i):o?new st(o.sort(_o),xa):Ut}add(e,t){return t.length?this==Ut?st.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=JP(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,Kf(u,a,c+1,wo)),i+=3}});let o=QP(i?YP(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new st(o.length?this.local.concat(o).sort(_o):this.local,s||this.children)}remove(e){return e.length==0||this==Ut?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let u=0,h;u<e.length;u++)(h=e[u])&&h.from>a&&h.to<l&&(e[u]=null,(o||(o=[])).push(h));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=Ut?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new st(s,r):Ut}forChild(e,t){if(this==Ut)return this;if(t.isLeaf)return st.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof vi){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new st(s.sort(_o),xa);return r?new qs([a,r]):a}return r||Ut}eq(e){if(this==e)return!0;if(!(e instanceof st)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Ow(this.localsInner(e))}localsInner(e){if(this==Ut)return xa;if(e.inlineContent||!this.local.some(vi.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof vi||t.push(this.local[r]);return t}forEachSet(e){e(this)}}st.empty=new st([],[]);st.removeOverlap=Ow;const Ut=st.empty;class qs{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,wo));return qs.from(r)}forChild(e,t){if(t.isLeaf)return st.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=Ut&&(i instanceof qs?r=r.concat(i.members):r.push(i))}return qs.from(r)}eq(e){if(!(e instanceof qs)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?Ow(r?t:t.sort(_o)):xa}static from(e){switch(e.length){case 0:return Ut;case 1:return e[0];default:return new qs(e.every(t=>t instanceof st)?e:e.reduce((t,r)=>t.concat(r instanceof st?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function XW(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let h=0;t.maps[c].forEach((p,m,g,v)=>{let x=v-g-(m-p);for(let _=0;_<a.length;_+=3){let b=a[_+1];if(b<0||p>b+u-h)continue;let T=a[_]+u-h;m>=T?a[_+1]=p<=T?-2:-1:p>=u&&x&&(a[_]+=x,a[_+1]+=x)}h+=x}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),h=u-s;if(h<0||h>=r.content.size){l=!0;continue}let p=t.map(n[c+1]+i,-1),m=p-s,{index:g,offset:v}=r.content.findIndex(h),x=r.maybeChild(g);if(x&&v==h&&v+x.nodeSize==m){let _=a[c+2].mapInner(t,x,u+1,n[c]+i+1,o);_!=Ut?(a[c]=h,a[c+1]=m,a[c+2]=_):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=ZW(a,n,e,t,s,i,o),u=Kf(c,r,0,o);e=u.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,p=0;h<u.children.length;h+=3){let m=u.children[h];for(;p<a.length&&a[p]<m;)p+=3;a.splice(p,0,u.children[h],u.children[h+1],u.children[h+2])}}return new st(e.sort(_o),a)}function QP(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new Cn(s.from+e,s.to+e,s.type))}return t}function ZW(n,e,t,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let h=l.local[u].map(r,s,c);h?t.push(h):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function JP(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function YP(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Kf(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=JP(n,a,l+t);if(c){i=!0;let u=Kf(c,a,t+l+1,r);u!=Ut&&s.push(l,l+a.nodeSize,u)}});let o=QP(i?YP(n):n,-t).sort(_o);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new st(o,s):Ut}function _o(n,e){return n.from-e.from||n.to-e.to}function Ow(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),lT(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),lT(e,s,r.copy(i.from,r.to)));break}}}return e}function lT(n,e,t){for(;e<n.length&&_o(t,n[e])>0;)e++;n.splice(e,0,t)}function Zg(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ut&&e.push(r)}),n.cursorWrapper&&e.push(st.create(n.state.doc,[n.cursorWrapper.deco])),qs.from(e)}const eH={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},tH=xn&&gi<=11;class nH{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class rH{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new nH,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);xn&&gi<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),tH&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,eH)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(eT(this.view)){if(this.suppressingSelectionUpdates)return us(this.view);if(xn&&gi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&zo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=pl(i))t.add(i);for(let i=e.anchorNode;i;i=pl(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&eT(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let h=this.registerMutation(t[u],l);h&&(i=i<0?h.from:Math.min(h.from,i),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(a=!0))}if(Yn&&l.length){let u=l.filter(h=>h.nodeName=="BR");if(u.length==2){let[h,p]=u;h.parentNode&&h.parentNode.parentNode==p.parentNode?p.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let p of u){let m=p.parentNode;m&&m.nodeName=="LI"&&(!h||oH(e,h)!=m)&&p.remove()}}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&_m(r)&&(c=Nw(e))&&c.eq(pe.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,us(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),sH(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||us(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let h=e.addedNodes[u];t.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(xn&&gi<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:h,nextSibling:p}=e.addedNodes[u];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(i=p)}let o=s&&s.parentNode==e.target?Rt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?Rt(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let cT=new WeakMap,uT=!1;function sH(n){if(!cT.has(n)&&(cT.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Yn,uT)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),uT=!0}}function dT(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return zo(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function iH(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return dT(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?dT(n,t):null}function oH(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function aH(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],_m(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Wt&&n.input.lastKeyCode===8)for(let x=i;x>s;x--){let _=r.childNodes[x-1],b=_.pmViewDesc;if(_.nodeName=="BR"&&!b){i=x;break}if(!b||b.size)break}let h=n.state.doc,p=n.someProp("domParser")||mi.fromSchema(n.state.schema),m=h.resolve(o),g=null,v=p.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:lH,context:m});if(c&&c[0].pos!=null){let x=c[0].pos,_=c[1]&&c[1].pos;_==null&&(_=x),g={anchor:x+o,head:_+o}}return{doc:v,sel:g,from:o,to:a}}function lH(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(on&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||on&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const cH=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function uH(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let k=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,E=Nw(n,k);if(E&&!n.state.selection.eq(E)){if(Wt&&is&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",C=>C(n,no(13,"Enter"))))return;let S=n.state.tr.setSelection(E);k=="pointer"?S.setMeta("pointer",!0):k=="key"&&S.scrollIntoView(),i&&S.setMeta("composition",i),n.dispatch(S)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=aH(n,e,t),u=n.state.doc,h=u.slice(c.from,c.to),p,m;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(p=n.state.selection.to,m="end"):(p=n.state.selection.from,m="start"),n.input.lastKeyCode=null;let g=fH(h.content,c.doc.content,c.from,p,m);if(g&&n.input.domChangeCount++,(ml&&n.input.lastIOSEnter>Date.now()-225||is)&&s.some(k=>k.nodeType==1&&!cH.test(k.nodeName))&&(!g||g.endA>=g.endB)&&n.someProp("handleKeyDown",k=>k(n,no(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!g)if(r&&l instanceof ue&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))g={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let k=hT(n,n.state.doc,c.sel);if(k&&!k.eq(n.state.selection)){let E=n.state.tr.setSelection(k);i&&E.setMeta("composition",i),n.dispatch(E)}}return}n.state.selection.from<n.state.selection.to&&g.start==g.endB&&n.state.selection instanceof ue&&(g.start>n.state.selection.from&&g.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?g.start=n.state.selection.from:g.endA<n.state.selection.to&&g.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(g.endB+=n.state.selection.to-g.endA,g.endA=n.state.selection.to)),xn&&gi<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>c.from&&c.doc.textBetween(g.start-c.from-1,g.start-c.from+1)==" "&&(g.start--,g.endA--,g.endB--);let v=c.doc.resolveNoCache(g.start-c.from),x=c.doc.resolveNoCache(g.endB-c.from),_=u.resolve(g.start),b=v.sameParent(x)&&v.parent.inlineContent&&_.end()>=g.endA;if((ml&&n.input.lastIOSEnter>Date.now()-225&&(!b||s.some(k=>k.nodeName=="DIV"||k.nodeName=="P"))||!b&&v.pos<c.doc.content.size&&(!v.sameParent(x)||!v.parent.inlineContent)&&v.pos<x.pos&&!/\S/.test(c.doc.textBetween(v.pos,x.pos,"","")))&&n.someProp("handleKeyDown",k=>k(n,no(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>g.start&&hH(u,g.start,g.endA,v,x)&&n.someProp("handleKeyDown",k=>k(n,no(8,"Backspace")))){is&&Wt&&n.domObserver.suppressSelectionUpdates();return}Wt&&g.endB==g.start&&(n.input.lastChromeDelete=Date.now()),is&&!b&&v.start()!=x.start()&&x.parentOffset==0&&v.depth==x.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==g.endA&&(g.endB-=2,x=c.doc.resolveNoCache(g.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(k){return k(n,no(13,"Enter"))})},20));let T=g.start,A=g.endA,R=k=>{let E=k||n.state.tr.replace(T,A,c.doc.slice(g.start-c.from,g.endB-c.from));if(c.sel){let S=hT(n,E.doc,c.sel);S&&!(Wt&&n.composing&&S.empty&&(g.start!=g.endB||n.input.lastChromeDelete<Date.now()-100)&&(S.head==T||S.head==E.mapping.map(A)-1)||xn&&S.empty&&S.head==T)&&E.setSelection(S)}return i&&E.setMeta("composition",i),E.scrollIntoView()},D;if(b)if(v.pos==x.pos){xn&&gi<=11&&v.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>us(n),20));let k=R(n.state.tr.delete(T,A)),E=u.resolve(g.start).marksAcross(u.resolve(g.endA));E&&k.ensureMarks(E),n.dispatch(k)}else if(g.endA==g.endB&&(D=dH(v.parent.content.cut(v.parentOffset,x.parentOffset),_.parent.content.cut(_.parentOffset,g.endA-_.start())))){let k=R(n.state.tr);D.type=="add"?k.addMark(T,A,D.mark):k.removeMark(T,A,D.mark),n.dispatch(k)}else if(v.parent.child(v.index()).isText&&v.index()==x.index()-(x.textOffset?0:1)){let k=v.parent.textBetween(v.parentOffset,x.parentOffset),E=()=>R(n.state.tr.insertText(k,T,A));n.someProp("handleTextInput",S=>S(n,T,A,k,E))||n.dispatch(E())}else n.dispatch(R());else n.dispatch(R())}function hT(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Cw(n,e.resolve(t.anchor),e.resolve(t.head))}function dH(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(U.from(c).eq(n))return{mark:a,type:o}}function hH(n,e,t,r,s){if(t-e<=s.pos-r.pos||ey(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(ey(i,!0,!0));return!o.parent.isTextblock||o.pos>t||ey(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function ey(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function fH(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&fT(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&fT(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function fT(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class XP{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new PW,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(vT),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=gT(this),mT(this),this.nodeViews=yT(this),this.docView=Gb(this.state.doc,pT(this),Zg(this),this.dom,this),this.domObserver=new rH(this,(r,s,i,o)=>uH(this,r,s,i,o)),this.domObserver.start(),DW(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&cv(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(vT),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(HP(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let m=yT(this);mH(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&cv(this),this.editable=gT(this),mT(this);let l=Zg(this),c=pT(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",h=i||!this.docView.matchesNode(e.doc,c,l);(h||!e.selection.eq(s.selection))&&(o=!0);let p=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&K7(this);if(o){this.domObserver.stop();let m=h&&(xn||Wt)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&pH(s.selection,e.selection);if(h){let g=Wt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=qW(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Gb(e.doc,c,l,this.dom,this)),g&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&yW(this))?us(this,m):(DP(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():p&&G7(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof se){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&$b(this,t.getBoundingClientRect(),e)}else $b(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new KP(e.slice,e.move,s<0?void 0:se.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(xn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&Q7(this.dom),us(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return eW(this,e)}coordsAtPos(e,t=1){return TP(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return iW(this,t||this.state,e)}pasteHTML(e,t){return Iu(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Iu(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return Aw(this,e)}destroy(){this.docView&&(MW(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Zg(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,j7())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return jW(this,e)}domSelectionRange(){let e=this.domSelection();return e?on&&this.root.nodeType===11&&U7(this.dom.ownerDocument)==this.dom&&iH(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}XP.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function pT(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Cn.node(0,n.state.doc.content.size,e)]}function mT(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Cn.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function gT(n){return!n.someProp("editable",e=>e(n.state)===!1)}function pH(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function yT(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function mH(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function vT(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ii={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Gf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},gH=typeof navigator<"u"&&/Mac/.test(navigator.platform),yH=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Pt=0;Pt<10;Pt++)Ii[48+Pt]=Ii[96+Pt]=String(Pt);for(var Pt=1;Pt<=24;Pt++)Ii[Pt+111]="F"+Pt;for(var Pt=65;Pt<=90;Pt++)Ii[Pt]=String.fromCharCode(Pt+32),Gf[Pt]=String.fromCharCode(Pt);for(var ty in Ii)Gf.hasOwnProperty(ty)||(Gf[ty]=Ii[ty]);function vH(n){var e=gH&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||yH&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Gf:Ii)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const xH=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),wH=typeof navigator<"u"&&/Win/.test(navigator.platform);function _H(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))xH?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function EH(n){let e=Object.create(null);for(let t in n)e[_H(t)]=n[t];return e}function ny(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function kH(n){return new bt({props:{handleKeyDown:ZP(n)}})}function ZP(n){let e=EH(n);return function(t,r){let s=vH(r),i,o=e[ny(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[ny(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(wH&&r.ctrlKey&&r.altKey)&&(i=Ii[r.keyCode])&&i!=s){let a=e[ny(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const jw=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function e2(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const t2=(n,e,t)=>{let r=e2(n,t);if(!r)return!1;let s=Vw(r);if(!s){let o=r.blockRange(),a=o&&Sl(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(u2(n,s,e,-1))return!0;if(r.parent.content.size==0&&(gl(i,"end")||se.isSelectable(i)))for(let o=r.depth;;o--){let a=xm(n.doc,r.before(o),r.after(o),J.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(gl(i,"end")?pe.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):se.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},bH=(n,e,t)=>{let r=e2(n,t);if(!r)return!1;let s=Vw(r);return s?n2(n,s,e):!1},TH=(n,e,t)=>{let r=s2(n,t);if(!r)return!1;let s=Lw(r);return s?n2(n,s,e):!1};function n2(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=xm(n.doc,i,l,J.empty);if(!c||c.from!=i||c instanceof xt&&c.slice.size>=l-i)return!1;if(t){let u=n.tr.step(c);u.setSelection(ue.create(u.doc,i)),t(u.scrollIntoView())}return!0}function gl(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const r2=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=Vw(r)}let o=i&&i.nodeBefore;return!o||!se.isSelectable(o)?!1:(e&&e(n.tr.setSelection(se.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function Vw(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function s2(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const i2=(n,e,t)=>{let r=s2(n,t);if(!r)return!1;let s=Lw(r);if(!s)return!1;let i=s.nodeAfter;if(u2(n,s,e,1))return!0;if(r.parent.content.size==0&&(gl(i,"start")||se.isSelectable(i))){let o=xm(n.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(gl(i,"start")?pe.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):se.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},o2=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=Lw(r)}let o=i&&i.nodeAfter;return!o||!se.isSelectable(o)?!1:(e&&e(n.tr.setSelection(se.create(n.doc,i.pos)).scrollIntoView()),!0)};function Lw(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const SH=(n,e)=>{let t=n.selection,r=t instanceof se,s;if(r){if(t.node.isTextblock||!Li(n.doc,t.from))return!1;s=t.from}else if(s=vm(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(se.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},IH=(n,e)=>{let t=n.selection,r;if(t instanceof se){if(t.node.isTextblock||!Li(n.doc,t.to))return!1;r=t.to}else if(r=vm(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},NH=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&Sl(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},a2=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Fw(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const CH=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=Fw(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(pe.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},l2=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof Rn||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=Fw(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(ue.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},c2=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(cs(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&Sl(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function AH(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof se&&e.selection.node.isBlock)return!r.parentOffset||!cs(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let m=r.depth;;m--)if(r.node(m).isBlock){l=r.end(m)==r.pos+(r.depth-m),c=r.start(m)==r.pos-(r.depth-m),a=Fw(r.node(m-1).contentMatchAt(r.indexAfter(m-1))),i.unshift(l&&a?{type:a}:null),o=m;break}else{if(m==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof ue||e.selection instanceof Rn)&&u.deleteSelection();let h=u.mapping.map(r.pos),p=cs(u.doc,h,i.length,i);if(p||(i[0]=a?{type:a}:null,p=cs(u.doc,h,i.length,i)),!p)return!1;if(u.split(h,i.length,i),!l&&c&&r.node(o).type!=a){let m=u.mapping.map(r.before(o)),g=u.doc.resolve(m);a&&r.node(o-1).canReplaceWith(g.index(),g.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(o)),a)}return t&&t(u.scrollIntoView()),!0}}const RH=AH(),PH=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(se.create(n.doc,s))),!0)};function DH(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||Li(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function u2(n,e,t,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&DH(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(t){let m=e.pos+i.nodeSize,g=U.empty;for(let _=o.length-1;_>=0;_--)g=U.from(o[_].create(null,g));g=U.from(s.copy(g));let v=n.tr.step(new _t(e.pos-1,m,e.pos,m,new J(g,1,0),o.length,!0)),x=v.doc.resolve(m+2*o.length);x.nodeAfter&&x.nodeAfter.type==s.type&&Li(v.doc,x.pos)&&v.join(x.pos),t(v.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:pe.findFrom(e,1),h=u&&u.$from.blockRange(u.$to),p=h&&Sl(h);if(p!=null&&p>=e.depth)return t&&t(n.tr.lift(h,p).scrollIntoView()),!0;if(c&&gl(i,"start",!0)&&gl(s,"end")){let m=s,g=[];for(;g.push(m),!m.isTextblock;)m=m.lastChild;let v=i,x=1;for(;!v.isTextblock;v=v.firstChild)x++;if(m.canReplace(m.childCount,m.childCount,v.content)){if(t){let _=U.empty;for(let T=g.length-1;T>=0;T--)_=U.from(g[T].copy(_));let b=n.tr.step(new _t(e.pos-g.length,e.pos+i.nodeSize,e.pos+x,e.pos+i.nodeSize-x,new J(_,g.length,0),0,!0));t(b.scrollIntoView())}return!0}}return!1}function d2(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(ue.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const MH=d2(-1),OH=d2(1);function jH(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&Tw(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function xT(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let u=t.doc.resolve(c),h=u.index();s=u.parent.canReplaceWith(h,h+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}function Bw(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}Bw(jw,t2,r2);Bw(jw,i2,o2);Bw(a2,l2,c2,RH);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function VH(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i);if(!o)return!1;let a=r?t.tr:null;return LH(a,o,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function LH(n,e,t,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new Uf(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Uf(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let a=Tw(i,t,r,e);return a?(n&&FH(n,e,a,s,t),!0):!1}function FH(n,e,t,r,s){let i=U.empty;for(let u=t.length-1;u>=0;u--)i=U.from(t[u].type.create(t[u].attrs,i));n.step(new _t(e.start-(r?2:0),e.end,e.start,e.end,new J(i,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==s&&(o=u+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,h=e.endIndex,p=!0;u<h;u++,p=!1)!p&&cs(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function BH(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?UH(e,t,n,i):$H(e,t,i):!0:!1}}function UH(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new _t(i-1,o,i,o,new J(U.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Uf(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=Sl(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return Li(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),e(s.scrollIntoView()),!0}function $H(n,e,t){let r=n.tr,s=t.parent;for(let m=t.end,g=t.endIndex-1,v=t.startIndex;g>v;g--)m-=s.child(g).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?U.empty:U.from(s))))return!1;let h=i.pos,p=h+o.nodeSize;return r.step(new _t(h-(a?1:0),p+(l?1:0),h+1,p-1,new J((a?U.empty:U.from(s.copy(U.empty))).append(l?U.empty:U.from(s.copy(U.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function zH(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=U.from(c?n.create():null),h=new J(U.from(n.create(null,U.from(a.type.create(null,u)))),c?3:1,0),p=i.start,m=i.end;t(e.tr.step(new _t(p-(c?3:1),m,p,m,h,1,!0)).scrollIntoView())}return!0}}function bm(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}class Tm{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const h=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(p=>p===!0)),h={...Object.fromEntries(Object.entries(r).map(([p,m])=>[p,(...v)=>{const x=this.buildProps(c,t),_=m(...v)(x);return a.push(_),h}])),run:u};return h}createCan(e){const{rawCommands:t,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:bm({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class WH{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}once(e,t){const r=(...s)=>{this.off(e,r),t.apply(this,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function Z(n,e,t){return n.config[e]===void 0&&n.parent?Z(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Z(n.parent,e,t):null}):n.config[e]}function Sm(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function h2(n){const e=[],{nodeExtensions:t,markExtensions:r}=Sm(n),s=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=Z(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(h=>{Object.entries(u.attributes).forEach(([p,m])=>{e.push({type:h,name:p,attribute:{...i,...m}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=Z(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,h])=>{const p={...i,...h};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:o.name,name:u,attribute:p})})}),e}function kt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function pt(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[h,p]=u.split(":").map(m=>m.trim());c.set(h,p)}),a.forEach(u=>{const[h,p]=u.split(":").map(m=>m.trim());c.set(h,p)}),r[s]=Array.from(c.entries()).map(([u,h])=>`${u}: ${h}`).join("; ")}else r[s]=i}),r},{})}function uv(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>pt(t,r),{})}function f2(n){return typeof n=="function"}function me(n,e=void 0,...t){return f2(n)?e?n.bind(e)(...t):n(...t):n}function HH(n={}){return Object.keys(n).length===0&&n.constructor===Object}function qH(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function wT(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):qH(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function _T(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&HH(t)?!1:t!=null))}function KH(n,e){var t;const r=h2(n),{nodeExtensions:s,markExtensions:i}=Sm(n),o=(t=s.find(c=>Z(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(_=>_.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},p=n.reduce((_,b)=>{const T=Z(b,"extendNodeSchema",h);return{..._,...T?T(c):{}}},{}),m=_T({...p,content:me(Z(c,"content",h)),marks:me(Z(c,"marks",h)),group:me(Z(c,"group",h)),inline:me(Z(c,"inline",h)),atom:me(Z(c,"atom",h)),selectable:me(Z(c,"selectable",h)),draggable:me(Z(c,"draggable",h)),code:me(Z(c,"code",h)),whitespace:me(Z(c,"whitespace",h)),linebreakReplacement:me(Z(c,"linebreakReplacement",h)),defining:me(Z(c,"defining",h)),isolating:me(Z(c,"isolating",h)),attrs:Object.fromEntries(u.map(_=>{var b;return[_.name,{default:(b=_==null?void 0:_.attribute)===null||b===void 0?void 0:b.default}]}))}),g=me(Z(c,"parseHTML",h));g&&(m.parseDOM=g.map(_=>wT(_,u)));const v=Z(c,"renderHTML",h);v&&(m.toDOM=_=>v({node:_,HTMLAttributes:uv(_,u)}));const x=Z(c,"renderText",h);return x&&(m.toText=x),[c.name,m]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(x=>x.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},p=n.reduce((x,_)=>{const b=Z(_,"extendMarkSchema",h);return{...x,...b?b(c):{}}},{}),m=_T({...p,inclusive:me(Z(c,"inclusive",h)),excludes:me(Z(c,"excludes",h)),group:me(Z(c,"group",h)),spanning:me(Z(c,"spanning",h)),code:me(Z(c,"code",h)),attrs:Object.fromEntries(u.map(x=>{var _;return[x.name,{default:(_=x==null?void 0:x.attribute)===null||_===void 0?void 0:_.default}]}))}),g=me(Z(c,"parseHTML",h));g&&(m.parseDOM=g.map(x=>wT(x,u)));const v=Z(c,"renderHTML",h);return v&&(m.toDOM=x=>v({mark:x,HTMLAttributes:uv(x,u)})),[c.name,m]}));return new eP({topNode:o,nodes:a,marks:l})}function ry(n,e){return e.nodes[n]||e.marks[n]||null}function ET(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function Uw(n,e){const t=ea.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}const GH=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-i))}),t};function $w(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Im{constructor(e){this.find=e.find,this.handler=e.handler}}const QH=(n,e)=>{if($w(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Xd(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let u=!1;const h=GH(c)+i;return o.forEach(p=>{if(u)return;const m=QH(h,p.find);if(!m)return;const g=l.state.tr,v=bm({state:l.state,transaction:g}),x={from:r-(m[0].length-i.length),to:s},{commands:_,chain:b,can:T}=new Tm({editor:t,state:v});p.handler({state:v,range:x,match:m,commands:_,chain:b,can:T})===null||!g.steps.length||(g.setMeta(a,{transform:g,from:r,to:s,text:i}),l.dispatch(g),u=!0)}),u}function JH(n){const{editor:e,rules:t}=n,r=new bt({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Uw(U.from(u),o.schema);const{from:h}=l,p=h+u.length;Xd({editor:e,from:h,to:p,text:u,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return Xd({editor:e,from:i,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&Xd({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?Xd({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function YH(n){return Object.prototype.toString.call(n).slice(8,-1)}function Zd(n){return YH(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Nm(n,e){const t={...n};return Zd(n)&&Zd(e)&&Object.keys(e).forEach(r=>{Zd(e[r])&&Zd(n[r])?t[r]=Nm(n[r],e[r]):t[r]=e[r]}),t}class gr{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=me(Z(this,"addOptions",{name:this.name}))),this.storage=me(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new gr(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Nm(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new gr(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=me(Z(t,"addOptions",{name:t.name})),t.storage=me(Z(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}function XH(n){return typeof n=="number"}class ZH{constructor(e){this.find=e.find,this.handler=e.handler}}const e8=(n,e,t)=>{if($w(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function t8(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new Tm({editor:e,state:t}),h=[];return t.doc.nodesBetween(r,s,(m,g)=>{if(!m.isTextblock||m.type.spec.code)return;const v=Math.max(r,g),x=Math.min(s,g+m.content.size),_=m.textBetween(v-g,x-g,void 0,"");e8(_,i.find,o).forEach(T=>{if(T.index===void 0)return;const A=v+T.index+1,R=A+T[0].length,D={from:t.tr.mapping.map(A),to:t.tr.mapping.map(R)},k=i.handler({state:t,range:D,match:T,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});h.push(k)})}),h.every(m=>m!==null)}let eh=null;const n8=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function r8(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:h,to:p,rule:m,pasteEvt:g})=>{const v=u.tr,x=bm({state:u,transaction:v});if(!(!t8({editor:e,state:x,from:Math.max(h-1,0),to:p.b-1,rule:m,pasteEvent:g,dropEvent:a})||!v.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return t.map(u=>new bt({view(h){const p=g=>{var v;r=!((v=h.dom.parentElement)===null||v===void 0)&&v.contains(g.target)?h.dom.parentElement:null,r&&(eh=e)},m=()=>{eh&&(eh=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(h,p)=>{if(i=r===h.dom.parentElement,a=p,!i){const m=eh;m!=null&&m.isEditable&&setTimeout(()=>{const g=m.state.selection;g&&m.commands.deleteRange({from:g.from,to:g.to})},10)}return!1},paste:(h,p)=>{var m;const g=(m=p.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return o=p,s=!!(g!=null&&g.includes("data-pm-slice")),!1}}},appendTransaction:(h,p,m)=>{const g=h[0],v=g.getMeta("uiEvent")==="paste"&&!s,x=g.getMeta("uiEvent")==="drop"&&!i,_=g.getMeta("applyPasteRules"),b=!!_;if(!v&&!x&&!b)return;if(b){let{text:R}=_;typeof R=="string"?R=R:R=Uw(U.from(R),m.schema);const{from:D}=_,k=D+R.length,E=n8(R);return l({rule:u,state:m,from:D,to:{b:k},pasteEvt:E})}const T=p.doc.content.findDiffStart(m.doc.content),A=p.doc.content.findDiffEnd(m.doc.content);if(!(!XH(T)||!A||T===A.b))return l({rule:u,state:m,from:T,to:A,pasteEvt:o})}}))}function s8(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class Oa{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Oa.resolve(e),this.schema=KH(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Oa.sort(Oa.flatten(e)),r=s8(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=Z(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=Z(r,"priority")||100,o=Z(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:ry(t.name,this.schema)},s=Z(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=Oa.sort([...this.extensions].reverse()),r=[],s=[],i=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:ry(o.name,this.schema)},l=[],c=Z(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&Z(o,"exitable",a)&&(u.ArrowRight=()=>gr.handleExit({editor:e,mark:o})),c){const v=Object.fromEntries(Object.entries(c()).map(([x,_])=>[x,()=>_({editor:e})]));u={...u,...v}}const h=kH(u);l.push(h);const p=Z(o,"addInputRules",a);ET(o,e.options.enableInputRules)&&p&&r.push(...p());const m=Z(o,"addPasteRules",a);ET(o,e.options.enablePasteRules)&&m&&s.push(...m());const g=Z(o,"addProseMirrorPlugins",a);if(g){const v=g();l.push(...v)}return l}).flat();return[JH({editor:e,rules:r}),...r8({editor:e,rules:s}),...i]}get attributes(){return h2(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Sm(this.extensions);return Object.fromEntries(t.filter(r=>!!Z(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:kt(r.name,this.schema)},o=Z(r,"addNodeView",i);if(!o)return[];const a=(l,c,u,h,p)=>{const m=uv(l,s);return o()({node:l,view:c,getPos:u,decorations:h,innerDecorations:p,editor:e,extension:r,HTMLAttributes:m})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:ry(e.name,this.schema)};e.type==="mark"&&(!((t=me(Z(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=Z(e,"onBeforeCreate",r),i=Z(e,"onCreate",r),o=Z(e,"onUpdate",r),a=Z(e,"onSelectionUpdate",r),l=Z(e,"onTransaction",r),c=Z(e,"onFocus",r),u=Z(e,"onBlur",r),h=Z(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}}class qt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=me(Z(this,"addOptions",{name:this.name}))),this.storage=me(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new qt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Nm(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new qt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=me(Z(t,"addOptions",{name:t.name})),t.storage=me(Z(t,"addStorage",{name:t.name,options:t.options})),t}}function p2(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="";return n.nodesBetween(r,s,(l,c,u,h)=>{var p;l.isBlock&&c>r&&(a+=i);const m=o==null?void 0:o[l.type.name];if(m)return u&&(a+=m({node:l,pos:c,parent:u,index:h,range:e})),!1;l.isText&&(a+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(r,c)-c,s-c))}),a}function m2(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const i8=qt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new bt({key:new En("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=m2(t);return p2(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),o8=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),a8=(n=!1)=>({commands:e})=>e.setContent("",n),l8=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,h=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),m=h.blockRange(p);if(!m)return;const g=Sl(m);if(a.type.isTextblock){const{defaultType:v}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(m.start,v)}(g||g===0)&&e.lift(m,g)})}),!0},c8=n=>e=>n(e),u8=()=>({state:n,dispatch:e})=>l2(n,e),d8=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new ue(r.doc.resolve(Math.max(o-1,0)))),!0},h8=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},f8=n=>({tr:e,state:t,dispatch:r})=>{const s=kt(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},p8=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},m8=()=>({state:n,dispatch:e})=>jw(n,e),g8=()=>({commands:n})=>n.keyboardShortcut("Enter"),y8=()=>({state:n,dispatch:e})=>CH(n,e);function Qf(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:$w(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function g2(n,e,t={}){return n.find(r=>r.type===e&&Qf(Object.fromEntries(Object.keys(t).map(s=>[s,r.attrs[s]])),t))}function kT(n,e,t={}){return!!g2(n,e,t)}function zw(n,e,t){var r;if(!n||!e)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(t=t||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!g2([...s.node.marks],e,t)))return;let o=s.index,a=n.start()+s.offset,l=o+1,c=a+s.node.nodeSize;for(;o>0&&kT([...n.parent.child(o-1).marks],e,t);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&kT([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Bi(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const v8=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=Bi(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(s){const h=zw(l,i,e);if(h&&h.from<=c&&h.to>=u){const p=ue.create(o,h.from,h.to);t.setSelection(p)}}return!0},x8=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function y2(n){return n instanceof ue}function co(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function v2(n,e=null){if(!e)return null;const t=pe.atStart(n),r=pe.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?ue.create(n,co(0,s,i),co(n.content.size,s,i)):ue.create(n,co(e,s,i),co(e,s,i))}function w8(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Ww(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const _8=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(Ww()||w8())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!y2(t.state.selection))return o(),!0;const a=v2(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},E8=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),k8=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),x2=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&x2(r)}return n};function th(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return x2(t)}function Cu(n,e,t){if(n instanceof pi||n instanceof U)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return U.fromArray(n.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(n);return t.errorOnInvalidContent&&o.check(),o}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),Cu("",e,t)}if(s){if(t.errorOnInvalidContent){let o=!1,a="";const l=new eP({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?mi.fromSchema(l).parseSlice(th(n),t.parseOptions):mi.fromSchema(l).parse(th(n),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=mi.fromSchema(e);return t.slice?i.parseSlice(th(n),t.parseOptions).content:i.parse(th(n),t.parseOptions)}return Cu("",e,t)}function b8(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof xt||s instanceof _t))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(pe.near(n.doc.resolve(o),t))}const T8=n=>!("type"in n),S8=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=x=>{i.emit("contentError",{editor:i,error:x,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{Cu(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(x){l(x)}try{a=Cu(e,i.schema,{parseOptions:c,errorOnInvalidContent:(o=t.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(x){return l(x),!1}let{from:u,to:h}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},p=!0,m=!0;if((T8(a)?a:[a]).forEach(x=>{x.check(),p=p?x.isText&&x.marks.length===0:!1,m=m?x.isBlock:!1}),u===h&&m){const{parent:x}=r.doc.resolve(u);x.isTextblock&&!x.type.spec.code&&!x.childCount&&(u-=1,h+=1)}let v;if(p){if(Array.isArray(e))v=e.map(x=>x.text||"").join("");else if(e instanceof U){let x="";e.forEach(_=>{_.text&&(x+=_.text)}),v=x}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,u,h)}else v=a,r.replaceWith(u,h,v);t.updateSelection&&b8(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:v}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:v})}return!0},I8=()=>({state:n,dispatch:e})=>SH(n,e),N8=()=>({state:n,dispatch:e})=>IH(n,e),C8=()=>({state:n,dispatch:e})=>t2(n,e),A8=()=>({state:n,dispatch:e})=>i2(n,e),R8=()=>({state:n,dispatch:e,tr:t})=>{try{const r=vm(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},P8=()=>({state:n,dispatch:e,tr:t})=>{try{const r=vm(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},D8=()=>({state:n,dispatch:e})=>bH(n,e),M8=()=>({state:n,dispatch:e})=>TH(n,e);function w2(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function O8(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Ww()||w2()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const j8=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=O8(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function Au(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?kt(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(h,p)=>{if(h.isText)return;const m=Math.max(r,p),g=Math.min(s,p+h.nodeSize);a.push({node:h,from:m,to:g})});const l=s-r,c=a.filter(h=>o?o.name===h.node.type.name:!0).filter(h=>Qf(h.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((h,p)=>h+p.to-p.from,0)>=l}const V8=(n,e={})=>({state:t,dispatch:r})=>{const s=kt(n,t.schema);return Au(t,s,e)?NH(t,r):!1},L8=()=>({state:n,dispatch:e})=>c2(n,e),F8=n=>({state:e,dispatch:t})=>{const r=kt(n,e.schema);return BH(r)(e,t)},B8=()=>({state:n,dispatch:e})=>a2(n,e);function Cm(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function bT(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const U8=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Cm(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=kt(n,r.schema)),a==="mark"&&(o=Bi(n,r.schema)),s&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,bT(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(h=>{o===h.type&&t.addMark(u,u+c.nodeSize,o.create(bT(h.attrs,e)))})})}),!0):!1},$8=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),z8=()=>({tr:n,dispatch:e})=>{if(e){const t=new Rn(n.doc);n.setSelection(t)}return!0},W8=()=>({state:n,dispatch:e})=>r2(n,e),H8=()=>({state:n,dispatch:e})=>o2(n,e),q8=()=>({state:n,dispatch:e})=>PH(n,e),K8=()=>({state:n,dispatch:e})=>OH(n,e),G8=()=>({state:n,dispatch:e})=>MH(n,e);function dv(n,e,t={},r={}){return Cu(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const Q8=(n,e=!1,t={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,c;const{doc:u}=i;if(t.preserveWhitespace!=="full"){const h=dv(n,s.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return o&&i.replaceWith(0,u.content.size,h).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function _2(n,e){const t=Bi(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function J8(n,e){const t=new gP(n);return e.forEach(r=>{r.steps.forEach(s=>{t.step(s)})}),t}function Y8(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function X8(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(s,i)=>{t(s)&&r.push({node:s,pos:i})}),r}function Z8(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Hw(n){return e=>Z8(e.$from,n)}function eq(n,e){const t={from:0,to:n.content.size};return p2(n,t,e)}function tq(n,e){const t=kt(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function E2(n,e){const t=Cm(typeof e=="string"?e:e.name,n.schema);return t==="node"?tq(n,e):t==="mark"?_2(n,e):{}}function nq(n,e=JSON.stringify){const t={};return n.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(t,s)?!1:t[s]=!0})}function rq(n){const e=nq(n);return e.length===1?e:e.filter((t,r)=>!e.filter((i,o)=>o!==r).some(i=>t.oldRange.from>=i.oldRange.from&&t.oldRange.to<=i.oldRange.to&&t.newRange.from>=i.newRange.from&&t.newRange.to<=i.newRange.to))}function sq(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((s,i)=>{const o=[];if(s.ranges.length)s.forEach((a,l)=>{o.push({from:a,to:l})});else{const{from:a,to:l}=t[i];if(a===void 0||l===void 0)return;o.push({from:a,to:l})}o.forEach(({from:a,to:l})=>{const c=e.slice(i).map(a,-1),u=e.slice(i).map(l),h=e.invert().map(c,-1),p=e.invert().map(u);r.push({oldRange:{from:h,to:p},newRange:{from:c,to:u}})})}),rq(r)}function qw(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n),o=zw(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function Oh(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function hv(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?Bi(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(h=>i?i.name===h.type.name:!0).find(h=>Qf(h.attrs,t,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:h,$to:p})=>{const m=h.pos,g=p.pos;n.doc.nodesBetween(m,g,(v,x)=>{if(!v.isText&&!v.marks.length)return;const _=Math.max(m,x),b=Math.min(g,x+v.nodeSize),T=b-_;o+=T,a.push(...v.marks.map(A=>({mark:A,from:_,to:b})))})}),o===0)return!1;const l=a.filter(h=>i?i.name===h.mark.type.name:!0).filter(h=>Qf(h.mark.attrs,t,{strict:!1})).reduce((h,p)=>h+p.to-p.from,0),c=a.filter(h=>i?h.mark.type!==i&&h.mark.type.excludes(i):!0).reduce((h,p)=>h+p.to-p.from,0);return(l>0?l+c:l)>=o}function iq(n,e,t={}){if(!e)return Au(n,null,t)||hv(n,null,t);const r=Cm(e,n.schema);return r==="node"?Au(n,e,t):r==="mark"?hv(n,e,t):!1}function TT(n,e){const{nodeExtensions:t}=Sm(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=me(Z(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function Am(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let s=!0;return n.content.forEach(i=>{s!==!1&&(Am(i,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function oq(n){return n instanceof se}function aq(n,e,t){var r;const{selection:s}=e;let i=null;if(y2(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,h,p)=>{if(c)return!1;if(u.isInline){const m=!p||p.type.allowsMarkType(t),g=!!t.isInSet(u.marks)||!u.marks.some(v=>v.type.excludes(t));c=m&&g}return!c}),c})}const lq=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=Bi(n,r.schema);if(s)if(o){const c=_2(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,h=c.$to.pos;r.doc.nodesBetween(u,h,(p,m)=>{const g=Math.max(m,u),v=Math.min(m+p.nodeSize,h);p.marks.find(_=>_.type===l)?p.marks.forEach(_=>{l===_.type&&t.addMark(g,v,l.create({..._.attrs,...e}))}):t.addMark(g,v,l.create(e))})});return aq(r,t,l)},cq=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),uq=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=kt(n,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>xT(i,{...o,...e})(t)?!0:a.clearNodes()).command(({state:a})=>xT(i,{...o,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},dq=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=co(n,0,r.content.size),i=se.create(r,s);e.setSelection(i)}return!0},hq=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=ue.atStart(r).from,a=ue.atEnd(r).to,l=co(s,o,a),c=co(i,o,a),u=ue.create(r,l,c);e.setSelection(u)}return!0},fq=n=>({state:e,dispatch:t})=>{const r=kt(n,e.schema);return zH(r)(e,t)};function ST(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const pq=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,u=Oh(c,a.node().type.name,a.node().attrs);if(i instanceof se&&i.node.isBlock)return!a.parentOffset||!cs(o,a.pos)?!1:(r&&(n&&ST(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:Y8(a.node(-1).contentMatchAt(a.indexAfter(-1)));let m=h&&p?[{type:p,attrs:u}]:void 0,g=cs(e.doc,e.mapping.map(a.pos),1,m);if(!m&&!g&&cs(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(g=!0,m=p?[{type:p,attrs:u}]:void 0),r){if(g&&(i instanceof ue&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,m),p&&!h&&!a.parentOffset&&a.parent.type!==p)){const v=e.mapping.map(a.before()),x=e.doc.resolve(v);a.node(-1).canReplaceWith(x.index(),x.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}n&&ST(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return g},mq=(n,e={})=>({tr:t,state:r,dispatch:s,editor:i})=>{var o;const a=kt(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const h=l.node(-1);if(h.type!==a)return!1;const p=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let _=U.empty;const b=l.index(-1)?1:l.index(-2)?2:3;for(let E=l.depth-b;E>=l.depth-3;E-=1)_=U.from(l.node(E).copy(_));const T=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,A={...Oh(p,l.node().type.name,l.node().attrs),...e},R=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(A))||void 0;_=_.append(U.from(a.createAndFill(null,R)||void 0));const D=l.before(l.depth-(b-1));t.replace(D,l.after(-T),new J(_,4-b,0));let k=-1;t.doc.nodesBetween(D,t.doc.content.size,(E,S)=>{if(k>-1)return!1;E.isTextblock&&E.content.size===0&&(k=S+1)}),k>-1&&t.setSelection(ue.near(t.doc.resolve(k))),t.scrollIntoView()}return!0}const m=c.pos===l.end()?h.contentMatchAt(0).defaultType:null,g={...Oh(p,h.type.name,h.attrs),...e},v={...Oh(p,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const x=m?[{type:a,attrs:g},{type:m,attrs:v}]:[{type:a,attrs:g}];if(!cs(t.doc,l.pos,2))return!1;if(s){const{selection:_,storedMarks:b}=r,{splittableMarks:T}=i.extensionManager,A=b||_.$to.parentOffset&&_.$from.marks();if(t.split(l.pos,2,x).scrollIntoView(),!A||!s)return!0;const R=A.filter(D=>T.includes(D.type.name));t.ensureMarks(R)}return!0},sy=(n,e)=>{const t=Hw(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Li(n.doc,t.pos)&&n.join(t.pos),!0},iy=(n,e)=>{const t=Hw(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Li(n.doc,r)&&n.join(r),!0},gq=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:h,splittableMarks:p}=s.extensionManager,m=kt(n,o.schema),g=kt(e,o.schema),{selection:v,storedMarks:x}=o,{$from:_,$to:b}=v,T=_.blockRange(b),A=x||v.$to.parentOffset&&v.$from.marks();if(!T)return!1;const R=Hw(D=>TT(D.type.name,h))(v);if(T.depth>=1&&R&&T.depth-R.depth<=1){if(R.node.type===m)return c.liftListItem(g);if(TT(R.node.type.name,h)&&m.validContent(R.node.content)&&a)return l().command(()=>(i.setNodeMarkup(R.pos,m),!0)).command(()=>sy(i,m)).command(()=>iy(i,m)).run()}return!t||!A||!a?l().command(()=>u().wrapInList(m,r)?!0:c.clearNodes()).wrapInList(m,r).command(()=>sy(i,m)).command(()=>iy(i,m)).run():l().command(()=>{const D=u().wrapInList(m,r),k=A.filter(E=>p.includes(E.type.name));return i.ensureMarks(k),D?!0:c.clearNodes()}).wrapInList(m,r).command(()=>sy(i,m)).command(()=>iy(i,m)).run()},yq=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=Bi(n,r.schema);return hv(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},vq=(n,e,t={})=>({state:r,commands:s})=>{const i=kt(n,r.schema),o=kt(e,r.schema),a=Au(r,i,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...t})},xq=(n,e={})=>({state:t,commands:r})=>{const s=kt(n,t.schema);return Au(t,s,e)?r.lift(s):r.wrapIn(s,e)},wq=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},_q=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},Eq=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=Bi(n,r.schema),{$from:c,empty:u,ranges:h}=a;if(!s)return!0;if(u&&o){let{from:p,to:m}=a;const g=(i=c.marks().find(x=>x.type===l))===null||i===void 0?void 0:i.attrs,v=zw(c,l,g);v&&(p=v.from,m=v.to),t.removeMark(p,m,l)}else h.forEach(p=>{t.removeMark(p.$from.pos,p.$to.pos,l)});return t.removeStoredMark(l),!0},kq=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Cm(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=kt(n,r.schema)),a==="mark"&&(o=Bi(n,r.schema)),s&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let h,p,m,g;t.selection.empty?r.doc.nodesBetween(c,u,(v,x)=>{i&&i===v.type&&(m=Math.max(x,c),g=Math.min(x+v.nodeSize,u),h=x,p=v)}):r.doc.nodesBetween(c,u,(v,x)=>{x<c&&i&&i===v.type&&(m=Math.max(x,c),g=Math.min(x+v.nodeSize,u),h=x,p=v),x>=c&&x<=u&&(i&&i===v.type&&t.setNodeMarkup(x,void 0,{...v.attrs,...e}),o&&v.marks.length&&v.marks.forEach(_=>{if(o===_.type){const b=Math.max(x,c),T=Math.min(x+v.nodeSize,u);t.addMark(b,T,o.create({..._.attrs,...e}))}}))}),p&&(h!==void 0&&t.setNodeMarkup(h,void 0,{...p.attrs,...e}),o&&p.marks.length&&p.marks.forEach(v=>{o===v.type&&t.addMark(m,g,o.create({...v.attrs,...e}))}))}),!0):!1},bq=(n,e={})=>({state:t,dispatch:r})=>{const s=kt(n,t.schema);return jH(s,e)(t,r)},Tq=(n,e={})=>({state:t,dispatch:r})=>{const s=kt(n,t.schema);return VH(s,e)(t,r)};var Sq=Object.freeze({__proto__:null,blur:o8,clearContent:a8,clearNodes:l8,command:c8,createParagraphNear:u8,cut:d8,deleteCurrentNode:h8,deleteNode:f8,deleteRange:p8,deleteSelection:m8,enter:g8,exitCode:y8,extendMarkRange:v8,first:x8,focus:_8,forEach:E8,insertContent:k8,insertContentAt:S8,joinBackward:C8,joinDown:N8,joinForward:A8,joinItemBackward:R8,joinItemForward:P8,joinTextblockBackward:D8,joinTextblockForward:M8,joinUp:I8,keyboardShortcut:j8,lift:V8,liftEmptyBlock:L8,liftListItem:F8,newlineInCode:B8,resetAttributes:U8,scrollIntoView:$8,selectAll:z8,selectNodeBackward:W8,selectNodeForward:H8,selectParentNode:q8,selectTextblockEnd:K8,selectTextblockStart:G8,setContent:Q8,setMark:lq,setMeta:cq,setNode:uq,setNodeSelection:dq,setTextSelection:hq,sinkListItem:fq,splitBlock:pq,splitListItem:mq,toggleList:gq,toggleMark:yq,toggleNode:vq,toggleWrap:xq,undoInputRule:wq,unsetAllMarks:_q,unsetMark:Eq,updateAttributes:kq,wrapIn:bq,wrapInList:Tq});const Iq=qt.create({name:"commands",addCommands(){return{...Sq}}}),Nq=qt.create({name:"drop",addProseMirrorPlugins(){return[new bt({key:new En("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),Cq=qt.create({name:"editable",addProseMirrorPlugins(){return[new bt({key:new En("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Aq=new En("focusEvents"),Rq=qt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new bt({key:Aq,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Pq=qt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:h}=l,{pos:p,parent:m}=h,g=h.parent.isTextblock&&p>0?a.doc.resolve(p-1):h,v=g.parent.type.spec.isolating,x=h.pos-h.parentOffset,_=v&&g.parent.childCount===1?x===h.pos:pe.atStart(c).from===p;return!u||!m.type.isTextblock||m.textContent.length||!_||_&&h.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ww()||w2()?i:s},addProseMirrorPlugins(){return[new bt({key:new En("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(v=>v.getMeta("composition")))return;const r=n.some(v=>v.docChanged)&&!e.doc.eq(t.doc),s=n.some(v=>v.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=e.selection,l=pe.atStart(e.doc).from,c=pe.atEnd(e.doc).to;if(i||!(o===l&&a===c)||!Am(t.doc))return;const p=t.tr,m=bm({state:t,transaction:p}),{commands:g}=new Tm({editor:this.editor,state:m});if(g.clearNodes(),!!p.steps.length)return p}})]}}),Dq=qt.create({name:"paste",addProseMirrorPlugins(){return[new bt({key:new En("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),Mq=qt.create({name:"tabindex",addProseMirrorPlugins(){return[new bt({key:new En("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class ro{get name(){return this.node.type.name}constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new ro(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new ro(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new ro(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+r+(i?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new ro(a,this.editor,s,s?t:null);s&&(l.actualDepth=this.depth+1),e.push(new ro(a,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(t);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>t[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,t,r))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const Oq=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function jq(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}class Vq extends WH{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:s})=>this.options.onDrop(t,r,s)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=jq(Oq,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=f2(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(o))}),t.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[Cq,i8.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),Iq,Rq,Pq,Mq,Nq,Dq].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Oa(s,this)}createCommandManager(){this.commandManager=new Tm({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=dv(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=dv(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=v2(t,this.options.autofocus);this.view=new XP(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Ma.create({doc:t,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return E2(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return iq(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Uw(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return eq(this.state.doc,{blockSeparator:t,textSerializers:{...m2(this.schema),...r}})}get isEmpty(){return Am(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new ro(t,this)}get $doc(){return this.$pos(0)}}function Ho(n){return new Im({find:n.find,handler:({state:e,range:t,match:r})=>{const s=me(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),u=c+o.length;if(qw(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===n.type&&v!==m.mark.type)).filter(m=>m.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const p=t.from+l+o.length;i.addMark(t.from+l,p,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function Lq(n){return new Im({find:n.find,handler:({state:e,range:t,match:r})=>{const s=me(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const h=r[0][r[0].length-1];i.insertText(h,o+r[0].length-1),i.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function fv(n){return new Im({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=me(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function Ru(n){return new Im({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=me(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&Tw(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:h,storedMarks:p}=e,{splittableMarks:m}=n.editor.extensionManager,g=p||h.$to.parentOffset&&h.$from.marks();if(g){const v=g.filter(x=>m.includes(x.type.name));o.ensureMarks(v)}}if(n.keepAttributes){const h=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(h,i).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Li(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)}})}class wn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=me(Z(this,"addOptions",{name:this.name}))),this.storage=me(Z(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new wn(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Nm(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new wn(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=me(Z(t,"addOptions",{name:t.name})),t.storage=me(Z(t,"addStorage",{name:t.name,options:t.options})),t}}function Ni(n){return new ZH({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=me(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),h=t.from+l.indexOf(a),p=h+a.length;if(qw(t.from,t.to,e.doc).filter(g=>g.mark.type.excluded.find(x=>x===n.type&&x!==g.mark.type)).filter(g=>g.to>h).length)return null;p<t.to&&o.delete(p,t.to),h>t.from&&o.delete(t.from+u,h),c=t.from+u+a.length,o.addMark(t.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function Fq(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof se){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}function Bq(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var k2={exports:{}},oy={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IT;function Uq(){if(IT)return oy;IT=1;var n=At;function e(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,i=n.useLayoutEffect,o=n.useDebugValue;function a(h,p){var m=p(),g=r({inst:{value:m,getSnapshot:p}}),v=g[0].inst,x=g[1];return i(function(){v.value=m,v.getSnapshot=p,l(v)&&x({inst:v})},[h,m,p]),s(function(){return l(v)&&x({inst:v}),h(function(){l(v)&&x({inst:v})})},[h]),o(m),m}function l(h){var p=h.getSnapshot;h=h.value;try{var m=p();return!t(h,m)}catch{return!0}}function c(h,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return oy.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,oy}k2.exports=Uq();var Kw=k2.exports;const $q=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},zq=({contentComponent:n})=>{const e=Kw.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return At.createElement(At.Fragment,null,Object.values(e))};function Wq(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:WO.createPortal(r.reactElement,r.element,t)},n.forEach(s=>s())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(s=>s())}}}class Hq extends At.Component{constructor(e){var t;super(e),this.editorContentRef=At.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=Wq(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return At.createElement(At.Fragment,null,At.createElement("div",{ref:$q(t,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&At.createElement(zq,{contentComponent:e.contentComponent}))}}const qq=O.forwardRef((n,e)=>{const t=At.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return At.createElement(Hq,{key:t,innerRef:e,...n})}),Kq=At.memo(qq);var Gq=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!n(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!n(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!(o==="_owner"&&e.$$typeof)&&!n(e[o],t[o]))return!1}return!0}return e!==e&&t!==t},Qq=Bq(Gq),b2={exports:{}},ay={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NT;function Jq(){if(NT)return ay;NT=1;var n=At,e=Kw;function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,i=n.useRef,o=n.useEffect,a=n.useMemo,l=n.useDebugValue;return ay.useSyncExternalStoreWithSelector=function(c,u,h,p,m){var g=i(null);if(g.current===null){var v={hasValue:!1,value:null};g.current=v}else v=g.current;g=a(function(){function _(D){if(!b){if(b=!0,T=D,D=p(D),m!==void 0&&v.hasValue){var k=v.value;if(m(k,D))return A=k}return A=D}if(k=A,r(T,D))return k;var E=p(D);return m!==void 0&&m(k,E)?k:(T=D,A=E)}var b=!1,T,A,R=h===void 0?null:h;return[function(){return _(u())},R===null?void 0:function(){return _(R())}]},[u,h,p,m]);var x=s(c,g[0],g[1]);return o(function(){v.hasValue=!0,v.value=x},[x]),l(x),x},ay}b2.exports=Jq();var Yq=b2.exports;const Xq=typeof window<"u"?O.useLayoutEffect:O.useEffect;class Zq{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}}function eK(n){var e;const[t]=O.useState(()=>new Zq(n.editor)),r=Yq.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!==null&&e!==void 0?e:Qq);return Xq(()=>t.watch(n.editor),[n.editor,t]),O.useDebugValue(r),r}const tK=!1,pv=typeof window>"u",nK=pv||!!(typeof window<"u"&&window.next);class Gw{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?pv||nK?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)===null||i===void 0?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)===null||i===void 0?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)===null||i===void 0?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)===null||i===void 0?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)===null||i===void 0?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)===null||i===void 0?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)===null||i===void 0?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)===null||i===void 0?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)===null||i===void 0?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)===null||i===void 0?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)===null||i===void 0?void 0:i.call(s,...r)}};return new Vq(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((s,i)=>{var o;return s===((o=t.extensions)===null||o===void 0?void 0:o[i])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Gw.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function rK(n={},e=[]){const t=O.useRef(n);t.current=n;const[r]=O.useState(()=>new Gw(t)),s=Kw.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return O.useDebugValue(s),O.useEffect(r.onRender(e)),eK({editor:s,selector:({transactionNumber:i})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&i===0?0:i+1}),s}const sK=O.createContext({editor:null});sK.Consumer;const iK=O.createContext({onDragStart:void 0}),oK=()=>O.useContext(iK);At.forwardRef((n,e)=>{const{onDragStart:t}=oK(),r=n.as||"div";return At.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const aK=/^\s*>\s$/,lK=wn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ru({find:aK,type:this.type})]}}),cK=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,uK=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,dK=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,hK=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,fK=gr.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ho({find:cK,type:this.type}),Ho({find:dK,type:this.type})]},addPasteRules(){return[Ni({find:uK,type:this.type}),Ni({find:hK,type:this.type})]}}),pK="listItem",CT="textStyle",AT=/^\s*([-+*])\s$/,mK=wn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(pK,this.editor.getAttributes(CT)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Ru({find:AT,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Ru({find:AT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(CT),editor:this.editor})),[n]}}),gK=/(^|[^`])`([^`]+)`(?!`)/,yK=/(^|[^`])`([^`]+)`(?!`)/g,vK=gr.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ho({find:gK,type:this.type})]},addPasteRules(){return[Ni({find:yK,type:this.type})]}}),xK=/^```([a-z]+)?[\s\n]$/,wK=/^~~~([a-z]+)?[\s\n]$/,_K=wn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",pt(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(pe.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[fv({find:xK,type:this.type,getAttributes:n=>({language:n[1]})}),fv({find:wK,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new bt({key:new En("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!t||!i)return!1;const{tr:o,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(ue.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),EK=wn.create({name:"doc",topNode:!0,content:"block+"});function kK(n={}){return new bt({view(e){return new bK(e,n)}})}class bK{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,a=i.height/s.offsetHeight;if(t){let h=e.nodeBefore,p=e.nodeAfter;if(h||p){let m=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(m){let g=m.getBoundingClientRect(),v=h?g.bottom:g.top;h&&p&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let x=this.width/2*a;r={left:g.left,right:g.right,top:v-x,bottom:v+x}}}}if(!r){let h=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*o;r={left:h.left-p,right:h.left+p,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let h=l.getBoundingClientRect(),p=h.width/l.offsetWidth,m=h.height/l.offsetHeight;c=h.left-l.scrollLeft*p,u=h.top-l.scrollTop*m}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=dP(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const TK=qt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[kK(this.options)]}});class Ye extends pe{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Ye.valid(r)?new Ye(r):pe.near(r)}content(){return J.empty}eq(e){return e instanceof Ye&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ye(e.resolve(t.pos))}getBookmark(){return new Qw(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!SK(e)||!IK(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Ye.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let l=e.doc.resolve(s);if(Ye.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!se.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let a=e.doc.resolve(s);if(Ye.valid(a))return a}return null}}}Ye.prototype.visible=!1;Ye.findFrom=Ye.findGapCursorFrom;pe.jsonID("gapcursor",Ye);class Qw{constructor(e){this.pos=e}map(e){return new Qw(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Ye.valid(t)?new Ye(t):pe.near(t)}}function T2(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function SK(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||T2(s.type))return!0;if(s.inlineContent)return!1}}return!0}function IK(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||T2(s.type))return!0;if(s.inlineContent)return!1}}return!0}function NK(){return new bt({props:{decorations:PK,createSelectionBetween(n,e,t){return e.pos==t.pos&&Ye.valid(t)?new Ye(t):null},handleClick:AK,handleKeyDown:CK,handleDOMEvents:{beforeinput:RK}}})}const CK=ZP({ArrowLeft:nh("horiz",-1),ArrowRight:nh("horiz",1),ArrowUp:nh("vert",-1),ArrowDown:nh("vert",1)});function nh(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ue){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Ye.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new Ye(c))),!0):!1}}function AK(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Ye.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&se.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Ye(r))),!0)}function RK(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Ye))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=U.empty;for(let o=r.length-1;o>=0;o--)s=U.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new J(s,0,0));return i.setSelection(ue.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function PK(n){if(!(n.selection instanceof Ye))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",st.create(n.doc,[Cn.widget(n.selection.head,e,{key:"gapcursor"})])}const DK=qt.create({name:"gapCursor",addProseMirrorPlugins(){return[NK()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=me(Z(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),MK=wn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",pt(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const h=l.filter(p=>a.includes(p.type.name));c.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),OK=wn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,pt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>fv({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Jf=200,Et=function(){};Et.prototype.append=function(e){return e.length?(e=Et.from(e),!this.length&&e||e.length<Jf&&this.leafAppend(e)||this.length<Jf&&e.leafPrepend(this)||this.appendInner(e)):this};Et.prototype.prepend=function(e){return e.length?Et.from(e).append(this):this};Et.prototype.appendInner=function(e){return new jK(this,e)};Et.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Et.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Et.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Et.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Et.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};Et.from=function(e){return e instanceof Et?e:e&&e.length?new S2(e):Et.empty};var S2=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Jf)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Jf)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Et);Et.empty=new S2([]);var jK=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Et);const VK=500;class or{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((h,p)=>{if(!h.step){s||(s=this.remapping(r,p+1),i=s.maps.length),i--,u.push(h);return}if(s){u.push(new xr(h.map));let m=h.step.map(s.slice(i)),g;m&&o.maybeStep(m).doc&&(g=o.mapping.maps[o.mapping.maps.length-1],c.push(new xr(g,void 0,void 0,c.length+u.length))),i--,g&&s.appendMap(g,i)}else o.maybeStep(h.step);if(h.selection)return a=s?h.selection.map(s.slice(i)):h.selection,l=new or(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let h=e.steps[u].invert(e.docs[u]),p=new xr(e.mapping.maps[u],h,t),m;(m=l&&l.merge(p))&&(p=m,u?i.pop():a=a.slice(0,a.length-1)),i.push(p),t&&(o++,t=void 0),s||(l=p)}let c=o-r.depth;return c>FK&&(a=LK(a,c),o-=c),new or(a.append(i),o)}remapping(e,t){let r=new bu;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new or(this.items.append(e.map(t=>new xr(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(p=>{p.selection&&a--},s);let l=t;this.items.forEach(p=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let g=i.maps[m];if(p.step){let v=e.steps[m].invert(e.docs[m]),x=p.selection&&p.selection.map(i.slice(l+1,m));x&&a++,r.push(new xr(g,v,x))}else r.push(new xr(g))},s);let c=[];for(let p=t;p<o;p++)c.push(new xr(i.maps[p]));let u=this.items.slice(0,s).append(c).append(r),h=new or(u,a);return h.emptyItemCount()>VK&&(h=h.compress(this.items.length-r.length)),h}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&i++;let h=new xr(c.invert(),l,u),p,m=s.length-1;(p=s.length&&s[m].merge(h))?s[m]=p:s.push(h)}}else o.map&&r--},this.items.length,0),new or(Et.from(s.reverse()),i)}}or.empty=new or(Et.empty,0);function LK(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class xr{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new xr(t.getMap().invert(),t,this.selection)}}}class js{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const FK=20;function BK(n,e,t,r){let s=t.getMeta(Eo),i;if(s)return s.historyState;t.getMeta(zK)&&(n=new js(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Eo))return o.getMeta(Eo).redo?new js(n.done.addTransform(t,void 0,r,jh(e)),n.undone,RT(t.mapping.maps),n.prevTime,n.prevComposition):new js(n.done,n.undone.addTransform(t,void 0,r,jh(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!UK(t,n.prevRanges)),c=o?ly(n.prevRanges,t.mapping):RT(t.mapping.maps);return new js(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,jh(e)),or.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new js(n.done.rebased(t,i),n.undone.rebased(t,i),ly(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new js(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),ly(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function UK(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function RT(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,o)=>e.push(i,o));return e}function ly(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function $K(n,e,t){let r=jh(e),s=Eo.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new js(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(Eo,{redo:t,historyState:l})}let cy=!1,PT=null;function jh(n){let e=n.plugins;if(PT!=e){cy=!1,PT=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){cy=!0;break}}return cy}const Eo=new En("history"),zK=new En("closeHistory");function WK(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new bt({key:Eo,state:{init(){return new js(or.empty,or.empty,null,0,-1)},apply(e,t,r){return BK(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?N2:r=="historyRedo"?C2:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function I2(n,e){return(t,r)=>{let s=Eo.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=$K(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const N2=I2(!1,!0),C2=I2(!0,!0),HK=qt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>N2(n,e),redo:()=>({state:n,dispatch:e})=>C2(n,e)}},addProseMirrorPlugins(){return[WK(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),qK=wn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",pt(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!Fq(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$from:r,$to:s}=t,i=n();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):oq(t)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(ue.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(se.create(o.doc,c.pos)):o.setSelection(ue.create(o.doc,c.pos));else{const h=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();h&&(o.insert(u,h),o.setSelection(ue.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Lq({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),KK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,GK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,QK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,JK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,YK=gr.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ho({find:KK,type:this.type}),Ho({find:QK,type:this.type})]},addPasteRules(){return[Ni({find:GK,type:this.type}),Ni({find:JK,type:this.type})]}}),XK=wn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",pt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ZK="listItem",DT="textStyle",MT=/^(\d+)\.\s$/,eG=wn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",pt(this.options.HTMLAttributes,t),0]:["ol",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ZK,this.editor.getAttributes(DT)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Ru({find:MT,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Ru({find:MT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(DT)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),tG=wn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),nG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,rG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,sG=gr.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ho({find:nG,type:this.type})]},addPasteRules(){return[Ni({find:rG,type:this.type})]}}),iG=wn.create({name:"text",group:"inline"}),oG=qt.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(fK.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(lK.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(mK.configure(this.options.bulletList)),this.options.code!==!1&&n.push(vK.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(_K.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(EK.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(TK.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(DK.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(MK.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(OK.configure(this.options.heading)),this.options.history!==!1&&n.push(HK.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(qK.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(YK.configure(this.options.italic)),this.options.listItem!==!1&&n.push(XK.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(eG.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(tG.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(sG.configure(this.options.strike)),this.options.text!==!1&&n.push(iG.configure(this.options.text)),n}}),aG=qt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new bt({key:new En("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!t)return null;const i=this.editor.isEmpty;return n.descendants((o,a)=>{const l=r>=a&&r<=a+o.nodeSize,c=!o.isLeaf&&Am(o);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];i&&u.push(this.options.emptyEditorClass);const h=Cn.node(a,a+o.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:a,hasAnchor:l}):this.options.placeholder});s.push(h)}return this.options.includeChildren}),st.create(n,s)}}})]}}),lG=gr.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),cG="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",uG="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",mv="numeric",gv="ascii",yv="alpha",Lc="asciinumeric",vc="alphanumeric",vv="domain",A2="emoji",dG="scheme",hG="slashscheme",uy="whitespace";function fG(n,e){return n in e||(e[n]=[]),e[n]}function uo(n,e,t){e[mv]&&(e[Lc]=!0,e[vc]=!0),e[gv]&&(e[Lc]=!0,e[yv]=!0),e[Lc]&&(e[vc]=!0),e[yv]&&(e[vc]=!0),e[vc]&&(e[vv]=!0),e[A2]&&(e[vv]=!0);for(const r in e){const s=fG(r,t);s.indexOf(n)<0&&s.push(n)}}function pG(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function fn(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}fn.groups={};fn.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const s=e.jr[r][0],i=e.jr[r][1];if(i&&s.test(n))return i}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let s=0;s<n.length;s++)this.tt(n[s],e,t,r)},tr(n,e,t,r){r=r||fn.groups;let s;return e&&e.j?s=e:(s=new fn(e),t&&r&&uo(e,t,r)),this.jr.push([n,s]),s},ts(n,e,t,r){let s=this;const i=n.length;if(!i)return s;for(let o=0;o<i-1;o++)s=s.tt(n[o]);return s.tt(n[i-1],e,t,r)},tt(n,e,t,r){r=r||fn.groups;const s=this;if(e&&e.j)return s.j[n]=e,e;const i=e;let o,a=s.go(n);if(a?(o=new fn,Object.assign(o.j,a.j),o.jr.push.apply(o.jr,a.jr),o.jd=a.jd,o.t=a.t):o=new fn,i){if(r)if(o.t&&typeof o.t=="string"){const l=Object.assign(pG(o.t,r),t);uo(i,l,r)}else t&&uo(i,t,r);o.t=i}return s.j[n]=o,o}};const fe=(n,e,t,r,s)=>n.ta(e,t,r,s),Qe=(n,e,t,r,s)=>n.tr(e,t,r,s),OT=(n,e,t,r,s)=>n.ts(e,t,r,s),z=(n,e,t,r,s)=>n.tt(e,t,r,s),Gr="WORD",xv="UWORD",R2="ASCIINUMERICAL",P2="ALPHANUMERICAL",Pu="LOCALHOST",wv="TLD",_v="UTLD",Vh="SCHEME",wa="SLASH_SCHEME",Jw="NUM",Ev="WS",Yw="NL",Fc="OPENBRACE",Bc="CLOSEBRACE",Yf="OPENBRACKET",Xf="CLOSEBRACKET",Zf="OPENPAREN",ep="CLOSEPAREN",tp="OPENANGLEBRACKET",np="CLOSEANGLEBRACKET",rp="FULLWIDTHLEFTPAREN",sp="FULLWIDTHRIGHTPAREN",ip="LEFTCORNERBRACKET",op="RIGHTCORNERBRACKET",ap="LEFTWHITECORNERBRACKET",lp="RIGHTWHITECORNERBRACKET",cp="FULLWIDTHLESSTHAN",up="FULLWIDTHGREATERTHAN",dp="AMPERSAND",hp="APOSTROPHE",fp="ASTERISK",Vs="AT",pp="BACKSLASH",mp="BACKTICK",gp="CARET",Ks="COLON",Xw="COMMA",yp="DOLLAR",wr="DOT",vp="EQUALS",Zw="EXCLAMATION",Ln="HYPHEN",Uc="PERCENT",xp="PIPE",wp="PLUS",_p="POUND",$c="QUERY",e_="QUOTE",D2="FULLWIDTHMIDDLEDOT",t_="SEMI",_r="SLASH",zc="TILDE",Ep="UNDERSCORE",M2="EMOJI",kp="SYM";var O2=Object.freeze({__proto__:null,ALPHANUMERICAL:P2,AMPERSAND:dp,APOSTROPHE:hp,ASCIINUMERICAL:R2,ASTERISK:fp,AT:Vs,BACKSLASH:pp,BACKTICK:mp,CARET:gp,CLOSEANGLEBRACKET:np,CLOSEBRACE:Bc,CLOSEBRACKET:Xf,CLOSEPAREN:ep,COLON:Ks,COMMA:Xw,DOLLAR:yp,DOT:wr,EMOJI:M2,EQUALS:vp,EXCLAMATION:Zw,FULLWIDTHGREATERTHAN:up,FULLWIDTHLEFTPAREN:rp,FULLWIDTHLESSTHAN:cp,FULLWIDTHMIDDLEDOT:D2,FULLWIDTHRIGHTPAREN:sp,HYPHEN:Ln,LEFTCORNERBRACKET:ip,LEFTWHITECORNERBRACKET:ap,LOCALHOST:Pu,NL:Yw,NUM:Jw,OPENANGLEBRACKET:tp,OPENBRACE:Fc,OPENBRACKET:Yf,OPENPAREN:Zf,PERCENT:Uc,PIPE:xp,PLUS:wp,POUND:_p,QUERY:$c,QUOTE:e_,RIGHTCORNERBRACKET:op,RIGHTWHITECORNERBRACKET:lp,SCHEME:Vh,SEMI:t_,SLASH:_r,SLASH_SCHEME:wa,SYM:kp,TILDE:zc,TLD:wv,UNDERSCORE:Ep,UTLD:_v,UWORD:xv,WORD:Gr,WS:Ev});const Hr=/[a-z]/,rc=new RegExp("\\p{L}","u"),dy=new RegExp("\\p{Emoji}","u"),qr=/\d/,hy=/\s/,jT="\r",fy=`
`,mG="",gG="",py="";let rh=null,sh=null;function yG(n=[]){const e={};fn.groups=e;const t=new fn;rh==null&&(rh=VT(cG)),sh==null&&(sh=VT(uG)),z(t,"'",hp),z(t,"{",Fc),z(t,"}",Bc),z(t,"[",Yf),z(t,"]",Xf),z(t,"(",Zf),z(t,")",ep),z(t,"<",tp),z(t,">",np),z(t,"",rp),z(t,"",sp),z(t,"",ip),z(t,"",op),z(t,"",ap),z(t,"",lp),z(t,"",cp),z(t,"",up),z(t,"&",dp),z(t,"*",fp),z(t,"@",Vs),z(t,"`",mp),z(t,"^",gp),z(t,":",Ks),z(t,",",Xw),z(t,"$",yp),z(t,".",wr),z(t,"=",vp),z(t,"!",Zw),z(t,"-",Ln),z(t,"%",Uc),z(t,"|",xp),z(t,"+",wp),z(t,"#",_p),z(t,"?",$c),z(t,'"',e_),z(t,"/",_r),z(t,";",t_),z(t,"~",zc),z(t,"_",Ep),z(t,"\\",pp),z(t,"",D2);const r=Qe(t,qr,Jw,{[mv]:!0});Qe(r,qr,r);const s=Qe(r,Hr,R2,{[Lc]:!0}),i=Qe(r,rc,P2,{[vc]:!0}),o=Qe(t,Hr,Gr,{[gv]:!0});Qe(o,qr,s),Qe(o,Hr,o),Qe(s,qr,s),Qe(s,Hr,s);const a=Qe(t,rc,xv,{[yv]:!0});Qe(a,Hr),Qe(a,qr,i),Qe(a,rc,a),Qe(i,qr,i),Qe(i,Hr),Qe(i,rc,i);const l=z(t,fy,Yw,{[uy]:!0}),c=z(t,jT,Ev,{[uy]:!0}),u=Qe(t,hy,Ev,{[uy]:!0});z(t,py,u),z(c,fy,l),z(c,py,u),Qe(c,hy,u),z(u,jT),z(u,fy),Qe(u,hy,u),z(u,py,u);const h=Qe(t,dy,M2,{[A2]:!0});z(h,"#"),Qe(h,dy,h),z(h,mG,h);const p=z(h,gG);z(p,"#"),Qe(p,dy,h);const m=[[Hr,o],[qr,s]],g=[[Hr,null],[rc,a],[qr,i]];for(let v=0;v<rh.length;v++)Rs(t,rh[v],wv,Gr,m);for(let v=0;v<sh.length;v++)Rs(t,sh[v],_v,xv,g);uo(wv,{tld:!0,ascii:!0},e),uo(_v,{utld:!0,alpha:!0},e),Rs(t,"file",Vh,Gr,m),Rs(t,"mailto",Vh,Gr,m),Rs(t,"http",wa,Gr,m),Rs(t,"https",wa,Gr,m),Rs(t,"ftp",wa,Gr,m),Rs(t,"ftps",wa,Gr,m),uo(Vh,{scheme:!0,ascii:!0},e),uo(wa,{slashscheme:!0,ascii:!0},e),n=n.sort((v,x)=>v[0]>x[0]?1:-1);for(let v=0;v<n.length;v++){const x=n[v][0],b=n[v][1]?{[dG]:!0}:{[hG]:!0};x.indexOf("-")>=0?b[vv]=!0:Hr.test(x)?qr.test(x)?b[Lc]=!0:b[gv]=!0:b[mv]=!0,OT(t,x,x,b)}return OT(t,"localhost",Pu,{ascii:!0}),t.jd=new fn(kp),{start:t,tokens:Object.assign({groups:e},O2)}}function j2(n,e){const t=vG(e.replace(/[A-Z]/g,a=>a.toLowerCase())),r=t.length,s=[];let i=0,o=0;for(;o<r;){let a=n,l=null,c=0,u=null,h=-1,p=-1;for(;o<r&&(l=a.go(t[o]));)a=l,a.accepts()?(h=0,p=0,u=a):h>=0&&(h+=t[o].length,p++),c+=t[o].length,i+=t[o].length,o++;i-=h,o-=p,c-=h,s.push({t:u.t,v:e.slice(i-c,i),s:i-c,e:i})}return s}function vG(n){const e=[],t=n.length;let r=0;for(;r<t;){let s=n.charCodeAt(r),i,o=s<55296||s>56319||r+1===t||(i=n.charCodeAt(r+1))<56320||i>57343?n[r]:n.slice(r,r+2);e.push(o),r+=o.length}return e}function Rs(n,e,t,r,s){let i;const o=e.length;for(let a=0;a<o-1;a++){const l=e[a];n.j[l]?i=n.j[l]:(i=new fn(r),i.jr=s.slice(),n.j[l]=i),n=i}return i=new fn(t),i.jr=s.slice(),n.j[e[o-1]]=i,i}function VT(n){const e=[],t=[];let r=0,s="0123456789";for(;r<n.length;){let i=0;for(;s.indexOf(n[r+i])>=0;)i++;if(i>0){e.push(t.join(""));for(let o=parseInt(n.substring(r,r+i),10);o>0;o--)t.pop();r+=i}else t.push(n[r]),r++}return e}const Du={defaultProtocol:"http",events:null,format:LT,formatHref:LT,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function n_(n,e=null){let t=Object.assign({},Du);n&&(t=Object.assign(t,n instanceof n_?n.o:n));const r=t.ignoreTags,s=[];for(let i=0;i<r.length;i++)s.push(r[i].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=s}n_.prototype={o:Du,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let s=this.o[n];return s&&(typeof s=="object"?(s=t.t in s?s[t.t]:Du[n],typeof s=="function"&&r&&(s=s(e,t))):typeof s=="function"&&r&&(s=s(e,t.t,t)),s)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function LT(n){return n}function V2(n,e){this.t="token",this.v=n,this.tk=e}V2.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=Du.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),s=n.get("tagName",t,e),i=this.toFormattedString(n),o={},a=n.get("className",t,e),l=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),h=n.getObj("events",t,e);return o.href=r,a&&(o.class=a),l&&(o.target=l),c&&(o.rel=c),u&&Object.assign(o,u),{tagName:s,attributes:o,content:i,eventListeners:h}}};function Rm(n,e){class t extends V2{constructor(s,i){super(s,i),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const FT=Rm("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),BT=Rm("text"),xG=Rm("nl"),ih=Rm("url",{isLink:!0,toHref(n=Du.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==Pu&&n[1].t===Ks}}),Vn=n=>new fn(n);function wG({groups:n}){const e=n.domain.concat([dp,fp,Vs,pp,mp,gp,yp,vp,Ln,Jw,Uc,xp,wp,_p,_r,kp,zc,Ep]),t=[hp,Ks,Xw,wr,Zw,Uc,$c,e_,t_,tp,np,Fc,Bc,Xf,Yf,Zf,ep,rp,sp,ip,op,ap,lp,cp,up],r=[dp,hp,fp,pp,mp,gp,yp,vp,Ln,Fc,Bc,Uc,xp,wp,_p,$c,_r,kp,zc,Ep],s=Vn(),i=z(s,zc);fe(i,r,i),fe(i,n.domain,i);const o=Vn(),a=Vn(),l=Vn();fe(s,n.domain,o),fe(s,n.scheme,a),fe(s,n.slashscheme,l),fe(o,r,i),fe(o,n.domain,o);const c=z(o,Vs);z(i,Vs,c),z(a,Vs,c),z(l,Vs,c);const u=z(i,wr);fe(u,r,i),fe(u,n.domain,i);const h=Vn();fe(c,n.domain,h),fe(h,n.domain,h);const p=z(h,wr);fe(p,n.domain,h);const m=Vn(FT);fe(p,n.tld,m),fe(p,n.utld,m),z(c,Pu,m);const g=z(h,Ln);z(g,Ln,g),fe(g,n.domain,h),fe(m,n.domain,h),z(m,wr,p),z(m,Ln,g);const v=z(m,Ks);fe(v,n.numeric,FT);const x=z(o,Ln),_=z(o,wr);z(x,Ln,x),fe(x,n.domain,o),fe(_,r,i),fe(_,n.domain,o);const b=Vn(ih);fe(_,n.tld,b),fe(_,n.utld,b),fe(b,n.domain,o),fe(b,r,i),z(b,wr,_),z(b,Ln,x),z(b,Vs,c);const T=z(b,Ks),A=Vn(ih);fe(T,n.numeric,A);const R=Vn(ih),D=Vn();fe(R,e,R),fe(R,t,D),fe(D,e,R),fe(D,t,D),z(b,_r,R),z(A,_r,R);const k=z(a,Ks),E=z(l,Ks),S=z(E,_r),C=z(S,_r);fe(a,n.domain,o),z(a,wr,_),z(a,Ln,x),fe(l,n.domain,o),z(l,wr,_),z(l,Ln,x),fe(k,n.domain,R),z(k,_r,R),z(k,$c,R),fe(C,n.domain,R),fe(C,e,R),z(C,_r,R);const M=[[Fc,Bc],[Yf,Xf],[Zf,ep],[tp,np],[rp,sp],[ip,op],[ap,lp],[cp,up]];for(let P=0;P<M.length;P++){const[N,ae]=M[P],ye=z(R,N);z(D,N,ye),z(ye,ae,R);const H=Vn(ih);fe(ye,e,H);const ee=Vn();fe(ye,t),fe(H,e,H),fe(H,t,ee),fe(ee,e,H),fe(ee,t,ee),z(H,ae,R),z(ee,ae,R)}return z(s,Pu,b),z(s,Yw,xG),{start:s,tokens:O2}}function _G(n,e,t){let r=t.length,s=0,i=[],o=[];for(;s<r;){let a=n,l=null,c=null,u=0,h=null,p=-1;for(;s<r&&!(l=a.go(t[s].t));)o.push(t[s++]);for(;s<r&&(c=l||a.go(t[s].t));)l=null,a=c,a.accepts()?(p=0,h=a):p>=0&&p++,s++,u++;if(p<0)s-=u,s<r&&(o.push(t[s]),s++);else{o.length>0&&(i.push(my(BT,e,o)),o=[]),s-=p,u-=p;const m=h.t,g=t.slice(s-u,s);i.push(my(m,e,g))}}return o.length>0&&i.push(my(BT,e,o)),i}function my(n,e,t){const r=t[0].s,s=t[t.length-1].e,i=e.slice(r,s);return new n(i,t)}const EG=typeof console<"u"&&console&&console.warn||(()=>{}),kG="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Le={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function bG(){return fn.groups={},Le.scanner=null,Le.parser=null,Le.tokenQueue=[],Le.pluginQueue=[],Le.customSchemes=[],Le.initialized=!1,Le}function UT(n,e=!1){if(Le.initialized&&EG(`linkifyjs: already initialized - will not register custom scheme "${n}" ${kG}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Le.customSchemes.push([n,e])}function TG(){Le.scanner=yG(Le.customSchemes);for(let n=0;n<Le.tokenQueue.length;n++)Le.tokenQueue[n][1]({scanner:Le.scanner});Le.parser=wG(Le.scanner.tokens);for(let n=0;n<Le.pluginQueue.length;n++)Le.pluginQueue[n][1]({scanner:Le.scanner,parser:Le.parser});return Le.initialized=!0,Le}function r_(n){return Le.initialized||TG(),_G(Le.parser.start,n,j2(Le.scanner.start,n))}r_.scan=j2;function L2(n,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new n_(t),s=r_(n),i=[];for(let o=0;o<s.length;o++){const a=s[o];a.isLink&&(!e||a.t===e)&&r.check(a)&&i.push(a.toFormattedObject(r))}return i}const s_="[\0- -\u2029]",SG=new RegExp(s_),IG=new RegExp(`${s_}$`),NG=new RegExp(s_,"g");function CG(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function AG(n){return new bt({key:new En("autolink"),appendTransaction:(e,t,r)=>{const s=e.some(c=>c.docChanged)&&!t.doc.eq(r.doc),i=e.some(c=>c.getMeta("preventAutolink"));if(!s||i)return;const{tr:o}=r,a=J8(t.doc,[...e]);if(sq(a).forEach(({newRange:c})=>{const u=X8(r.doc,c,m=>m.isTextblock);let h,p;if(u.length>1)h=u[0],p=r.doc.textBetween(h.pos,h.pos+h.node.nodeSize,void 0," ");else if(u.length){const m=r.doc.textBetween(c.from,c.to," "," ");if(!IG.test(m))return;h=u[0],p=r.doc.textBetween(h.pos,c.to,void 0," ")}if(h&&p){const m=p.split(SG).filter(Boolean);if(m.length<=0)return!1;const g=m[m.length-1],v=h.pos+p.lastIndexOf(g);if(!g)return!1;const x=r_(g).map(_=>_.toObject(n.defaultProtocol));if(!CG(x))return!1;x.filter(_=>_.isLink).map(_=>({..._,from:v+_.start+1,to:v+_.end+1})).filter(_=>r.schema.marks.code?!r.doc.rangeHasMark(_.from,_.to,r.schema.marks.code):!0).filter(_=>n.validate(_.value)).filter(_=>n.shouldAutoLink(_.value)).forEach(_=>{qw(_.from,_.to,r.doc).some(b=>b.mark.type===n.type)||o.addMark(_.from,_.to,n.type.create({href:_.href}))})}}),!!o.steps.length)return o}})}function RG(n){return new bt({key:new En("handleClickLink"),props:{handleClick:(e,t,r)=>{var s,i;if(r.button!==0||!e.editable)return!1;let o=r.target;const a=[];for(;o.nodeName!=="DIV";)a.push(o),o=o.parentNode;if(!a.find(p=>p.nodeName==="A"))return!1;const l=E2(e.state,n.type.name),c=r.target,u=(s=c==null?void 0:c.href)!==null&&s!==void 0?s:l.href,h=(i=c==null?void 0:c.target)!==null&&i!==void 0?i:l.target;return c&&u?(window.open(u,h),!0):!1}}})}function PG(n){return new bt({key:new En("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{state:s}=e,{selection:i}=s,{empty:o}=i;if(o)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=L2(a,{defaultProtocol:n.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!l?!1:n.editor.commands.setMark(n.type,{href:l.href})}}})}function qi(n,e){const t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&t.push(s)}),!n||n.replace(NG,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}const DG=gr.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){UT(n);return}UT(n.scheme,n.optionalSlashes)})},onDestroy(){bG()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,e)=>!!qi(n,e.protocols),validate:n=>!!n,shouldAutoLink:n=>!!n}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const e=n.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!qi(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:e=>!!qi(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",pt(this.options.HTMLAttributes,n),0]:["a",pt(this.options.HTMLAttributes,{...n,href:""}),0]},addCommands(){return{setLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!qi(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!qi(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run():!1},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Ni({find:n=>{const e=[];if(n){const{protocols:t,defaultProtocol:r}=this.options,s=L2(n).filter(i=>i.isLink&&this.options.isAllowedUri(i.value,{defaultValidate:o=>!!qi(o,t),protocols:t,defaultProtocol:r}));s.length&&s.forEach(i=>e.push({text:i.value,data:{href:i.href},index:i.start}))}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)===null||e===void 0?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&n.push(AG({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!qi(s,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&n.push(RG({type:this.type})),this.options.linkOnPaste&&n.push(PG({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),n}}),MG=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,OG=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,jG=gr.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",pt(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[Ho({find:MG,type:this.type})]},addPasteRules(){return[Ni({find:OG,type:this.type})]}}),$T=({entry:n=null,onSave:e,onCancel:t})=>{const{currentUser:r}=_n(),[s,i]=O.useState((n==null?void 0:n.title)||""),[o,a]=O.useState((n==null?void 0:n.tags)||[]),[l,c]=O.useState((n==null?void 0:n.linkedGoals)||[]),[u,h]=O.useState([]),[p,m]=O.useState(!1),[g,v]=O.useState(!1),[x,_]=O.useState(!1),[b,T]=O.useState(""),[A,R]=O.useState("1.0"),[D,k]=O.useState(!1),[E,S]=O.useState(!0),[C,M]=O.useState(!1),P=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"],N=rK({extensions:[oG.configure({heading:{levels:[1,2,3]}}),lG,DG.configure({openOnClick:!1,HTMLAttributes:{class:"text-primary-600 hover:text-primary-700 underline"}}),jG.configure({multicolor:!1,HTMLAttributes:{class:"bg-purple-200 dark:bg-purple-900"}}),aG.configure({placeholder:"Start writing your journal entry...",emptyNodeClass:"is-editor-empty"})],content:(n==null?void 0:n.content)||"",editorProps:{attributes:{class:"tiptap prose dark:prose-invert max-w-none focus:outline-none min-h-[400px] p-4"}},onUpdate:({editor:X})=>{ye(X.getText().length)}}),[ae,ye]=O.useState(0),H=X=>{switch(X){case"0.5":return"leading-tight";case"0.75":return"leading-snug";case"1.0":return"leading-normal";case"1.5":return"leading-relaxed";case"2.0":return"leading-loose";default:return"leading-normal"}};O.useEffect(()=>{if(N){ye(N.getText().length);const X=H(A),nt=E?"prose-p:mb-4":"prose-p:mb-0";N.view.dom.className=`tiptap prose dark:prose-invert max-w-none focus:outline-none min-h-[400px] p-4 ${X} ${nt}`}},[N,A,E]),O.useEffect(()=>{ee()},[r]);const ee=async()=>{if(r)try{const X=zn($n(be,"goals"),vt("userId","==",r.uid),vt("status","==","active")),Gt=(await Wn(X)).docs.map(jn=>({id:jn.id.replace(`${r.uid}_`,""),...jn.data()}));h(Gt)}catch(X){console.error("Error fetching goals:",X)}},B=X=>{a(nt=>nt.includes(X)?nt.filter(Gt=>Gt!==X):[...nt,X])},Q=X=>{c(nt=>nt.includes(X)?nt.filter(Gt=>Gt!==X):[...nt,X])},le=async()=>{if(!s.trim()&&!(N!=null&&N.getText().trim()))return;v(!0);const X={title:s.trim()||"Untitled Entry",content:(N==null?void 0:N.getHTML())||"",tags:o,linkedGoals:l};await e(X),v(!1)},Ie=()=>{b&&(N.chain().focus().setLink({href:b}).run(),T(""),_(!1))},Ee=()=>{N.chain().focus().unsetLink().run(),_(!1)},ve=X=>{R(X),k(!1)};return N?f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 dark:text-white",children:n?"Edit Journal Entry":"New Journal Entry"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:le,disabled:g,className:"hidden sm:flex btn-primary items-center",children:g?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(yo,{className:"h-5 w-5 mr-2"}),"Save Entry"]})}),f.jsx("button",{onClick:t,className:"hidden sm:block btn-secondary",disabled:g,children:"Cancel"}),f.jsx("button",{onClick:le,disabled:g,className:"sm:hidden p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:g?f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):f.jsx(yo,{className:"h-5 w-5"})}),f.jsx("button",{onClick:t,className:"sm:hidden p-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",disabled:g,children:f.jsx(Jn,{className:"h-5 w-5"})})]})]})}),f.jsxs("div",{className:"px-3 sm:px-4 py-3 sm:py-4 border-b border-gray-200 dark:border-gray-700",children:[f.jsx("input",{type:"text",value:s,onChange:X=>i(X.target.value),placeholder:"Entry Title",className:"w-full text-lg sm:text-xl font-semibold bg-transparent border-none outline-none text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-600 mb-3"}),f.jsxs("div",{className:"sm:hidden mb-3",children:[f.jsxs("button",{onClick:()=>M(!C),className:"flex items-center justify-between w-full text-left",children:[f.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[f.jsx(q0,{className:"h-4 w-4 mr-1"}),"Tags & Goals"]}),C?f.jsx(mm,{className:"h-4 w-4 text-gray-500"}):f.jsx(NR,{className:"h-4 w-4 text-gray-500"})]}),!C&&f.jsxs("div",{className:"mt-2 space-y-3",children:[f.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(X=>f.jsx("button",{onClick:()=>B(X),className:`px-2 py-1 text-xs rounded-full transition-colors ${o.includes(X)?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:X},X))}),f.jsxs("div",{children:[f.jsxs("button",{onClick:()=>m(!p),className:"flex items-center text-xs text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300",children:[f.jsx(Bg,{className:"h-4 w-4 mr-1"}),"Link to Goals (",l.length,")"]}),p&&f.jsx("div",{className:"mt-2 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-32 overflow-y-auto",children:u.length===0?f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No active goals available"}):f.jsx("div",{className:"space-y-1",children:u.map(X=>f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-1 rounded",children:[f.jsx("input",{type:"checkbox",checked:l.includes(X.id),onChange:()=>Q(X.id),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),f.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:X.title})]},X.id))})})]})]})]}),f.jsx("div",{className:"hidden sm:block space-y-3",children:f.jsxs("div",{children:[f.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[f.jsx(q0,{className:"h-4 w-4 mr-1"}),"Tags"]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(X=>f.jsx("button",{onClick:()=>B(X),className:`px-3 py-1 text-sm rounded-full transition-colors ${o.includes(X)?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:X},X))})]})}),f.jsxs("div",{children:[f.jsxs("button",{onClick:()=>m(!p),className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center hover:text-primary-600 dark:hover:text-primary-400",children:[f.jsx(Bg,{className:"h-4 w-4 mr-1"}),"Link to Goals (",l.length,")"]}),p&&f.jsx("div",{className:"mt-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-48 overflow-y-auto",children:u.length===0?f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No active goals available"}):f.jsx("div",{className:"space-y-2",children:u.map(X=>f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded",children:[f.jsx("input",{type:"checkbox",checked:l.includes(X.id),onChange:()=>Q(X.id),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:X.title}),f.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",X.subsection,")"]})]},X.id))})})]})]}),f.jsx("div",{className:`border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 transition-all duration-200 ${D?"p-2 sm:p-3":"p-2 sm:p-3 overflow-x-auto"}`,children:f.jsxs("div",{className:`flex items-center space-x-1 sm:space-x-2 ${D?"":"min-w-max"}`,children:[f.jsxs("div",{className:"flex items-center space-x-1 border-r border-gray-300 dark:border-gray-600 pr-2",children:[f.jsx("button",{onClick:()=>N.chain().focus().toggleHeading({level:1}).run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("heading",{level:1})?"bg-gray-200 dark:bg-gray-700":""}`,title:"Heading",children:f.jsx(g$,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().toggleHeading({level:2}).run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("heading",{level:2})?"bg-gray-200 dark:bg-gray-700":""}`,title:"Subheading",children:f.jsx(v$,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().setParagraph().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("paragraph")&&!N.isActive("heading")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Body text",children:f.jsx(yz,{className:"h-4 w-4"})})]}),f.jsxs("div",{className:"flex items-center space-x-1 border-r border-gray-300 dark:border-gray-600 pr-2",children:[f.jsx("button",{onClick:()=>N.chain().focus().toggleBold().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("bold")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Bold",children:f.jsx(HU,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().toggleItalic().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("italic")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Italic",children:f.jsx(E$,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().toggleUnderline().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("underline")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Underline",children:f.jsx(xz,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().toggleStrike().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("strike")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Strikethrough",children:f.jsx(ez,{className:"h-4 w-4"})})]}),f.jsxs("div",{className:"flex items-center space-x-1 border-r border-gray-300 dark:border-gray-600 pr-2",children:[f.jsx("button",{onClick:()=>N.chain().focus().toggleBulletList().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("bulletList")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Bullet list",children:f.jsx(RR,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().toggleOrderedList().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("orderedList")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Numbered list",children:f.jsx(T$,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().toggleBlockquote().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("blockquote")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Quote",children:f.jsx(B$,{className:"h-4 w-4"})})]}),f.jsxs("div",{className:"flex items-center space-x-1 border-r border-gray-300 dark:border-gray-600 pr-2",children:[f.jsx("button",{onClick:()=>N.chain().focus().toggleHighlight().run(),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("highlight")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Highlight",children:f.jsx(w$,{className:"h-4 w-4 text-purple-600"})}),f.jsx("button",{onClick:()=>S(!E),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${E?"bg-gray-200 dark:bg-gray-700":""}`,title:E?"Remove paragraph spacing":"Add paragraph spacing",children:f.jsx(V$,{className:"h-4 w-4"})}),D?f.jsxs("div",{className:"flex items-center space-x-1 bg-white dark:bg-gray-700 rounded-lg px-2 py-1",children:[f.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400 mr-1",children:"Spacing:"}),["0.5","0.75","1.0","1.5","2.0"].map(X=>f.jsx("button",{onClick:()=>ve(X),className:`px-2 py-1 text-xs rounded hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors ${A===X?"bg-gray-200 dark:bg-gray-600 font-semibold":""}`,children:X},X)),f.jsx("button",{onClick:()=>k(!1),className:"ml-1 p-1 hover:bg-gray-100 dark:hover:bg-gray-600 rounded",children:f.jsx(Jn,{className:"h-3 w-3"})})]}):f.jsx("button",{onClick:()=>k(!0),className:"p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Line spacing",children:f.jsx(VU,{className:"h-4 w-4"})})]}),f.jsx("div",{className:"flex items-center space-x-1 border-r border-gray-300 dark:border-gray-600 pr-2",children:x?f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx("input",{type:"text",value:b,onChange:X=>T(X.target.value),placeholder:"URL",className:"px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700",onKeyDown:X=>{X.key==="Enter"&&Ie()}}),f.jsx("button",{onClick:Ie,className:"p-1 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded",children:f.jsx(yo,{className:"h-3 w-3"})}),f.jsx("button",{onClick:Ee,className:"p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:f.jsx(Jn,{className:"h-3 w-3"})})]}):f.jsx("button",{onClick:()=>_(!0),className:`p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${N.isActive("link")?"bg-gray-200 dark:bg-gray-700":""}`,title:"Add link",children:f.jsx(Bg,{className:"h-4 w-4"})})}),f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx("button",{onClick:()=>N.chain().focus().undo().run(),className:"p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",disabled:!N.can().undo(),children:f.jsx(_z,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>N.chain().focus().redo().run(),className:"p-1.5 sm:p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",disabled:!N.can().redo(),children:f.jsx($$,{className:"h-4 w-4"})})]}),f.jsx("div",{className:"flex-1"}),f.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 hidden sm:block",children:[ae," characters"]})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto bg-white dark:bg-gray-900",children:f.jsx(Kq,{editor:N})})]}):null},VG=()=>{const{currentUser:n}=_n(),[e,t]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(null),[a,l]=O.useState(!1),[c,u]=O.useState(!1),[h,p]=O.useState(!0),[m,g]=O.useState(!0),[v,x]=O.useState(""),[_,b]=O.useState([]),[T,A]=O.useState("all"),[R,D]=O.useState(""),[k,E]=O.useState(""),S=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"];O.useEffect(()=>{C()},[n]),O.useEffect(()=>{M()},[e,v,_,T,R,k]);const C=async()=>{if(n)try{const H=zn($n(be,"journalEntries"),vt("userId","==",n.uid),ss("date","desc")),B=(await Wn(H)).docs.map(Q=>({id:Q.id.replace(`${n.uid}_`,""),...Q.data()}));t(B),s(B),B.length>0&&!i&&o(B[0])}catch(H){console.error("Error fetching journal entries:",H),oe.error("Failed to load journal entries")}finally{p(!1)}},M=()=>{let H=[...e];if(v&&(H=H.filter(ee=>{var B,Q;return((B=ee.title)==null?void 0:B.toLowerCase().includes(v.toLowerCase()))||((Q=ee.content)==null?void 0:Q.toLowerCase().includes(v.toLowerCase()))})),_.length>0&&(H=H.filter(ee=>{var B;return(B=ee.tags)==null?void 0:B.some(Q=>_.includes(Q))})),T!=="all"){const ee=new Date;let B,Q;switch(T){case"today":B=new Date(ee.setHours(0,0,0,0)),Q=new Date(ee.setHours(23,59,59,999));break;case"week":B=new Date(ee.setDate(ee.getDate()-7)),Q=new Date;break;case"month":B=Vf(ee),Q=jf(ee);break;case"three-months":B=Ph(ee,3),Q=new Date;break;case"custom":B=R?new Date(R):null,Q=k?new Date(k):null;break}B&&Q&&(H=H.filter(le=>{var Ee;const Ie=((Ee=le.date)==null?void 0:Ee.toDate())||new Date;return Ie>=B&&Ie<=Q}))}s(H)},P=async H=>{if(n)try{const ee=`entry_${Date.now()}`,B={...H,userId:n.uid,date:new Date,createdAt:ur(),updatedAt:ur()};await Mr(et(be,"journalEntries",`${n.uid}_${ee}`),B);const Q={id:ee,...B,date:{toDate:()=>new Date},createdAt:{toDate:()=>new Date},updatedAt:{toDate:()=>new Date}};t([Q,...e]),o(Q),l(!1),oe.success("Journal entry created successfully")}catch(ee){console.error("Error creating entry:",ee),oe.error("Failed to create journal entry")}},N=async H=>{if(!(!n||!i))try{const ee={...H,updatedAt:ur()};await Mr(et(be,"journalEntries",`${n.uid}_${i.id}`),ee,{merge:!0});const B=e.map(Q=>Q.id===i.id?{...Q,...ee,updatedAt:{toDate:()=>new Date}}:Q);t(B),o({...i,...ee}),u(!1),oe.success("Journal entry updated successfully")}catch(ee){console.error("Error updating entry:",ee),oe.error("Failed to update journal entry")}},ae=async H=>{if(!(!n||!confirm("Are you sure you want to delete this entry?")))try{await hl(et(be,"journalEntries",`${n.uid}_${H}`));const ee=e.filter(B=>B.id!==H);t(ee),(i==null?void 0:i.id)===H&&o(ee[0]||null),oe.success("Journal entry deleted successfully")}catch(ee){console.error("Error deleting entry:",ee),oe.error("Failed to delete journal entry")}},ye=H=>{b(ee=>ee.includes(H)?ee.filter(B=>B!==H):[...ee,H])};return h?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"flex h-[calc(100vh-8rem)] -mx-4 sm:-mx-6 lg:-mx-8",children:[f.jsx("button",{onClick:()=>g(!m),className:"lg:hidden fixed bottom-4 right-4 z-40 btn-primary rounded-full p-3 shadow-lg",children:m?f.jsx(Jn,{className:"h-6 w-6"}):f.jsx(go,{className:"h-6 w-6"})}),f.jsxs("div",{className:`${m?"translate-x-0":"-translate-x-full"} lg:translate-x-0 fixed lg:relative z-30 lg:z-auto w-80 lg:w-96 h-full bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-transform duration-300 overflow-hidden flex flex-col`,children:[f.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Journal Entries"}),f.jsx("button",{onClick:()=>{l(!0),o(null),g(!1)},className:"btn-primary p-2",children:f.jsx(pr,{className:"h-5 w-5"})})]}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:v,onChange:H=>x(H.target.value),placeholder:"Search entries...",className:"input pl-10"}),f.jsx(H$,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),f.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"mb-3",children:[f.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2 block",children:"Time Period"}),f.jsxs("select",{value:T,onChange:H=>A(H.target.value),className:"input text-sm",children:[f.jsx("option",{value:"all",children:"All Time"}),f.jsx("option",{value:"today",children:"Today"}),f.jsx("option",{value:"week",children:"Past Week"}),f.jsx("option",{value:"month",children:"This Month"}),f.jsx("option",{value:"three-months",children:"Past 3 Months"}),f.jsx("option",{value:"custom",children:"Custom Range"})]})]}),T==="custom"&&f.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[f.jsx("input",{type:"date",value:R,onChange:H=>D(H.target.value),className:"input text-sm"}),f.jsx("input",{type:"date",value:k,onChange:H=>E(H.target.value),className:"input text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2 block",children:"Tags"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(H=>f.jsx("button",{onClick:()=>ye(H),className:`px-2 py-1 text-xs rounded-full transition-colors ${_.includes(H)?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:H},H))})]})]}),f.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?f.jsxs("div",{className:"p-8 text-center",children:[f.jsx(go,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.length===0?"No journal entries yet":"No entries match your filters"})]}):f.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:r.map(H=>{var ee;return f.jsxs("div",{onClick:()=>{o(H),l(!1),u(!1),g(!1)},className:`p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors ${(i==null?void 0:i.id)===H.id?"bg-primary-50 dark:bg-primary-900/20 border-l-4 border-primary-600":""}`,children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:H.title||"Untitled Entry"}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2 mb-2",children:[(ee=H.content)==null?void 0:ee.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[f.jsx(Fo,{className:"h-3 w-3 mr-1"}),H.date&&Zt(H.date.toDate(),"MMM d, yyyy")]}),H.tags&&H.tags.length>0&&f.jsxs("div",{className:"flex items-center space-x-1",children:[H.tags.slice(0,2).map(B=>f.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full",children:B},B)),H.tags.length>2&&f.jsxs("span",{className:"text-xs text-gray-500",children:["+",H.tags.length-2]})]})]})]},H.id)})})})]}),f.jsx("div",{className:"flex-1 bg-white dark:bg-gray-900 overflow-hidden",children:a?f.jsx($T,{onSave:P,onCancel:()=>{l(!1),o(r[0]||null)}}):c&&i?f.jsx($T,{entry:i,onSave:N,onCancel:()=>u(!1)}):i?f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:i.title||"Untitled Entry"}),f.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(Fo,{className:"h-4 w-4 mr-1"}),i.date&&Zt(i.date.toDate(),"MMMM d, yyyy")]}),i.tags&&i.tags.length>0&&f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(q0,{className:"h-4 w-4"}),i.tags.map(H=>f.jsx("span",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded text-xs",children:H},H))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>u(!0),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:f.jsx(gm,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),f.jsx("button",{onClick:()=>ae(i.id),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:f.jsx(Bo,{className:"h-5 w-5 text-red-600 dark:text-red-400"})})]})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:f.jsx("div",{className:"prose dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:i.content}})})]}):f.jsx("div",{className:"h-full flex items-center justify-center p-4",children:f.jsxs("div",{className:"text-center",children:[f.jsx(go,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-4",children:"Select an entry to read or create a new one"}),f.jsxs("button",{onClick:()=>l(!0),className:"btn-primary inline-flex items-center",children:[f.jsx(pr,{className:"h-5 w-5 mr-2"}),"Create New Entry"]})]})})})]})},ja=({goal:n,onUpdate:e,onDelete:t})=>{var D;const{currentUser:r}=_n(),[s,i]=O.useState(!1),[o,a]=O.useState(!1),[l,c]=O.useState(n.actionSteps||[]),[u,h]=O.useState(!1),p=()=>{var E;const k=(E=n.actionSteps)==null?void 0:E.filter(S=>!S.completed);return k==null?void 0:k[0]},m=async k=>{const E=[...l];E[k].completed=!E[k].completed,E[k].targetValue&&(E[k].currentValue=E[k].completed?E[k].targetValue:0),await v(E)},g=k=>{if(!k||k.length===0)return 0;let E=0,S=0;return k.forEach(C=>{C.targetValue?(E+=C.targetValue,S+=C.currentValue||0):(E+=1,S+=C.completed?1:0)}),Math.round(S/E*100)},v=async k=>{h(!0);try{const E=g(k),S=E===100?"completed":"active";await wR(et(be,"goals",`${r.uid}_${n.id}`),{actionSteps:k,progress:E,status:S,updatedAt:new Date}),c(k),e&&e({...n,actionSteps:k,progress:E,status:S}),oe.success("Goal updated successfully"),a(!1)}catch(E){console.error("Error updating goal:",E),oe.error("Failed to update goal")}finally{h(!1)}},x=async()=>{if(confirm("Are you sure you want to delete this goal?")){h(!0);try{await hl(et(be,"goals",`${r.uid}_${n.id}`)),t&&t(n.id),oe.success("Goal deleted successfully")}catch(k){console.error("Error deleting goal:",k),oe.error("Failed to delete goal")}finally{h(!1)}}},_=()=>{c([...l,{id:Date.now().toString(),description:"",completed:!1,targetValue:null,currentValue:0}])},b=k=>{c(l.filter((E,S)=>S!==k))},T=(k,E,S)=>{const C=[...l];C[k][E]=S,c(C)},A=p(),R={weekly:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",monthly:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",yearly:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",custom:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"};return f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-start justify-between mb-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:n.title}),f.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${R[n.timeframe]}`,children:n.timeframe}),f.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:n.subsection})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>a(!o),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:u,children:f.jsx(gm,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),f.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:u,children:f.jsx(Bo,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Progress"}),f.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[n.progress||0,"%"]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar-fill",style:{width:`${n.progress||0}%`}})})]}),!s&&A&&f.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[f.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"Next Step:"}),f.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[A.description,A.targetValue&&f.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:["(",A.currentValue||0,"/",A.targetValue,")"]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400 mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(Fo,{className:"h-4 w-4 mr-1"}),"Start:"," ",n.startDate&&Zt(n.startDate.toDate(),"MMM d, yyyy")]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(CR,{className:"h-4 w-4 mr-1"}),"End: ",n.endDate&&Zt(n.endDate.toDate(),"MMM d, yyyy")]})]}),f.jsx("button",{onClick:()=>i(!s),className:"w-full flex items-center justify-center py-2 text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors",children:s?f.jsxs(f.Fragment,{children:[f.jsx(NR,{className:"h-4 w-4 mr-1"}),"Hide Details"]}):f.jsxs(f.Fragment,{children:[f.jsx(mm,{className:"h-4 w-4 mr-1"}),"Show All Steps"]})}),s&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Action Steps"}),o?f.jsxs("div",{className:"space-y-3",children:[l.map((k,E)=>f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx("input",{type:"text",value:k.description,onChange:S=>T(E,"description",S.target.value),className:"input flex-1",placeholder:"Step description"}),f.jsx("input",{type:"number",value:k.targetValue||"",onChange:S=>T(E,"targetValue",S.target.value?parseInt(S.target.value):null),className:"input w-20",placeholder:"Target"}),f.jsx("button",{onClick:()=>b(E),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:f.jsx(Bo,{className:"h-4 w-4"})})]},k.id)),f.jsxs("div",{className:"flex space-x-2 mt-4",children:[f.jsx("button",{onClick:_,className:"btn-secondary",children:"Add Step"}),f.jsx("button",{onClick:()=>v(l),className:"btn-primary",disabled:u,children:"Save Changes"}),f.jsx("button",{onClick:()=>{c(n.actionSteps||[]),a(!1)},className:"btn-secondary",children:"Cancel"})]})]}):f.jsx("div",{className:"space-y-2",children:(D=n.actionSteps)==null?void 0:D.map((k,E)=>f.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg cursor-pointer",onClick:()=>m(E),children:[k.completed?f.jsx(XU,{className:"h-5 w-5 text-green-600 flex-shrink-0"}):f.jsx(e$,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),f.jsx("span",{className:`flex-1 ${k.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:k.description}),k.targetValue&&f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[k.currentValue||0,"/",k.targetValue]})]},k.id))})]})]})},F2=({subsection:n,onClose:e,onGoalCreated:t,parentGoal:r=null})=>{const{currentUser:s}=_n(),[i,o]=O.useState(!1),[a,l]=O.useState(!1),[c,u]=O.useState({title:"",description:"",timeframe:"monthly",customStartDate:"",customEndDate:"",actionSteps:[{id:"1",description:"",completed:!1,targetValue:null,currentValue:0}],parentGoalId:(r==null?void 0:r.id)||null}),h=()=>{const x=new Date;let _,b;switch(c.timeframe){case"weekly":_=Si(x),b=Oz(x);break;case"monthly":_=Vf(x),b=jf(x);break;case"yearly":_=jR(x),b=Mz(x);break;case"custom":_=c.customStartDate?new Date(c.customStartDate):x,b=c.customEndDate?new Date(c.customEndDate):K0(x,30);break;default:_=x,b=K0(x,30)}return{startDate:_,endDate:b}},p=()=>{u({...c,actionSteps:[...c.actionSteps,{id:Date.now().toString(),description:"",completed:!1,targetValue:null,currentValue:0}]})},m=x=>{c.actionSteps.length>1&&u({...c,actionSteps:c.actionSteps.filter((_,b)=>b!==x)})},g=(x,_,b)=>{const T=[...c.actionSteps];_==="targetValue"?T[x][_]=b?parseInt(b):null:T[x][_]=b,u({...c,actionSteps:T})},v=async x=>{if(x.preventDefault(),!c.title.trim()){oe.error("Please enter a goal title");return}if(c.actionSteps.every(_=>!_.description.trim())){oe.error("Please add at least one action step");return}o(!0);try{const{startDate:_,endDate:b}=h(),T=`goal_${Date.now()}`,A=c.actionSteps.filter(D=>D.description.trim()),R={title:c.title,description:c.description,subsection:n,timeframe:c.timeframe,startDate:_,endDate:b,actionSteps:A,progress:0,status:"active",userId:s.uid,parentGoalId:c.parentGoalId,createdAt:ur(),updatedAt:ur()};await Mr(et(be,"goals",`${s.uid}_${T}`),R),oe.success("Goal created successfully!"),t&&t({id:T,...R,startDate:{toDate:()=>_},endDate:{toDate:()=>b},createdAt:{toDate:()=>new Date},updatedAt:{toDate:()=>new Date}}),e()}catch(_){console.error("Error creating goal:",_),oe.error("Failed to create goal")}finally{o(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create New Goal"}),f.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:f.jsx(Jn,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),r&&f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Creating sub-goal for: ",r.title]})]}),f.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Goal Title *"}),f.jsx("input",{type:"text",value:c.title,onChange:x=>u({...c,title:x.target.value}),className:"input",placeholder:"e.g., Attend 20 Jiu Jitsu classes this month",disabled:i})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Description (Optional)"}),f.jsx("textarea",{value:c.description,onChange:x=>u({...c,description:x.target.value}),className:"input min-h-[80px]",placeholder:"Add more details about this goal...",disabled:i})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Timeframe"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:["weekly","monthly","yearly","custom"].map(x=>f.jsx("button",{type:"button",onClick:()=>u({...c,timeframe:x}),className:`px-4 py-2 rounded-lg border-2 transition-colors ${c.timeframe===x?"border-primary-600 bg-primary-50 dark:bg-primary-900/20 text-primary-600":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,disabled:i,children:x.charAt(0).toUpperCase()+x.slice(1)},x))})]}),c.timeframe==="custom"&&f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Start Date"}),f.jsx("input",{type:"date",value:c.customStartDate,onChange:x=>u({...c,customStartDate:x.target.value}),className:"input",disabled:i})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"End Date"}),f.jsx("input",{type:"date",value:c.customEndDate,onChange:x=>u({...c,customEndDate:x.target.value}),className:"input",disabled:i})]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"label mb-3",children:["Action Steps *",f.jsx("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:"(Define the steps needed to achieve this goal)"})]}),f.jsx("div",{className:"space-y-3",children:c.actionSteps.map((x,_)=>f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx("div",{className:"flex-1",children:f.jsx("input",{type:"text",value:x.description,onChange:b=>g(_,"description",b.target.value),className:"input",placeholder:`Step ${_+1}: e.g., Attend class #${_+1}`,disabled:i})}),f.jsx("div",{className:"w-24",children:f.jsx("input",{type:"number",value:x.targetValue||"",onChange:b=>g(_,"targetValue",b.target.value),className:"input",placeholder:"Target",disabled:i})}),c.actionSteps.length>1&&f.jsx("button",{type:"button",onClick:()=>m(_),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",disabled:i,children:f.jsx(Bo,{className:"h-5 w-5"})})]},x.id))}),f.jsxs("button",{type:"button",onClick:p,className:"mt-3 btn-secondary flex items-center",disabled:i,children:[f.jsx(pr,{className:"h-4 w-4 mr-2"}),"Add Step"]})]}),f.jsxs("div",{children:[f.jsxs("button",{type:"button",onClick:()=>l(!a),className:"flex items-center text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:[f.jsx(mm,{className:`h-4 w-4 mr-1 transition-transform ${a?"rotate-180":""}`}),"Advanced Options"]}),a&&f.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Advanced options like goal dependencies, notifications, and custom metrics will be available soon."})})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("button",{type:"button",onClick:e,className:"btn-secondary",disabled:i,children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn-primary flex items-center",disabled:i,children:i?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Ti,{className:"h-4 w-4 mr-2"}),"Create Goal"]})})]})]})]})})},LG=()=>{const{currentUser:n}=_n(),[e,t]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[a,l]=O.useState(!1),[c,u]=O.useState("all"),[h,p]=O.useState("all"),[m,g]=O.useState("active"),v=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"];O.useEffect(()=>{x()},[n]),O.useEffect(()=>{_()},[e,c,h,m]);const x=async()=>{if(n)try{const A=zn($n(be,"goals"),vt("userId","==",n.uid),ss("createdAt","desc")),D=(await Wn(A)).docs.map(k=>({id:k.id.replace(`${n.uid}_`,""),...k.data()}));t(D)}catch(A){console.error("Error fetching goals:",A)}finally{o(!1)}},_=()=>{let A=[...e];m!=="all"&&(A=A.filter(R=>R.status===m)),c!=="all"&&(A=A.filter(R=>R.timeframe===c)),h!=="all"&&(A=A.filter(R=>R.subsection===h)),s(A)},b=A=>r.filter(R=>R.timeframe===A),T={total:e.length,active:e.filter(A=>A.status==="active").length,completed:e.filter(A=>A.status==="completed").length,thisWeek:e.filter(A=>{var D;const R=(D=A.startDate)==null?void 0:D.toDate();return R&&L9(R)}).length,thisMonth:e.filter(A=>{var D;const R=(D=A.startDate)==null?void 0:D.toDate();return R&&V9(R)}).length,thisYear:e.filter(A=>{var D;const R=(D=A.startDate)==null?void 0:D.toDate();return R&&F9(R)}).length};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Goals Overview"}),f.jsx("p",{className:"opacity-90",children:"Track and manage all your goals across different life areas"})]}),f.jsxs("button",{onClick:()=>l(!0),className:"bg-white text-primary-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(pr,{className:"h-5 w-5 mr-2"}),"New Goal"]})]})}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T.total}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Goals"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-primary-600",children:T.active}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.completed}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.thisWeek}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Week"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-purple-600",children:T.thisMonth}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Month"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-orange-600",children:T.thisYear}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Year"})]})]}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex flex-wrap gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Status"}),f.jsxs("select",{value:m,onChange:A=>g(A.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Status"}),f.jsx("option",{value:"active",children:"Active"}),f.jsx("option",{value:"completed",children:"Completed"}),f.jsx("option",{value:"paused",children:"Paused"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Timeframe"}),f.jsxs("select",{value:c,onChange:A=>u(A.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Timeframes"}),f.jsx("option",{value:"weekly",children:"Weekly"}),f.jsx("option",{value:"monthly",children:"Monthly"}),f.jsx("option",{value:"yearly",children:"Yearly"}),f.jsx("option",{value:"custom",children:"Custom"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Life Area"}),f.jsxs("select",{value:h,onChange:A=>p(A.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Areas"}),v.map(A=>f.jsx("option",{value:A,children:A.charAt(0).toUpperCase()+A.slice(1)},A))]})]})]})}),c==="all"?f.jsxs(f.Fragment,{children:[b("yearly").length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Yearly Goals (",b("yearly").length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:b("yearly").map(A=>f.jsx(ja,{goal:A,onUpdate:R=>{t(e.map(D=>D.id===R.id?R:D))},onDelete:R=>{t(e.filter(D=>D.id!==R))}},A.id))})]}),b("monthly").length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Monthly Goals (",b("monthly").length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:b("monthly").map(A=>f.jsx(ja,{goal:A,onUpdate:R=>{t(e.map(D=>D.id===R.id?R:D))},onDelete:R=>{t(e.filter(D=>D.id!==R))}},A.id))})]}),b("weekly").length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Weekly Goals (",b("weekly").length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:b("weekly").map(A=>f.jsx(ja,{goal:A,onUpdate:R=>{t(e.map(D=>D.id===R.id?R:D))},onDelete:R=>{t(e.filter(D=>D.id!==R))}},A.id))})]})]}):f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Filtered Goals (",r.length,")"]}),r.length===0?f.jsxs("div",{className:"card text-center py-12",children:[f.jsx(Ti,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No goals match your filters"})]}):f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:r.map(A=>f.jsx(ja,{goal:A,onUpdate:R=>{t(e.map(D=>D.id===R.id?R:D))},onDelete:R=>{t(e.filter(D=>D.id!==R))}},A.id))})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Access to Life Areas"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:v.map(A=>f.jsxs(Tn,{to:`/subsection/${A}`,className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:A.charAt(0).toUpperCase()+A.slice(1)}),f.jsx($0,{className:"h-4 w-4 text-gray-400"})]},A))})]}),a&&f.jsx(F2,{subsection:"general",onClose:()=>l(!1),onGoalCreated:A=>{t([A,...e]),l(!1)}})]})},FG=()=>{const{currentUser:n}=_n(),[e,t]=O.useState(!0),[r,s]=O.useState("30"),[i,o]=O.useState({journalStreak:0,totalJournalEntries:0,goalsCompleted:0,goalsActive:0,avgGoalProgress:0,jiuJitsuClasses:0,workouts:0});O.useEffect(()=>{a()},[n,r]);const a=async()=>{if(n)try{const h=xb(new Date,parseInt(r)),p=zn($n(be,"journalEntries"),vt("userId","==",n.uid),vt("date",">=",h),ss("date","desc")),m=await Wn(p),g=zn($n(be,"goals"),vt("userId","==",n.uid)),x=(await Wn(g)).docs.map(D=>D.data()),_=m.docs.map(D=>D.data()),b=x.filter(D=>D.status==="completed").length,T=x.filter(D=>D.status==="active").length,A=T>0?x.filter(D=>D.status==="active").reduce((D,k)=>D+(k.progress||0),0)/T:0,R=l(_);o({journalStreak:R,totalJournalEntries:_.length,goalsCompleted:b,goalsActive:T,avgGoalProgress:Math.round(A),jiuJitsuClasses:0,workouts:0})}catch(u){console.error("Error fetching stats:",u),oe.error("Failed to load statistics")}finally{t(!1)}},l=u=>{if(u.length===0)return 0;let h=0;const p=new Date,m=u.map(g=>{var v,x;return((x=(v=g.date)==null?void 0:v.toDate)==null?void 0:x.call(v))||new Date}).sort((g,v)=>v-g);for(let g=0;g<m.length;g++){const v=xb(p,g),x=m[g];if(Zt(x,"yyyy-MM-dd")===Zt(v,"yyyy-MM-dd"))h++;else break}return h},c=()=>{const u=`
Date Range,${r} days
Journal Streak,${i.journalStreak}
Total Journal Entries,${i.totalJournalEntries}
Goals Completed,${i.goalsCompleted}
Goals Active,${i.goalsActive}
Average Goal Progress,${i.avgGoalProgress}%
    `.trim(),h=new Blob([u],{type:"text/csv"}),p=window.URL.createObjectURL(h),m=document.createElement("a");m.href=p,m.download=`stats-${Zt(new Date,"yyyy-MM-dd")}.csv`,m.click(),oe.success("Stats exported to CSV")};return e?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Statistics"}),f.jsx("p",{className:"opacity-90",children:"Track your progress and analyze your performance"})]}),f.jsxs("button",{onClick:c,className:"bg-white text-purple-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(AR,{className:"h-5 w-5 mr-2"}),"Export CSV"]})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date Range"}),f.jsxs("select",{value:r,onChange:u=>s(u.target.value),className:"input w-auto",children:[f.jsx("option",{value:"7",children:"Last 7 days"}),f.jsx("option",{value:"30",children:"Last 30 days"}),f.jsx("option",{value:"90",children:"Last 90 days"}),f.jsx("option",{value:"365",children:"Last year"})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(go,{className:"h-8 w-8 text-purple-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.journalStreak})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Journal Streak"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Consecutive days"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(go,{className:"h-8 w-8 text-purple-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.totalJournalEntries})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Total Entries"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"In selected period"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(Ti,{className:"h-8 w-8 text-green-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.goalsCompleted})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Goals Completed"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Successfully achieved"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(Ti,{className:"h-8 w-8 text-blue-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.goalsActive})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Active Goals"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Currently pursuing"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(_w,{className:"h-8 w-8 text-orange-600"}),f.jsxs("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i.avgGoalProgress,"%"]})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Avg Progress"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Across active goals"})]}),f.jsxs("div",{className:"card opacity-50",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(Fo,{className:"h-8 w-8 text-indigo-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Jiu Jitsu Classes"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Coming soon"})]})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Progress Over Time"}),f.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50 dark:bg-gray-800 rounded-lg",children:f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Chart visualization will be implemented with Chart.js"})})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Life Areas Overview"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"Progress towards win states in each life area"}),f.jsx("div",{className:"space-y-4",children:["Finances","Fitness","Jiu Jitsu","Philosophy"].map(u=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:u}),f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Math.floor(Math.random()*100),"%"]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar-fill",style:{width:`${Math.floor(Math.random()*100)}%`}})})]},u))})]})]})},BG=()=>{var b,T,A,R;const{currentUser:n,userProfile:e,updateUserSettings:t,logout:r,resetPassword:s}=_n(),{theme:i,toggleTheme:o}=SR(),[a,l]=O.useState(!1),[c,u]=O.useState(!1),[h,p]=O.useState((e==null?void 0:e.displayName)||""),[m,g]=O.useState({emailNotifications:((b=e==null?void 0:e.settings)==null?void 0:b.emailNotifications)||!1,journalReminders:((T=e==null?void 0:e.settings)==null?void 0:T.journalReminders)||!1,goalDeadlineAlerts:((A=e==null?void 0:e.settings)==null?void 0:A.goalDeadlineAlerts)||!0,weeklyReports:((R=e==null?void 0:e.settings)==null?void 0:R.weeklyReports)||!1});O.useEffect(()=>{e!=null&&e.displayName&&p(e.displayName),e!=null&&e.settings&&g({emailNotifications:e.settings.emailNotifications||!1,journalReminders:e.settings.journalReminders||!1,goalDeadlineAlerts:e.settings.goalDeadlineAlerts||!0,weeklyReports:e.settings.weeklyReports||!1})},[e]);const v=async()=>{l(!0);try{await t({...e==null?void 0:e.settings,...m,displayName:h,theme:i}),oe.success("Settings saved successfully")}catch(D){console.error("Error saving settings:",D),oe.error("Failed to save settings")}finally{l(!1)}},x=async()=>{if(n!=null&&n.email){u(!0);try{await s(n.email),oe.success("Password reset email sent")}catch(D){console.error("Error sending reset email:",D),oe.error("Failed to send reset email")}finally{u(!1)}}},_=async()=>{confirm("Are you sure you want to sign out?")&&await r()};return f.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[f.jsxs("div",{className:"bg-gradient-to-r from-gray-700 to-gray-800 dark:from-gray-800 dark:to-gray-900 rounded-lg p-6 text-white",children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Settings"}),f.jsx("p",{className:"opacity-90",children:"Manage your account and application preferences"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(DR,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Profile Information"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Display Name"}),f.jsx("input",{type:"text",value:h,onChange:D=>p(D.target.value),placeholder:"Enter your name",className:"input"}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"This is how you'll be greeted in the app"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Email Address"}),f.jsx("input",{type:"email",value:(n==null?void 0:n.email)||"",disabled:!0,className:"input bg-gray-50 dark:bg-gray-800"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"User ID"}),f.jsx("input",{type:"text",value:(n==null?void 0:n.uid)||"",disabled:!0,className:"input bg-gray-50 dark:bg-gray-800 font-mono text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Member Since"}),f.jsx("input",{type:"text",value:e!=null&&e.createdAt?new Date(e.createdAt.seconds*1e3).toLocaleDateString():"N/A",disabled:!0,className:"input bg-gray-50 dark:bg-gray-800"})]})]}),f.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:f.jsx("button",{onClick:v,disabled:a,className:"btn-primary flex items-center",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(yo,{className:"h-4 w-4 mr-2"}),"Save Profile"]})})})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[i==="light"?f.jsx(Mf,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}):f.jsx(ww,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Appearance"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Theme"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Choose your preferred color scheme"})]}),f.jsx("button",{onClick:o,className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i==="dark"?"translate-x-6":"translate-x-1"}`})})]})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(zU,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Notifications"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Email Notifications"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Receive updates about your goals and progress"})]}),f.jsx("button",{onClick:()=>g({...m,emailNotifications:!m.emailNotifications}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.emailNotifications?"translate-x-6":"translate-x-1"}`})})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Journal Reminders"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Daily reminders to write in your journal"})]}),f.jsx("button",{onClick:()=>g({...m,journalReminders:!m.journalReminders}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.journalReminders?"translate-x-6":"translate-x-1"}`})})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Goal Deadline Alerts"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Notifications when goals are approaching deadlines"})]}),f.jsx("button",{onClick:()=>g({...m,goalDeadlineAlerts:!m.goalDeadlineAlerts}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.goalDeadlineAlerts?"translate-x-6":"translate-x-1"}`})})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Weekly Progress Reports"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Weekly email summary of your progress"})]}),f.jsx("button",{onClick:()=>g({...m,weeklyReports:!m.weeklyReports}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.weeklyReports?"translate-x-6":"translate-x-1"}`})})]})]}),f.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:f.jsx("button",{onClick:v,disabled:a,className:"btn-primary flex items-center",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(yo,{className:"h-4 w-4 mr-2"}),"Save Notification Settings"]})})})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(Q$,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Security"})]}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Password Reset"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Send a password reset link to your email address"}),f.jsx("button",{onClick:x,disabled:c,className:"btn-secondary flex items-center",children:c?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"}),"Sending..."]}):f.jsxs(f.Fragment,{children:[f.jsx(H0,{className:"h-4 w-4 mr-2"}),"Send Reset Email"]})})]})})]}),f.jsxs("div",{className:"card border-red-200 dark:border-red-900",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(W0,{className:"h-6 w-6 text-red-600 dark:text-red-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-red-600 dark:text-red-400",children:"Danger Zone"})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Sign out of your account on this device"}),f.jsxs("button",{onClick:_,className:"btn-danger flex items-center",children:[f.jsx(W0,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})]})},UG=()=>{const{subsectionName:n}=_j(),{currentUser:e}=_n(),[t,r]=O.useState(null),[s,i]=O.useState([]),[o,a]=O.useState(!1),[l,c]=O.useState(!1),[u,h]=O.useState(!0),[p,m]=O.useState({description:"",metrics:[]}),g={finances:{name:"Finances",icon:"",color:"bg-green-500",defaultMetrics:[{name:"Net Worth",unit:"$",targetValue:0,currentValue:0},{name:"Passive Income",unit:"$/month",targetValue:0,currentValue:0}]},fitness:{name:"Fitness",icon:"",color:"bg-blue-500",defaultMetrics:[{name:"Body Weight",unit:"lbs",targetValue:0,currentValue:0},{name:"Body Fat %",unit:"%",targetValue:0,currentValue:0},{name:"Bench Press",unit:"lbs",targetValue:0,currentValue:0}]},"jiu-jitsu":{name:"Jiu Jitsu",icon:"",color:"bg-purple-500",defaultMetrics:[{name:"Belt Level",unit:"",targetValue:0,currentValue:0},{name:"Classes Attended",unit:"classes",targetValue:0,currentValue:0},{name:"Competitions Won",unit:"wins",targetValue:0,currentValue:0}]},women:{name:"Women",icon:"",color:"bg-pink-500",defaultMetrics:[{name:"Relationship Quality",unit:"/10",targetValue:0,currentValue:0},{name:"Social Confidence",unit:"/10",targetValue:0,currentValue:0}]},attractiveness:{name:"Attractive",icon:"",color:"bg-yellow-500",defaultMetrics:[{name:"Physical Fitness",unit:"/10",targetValue:0,currentValue:0},{name:"Style & Grooming",unit:"/10",targetValue:0,currentValue:0},{name:"Charisma",unit:"/10",targetValue:0,currentValue:0}]},nutrition:{name:"Nutrition",icon:"",color:"bg-green-400",defaultMetrics:[{name:"Daily Calories",unit:"kcal",targetValue:0,currentValue:0},{name:"Protein Intake",unit:"g/day",targetValue:0,currentValue:0},{name:"Healthy Meals",unit:"/week",targetValue:0,currentValue:0}]},philosophy:{name:"Philosophy",icon:"",color:"bg-indigo-500",defaultMetrics:[{name:"Books Read",unit:"books",targetValue:0,currentValue:0},{name:"Meditation Practice",unit:"days/year",targetValue:0,currentValue:0},{name:"Life Satisfaction",unit:"/10",targetValue:0,currentValue:0}]},languages:{name:"Languages",icon:"",color:"bg-teal-500",defaultMetrics:[{name:"Languages Fluent",unit:"languages",targetValue:0,currentValue:0},{name:"Vocabulary Size",unit:"words",targetValue:0,currentValue:0},{name:"Practice Hours",unit:"hrs/week",targetValue:0,currentValue:0}]}},v=g[n]||g.fitness;O.useEffect(()=>{x()},[e,n]);const x=async()=>{var E,S;if(e)try{const C=await yw(et(be,"lifeSubsections",`${e.uid}_${n}`));if(C.exists()){const ae=C.data();r(ae.winState),m({description:((E=ae.winState)==null?void 0:E.description)||"",metrics:((S=ae.winState)==null?void 0:S.metrics)||v.defaultMetrics})}else m({description:"",metrics:v.defaultMetrics});const M=zn($n(be,"goals"),vt("userId","==",e.uid),vt("subsection","==",n),ss("createdAt","desc")),N=(await Wn(M)).docs.map(ae=>({id:ae.id.replace(`${e.uid}_`,""),...ae.data()}));i(N)}catch(C){console.error("Error fetching subsection data:",C),oe.error("Failed to load subsection data")}finally{h(!1)}},_=async()=>{if(e)try{await Mr(et(be,"lifeSubsections",`${e.uid}_${n}`),{name:n,userId:e.uid,winState:p,updatedAt:ur()},{merge:!0}),r(p),a(!1),oe.success("Win state updated successfully")}catch(E){console.error("Error saving win state:",E),oe.error("Failed to save win state")}},b=()=>{m({...p,metrics:[...p.metrics,{name:"",unit:"",targetValue:0,currentValue:0}]})},T=(E,S,C)=>{const M=[...p.metrics];M[E][S]=S.includes("Value")?parseFloat(C)||0:C,m({...p,metrics:M})},A=E=>{m({...p,metrics:p.metrics.filter((S,C)=>C!==E)})},R=()=>{if(!(t!=null&&t.metrics)||t.metrics.length===0)return 0;let E=0,S=0;return t.metrics.forEach(C=>{if(C.targetValue>0){const M=C.currentValue/C.targetValue*100;E+=Math.min(M,100),S++}}),S>0?Math.round(E/S):0},D=s.filter(E=>E.status==="active"),k=s.filter(E=>E.status==="completed");return u?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-700 dark:from-gray-900 dark:to-gray-800 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:`w-16 h-16 ${v.color} rounded-full flex items-center justify-center text-3xl`,children:v.icon}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold",children:v.name}),f.jsx("p",{className:"text-gray-300 mt-1",children:"Track your progress and achieve your goals"})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-sm text-gray-400",children:"Overall Progress"}),f.jsxs("p",{className:"text-3xl font-bold",children:[R(),"%"]})]})]})}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[f.jsx(mz,{className:"h-6 w-6 mr-2 text-yellow-500"}),"Win State"]}),f.jsx("button",{onClick:()=>a(!o),className:"btn-secondary flex items-center",children:o?f.jsxs(f.Fragment,{children:[f.jsx(Jn,{className:"h-4 w-4 mr-2"}),"Cancel"]}):f.jsxs(f.Fragment,{children:[f.jsx(gm,{className:"h-4 w-4 mr-2"}),"Edit"]})})]}),o?f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Win State Description"}),f.jsx("textarea",{value:p.description,onChange:E=>m({...p,description:E.target.value}),className:"input min-h-[100px]",placeholder:"Describe what success looks like in this area..."})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Success Metrics"}),f.jsx("div",{className:"space-y-3",children:p.metrics.map((E,S)=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"text",value:E.name,onChange:C=>T(S,"name",C.target.value),className:"input flex-1",placeholder:"Metric name"}),f.jsx("input",{type:"text",value:E.unit,onChange:C=>T(S,"unit",C.target.value),className:"input w-24",placeholder:"Unit"}),f.jsx("input",{type:"number",value:E.currentValue,onChange:C=>T(S,"currentValue",C.target.value),className:"input w-32",placeholder:"Current"}),f.jsx("input",{type:"number",value:E.targetValue,onChange:C=>T(S,"targetValue",C.target.value),className:"input w-32",placeholder:"Target"}),f.jsx("button",{onClick:()=>A(S),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:f.jsx(Jn,{className:"h-4 w-4"})})]},S))}),f.jsxs("div",{className:"flex space-x-2 mt-4",children:[f.jsx("button",{onClick:b,className:"btn-secondary",children:"Add Metric"}),f.jsxs("button",{onClick:_,className:"btn-primary",children:[f.jsx(yo,{className:"h-4 w-4 mr-2"}),"Save Win State"]})]})]})]}):f.jsxs("div",{children:[t!=null&&t.description?f.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:t.description}):f.jsx("p",{className:"text-gray-500 dark:text-gray-400 italic mb-4",children:"No win state defined yet. Click edit to define your success criteria."}),(t==null?void 0:t.metrics)&&t.metrics.length>0&&f.jsx("div",{className:"space-y-3",children:t.metrics.map((E,S)=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:E.name}),f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[E.currentValue," / ",E.targetValue," ",E.unit]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar-fill",style:{width:`${Math.min(E.currentValue/E.targetValue*100,100)}%`}})})]},S))})]})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Active Goals (",D.length,")"]}),f.jsxs("button",{onClick:()=>c(!0),className:"btn-primary flex items-center",children:[f.jsx(pr,{className:"h-4 w-4 mr-2"}),"Create Goal"]})]}),D.length===0?f.jsxs("div",{className:"card text-center py-12",children:[f.jsx(Ti,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No active goals in this area yet"}),f.jsxs("button",{onClick:()=>c(!0),className:"btn-primary inline-flex items-center",children:[f.jsx(pr,{className:"h-4 w-4 mr-2"}),"Create Your First Goal"]})]}):f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:D.map(E=>f.jsx(ja,{goal:E,onUpdate:S=>{i(s.map(C=>C.id===S.id?S:C))},onDelete:S=>{i(s.filter(C=>C.id!==S))}},E.id))})]}),k.length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Completed Goals (",k.length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:k.map(E=>f.jsx(ja,{goal:E,onUpdate:S=>{i(s.map(C=>C.id===S.id?S:C))},onDelete:S=>{i(s.filter(C=>C.id!==S))}},E.id))})]}),l&&f.jsx(F2,{subsection:n,onClose:()=>c(!1),onGoalCreated:E=>{i([E,...s]),c(!1)}})]})},$G=()=>{const{currentUser:n}=_n(),[e,t]=O.useState("grid"),[r,s]=O.useState(!1),[i,o]=O.useState(!0),[a,l]=O.useState(!1),c=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=["Early Morning","Morning","Late Morning","Afternoon","Late Afternoon","Evening","Night"],h={"Early Morning":f.jsx(rz,{className:"h-4 w-4 text-orange-500"}),Morning:f.jsx(r$,{className:"h-4 w-4 text-amber-600"}),"Late Morning":f.jsx(Mf,{className:"h-4 w-4 text-yellow-500"}),Afternoon:f.jsx(Mf,{className:"h-4 w-4 text-yellow-600"}),"Late Afternoon":f.jsx(iz,{className:"h-4 w-4 text-orange-600"}),Evening:f.jsx(ww,{className:"h-4 w-4 text-indigo-600"}),Night:f.jsx(UU,{className:"h-4 w-4 text-purple-600"})},p={"Early Morning":"5:30-7:00",Morning:"7:00-10:00","Late Morning":"10:00-12:00",Afternoon:"12:00-3:30","Late Afternoon":"3:30-6:00",Evening:"6:00-8:30",Night:"8:30-10:00"},[m,g]=O.useState({}),[v,x]=O.useState({});O.useEffect(()=>{_()},[n]);const _=async()=>{if(n)try{const R=await yw(et(be,"weeklySchedule",n.uid));if(R.exists())g(R.data().schedule||{}),x(R.data().schedule||{});else{const D={};c.forEach(k=>{D[k]={},u.forEach(E=>{D[k][E]=""})}),g(D),x(D)}}catch(R){console.error("Error fetching schedule:",R),oe.error("Failed to load schedule")}finally{o(!1)}},b=async()=>{if(n){l(!0);try{await Mr(et(be,"weeklySchedule",n.uid),{schedule:v,userId:n.uid,updatedAt:ur()}),g(v),s(!1),oe.success("Schedule saved successfully")}catch(R){console.error("Error saving schedule:",R),oe.error("Failed to save schedule")}finally{l(!1)}}},T=(R,D,k)=>{x({...v,[R]:{...v[R],[D]:k}})},A=()=>{x(m),s(!1)};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"My Week"}),f.jsx("p",{className:"opacity-90",children:"Your typical weekly schedule template"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("div",{className:"bg-white/20 rounded-lg p-1 flex",children:[f.jsx("button",{onClick:()=>t("grid"),className:`p-2 rounded transition-colors ${e==="grid"?"bg-white text-blue-600":"text-white hover:bg-white/20"}`,title:"Grid View",children:f.jsx(p$,{className:"h-5 w-5"})}),f.jsx("button",{onClick:()=>t("list"),className:`p-2 rounded transition-colors ${e==="list"?"bg-white text-blue-600":"text-white hover:bg-white/20"}`,title:"List View",children:f.jsx(RR,{className:"h-5 w-5"})})]}),r?f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:b,disabled:a,className:"bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(yo,{className:"h-5 w-5 mr-2"}),"Save"]})}),f.jsx("button",{onClick:A,className:"bg-white/20 text-white px-4 py-2 rounded-lg font-medium hover:bg-white/30 transition-colors",children:f.jsx(Jn,{className:"h-5 w-5"})})]}):f.jsxs("button",{onClick:()=>s(!0),className:"bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(gm,{className:"h-5 w-5 mr-2"}),"Edit Schedule"]})]})]})}),e==="grid"?f.jsx("div",{className:"card overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-left p-3 font-medium text-gray-700 dark:text-gray-300",children:"Time"}),c.map(R=>f.jsx("th",{className:"text-left p-3 font-medium text-gray-700 dark:text-gray-300 min-w-[120px]",children:R},R))]})}),f.jsx("tbody",{children:u.map(R=>f.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700",children:[f.jsx("td",{className:"p-3",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[h[R],f.jsxs("div",{children:[f.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:R}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:p[R]})]})]})}),c.map(D=>{var k,E;return f.jsx("td",{className:"p-3",children:r?f.jsx("input",{type:"text",value:((k=v[D])==null?void 0:k[R])||"",onChange:S=>T(D,R,S.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-primary-500",placeholder:"Add activity..."}):f.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:((E=m[D])==null?void 0:E[R])||f.jsx("span",{className:"text-gray-400 dark:text-gray-600 italic",children:"Empty"})})},`${D}-${R}`)})]},R))})]})}):f.jsx("div",{className:"space-y-4",children:c.map(R=>f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:R}),f.jsx("div",{className:"space-y-3",children:u.map(D=>{var k,E;return f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsxs("div",{className:"flex items-center space-x-2 w-40 flex-shrink-0",children:[h[D],f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:D}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:p[D]})]})]}),r?f.jsx("input",{type:"text",value:((k=v[R])==null?void 0:k[D])||"",onChange:S=>T(R,D,S.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500",placeholder:"Add activity..."}):f.jsx("div",{className:"flex-1 px-3 py-2",children:(E=m[R])!=null&&E[D]?f.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:m[R][D]}):f.jsx("span",{className:"text-gray-400 dark:text-gray-600 italic",children:"No activity scheduled"})})]},`${R}-${D}`)})})]},R))}),r&&f.jsx("div",{className:"card bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx(Fo,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-200 mb-1",children:"Editing Your Schedule"}),f.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Add your typical activities for each time slot. This template represents your ideal week and won't change unless you edit it. Use it as a reference for planning your actual week."})]})]})})]})},zG=()=>{const{currentUser:n}=_n(),[e,t]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[a,l]=O.useState(!1),[c,u]=O.useState({}),[h,p]=O.useState("all"),[m,g]=O.useState("all"),[v,x]=O.useState(""),[_,b]=O.useState(""),[T,A]=O.useState({date:Zt(new Date,"yyyy-MM-dd"),amount:"",note:"",type:"expense"});O.useEffect(()=>{R()},[n]),O.useEffect(()=>{D()},[e,h,m,v,_]);const R=async()=>{if(n)try{const P=zn($n(be,"transactions"),vt("userId","==",n.uid),ss("date","desc")),ae=(await Wn(P)).docs.map(ye=>({id:ye.id.replace(`${n.uid}_`,""),...ye.data()}));t(ae)}catch(P){console.error("Error fetching transactions:",P),oe.error("Failed to load transactions")}finally{o(!1)}},D=()=>{let P=[...e];if(m!=="all"&&(P=P.filter(N=>N.type===m)),h!=="all"){const N=new Date;let ae,ye;switch(h){case"this-month":ae=Vf(N),ye=jf(N);break;case"last-month":ae=Vf(Ph(N,1)),ye=jf(Ph(N,1));break;case"last-3-months":ae=Ph(N,3),ye=N;break;case"custom":ae=v?new Date(v):null,ye=_?new Date(_):null;break}ae&&ye&&(P=P.filter(H=>{var B;const ee=(B=H.date)!=null&&B.toDate?H.date.toDate():new Date(H.date);return ee>=ae&&ee<=ye}))}s(P)},k=async P=>{if(P.preventDefault(),!T.amount||!T.note){oe.error("Please fill in all fields");return}const N=`transaction_${Date.now()}`,ae=parseFloat(T.amount);try{const ye={date:new Date(T.date),amount:T.type==="income"?Math.abs(ae):-Math.abs(ae),note:T.note,type:T.type,userId:n.uid,createdAt:ur()};await Mr(et(be,"transactions",`${n.uid}_${N}`),ye);const H={id:N,...ye,date:{toDate:()=>new Date(T.date)},createdAt:{toDate:()=>new Date}};t([H,...e]),A({date:Zt(new Date,"yyyy-MM-dd"),amount:"",note:"",type:"expense"}),l(!1),oe.success("Transaction added successfully")}catch(ye){console.error("Error adding transaction:",ye),oe.error("Failed to add transaction")}},E=P=>{c[P]==="pending"?S(P):(u({...c,[P]:"pending"}),setTimeout(()=>{u(N=>{const ae={...N};return ae[P]==="pending"&&delete ae[P],ae})},3e3))},S=async P=>{try{await hl(et(be,"transactions",`${n.uid}_${P}`)),t(e.filter(N=>N.id!==P)),u(N=>{const ae={...N};return delete ae[P],ae}),oe.success("Transaction deleted")}catch(N){console.error("Error deleting transaction:",N),oe.error("Failed to delete transaction")}},C=async()=>{if(confirm("Are you sure you want to delete ALL transactions? This cannot be undone."))try{const P=e.map(N=>hl(et(be,"transactions",`${n.uid}_${N.id}`)));await Promise.all(P),t([]),s([]),oe.success("All transactions cleared")}catch(P){console.error("Error clearing transactions:",P),oe.error("Failed to clear transactions")}},M=()=>{const P=[["Date","Type","Amount","Note"],...r.map(H=>{var ee;return[Zt((ee=H.date)!=null&&ee.toDate?H.date.toDate():new Date(H.date),"yyyy-MM-dd"),H.type,H.amount,H.note]})].map(H=>H.join(",")).join(`
`),N=new Blob([P],{type:"text/csv"}),ae=window.URL.createObjectURL(N),ye=document.createElement("a");ye.href=ae,ye.download=`transactions-${Zt(new Date,"yyyy-MM-dd")}.csv`,ye.click(),oe.success("Transactions exported to CSV")};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1 mr-4",children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"Expenses"}),f.jsx("p",{className:"opacity-90 text-sm sm:text-base",children:"Track your income and expenses"})]}),f.jsxs("div",{className:"flex sm:flex-row flex-col items-end sm:items-center sm:space-x-2 space-y-2 sm:space-y-0",children:[f.jsxs("button",{onClick:M,className:"bg-white/20 text-white px-3 sm:px-4 py-2 rounded-lg font-medium hover:bg-white/30 transition-colors flex items-center text-sm sm:text-base whitespace-nowrap",children:[f.jsx(AR,{className:"h-4 sm:h-5 w-4 sm:w-5 mr-1 sm:mr-2"}),"Export"]}),f.jsxs("button",{onClick:()=>l(!0),className:"bg-white text-green-600 px-3 sm:px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center text-sm sm:text-base whitespace-nowrap",children:[f.jsx(pr,{className:"h-4 sm:h-5 w-4 sm:w-5 mr-1 sm:mr-2"}),"Add Transaction"]})]})]})}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Type"}),f.jsxs("select",{value:m,onChange:P=>g(P.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Transactions"}),f.jsx("option",{value:"expense",children:"Expenses Only"}),f.jsx("option",{value:"income",children:"Income Only"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Date Range"}),f.jsxs("select",{value:h,onChange:P=>p(P.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Time"}),f.jsx("option",{value:"this-month",children:"This Month"}),f.jsx("option",{value:"last-month",children:"Last Month"}),f.jsx("option",{value:"last-3-months",children:"Last 3 Months"}),f.jsx("option",{value:"custom",children:"Custom Range"})]})]}),h==="custom"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Start Date"}),f.jsx("input",{type:"date",value:v,onChange:P=>x(P.target.value),className:"input"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"End Date"}),f.jsx("input",{type:"date",value:_,onChange:P=>b(P.target.value),className:"input"})]})]})]}),e.length>0&&f.jsx("div",{className:"flex justify-end",children:f.jsxs("button",{onClick:C,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",children:[f.jsx(fz,{className:"h-4 w-4 mr-1"}),"Clear All Transactions"]})})]}),f.jsxs("div",{className:"card",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Transactions (",r.length,")"]}),r.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(i$,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No transactions found"})]}):f.jsx("div",{className:"space-y-2",children:r.map(P=>{var N;return f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors",children:[f.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[f.jsx("div",{className:`p-2 rounded-lg ${P.amount>0?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:P.amount>0?f.jsx(_w,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):f.jsx(uz,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("span",{className:`font-semibold ${P.amount>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:["$",Math.abs(P.amount).toFixed(2)]}),f.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:P.type==="income"?"Income":"Expense"})]}),f.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:P.note}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mt-1",children:[f.jsx(Fo,{className:"h-3 w-3 mr-1"}),Zt((N=P.date)!=null&&N.toDate?P.date.toDate():new Date(P.date),"MMM d, yyyy")]})]})]}),f.jsx("button",{onClick:()=>E(P.id),className:`p-2 rounded-lg transition-all ${c[P.id]==="pending"?"bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,title:c[P.id]==="pending"?"Click again to confirm delete":"Delete transaction",children:f.jsx(Bo,{className:`h-5 w-5 ${c[P.id]==="pending"?"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-600"}`})})]},P.id)})})]}),a&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Add Transaction"}),f.jsx("button",{onClick:()=>l(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:f.jsx(Jn,{className:"h-5 w-5 text-gray-500"})})]}),f.jsxs("form",{onSubmit:k,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Type"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("button",{type:"button",onClick:()=>A({...T,type:"expense"}),className:`p-2 rounded-lg border-2 transition-colors ${T.type==="expense"?"border-red-600 bg-red-50 dark:bg-red-900/20 text-red-600":"border-gray-300 dark:border-gray-600"}`,children:"Expense"}),f.jsx("button",{type:"button",onClick:()=>A({...T,type:"income"}),className:`p-2 rounded-lg border-2 transition-colors ${T.type==="income"?"border-green-600 bg-green-50 dark:bg-green-900/20 text-green-600":"border-gray-300 dark:border-gray-600"}`,children:"Income"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Date"}),f.jsx("input",{type:"date",value:T.date,onChange:P=>A({...T,date:P.target.value}),className:"input",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Amount"}),f.jsx("input",{type:"number",step:"0.01",value:T.amount,onChange:P=>A({...T,amount:P.target.value}),className:"input",placeholder:"0.00",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Note"}),f.jsx("input",{type:"text",value:T.note,onChange:P=>A({...T,note:P.target.value}),className:"input",placeholder:"What was this for?",required:!0})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>l(!1),className:"btn-secondary",children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn-primary",children:"Add Transaction"})]})]})]})})]})};function WG(){return f.jsx(Wj,{children:f.jsx(AU,{children:f.jsxs(CU,{children:[f.jsx(OV,{position:"top-center",toastOptions:{duration:3e3,style:{background:"rgb(31 41 55)",color:"#fff"},success:{iconTheme:{primary:"rgb(34 197 94)",secondary:"#fff"}},error:{iconTheme:{primary:"rgb(239 68 68)",secondary:"#fff"}}}}),f.jsx(Tz,{children:f.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[f.jsx(Sz,{}),f.jsx("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8",children:f.jsxs(Vj,{children:[f.jsx(Kr,{path:"/",element:f.jsx(B9,{})}),f.jsx(Kr,{path:"/journal",element:f.jsx(VG,{})}),f.jsx(Kr,{path:"/goals",element:f.jsx(LG,{})}),f.jsx(Kr,{path:"/stats",element:f.jsx(FG,{})}),f.jsx(Kr,{path:"/my-week",element:f.jsx($G,{})}),f.jsx(Kr,{path:"/expenses",element:f.jsx(zG,{})}),f.jsx(Kr,{path:"/settings",element:f.jsx(BG,{})}),f.jsx(Kr,{path:"/subsection/:subsectionName",element:f.jsx(UG,{})})]})})]})})]})})})}const HG="modulepreload",qG=function(n){return"/"+n},zT={},KG=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=qG(l),l in zT)return;zT[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":HG,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function GG(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=n;let a,l;const c=async(h=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await KG(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;a.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),a.addEventListener("installed",h=>{h.isUpdate||r==null||r()}),a.register({immediate:e}).then(h=>{i?i("/sw.js",h):s==null||s(h)}).catch(h=>{o==null||o(h)})}}return l=u(),c}"serviceWorker"in navigator&&GG({onNeedRefresh(){confirm("New content available. Reload?")&&window.location.reload()},onOfflineReady(){console.log("App ready to work offline")}});gy.createRoot(document.getElementById("root")).render(f.jsx(At.StrictMode,{children:f.jsx(WG,{})}));

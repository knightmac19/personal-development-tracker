function EP(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function ib(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ob={exports:{}},xf={},ab={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ou=Symbol.for("react.element"),kP=Symbol.for("react.portal"),bP=Symbol.for("react.fragment"),TP=Symbol.for("react.strict_mode"),SP=Symbol.for("react.profiler"),IP=Symbol.for("react.provider"),NP=Symbol.for("react.context"),CP=Symbol.for("react.forward_ref"),AP=Symbol.for("react.suspense"),RP=Symbol.for("react.memo"),PP=Symbol.for("react.lazy"),Sw=Symbol.iterator;function DP(n){return n===null||typeof n!="object"?null:(n=Sw&&n[Sw]||n["@@iterator"],typeof n=="function"?n:null)}var lb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cb=Object.assign,ub={};function Xa(n,e,t){this.props=n,this.context=e,this.refs=ub,this.updater=t||lb}Xa.prototype.isReactComponent={};Xa.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Xa.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function db(){}db.prototype=Xa.prototype;function e0(n,e,t){this.props=n,this.context=e,this.refs=ub,this.updater=t||lb}var t0=e0.prototype=new db;t0.constructor=e0;cb(t0,Xa.prototype);t0.isPureReactComponent=!0;var Iw=Array.isArray,hb=Object.prototype.hasOwnProperty,n0={current:null},fb={key:!0,ref:!0,__self:!0,__source:!0};function pb(n,e,t){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)hb.call(e,r)&&!fb.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:ou,type:n,key:i,ref:o,props:s,_owner:n0.current}}function MP(n,e){return{$$typeof:ou,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function r0(n){return typeof n=="object"&&n!==null&&n.$$typeof===ou}function OP(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Nw=/\/+/g;function Gp(n,e){return typeof n=="object"&&n!==null&&n.key!=null?OP(""+n.key):e.toString(36)}function Cd(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case ou:case kP:o=!0}}if(o)return o=n,s=s(o),n=r===""?"."+Gp(o,0):r,Iw(s)?(t="",n!=null&&(t=n.replace(Nw,"$&/")+"/"),Cd(s,e,t,"",function(c){return c})):s!=null&&(r0(s)&&(s=MP(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Nw,"$&/")+"/")+n)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Iw(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+Gp(i,a);o+=Cd(i,e,t,l,s)}else if(l=DP(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+Gp(i,a++),o+=Cd(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Qu(n,e,t){if(n==null)return n;var r=[],s=0;return Cd(n,r,"","",function(i){return e.call(t,i,s++)}),r}function VP(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var en={current:null},Ad={transition:null},jP={ReactCurrentDispatcher:en,ReactCurrentBatchConfig:Ad,ReactCurrentOwner:n0};function mb(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:Qu,forEach:function(n,e,t){Qu(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Qu(n,function(){e++}),e},toArray:function(n){return Qu(n,function(e){return e})||[]},only:function(n){if(!r0(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};pe.Component=Xa;pe.Fragment=bP;pe.Profiler=SP;pe.PureComponent=e0;pe.StrictMode=TP;pe.Suspense=AP;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jP;pe.act=mb;pe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=cb({},n.props),s=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=n0.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)hb.call(e,l)&&!fb.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ou,type:n.type,key:s,ref:i,props:r,_owner:o}};pe.createContext=function(n){return n={$$typeof:NP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:IP,_context:n},n.Consumer=n};pe.createElement=pb;pe.createFactory=function(n){var e=pb.bind(null,n);return e.type=n,e};pe.createRef=function(){return{current:null}};pe.forwardRef=function(n){return{$$typeof:CP,render:n}};pe.isValidElement=r0;pe.lazy=function(n){return{$$typeof:PP,_payload:{_status:-1,_result:n},_init:VP}};pe.memo=function(n,e){return{$$typeof:RP,type:n,compare:e===void 0?null:e}};pe.startTransition=function(n){var e=Ad.transition;Ad.transition={};try{n()}finally{Ad.transition=e}};pe.unstable_act=mb;pe.useCallback=function(n,e){return en.current.useCallback(n,e)};pe.useContext=function(n){return en.current.useContext(n)};pe.useDebugValue=function(){};pe.useDeferredValue=function(n){return en.current.useDeferredValue(n)};pe.useEffect=function(n,e){return en.current.useEffect(n,e)};pe.useId=function(){return en.current.useId()};pe.useImperativeHandle=function(n,e,t){return en.current.useImperativeHandle(n,e,t)};pe.useInsertionEffect=function(n,e){return en.current.useInsertionEffect(n,e)};pe.useLayoutEffect=function(n,e){return en.current.useLayoutEffect(n,e)};pe.useMemo=function(n,e){return en.current.useMemo(n,e)};pe.useReducer=function(n,e,t){return en.current.useReducer(n,e,t)};pe.useRef=function(n){return en.current.useRef(n)};pe.useState=function(n){return en.current.useState(n)};pe.useSyncExternalStore=function(n,e,t){return en.current.useSyncExternalStore(n,e,t)};pe.useTransition=function(){return en.current.useTransition()};pe.version="18.3.1";ab.exports=pe;var O=ab.exports;const Et=ib(O),LP=EP({__proto__:null,default:Et},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FP=O,BP=Symbol.for("react.element"),$P=Symbol.for("react.fragment"),UP=Object.prototype.hasOwnProperty,zP=FP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WP={key:!0,ref:!0,__self:!0,__source:!0};function gb(n,e,t){var r,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)UP.call(e,r)&&!WP.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:BP,type:n,key:i,ref:o,props:s,_owner:zP.current}}xf.Fragment=$P;xf.jsx=gb;xf.jsxs=gb;ob.exports=xf;var f=ob.exports,ng={},yb={exports:{}},Tn={},vb={exports:{}},xb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(B,G){var oe=B.length;B.push(G);e:for(;0<oe;){var Ne=oe-1>>>1,_e=B[Ne];if(0<s(_e,G))B[Ne]=G,B[oe]=_e,oe=Ne;else break e}}function t(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var G=B[0],oe=B.pop();if(oe!==G){B[0]=oe;e:for(var Ne=0,_e=B.length,ye=_e>>>1;Ne<ye;){var Sr=2*(Ne+1)-1,Ir=B[Sr],Nr=Sr+1,Cr=B[Nr];if(0>s(Ir,oe))Nr<_e&&0>s(Cr,Ir)?(B[Ne]=Cr,B[Nr]=oe,Ne=Nr):(B[Ne]=Ir,B[Sr]=oe,Ne=Sr);else if(Nr<_e&&0>s(Cr,oe))B[Ne]=Cr,B[Nr]=oe,Ne=Nr;else break e}}return G}function s(B,G){var oe=B.sortIndex-G.sortIndex;return oe!==0?oe:B.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,p=3,m=!1,y=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(B){for(var G=t(c);G!==null;){if(G.callback===null)r(c);else if(G.startTime<=B)r(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=t(c)}}function C(B){if(v=!1,T(B),!y)if(t(l)!==null)y=!0,H(P);else{var G=t(c);G!==null&&te(C,G.startTime-B)}}function P(B,G){y=!1,v&&(v=!1,k(E),E=-1),m=!0;var oe=p;try{for(T(G),h=t(l);h!==null&&(!(h.expirationTime>G)||B&&!M());){var Ne=h.callback;if(typeof Ne=="function"){h.callback=null,p=h.priorityLevel;var _e=Ne(h.expirationTime<=G);G=n.unstable_now(),typeof _e=="function"?h.callback=_e:h===t(l)&&r(l),T(G)}else r(l);h=t(l)}if(h!==null)var ye=!0;else{var Sr=t(c);Sr!==null&&te(C,Sr.startTime-G),ye=!1}return ye}finally{h=null,p=oe,m=!1}}var D=!1,_=null,E=-1,S=5,N=-1;function M(){return!(n.unstable_now()-N<S)}function R(){if(_!==null){var B=n.unstable_now();N=B;var G=!0;try{G=_(!0,B)}finally{G?A():(D=!1,_=null)}}else D=!1}var A;if(typeof b=="function")A=function(){b(R)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ke=ce.port2;ce.port1.onmessage=R,A=function(){ke.postMessage(null)}}else A=function(){w(R,0)};function H(B){_=B,D||(D=!0,A())}function te(B,G){E=w(function(){B(n.unstable_now())},G)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,H(P))},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(B){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var oe=p;p=G;try{return B()}finally{p=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(B,G){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var oe=p;p=B;try{return G()}finally{p=oe}},n.unstable_scheduleCallback=function(B,G,oe){var Ne=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?Ne+oe:Ne):oe=Ne,B){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=oe+_e,B={id:u++,callback:G,priorityLevel:B,startTime:oe,expirationTime:_e,sortIndex:-1},oe>Ne?(B.sortIndex=oe,e(c,B),t(l)===null&&B===t(c)&&(v?(k(E),E=-1):v=!0,te(C,oe-Ne))):(B.sortIndex=_e,e(l,B),y||m||(y=!0,H(P))),B},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(B){var G=p;return function(){var oe=p;p=G;try{return B.apply(this,arguments)}finally{p=oe}}}})(xb);vb.exports=xb;var qP=vb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HP=O,kn=qP;function z(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wb=new Set,yc={};function So(n,e){Na(n,e),Na(n+"Capture",e)}function Na(n,e){for(yc[n]=e,n=0;n<e.length;n++)wb.add(e[n])}var Jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rg=Object.prototype.hasOwnProperty,KP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cw={},Aw={};function GP(n){return rg.call(Aw,n)?!0:rg.call(Cw,n)?!1:KP.test(n)?Aw[n]=!0:(Cw[n]=!0,!1)}function QP(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function JP(n,e,t,r){if(e===null||typeof e>"u"||QP(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tn(n,e,t,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){St[n]=new tn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];St[e]=new tn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){St[n]=new tn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){St[n]=new tn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){St[n]=new tn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){St[n]=new tn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){St[n]=new tn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){St[n]=new tn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){St[n]=new tn(n,5,!1,n.toLowerCase(),null,!1,!1)});var s0=/[\-:]([a-z])/g;function i0(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(s0,i0);St[e]=new tn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(s0,i0);St[e]=new tn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(s0,i0);St[e]=new tn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){St[n]=new tn(n,1,!1,n.toLowerCase(),null,!1,!1)});St.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){St[n]=new tn(n,1,!1,n.toLowerCase(),null,!0,!0)});function o0(n,e,t,r){var s=St.hasOwnProperty(e)?St[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(JP(e,t,s,r)&&(t=null),r||s===null?GP(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var as=HP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ju=Symbol.for("react.element"),ea=Symbol.for("react.portal"),ta=Symbol.for("react.fragment"),a0=Symbol.for("react.strict_mode"),sg=Symbol.for("react.profiler"),_b=Symbol.for("react.provider"),Eb=Symbol.for("react.context"),l0=Symbol.for("react.forward_ref"),ig=Symbol.for("react.suspense"),og=Symbol.for("react.suspense_list"),c0=Symbol.for("react.memo"),ws=Symbol.for("react.lazy"),kb=Symbol.for("react.offscreen"),Rw=Symbol.iterator;function _l(n){return n===null||typeof n!="object"?null:(n=Rw&&n[Rw]||n["@@iterator"],typeof n=="function"?n:null)}var ze=Object.assign,Qp;function Ll(n){if(Qp===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Qp=e&&e[1]||""}return`
`+Qp+n}var Jp=!1;function Yp(n,e){if(!n||Jp)return"";Jp=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Jp=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Ll(n):""}function YP(n){switch(n.tag){case 5:return Ll(n.type);case 16:return Ll("Lazy");case 13:return Ll("Suspense");case 19:return Ll("SuspenseList");case 0:case 2:case 15:return n=Yp(n.type,!1),n;case 11:return n=Yp(n.type.render,!1),n;case 1:return n=Yp(n.type,!0),n;default:return""}}function ag(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ta:return"Fragment";case ea:return"Portal";case sg:return"Profiler";case a0:return"StrictMode";case ig:return"Suspense";case og:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Eb:return(n.displayName||"Context")+".Consumer";case _b:return(n._context.displayName||"Context")+".Provider";case l0:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case c0:return e=n.displayName||null,e!==null?e:ag(n.type)||"Memo";case ws:e=n._payload,n=n._init;try{return ag(n(e))}catch{}}return null}function XP(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ag(e);case 8:return e===a0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function si(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function bb(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZP(n){var e=bb(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Yu(n){n._valueTracker||(n._valueTracker=ZP(n))}function Tb(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=bb(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function oh(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function lg(n,e){var t=e.checked;return ze({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Pw(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=si(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sb(n,e){e=e.checked,e!=null&&o0(n,"checked",e,!1)}function cg(n,e){Sb(n,e);var t=si(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?ug(n,e.type,t):e.hasOwnProperty("defaultValue")&&ug(n,e.type,si(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Dw(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function ug(n,e,t){(e!=="number"||oh(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Fl=Array.isArray;function ga(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+si(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function dg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return ze({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Mw(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(z(92));if(Fl(t)){if(1<t.length)throw Error(z(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:si(t)}}function Ib(n,e){var t=si(e.value),r=si(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Ow(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Nb(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Nb(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Xu,Cb=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Xu=Xu||document.createElement("div"),Xu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xu.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function vc(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Xl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eD=["Webkit","ms","Moz","O"];Object.keys(Xl).forEach(function(n){eD.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Xl[e]=Xl[n]})});function Ab(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Xl.hasOwnProperty(n)&&Xl[n]?(""+e).trim():e+"px"}function Rb(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=Ab(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var tD=ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fg(n,e){if(e){if(tD[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function pg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mg=null;function u0(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var gg=null,ya=null,va=null;function Vw(n){if(n=cu(n)){if(typeof gg!="function")throw Error(z(280));var e=n.stateNode;e&&(e=bf(e),gg(n.stateNode,n.type,e))}}function Pb(n){ya?va?va.push(n):va=[n]:ya=n}function Db(){if(ya){var n=ya,e=va;if(va=ya=null,Vw(n),e)for(n=0;n<e.length;n++)Vw(e[n])}}function Mb(n,e){return n(e)}function Ob(){}var Xp=!1;function Vb(n,e,t){if(Xp)return n(e,t);Xp=!0;try{return Mb(n,e,t)}finally{Xp=!1,(ya!==null||va!==null)&&(Ob(),Db())}}function xc(n,e){var t=n.stateNode;if(t===null)return null;var r=bf(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(z(231,e,typeof t));return t}var yg=!1;if(Jr)try{var El={};Object.defineProperty(El,"passive",{get:function(){yg=!0}}),window.addEventListener("test",El,El),window.removeEventListener("test",El,El)}catch{yg=!1}function nD(n,e,t,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Zl=!1,ah=null,lh=!1,vg=null,rD={onError:function(n){Zl=!0,ah=n}};function sD(n,e,t,r,s,i,o,a,l){Zl=!1,ah=null,nD.apply(rD,arguments)}function iD(n,e,t,r,s,i,o,a,l){if(sD.apply(this,arguments),Zl){if(Zl){var c=ah;Zl=!1,ah=null}else throw Error(z(198));lh||(lh=!0,vg=c)}}function Io(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function jb(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function jw(n){if(Io(n)!==n)throw Error(z(188))}function oD(n){var e=n.alternate;if(!e){if(e=Io(n),e===null)throw Error(z(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return jw(s),n;if(i===r)return jw(s),e;i=i.sibling}throw Error(z(188))}if(t.return!==r.return)t=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o)throw Error(z(189))}}if(t.alternate!==r)throw Error(z(190))}if(t.tag!==3)throw Error(z(188));return t.stateNode.current===t?n:e}function Lb(n){return n=oD(n),n!==null?Fb(n):null}function Fb(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Fb(n);if(e!==null)return e;n=n.sibling}return null}var Bb=kn.unstable_scheduleCallback,Lw=kn.unstable_cancelCallback,aD=kn.unstable_shouldYield,lD=kn.unstable_requestPaint,Ge=kn.unstable_now,cD=kn.unstable_getCurrentPriorityLevel,d0=kn.unstable_ImmediatePriority,$b=kn.unstable_UserBlockingPriority,ch=kn.unstable_NormalPriority,uD=kn.unstable_LowPriority,Ub=kn.unstable_IdlePriority,wf=null,fr=null;function dD(n){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot(wf,n,void 0,(n.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:pD,hD=Math.log,fD=Math.LN2;function pD(n){return n>>>=0,n===0?32:31-(hD(n)/fD|0)|0}var Zu=64,ed=4194304;function Bl(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function uh(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?r=Bl(a):(i&=o,i!==0&&(r=Bl(i)))}else o=t&~s,o!==0?r=Bl(o):i!==0&&(r=Bl(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Qn(e),s=1<<t,r|=n[t],e&=~s;return r}function mD(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gD(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Qn(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&r)&&(s[o]=mD(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function xg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function zb(){var n=Zu;return Zu<<=1,!(Zu&4194240)&&(Zu=64),n}function Zp(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function au(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Qn(e),n[e]=t}function yD(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-Qn(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function h0(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Qn(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var Ie=0;function Wb(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var qb,f0,Hb,Kb,Gb,wg=!1,td=[],Bs=null,$s=null,Us=null,wc=new Map,_c=new Map,bs=[],vD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fw(n,e){switch(n){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Us=null;break;case"pointerover":case"pointerout":wc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_c.delete(e.pointerId)}}function kl(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=cu(e),e!==null&&f0(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function xD(n,e,t,r,s){switch(e){case"focusin":return Bs=kl(Bs,n,e,t,r,s),!0;case"dragenter":return $s=kl($s,n,e,t,r,s),!0;case"mouseover":return Us=kl(Us,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return wc.set(i,kl(wc.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,_c.set(i,kl(_c.get(i)||null,n,e,t,r,s)),!0}return!1}function Qb(n){var e=$i(n.target);if(e!==null){var t=Io(e);if(t!==null){if(e=t.tag,e===13){if(e=jb(t),e!==null){n.blockedOn=e,Gb(n.priority,function(){Hb(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Rd(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=_g(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);mg=r,t.target.dispatchEvent(r),mg=null}else return e=cu(t),e!==null&&f0(e),n.blockedOn=t,!1;e.shift()}return!0}function Bw(n,e,t){Rd(n)&&t.delete(e)}function wD(){wg=!1,Bs!==null&&Rd(Bs)&&(Bs=null),$s!==null&&Rd($s)&&($s=null),Us!==null&&Rd(Us)&&(Us=null),wc.forEach(Bw),_c.forEach(Bw)}function bl(n,e){n.blockedOn===e&&(n.blockedOn=null,wg||(wg=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,wD)))}function Ec(n){function e(s){return bl(s,n)}if(0<td.length){bl(td[0],n);for(var t=1;t<td.length;t++){var r=td[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Bs!==null&&bl(Bs,n),$s!==null&&bl($s,n),Us!==null&&bl(Us,n),wc.forEach(e),_c.forEach(e),t=0;t<bs.length;t++)r=bs[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<bs.length&&(t=bs[0],t.blockedOn===null);)Qb(t),t.blockedOn===null&&bs.shift()}var xa=as.ReactCurrentBatchConfig,dh=!0;function _D(n,e,t,r){var s=Ie,i=xa.transition;xa.transition=null;try{Ie=1,p0(n,e,t,r)}finally{Ie=s,xa.transition=i}}function ED(n,e,t,r){var s=Ie,i=xa.transition;xa.transition=null;try{Ie=4,p0(n,e,t,r)}finally{Ie=s,xa.transition=i}}function p0(n,e,t,r){if(dh){var s=_g(n,e,t,r);if(s===null)cm(n,e,r,hh,t),Fw(n,r);else if(xD(s,n,e,t,r))r.stopPropagation();else if(Fw(n,r),e&4&&-1<vD.indexOf(n)){for(;s!==null;){var i=cu(s);if(i!==null&&qb(i),i=_g(n,e,t,r),i===null&&cm(n,e,r,hh,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else cm(n,e,r,null,t)}}var hh=null;function _g(n,e,t,r){if(hh=null,n=u0(r),n=$i(n),n!==null)if(e=Io(n),e===null)n=null;else if(t=e.tag,t===13){if(n=jb(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return hh=n,null}function Jb(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cD()){case d0:return 1;case $b:return 4;case ch:case uD:return 16;case Ub:return 536870912;default:return 16}default:return 16}}var Ds=null,m0=null,Pd=null;function Yb(){if(Pd)return Pd;var n,e=m0,t=e.length,r,s="value"in Ds?Ds.value:Ds.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===s[i-r];r++);return Pd=s.slice(n,1<r?1-r:void 0)}function Dd(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function nd(){return!0}function $w(){return!1}function Sn(n){function e(t,r,s,i,o){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?nd:$w,this.isPropagationStopped=$w,this}return ze(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=nd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=nd)},persist:function(){},isPersistent:nd}),e}var Za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},g0=Sn(Za),lu=ze({},Za,{view:0,detail:0}),kD=Sn(lu),em,tm,Tl,_f=ze({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y0,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Tl&&(Tl&&n.type==="mousemove"?(em=n.screenX-Tl.screenX,tm=n.screenY-Tl.screenY):tm=em=0,Tl=n),em)},movementY:function(n){return"movementY"in n?n.movementY:tm}}),Uw=Sn(_f),bD=ze({},_f,{dataTransfer:0}),TD=Sn(bD),SD=ze({},lu,{relatedTarget:0}),nm=Sn(SD),ID=ze({},Za,{animationName:0,elapsedTime:0,pseudoElement:0}),ND=Sn(ID),CD=ze({},Za,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),AD=Sn(CD),RD=ze({},Za,{data:0}),zw=Sn(RD),PD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OD(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=MD[n])?!!e[n]:!1}function y0(){return OD}var VD=ze({},lu,{key:function(n){if(n.key){var e=PD[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Dd(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?DD[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y0,charCode:function(n){return n.type==="keypress"?Dd(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Dd(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),jD=Sn(VD),LD=ze({},_f,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ww=Sn(LD),FD=ze({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y0}),BD=Sn(FD),$D=ze({},Za,{propertyName:0,elapsedTime:0,pseudoElement:0}),UD=Sn($D),zD=ze({},_f,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),WD=Sn(zD),qD=[9,13,27,32],v0=Jr&&"CompositionEvent"in window,ec=null;Jr&&"documentMode"in document&&(ec=document.documentMode);var HD=Jr&&"TextEvent"in window&&!ec,Xb=Jr&&(!v0||ec&&8<ec&&11>=ec),qw=" ",Hw=!1;function Zb(n,e){switch(n){case"keyup":return qD.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var na=!1;function KD(n,e){switch(n){case"compositionend":return eT(e);case"keypress":return e.which!==32?null:(Hw=!0,qw);case"textInput":return n=e.data,n===qw&&Hw?null:n;default:return null}}function GD(n,e){if(na)return n==="compositionend"||!v0&&Zb(n,e)?(n=Yb(),Pd=m0=Ds=null,na=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xb&&e.locale!=="ko"?null:e.data;default:return null}}var QD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!QD[n.type]:e==="textarea"}function tT(n,e,t,r){Pb(r),e=fh(e,"onChange"),0<e.length&&(t=new g0("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var tc=null,kc=null;function JD(n){hT(n,0)}function Ef(n){var e=ia(n);if(Tb(e))return n}function YD(n,e){if(n==="change")return e}var nT=!1;if(Jr){var rm;if(Jr){var sm="oninput"in document;if(!sm){var Gw=document.createElement("div");Gw.setAttribute("oninput","return;"),sm=typeof Gw.oninput=="function"}rm=sm}else rm=!1;nT=rm&&(!document.documentMode||9<document.documentMode)}function Qw(){tc&&(tc.detachEvent("onpropertychange",rT),kc=tc=null)}function rT(n){if(n.propertyName==="value"&&Ef(kc)){var e=[];tT(e,kc,n,u0(n)),Vb(JD,e)}}function XD(n,e,t){n==="focusin"?(Qw(),tc=e,kc=t,tc.attachEvent("onpropertychange",rT)):n==="focusout"&&Qw()}function ZD(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ef(kc)}function eM(n,e){if(n==="click")return Ef(e)}function tM(n,e){if(n==="input"||n==="change")return Ef(e)}function nM(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Xn=typeof Object.is=="function"?Object.is:nM;function bc(n,e){if(Xn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!rg.call(e,s)||!Xn(n[s],e[s]))return!1}return!0}function Jw(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Yw(n,e){var t=Jw(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Jw(t)}}function sT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?sT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function iT(){for(var n=window,e=oh();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=oh(n.document)}return e}function x0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function rM(n){var e=iT(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&sT(t.ownerDocument.documentElement,t)){if(r!==null&&x0(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=Yw(t,i);var o=Yw(t,r);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var sM=Jr&&"documentMode"in document&&11>=document.documentMode,ra=null,Eg=null,nc=null,kg=!1;function Xw(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;kg||ra==null||ra!==oh(r)||(r=ra,"selectionStart"in r&&x0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),nc&&bc(nc,r)||(nc=r,r=fh(Eg,"onSelect"),0<r.length&&(e=new g0("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=ra)))}function rd(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var sa={animationend:rd("Animation","AnimationEnd"),animationiteration:rd("Animation","AnimationIteration"),animationstart:rd("Animation","AnimationStart"),transitionend:rd("Transition","TransitionEnd")},im={},oT={};Jr&&(oT=document.createElement("div").style,"AnimationEvent"in window||(delete sa.animationend.animation,delete sa.animationiteration.animation,delete sa.animationstart.animation),"TransitionEvent"in window||delete sa.transitionend.transition);function kf(n){if(im[n])return im[n];if(!sa[n])return n;var e=sa[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in oT)return im[n]=e[t];return n}var aT=kf("animationend"),lT=kf("animationiteration"),cT=kf("animationstart"),uT=kf("transitionend"),dT=new Map,Zw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fi(n,e){dT.set(n,e),So(e,[n])}for(var om=0;om<Zw.length;om++){var am=Zw[om],iM=am.toLowerCase(),oM=am[0].toUpperCase()+am.slice(1);fi(iM,"on"+oM)}fi(aT,"onAnimationEnd");fi(lT,"onAnimationIteration");fi(cT,"onAnimationStart");fi("dblclick","onDoubleClick");fi("focusin","onFocus");fi("focusout","onBlur");fi(uT,"onTransitionEnd");Na("onMouseEnter",["mouseout","mouseover"]);Na("onMouseLeave",["mouseout","mouseover"]);Na("onPointerEnter",["pointerout","pointerover"]);Na("onPointerLeave",["pointerout","pointerover"]);So("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));So("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));So("onBeforeInput",["compositionend","keypress","textInput","paste"]);So("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));So("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));So("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aM=new Set("cancel close invalid load scroll toggle".split(" ").concat($l));function e_(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,iD(r,e,void 0,n),n.currentTarget=null}function hT(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;e_(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;e_(s,a,c),i=l}}}if(lh)throw n=vg,lh=!1,vg=null,n}function Me(n,e){var t=e[Ng];t===void 0&&(t=e[Ng]=new Set);var r=n+"__bubble";t.has(r)||(fT(e,n,2,!1),t.add(r))}function lm(n,e,t){var r=0;e&&(r|=4),fT(t,n,r,e)}var sd="_reactListening"+Math.random().toString(36).slice(2);function Tc(n){if(!n[sd]){n[sd]=!0,wb.forEach(function(t){t!=="selectionchange"&&(aM.has(t)||lm(t,!1,n),lm(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[sd]||(e[sd]=!0,lm("selectionchange",!1,e))}}function fT(n,e,t,r){switch(Jb(e)){case 1:var s=_D;break;case 4:s=ED;break;default:s=p0}t=s.bind(null,e,t,n),s=void 0,!yg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function cm(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=$i(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Vb(function(){var c=i,u=u0(t),h=[];e:{var p=dT.get(n);if(p!==void 0){var m=g0,y=n;switch(n){case"keypress":if(Dd(t)===0)break e;case"keydown":case"keyup":m=jD;break;case"focusin":y="focus",m=nm;break;case"focusout":y="blur",m=nm;break;case"beforeblur":case"afterblur":m=nm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Uw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=TD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=BD;break;case aT:case lT:case cT:m=ND;break;case uT:m=UD;break;case"scroll":m=kD;break;case"wheel":m=WD;break;case"copy":case"cut":case"paste":m=AD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ww}var v=(e&4)!==0,w=!v&&n==="scroll",k=v?p!==null?p+"Capture":null:p;v=[];for(var b=c,T;b!==null;){T=b;var C=T.stateNode;if(T.tag===5&&C!==null&&(T=C,k!==null&&(C=xc(b,k),C!=null&&v.push(Sc(b,C,T)))),w)break;b=b.return}0<v.length&&(p=new m(p,y,null,t,u),h.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==mg&&(y=t.relatedTarget||t.fromElement)&&($i(y)||y[Yr]))break e;if((m||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=c,y=y?$i(y):null,y!==null&&(w=Io(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=c),m!==y)){if(v=Uw,C="onMouseLeave",k="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(v=Ww,C="onPointerLeave",k="onPointerEnter",b="pointer"),w=m==null?p:ia(m),T=y==null?p:ia(y),p=new v(C,b+"leave",m,t,u),p.target=w,p.relatedTarget=T,C=null,$i(u)===c&&(v=new v(k,b+"enter",y,t,u),v.target=T,v.relatedTarget=w,C=v),w=C,m&&y)t:{for(v=m,k=y,b=0,T=v;T;T=Fo(T))b++;for(T=0,C=k;C;C=Fo(C))T++;for(;0<b-T;)v=Fo(v),b--;for(;0<T-b;)k=Fo(k),T--;for(;b--;){if(v===k||k!==null&&v===k.alternate)break t;v=Fo(v),k=Fo(k)}v=null}else v=null;m!==null&&t_(h,p,m,v,!1),y!==null&&w!==null&&t_(h,w,y,v,!0)}}e:{if(p=c?ia(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var P=YD;else if(Kw(p))if(nT)P=tM;else{P=ZD;var D=XD}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=eM);if(P&&(P=P(n,c))){tT(h,P,t,u);break e}D&&D(n,p,c),n==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&ug(p,"number",p.value)}switch(D=c?ia(c):window,n){case"focusin":(Kw(D)||D.contentEditable==="true")&&(ra=D,Eg=c,nc=null);break;case"focusout":nc=Eg=ra=null;break;case"mousedown":kg=!0;break;case"contextmenu":case"mouseup":case"dragend":kg=!1,Xw(h,t,u);break;case"selectionchange":if(sM)break;case"keydown":case"keyup":Xw(h,t,u)}var _;if(v0)e:{switch(n){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else na?Zb(n,t)&&(E="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(E="onCompositionStart");E&&(Xb&&t.locale!=="ko"&&(na||E!=="onCompositionStart"?E==="onCompositionEnd"&&na&&(_=Yb()):(Ds=u,m0="value"in Ds?Ds.value:Ds.textContent,na=!0)),D=fh(c,E),0<D.length&&(E=new zw(E,n,null,t,u),h.push({event:E,listeners:D}),_?E.data=_:(_=eT(t),_!==null&&(E.data=_)))),(_=HD?KD(n,t):GD(n,t))&&(c=fh(c,"onBeforeInput"),0<c.length&&(u=new zw("onBeforeInput","beforeinput",null,t,u),h.push({event:u,listeners:c}),u.data=_))}hT(h,e)})}function Sc(n,e,t){return{instance:n,listener:e,currentTarget:t}}function fh(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=xc(n,t),i!=null&&r.unshift(Sc(n,i,s)),i=xc(n,e),i!=null&&r.push(Sc(n,i,s))),n=n.return}return r}function Fo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function t_(n,e,t,r,s){for(var i=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=xc(t,i),l!=null&&o.unshift(Sc(t,l,a))):s||(l=xc(t,i),l!=null&&o.push(Sc(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var lM=/\r\n?/g,cM=/\u0000|\uFFFD/g;function n_(n){return(typeof n=="string"?n:""+n).replace(lM,`
`).replace(cM,"")}function id(n,e,t){if(e=n_(e),n_(n)!==e&&t)throw Error(z(425))}function ph(){}var bg=null,Tg=null;function Sg(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ig=typeof setTimeout=="function"?setTimeout:void 0,uM=typeof clearTimeout=="function"?clearTimeout:void 0,r_=typeof Promise=="function"?Promise:void 0,dM=typeof queueMicrotask=="function"?queueMicrotask:typeof r_<"u"?function(n){return r_.resolve(null).then(n).catch(hM)}:Ig;function hM(n){setTimeout(function(){throw n})}function um(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),Ec(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);Ec(e)}function zs(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function s_(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var el=Math.random().toString(36).slice(2),ar="__reactFiber$"+el,Ic="__reactProps$"+el,Yr="__reactContainer$"+el,Ng="__reactEvents$"+el,fM="__reactListeners$"+el,pM="__reactHandles$"+el;function $i(n){var e=n[ar];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Yr]||t[ar]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=s_(n);n!==null;){if(t=n[ar])return t;n=s_(n)}return e}n=t,t=n.parentNode}return null}function cu(n){return n=n[ar]||n[Yr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ia(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(z(33))}function bf(n){return n[Ic]||null}var Cg=[],oa=-1;function pi(n){return{current:n}}function Oe(n){0>oa||(n.current=Cg[oa],Cg[oa]=null,oa--)}function Pe(n,e){oa++,Cg[oa]=n.current,n.current=e}var ii={},jt=pi(ii),ln=pi(!1),ro=ii;function Ca(n,e){var t=n.type.contextTypes;if(!t)return ii;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function cn(n){return n=n.childContextTypes,n!=null}function mh(){Oe(ln),Oe(jt)}function i_(n,e,t){if(jt.current!==ii)throw Error(z(168));Pe(jt,e),Pe(ln,t)}function pT(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(z(108,XP(n)||"Unknown",s));return ze({},t,r)}function gh(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ii,ro=jt.current,Pe(jt,n),Pe(ln,ln.current),!0}function o_(n,e,t){var r=n.stateNode;if(!r)throw Error(z(169));t?(n=pT(n,e,ro),r.__reactInternalMemoizedMergedChildContext=n,Oe(ln),Oe(jt),Pe(jt,n)):Oe(ln),Pe(ln,t)}var jr=null,Tf=!1,dm=!1;function mT(n){jr===null?jr=[n]:jr.push(n)}function mM(n){Tf=!0,mT(n)}function mi(){if(!dm&&jr!==null){dm=!0;var n=0,e=Ie;try{var t=jr;for(Ie=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}jr=null,Tf=!1}catch(s){throw jr!==null&&(jr=jr.slice(n+1)),Bb(d0,mi),s}finally{Ie=e,dm=!1}}return null}var aa=[],la=0,yh=null,vh=0,Nn=[],Cn=0,so=null,Lr=1,Fr="";function Ai(n,e){aa[la++]=vh,aa[la++]=yh,yh=n,vh=e}function gT(n,e,t){Nn[Cn++]=Lr,Nn[Cn++]=Fr,Nn[Cn++]=so,so=n;var r=Lr;n=Fr;var s=32-Qn(r)-1;r&=~(1<<s),t+=1;var i=32-Qn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Lr=1<<32-Qn(e)+s|t<<s|r,Fr=i+n}else Lr=1<<i|t<<s|r,Fr=n}function w0(n){n.return!==null&&(Ai(n,1),gT(n,1,0))}function _0(n){for(;n===yh;)yh=aa[--la],aa[la]=null,vh=aa[--la],aa[la]=null;for(;n===so;)so=Nn[--Cn],Nn[Cn]=null,Fr=Nn[--Cn],Nn[Cn]=null,Lr=Nn[--Cn],Nn[Cn]=null}var _n=null,vn=null,je=!1,Hn=null;function yT(n,e){var t=Mn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function a_(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,_n=n,vn=zs(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,_n=n,vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=so!==null?{id:Lr,overflow:Fr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Mn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,_n=n,vn=null,!0):!1;default:return!1}}function Ag(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Rg(n){if(je){var e=vn;if(e){var t=e;if(!a_(n,e)){if(Ag(n))throw Error(z(418));e=zs(t.nextSibling);var r=_n;e&&a_(n,e)?yT(r,t):(n.flags=n.flags&-4097|2,je=!1,_n=n)}}else{if(Ag(n))throw Error(z(418));n.flags=n.flags&-4097|2,je=!1,_n=n}}}function l_(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;_n=n}function od(n){if(n!==_n)return!1;if(!je)return l_(n),je=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Sg(n.type,n.memoizedProps)),e&&(e=vn)){if(Ag(n))throw vT(),Error(z(418));for(;e;)yT(n,e),e=zs(e.nextSibling)}if(l_(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(z(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){vn=zs(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}vn=null}}else vn=_n?zs(n.stateNode.nextSibling):null;return!0}function vT(){for(var n=vn;n;)n=zs(n.nextSibling)}function Aa(){vn=_n=null,je=!1}function E0(n){Hn===null?Hn=[n]:Hn.push(n)}var gM=as.ReactCurrentBatchConfig;function Sl(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(z(309));var r=t.stateNode}if(!r)throw Error(z(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(z(284));if(!t._owner)throw Error(z(290,n))}return n}function ad(n,e){throw n=Object.prototype.toString.call(e),Error(z(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function c_(n){var e=n._init;return e(n._payload)}function xT(n){function e(k,b){if(n){var T=k.deletions;T===null?(k.deletions=[b],k.flags|=16):T.push(b)}}function t(k,b){if(!n)return null;for(;b!==null;)e(k,b),b=b.sibling;return null}function r(k,b){for(k=new Map;b!==null;)b.key!==null?k.set(b.key,b):k.set(b.index,b),b=b.sibling;return k}function s(k,b){return k=Ks(k,b),k.index=0,k.sibling=null,k}function i(k,b,T){return k.index=T,n?(T=k.alternate,T!==null?(T=T.index,T<b?(k.flags|=2,b):T):(k.flags|=2,b)):(k.flags|=1048576,b)}function o(k){return n&&k.alternate===null&&(k.flags|=2),k}function a(k,b,T,C){return b===null||b.tag!==6?(b=vm(T,k.mode,C),b.return=k,b):(b=s(b,T),b.return=k,b)}function l(k,b,T,C){var P=T.type;return P===ta?u(k,b,T.props.children,C,T.key):b!==null&&(b.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ws&&c_(P)===b.type)?(C=s(b,T.props),C.ref=Sl(k,b,T),C.return=k,C):(C=Bd(T.type,T.key,T.props,null,k.mode,C),C.ref=Sl(k,b,T),C.return=k,C)}function c(k,b,T,C){return b===null||b.tag!==4||b.stateNode.containerInfo!==T.containerInfo||b.stateNode.implementation!==T.implementation?(b=xm(T,k.mode,C),b.return=k,b):(b=s(b,T.children||[]),b.return=k,b)}function u(k,b,T,C,P){return b===null||b.tag!==7?(b=Gi(T,k.mode,C,P),b.return=k,b):(b=s(b,T),b.return=k,b)}function h(k,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return b=vm(""+b,k.mode,T),b.return=k,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ju:return T=Bd(b.type,b.key,b.props,null,k.mode,T),T.ref=Sl(k,null,b),T.return=k,T;case ea:return b=xm(b,k.mode,T),b.return=k,b;case ws:var C=b._init;return h(k,C(b._payload),T)}if(Fl(b)||_l(b))return b=Gi(b,k.mode,T,null),b.return=k,b;ad(k,b)}return null}function p(k,b,T,C){var P=b!==null?b.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return P!==null?null:a(k,b,""+T,C);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Ju:return T.key===P?l(k,b,T,C):null;case ea:return T.key===P?c(k,b,T,C):null;case ws:return P=T._init,p(k,b,P(T._payload),C)}if(Fl(T)||_l(T))return P!==null?null:u(k,b,T,C,null);ad(k,T)}return null}function m(k,b,T,C,P){if(typeof C=="string"&&C!==""||typeof C=="number")return k=k.get(T)||null,a(b,k,""+C,P);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Ju:return k=k.get(C.key===null?T:C.key)||null,l(b,k,C,P);case ea:return k=k.get(C.key===null?T:C.key)||null,c(b,k,C,P);case ws:var D=C._init;return m(k,b,T,D(C._payload),P)}if(Fl(C)||_l(C))return k=k.get(T)||null,u(b,k,C,P,null);ad(b,C)}return null}function y(k,b,T,C){for(var P=null,D=null,_=b,E=b=0,S=null;_!==null&&E<T.length;E++){_.index>E?(S=_,_=null):S=_.sibling;var N=p(k,_,T[E],C);if(N===null){_===null&&(_=S);break}n&&_&&N.alternate===null&&e(k,_),b=i(N,b,E),D===null?P=N:D.sibling=N,D=N,_=S}if(E===T.length)return t(k,_),je&&Ai(k,E),P;if(_===null){for(;E<T.length;E++)_=h(k,T[E],C),_!==null&&(b=i(_,b,E),D===null?P=_:D.sibling=_,D=_);return je&&Ai(k,E),P}for(_=r(k,_);E<T.length;E++)S=m(_,k,E,T[E],C),S!==null&&(n&&S.alternate!==null&&_.delete(S.key===null?E:S.key),b=i(S,b,E),D===null?P=S:D.sibling=S,D=S);return n&&_.forEach(function(M){return e(k,M)}),je&&Ai(k,E),P}function v(k,b,T,C){var P=_l(T);if(typeof P!="function")throw Error(z(150));if(T=P.call(T),T==null)throw Error(z(151));for(var D=P=null,_=b,E=b=0,S=null,N=T.next();_!==null&&!N.done;E++,N=T.next()){_.index>E?(S=_,_=null):S=_.sibling;var M=p(k,_,N.value,C);if(M===null){_===null&&(_=S);break}n&&_&&M.alternate===null&&e(k,_),b=i(M,b,E),D===null?P=M:D.sibling=M,D=M,_=S}if(N.done)return t(k,_),je&&Ai(k,E),P;if(_===null){for(;!N.done;E++,N=T.next())N=h(k,N.value,C),N!==null&&(b=i(N,b,E),D===null?P=N:D.sibling=N,D=N);return je&&Ai(k,E),P}for(_=r(k,_);!N.done;E++,N=T.next())N=m(_,k,E,N.value,C),N!==null&&(n&&N.alternate!==null&&_.delete(N.key===null?E:N.key),b=i(N,b,E),D===null?P=N:D.sibling=N,D=N);return n&&_.forEach(function(R){return e(k,R)}),je&&Ai(k,E),P}function w(k,b,T,C){if(typeof T=="object"&&T!==null&&T.type===ta&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Ju:e:{for(var P=T.key,D=b;D!==null;){if(D.key===P){if(P=T.type,P===ta){if(D.tag===7){t(k,D.sibling),b=s(D,T.props.children),b.return=k,k=b;break e}}else if(D.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===ws&&c_(P)===D.type){t(k,D.sibling),b=s(D,T.props),b.ref=Sl(k,D,T),b.return=k,k=b;break e}t(k,D);break}else e(k,D);D=D.sibling}T.type===ta?(b=Gi(T.props.children,k.mode,C,T.key),b.return=k,k=b):(C=Bd(T.type,T.key,T.props,null,k.mode,C),C.ref=Sl(k,b,T),C.return=k,k=C)}return o(k);case ea:e:{for(D=T.key;b!==null;){if(b.key===D)if(b.tag===4&&b.stateNode.containerInfo===T.containerInfo&&b.stateNode.implementation===T.implementation){t(k,b.sibling),b=s(b,T.children||[]),b.return=k,k=b;break e}else{t(k,b);break}else e(k,b);b=b.sibling}b=xm(T,k.mode,C),b.return=k,k=b}return o(k);case ws:return D=T._init,w(k,b,D(T._payload),C)}if(Fl(T))return y(k,b,T,C);if(_l(T))return v(k,b,T,C);ad(k,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,b!==null&&b.tag===6?(t(k,b.sibling),b=s(b,T),b.return=k,k=b):(t(k,b),b=vm(T,k.mode,C),b.return=k,k=b),o(k)):t(k,b)}return w}var Ra=xT(!0),wT=xT(!1),xh=pi(null),wh=null,ca=null,k0=null;function b0(){k0=ca=wh=null}function T0(n){var e=xh.current;Oe(xh),n._currentValue=e}function Pg(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function wa(n,e){wh=n,k0=ca=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(on=!0),n.firstContext=null)}function Bn(n){var e=n._currentValue;if(k0!==n)if(n={context:n,memoizedValue:e,next:null},ca===null){if(wh===null)throw Error(z(308));ca=n,wh.dependencies={lanes:0,firstContext:n}}else ca=ca.next=n;return e}var Ui=null;function S0(n){Ui===null?Ui=[n]:Ui.push(n)}function _T(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,S0(e)):(t.next=s.next,s.next=t),e.interleaved=t,Xr(n,r)}function Xr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var _s=!1;function I0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ET(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Hr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ws(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Xr(n,t)}return s=r.interleaved,s===null?(e.next=e,S0(r)):(e.next=s.next,s.next=e),r.interleaved=e,Xr(n,t)}function Md(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,h0(n,t)}}function u_(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function _h(n,e,t,r){var s=n.updateQueue;_s=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var p=a.lane,m=a.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,v=a;switch(p=e,m=t,v.tag){case 1:if(y=v.payload,typeof y=="function"){h=y.call(m,h,p);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,p=typeof y=="function"?y.call(m,h,p):y,p==null)break e;h=ze({},h,p);break e;case 2:_s=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);oo|=o,n.lanes=o,n.memoizedState=h}}function d_(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(z(191,s));s.call(r)}}}var uu={},pr=pi(uu),Nc=pi(uu),Cc=pi(uu);function zi(n){if(n===uu)throw Error(z(174));return n}function N0(n,e){switch(Pe(Cc,e),Pe(Nc,n),Pe(pr,uu),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:hg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=hg(e,n)}Oe(pr),Pe(pr,e)}function Pa(){Oe(pr),Oe(Nc),Oe(Cc)}function kT(n){zi(Cc.current);var e=zi(pr.current),t=hg(e,n.type);e!==t&&(Pe(Nc,n),Pe(pr,t))}function C0(n){Nc.current===n&&(Oe(pr),Oe(Nc))}var Fe=pi(0);function Eh(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hm=[];function A0(){for(var n=0;n<hm.length;n++)hm[n]._workInProgressVersionPrimary=null;hm.length=0}var Od=as.ReactCurrentDispatcher,fm=as.ReactCurrentBatchConfig,io=0,$e=null,rt=null,ut=null,kh=!1,rc=!1,Ac=0,yM=0;function At(){throw Error(z(321))}function R0(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Xn(n[t],e[t]))return!1;return!0}function P0(n,e,t,r,s,i){if(io=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Od.current=n===null||n.memoizedState===null?_M:EM,n=t(r,s),rc){i=0;do{if(rc=!1,Ac=0,25<=i)throw Error(z(301));i+=1,ut=rt=null,e.updateQueue=null,Od.current=kM,n=t(r,s)}while(rc)}if(Od.current=bh,e=rt!==null&&rt.next!==null,io=0,ut=rt=$e=null,kh=!1,e)throw Error(z(300));return n}function D0(){var n=Ac!==0;return Ac=0,n}function ir(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?$e.memoizedState=ut=n:ut=ut.next=n,ut}function $n(){if(rt===null){var n=$e.alternate;n=n!==null?n.memoizedState:null}else n=rt.next;var e=ut===null?$e.memoizedState:ut.next;if(e!==null)ut=e,rt=n;else{if(n===null)throw Error(z(310));rt=n,n={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},ut===null?$e.memoizedState=ut=n:ut=ut.next=n}return ut}function Rc(n,e){return typeof e=="function"?e(n):e}function pm(n){var e=$n(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var r=rt,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((io&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,$e.lanes|=u,oo|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Xn(r,e.memoizedState)||(on=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,$e.lanes|=i,oo|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function mm(n){var e=$n(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=n(i,o.action),o=o.next;while(o!==s);Xn(i,e.memoizedState)||(on=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function bT(){}function TT(n,e){var t=$e,r=$n(),s=e(),i=!Xn(r.memoizedState,s);if(i&&(r.memoizedState=s,on=!0),r=r.queue,M0(NT.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||ut!==null&&ut.memoizedState.tag&1){if(t.flags|=2048,Pc(9,IT.bind(null,t,r,s,e),void 0,null),ft===null)throw Error(z(349));io&30||ST(t,e,s)}return s}function ST(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function IT(n,e,t,r){e.value=t,e.getSnapshot=r,CT(e)&&AT(n)}function NT(n,e,t){return t(function(){CT(e)&&AT(n)})}function CT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Xn(n,t)}catch{return!0}}function AT(n){var e=Xr(n,1);e!==null&&Jn(e,n,1,-1)}function h_(n){var e=ir();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rc,lastRenderedState:n},e.queue=n,n=n.dispatch=wM.bind(null,$e,n),[e.memoizedState,n]}function Pc(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function RT(){return $n().memoizedState}function Vd(n,e,t,r){var s=ir();$e.flags|=n,s.memoizedState=Pc(1|e,t,void 0,r===void 0?null:r)}function Sf(n,e,t,r){var s=$n();r=r===void 0?null:r;var i=void 0;if(rt!==null){var o=rt.memoizedState;if(i=o.destroy,r!==null&&R0(r,o.deps)){s.memoizedState=Pc(e,t,i,r);return}}$e.flags|=n,s.memoizedState=Pc(1|e,t,i,r)}function f_(n,e){return Vd(8390656,8,n,e)}function M0(n,e){return Sf(2048,8,n,e)}function PT(n,e){return Sf(4,2,n,e)}function DT(n,e){return Sf(4,4,n,e)}function MT(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function OT(n,e,t){return t=t!=null?t.concat([n]):null,Sf(4,4,MT.bind(null,e,n),t)}function O0(){}function VT(n,e){var t=$n();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&R0(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function jT(n,e){var t=$n();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&R0(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function LT(n,e,t){return io&21?(Xn(t,e)||(t=zb(),$e.lanes|=t,oo|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,on=!0),n.memoizedState=t)}function vM(n,e){var t=Ie;Ie=t!==0&&4>t?t:4,n(!0);var r=fm.transition;fm.transition={};try{n(!1),e()}finally{Ie=t,fm.transition=r}}function FT(){return $n().memoizedState}function xM(n,e,t){var r=Hs(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},BT(n))$T(e,t);else if(t=_T(n,e,t,r),t!==null){var s=Kt();Jn(t,n,r,s),UT(t,e,r)}}function wM(n,e,t){var r=Hs(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(BT(n))$T(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,Xn(a,o)){var l=e.interleaved;l===null?(s.next=s,S0(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=_T(n,e,s,r),t!==null&&(s=Kt(),Jn(t,n,r,s),UT(t,e,r))}}function BT(n){var e=n.alternate;return n===$e||e!==null&&e===$e}function $T(n,e){rc=kh=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function UT(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,h0(n,t)}}var bh={readContext:Bn,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},_M={readContext:Bn,useCallback:function(n,e){return ir().memoizedState=[n,e===void 0?null:e],n},useContext:Bn,useEffect:f_,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Vd(4194308,4,MT.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Vd(4194308,4,n,e)},useInsertionEffect:function(n,e){return Vd(4,2,n,e)},useMemo:function(n,e){var t=ir();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=ir();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=xM.bind(null,$e,n),[r.memoizedState,n]},useRef:function(n){var e=ir();return n={current:n},e.memoizedState=n},useState:h_,useDebugValue:O0,useDeferredValue:function(n){return ir().memoizedState=n},useTransition:function(){var n=h_(!1),e=n[0];return n=vM.bind(null,n[1]),ir().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=$e,s=ir();if(je){if(t===void 0)throw Error(z(407));t=t()}else{if(t=e(),ft===null)throw Error(z(349));io&30||ST(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,f_(NT.bind(null,r,i,n),[n]),r.flags|=2048,Pc(9,IT.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=ir(),e=ft.identifierPrefix;if(je){var t=Fr,r=Lr;t=(r&~(1<<32-Qn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ac++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=yM++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},EM={readContext:Bn,useCallback:VT,useContext:Bn,useEffect:M0,useImperativeHandle:OT,useInsertionEffect:PT,useLayoutEffect:DT,useMemo:jT,useReducer:pm,useRef:RT,useState:function(){return pm(Rc)},useDebugValue:O0,useDeferredValue:function(n){var e=$n();return LT(e,rt.memoizedState,n)},useTransition:function(){var n=pm(Rc)[0],e=$n().memoizedState;return[n,e]},useMutableSource:bT,useSyncExternalStore:TT,useId:FT,unstable_isNewReconciler:!1},kM={readContext:Bn,useCallback:VT,useContext:Bn,useEffect:M0,useImperativeHandle:OT,useInsertionEffect:PT,useLayoutEffect:DT,useMemo:jT,useReducer:mm,useRef:RT,useState:function(){return mm(Rc)},useDebugValue:O0,useDeferredValue:function(n){var e=$n();return rt===null?e.memoizedState=n:LT(e,rt.memoizedState,n)},useTransition:function(){var n=mm(Rc)[0],e=$n().memoizedState;return[n,e]},useMutableSource:bT,useSyncExternalStore:TT,useId:FT,unstable_isNewReconciler:!1};function Wn(n,e){if(n&&n.defaultProps){e=ze({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Dg(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:ze({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var If={isMounted:function(n){return(n=n._reactInternals)?Io(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Kt(),s=Hs(n),i=Hr(r,s);i.payload=e,t!=null&&(i.callback=t),e=Ws(n,i,s),e!==null&&(Jn(e,n,s,r),Md(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Kt(),s=Hs(n),i=Hr(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Ws(n,i,s),e!==null&&(Jn(e,n,s,r),Md(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Kt(),r=Hs(n),s=Hr(t,r);s.tag=2,e!=null&&(s.callback=e),e=Ws(n,s,r),e!==null&&(Jn(e,n,r,t),Md(e,n,r))}};function p_(n,e,t,r,s,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!bc(t,r)||!bc(s,i):!0}function zT(n,e,t){var r=!1,s=ii,i=e.contextType;return typeof i=="object"&&i!==null?i=Bn(i):(s=cn(e)?ro:jt.current,r=e.contextTypes,i=(r=r!=null)?Ca(n,s):ii),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=If,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function m_(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&If.enqueueReplaceState(e,e.state,null)}function Mg(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},I0(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Bn(i):(i=cn(e)?ro:jt.current,s.context=Ca(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Dg(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&If.enqueueReplaceState(s,s.state,null),_h(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Da(n,e){try{var t="",r=e;do t+=YP(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function gm(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Og(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var bM=typeof WeakMap=="function"?WeakMap:Map;function WT(n,e,t){t=Hr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Sh||(Sh=!0,qg=r),Og(n,e)},t}function qT(n,e,t){t=Hr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){Og(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Og(n,e),typeof r!="function"&&(qs===null?qs=new Set([this]):qs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function g_(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new bM;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=LM.bind(null,n,e,t),e.then(n,n))}function y_(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function v_(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Hr(-1,1),e.tag=2,Ws(t,e,1))),t.lanes|=1),n)}var TM=as.ReactCurrentOwner,on=!1;function zt(n,e,t,r){e.child=n===null?wT(e,null,t,r):Ra(e,n.child,t,r)}function x_(n,e,t,r,s){t=t.render;var i=e.ref;return wa(e,s),r=P0(n,e,t,r,i,s),t=D0(),n!==null&&!on?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Zr(n,e,s)):(je&&t&&w0(e),e.flags|=1,zt(n,e,r,s),e.child)}function w_(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!z0(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,HT(n,e,i,r,s)):(n=Bd(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:bc,t(o,r)&&n.ref===e.ref)return Zr(n,e,s)}return e.flags|=1,n=Ks(i,r),n.ref=e.ref,n.return=e,e.child=n}function HT(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(bc(i,r)&&n.ref===e.ref)if(on=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(on=!0);else return e.lanes=n.lanes,Zr(n,e,s)}return Vg(n,e,t,r,s)}function KT(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(da,mn),mn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Pe(da,mn),mn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Pe(da,mn),mn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Pe(da,mn),mn|=r;return zt(n,e,s,t),e.child}function GT(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Vg(n,e,t,r,s){var i=cn(t)?ro:jt.current;return i=Ca(e,i),wa(e,s),t=P0(n,e,t,r,i,s),r=D0(),n!==null&&!on?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Zr(n,e,s)):(je&&r&&w0(e),e.flags|=1,zt(n,e,t,s),e.child)}function __(n,e,t,r,s){if(cn(t)){var i=!0;gh(e)}else i=!1;if(wa(e,s),e.stateNode===null)jd(n,e),zT(e,t,r),Mg(e,t,r,s),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Bn(c):(c=cn(t)?ro:jt.current,c=Ca(e,c));var u=t.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&m_(e,o,r,c),_s=!1;var p=e.memoizedState;o.state=p,_h(e,r,o,s),l=e.memoizedState,a!==r||p!==l||ln.current||_s?(typeof u=="function"&&(Dg(e,t,u,r),l=e.memoizedState),(a=_s||p_(e,t,a,r,p,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,ET(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Wn(e.type,a),o.props=c,h=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Bn(l):(l=cn(t)?ro:jt.current,l=Ca(e,l));var m=t.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==l)&&m_(e,o,r,l),_s=!1,p=e.memoizedState,o.state=p,_h(e,r,o,s);var y=e.memoizedState;a!==h||p!==y||ln.current||_s?(typeof m=="function"&&(Dg(e,t,m,r),y=e.memoizedState),(c=_s||p_(e,t,c,r,p,y,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),r=!1)}return jg(n,e,t,r,i,s)}function jg(n,e,t,r,s,i){GT(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&o_(e,t,!1),Zr(n,e,i);r=e.stateNode,TM.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Ra(e,n.child,null,i),e.child=Ra(e,null,a,i)):zt(n,e,a,i),e.memoizedState=r.state,s&&o_(e,t,!0),e.child}function QT(n){var e=n.stateNode;e.pendingContext?i_(n,e.pendingContext,e.pendingContext!==e.context):e.context&&i_(n,e.context,!1),N0(n,e.containerInfo)}function E_(n,e,t,r,s){return Aa(),E0(s),e.flags|=256,zt(n,e,t,r),e.child}var Lg={dehydrated:null,treeContext:null,retryLane:0};function Fg(n){return{baseLanes:n,cachePool:null,transitions:null}}function JT(n,e,t){var r=e.pendingProps,s=Fe.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Pe(Fe,s&1),n===null)return Rg(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Af(o,r,0,null),n=Gi(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Fg(t),e.memoizedState=Lg,n):V0(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return SM(n,e,o,r,a,s,t);if(i){i=r.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ks(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Ks(a,i):(i=Gi(i,o,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=n.child.memoizedState,o=o===null?Fg(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Lg,r}return i=n.child,n=i.sibling,r=Ks(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function V0(n,e){return e=Af({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ld(n,e,t,r){return r!==null&&E0(r),Ra(e,n.child,null,t),n=V0(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function SM(n,e,t,r,s,i,o){if(t)return e.flags&256?(e.flags&=-257,r=gm(Error(z(422))),ld(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Af({mode:"visible",children:r.children},s,0,null),i=Gi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ra(e,n.child,null,o),e.child.memoizedState=Fg(o),e.memoizedState=Lg,i);if(!(e.mode&1))return ld(n,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(z(419)),r=gm(i,r,void 0),ld(n,e,o,r)}if(a=(o&n.childLanes)!==0,on||a){if(r=ft,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Xr(n,s),Jn(r,n,s,-1))}return U0(),r=gm(Error(z(421))),ld(n,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=FM.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,vn=zs(s.nextSibling),_n=e,je=!0,Hn=null,n!==null&&(Nn[Cn++]=Lr,Nn[Cn++]=Fr,Nn[Cn++]=so,Lr=n.id,Fr=n.overflow,so=e),e=V0(e,r.children),e.flags|=4096,e)}function k_(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Pg(n.return,e,t)}function ym(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function YT(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(zt(n,e,r.children,t),r=Fe.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&k_(n,t,e);else if(n.tag===19)k_(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Pe(Fe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Eh(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),ym(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Eh(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}ym(e,!0,t,null,i);break;case"together":ym(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jd(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Zr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),oo|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(z(153));if(e.child!==null){for(n=e.child,t=Ks(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Ks(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function IM(n,e,t){switch(e.tag){case 3:QT(e),Aa();break;case 5:kT(e);break;case 1:cn(e.type)&&gh(e);break;case 4:N0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pe(xh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Fe,Fe.current&1),e.flags|=128,null):t&e.child.childLanes?JT(n,e,t):(Pe(Fe,Fe.current&1),n=Zr(n,e,t),n!==null?n.sibling:null);Pe(Fe,Fe.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return YT(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pe(Fe,Fe.current),r)break;return null;case 22:case 23:return e.lanes=0,KT(n,e,t)}return Zr(n,e,t)}var XT,Bg,ZT,eS;XT=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Bg=function(){};ZT=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,zi(pr.current);var i=null;switch(t){case"input":s=lg(n,s),r=lg(n,r),i=[];break;case"select":s=ze({},s,{value:void 0}),r=ze({},r,{value:void 0}),i=[];break;case"textarea":s=dg(n,s),r=dg(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=ph)}fg(t,r);var o;t=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(yc.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(yc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Me("scroll",n),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};eS=function(n,e,t,r){t!==r&&(e.flags|=4)};function Il(n,e){if(!je)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Rt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function NM(n,e,t){var r=e.pendingProps;switch(_0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(e),null;case 1:return cn(e.type)&&mh(),Rt(e),null;case 3:return r=e.stateNode,Pa(),Oe(ln),Oe(jt),A0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(od(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hn!==null&&(Gg(Hn),Hn=null))),Bg(n,e),Rt(e),null;case 5:C0(e);var s=zi(Cc.current);if(t=e.type,n!==null&&e.stateNode!=null)ZT(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return Rt(e),null}if(n=zi(pr.current),od(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[ar]=e,r[Ic]=i,n=(e.mode&1)!==0,t){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(s=0;s<$l.length;s++)Me($l[s],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Pw(r,i),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Me("invalid",r);break;case"textarea":Mw(r,i),Me("invalid",r)}fg(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&id(r.textContent,a,n),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&id(r.textContent,a,n),s=["children",""+a]):yc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Me("scroll",r)}switch(t){case"input":Yu(r),Dw(r,i,!0);break;case"textarea":Yu(r),Ow(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ph)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Nb(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[ar]=e,n[Ic]=r,XT(n,e,!1,!1),e.stateNode=n;e:{switch(o=pg(t,r),t){case"dialog":Me("cancel",n),Me("close",n),s=r;break;case"iframe":case"object":case"embed":Me("load",n),s=r;break;case"video":case"audio":for(s=0;s<$l.length;s++)Me($l[s],n);s=r;break;case"source":Me("error",n),s=r;break;case"img":case"image":case"link":Me("error",n),Me("load",n),s=r;break;case"details":Me("toggle",n),s=r;break;case"input":Pw(n,r),s=lg(n,r),Me("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=ze({},r,{value:void 0}),Me("invalid",n);break;case"textarea":Mw(n,r),s=dg(n,r),Me("invalid",n);break;default:s=r}fg(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?Rb(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Cb(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&vc(n,l):typeof l=="number"&&vc(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(yc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Me("scroll",n):l!=null&&o0(n,i,l,o))}switch(t){case"input":Yu(n),Dw(n,r,!1);break;case"textarea":Yu(n),Ow(n);break;case"option":r.value!=null&&n.setAttribute("value",""+si(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?ga(n,!!r.multiple,i,!1):r.defaultValue!=null&&ga(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=ph)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rt(e),null;case 6:if(n&&e.stateNode!=null)eS(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(t=zi(Cc.current),zi(pr.current),od(e)){if(r=e.stateNode,t=e.memoizedProps,r[ar]=e,(i=r.nodeValue!==t)&&(n=_n,n!==null))switch(n.tag){case 3:id(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&id(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[ar]=e,e.stateNode=r}return Rt(e),null;case 13:if(Oe(Fe),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(je&&vn!==null&&e.mode&1&&!(e.flags&128))vT(),Aa(),e.flags|=98560,i=!1;else if(i=od(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[ar]=e}else Aa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rt(e),i=!1}else Hn!==null&&(Gg(Hn),Hn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Fe.current&1?it===0&&(it=3):U0())),e.updateQueue!==null&&(e.flags|=4),Rt(e),null);case 4:return Pa(),Bg(n,e),n===null&&Tc(e.stateNode.containerInfo),Rt(e),null;case 10:return T0(e.type._context),Rt(e),null;case 17:return cn(e.type)&&mh(),Rt(e),null;case 19:if(Oe(Fe),i=e.memoizedState,i===null)return Rt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Il(i,!1);else{if(it!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Eh(n),o!==null){for(e.flags|=128,Il(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Pe(Fe,Fe.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ge()>Ma&&(e.flags|=128,r=!0,Il(i,!1),e.lanes=4194304)}else{if(!r)if(n=Eh(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Il(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!je)return Rt(e),null}else 2*Ge()-i.renderingStartTime>Ma&&t!==1073741824&&(e.flags|=128,r=!0,Il(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ge(),e.sibling=null,t=Fe.current,Pe(Fe,r?t&1|2:t&1),e):(Rt(e),null);case 22:case 23:return $0(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?mn&1073741824&&(Rt(e),e.subtreeFlags&6&&(e.flags|=8192)):Rt(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function CM(n,e){switch(_0(e),e.tag){case 1:return cn(e.type)&&mh(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Pa(),Oe(ln),Oe(jt),A0(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return C0(e),null;case 13:if(Oe(Fe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(z(340));Aa()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Oe(Fe),null;case 4:return Pa(),null;case 10:return T0(e.type._context),null;case 22:case 23:return $0(),null;case 24:return null;default:return null}}var cd=!1,Mt=!1,AM=typeof WeakSet=="function"?WeakSet:Set,J=null;function ua(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){qe(n,e,r)}else t.current=null}function $g(n,e,t){try{t()}catch(r){qe(n,e,r)}}var b_=!1;function RM(n,e){if(bg=dh,n=iT(),x0(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=n,p=null;t:for(;;){for(var m;h!==t||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===n)break t;if(p===t&&++c===s&&(a=o),p===i&&++u===r&&(l=o),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Tg={focusedElem:n,selectionRange:t},dh=!1,J=e;J!==null;)if(e=J,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,J=n;else for(;J!==null;){e=J;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,w=y.memoizedState,k=e.stateNode,b=k.getSnapshotBeforeUpdate(e.elementType===e.type?v:Wn(e.type,v),w);k.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(C){qe(e,e.return,C)}if(n=e.sibling,n!==null){n.return=e.return,J=n;break}J=e.return}return y=b_,b_=!1,y}function sc(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&$g(e,t,i)}s=s.next}while(s!==r)}}function Nf(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Ug(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function tS(n){var e=n.alternate;e!==null&&(n.alternate=null,tS(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ar],delete e[Ic],delete e[Ng],delete e[fM],delete e[pM])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function nS(n){return n.tag===5||n.tag===3||n.tag===4}function T_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||nS(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zg(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=ph));else if(r!==4&&(n=n.child,n!==null))for(zg(n,e,t),n=n.sibling;n!==null;)zg(n,e,t),n=n.sibling}function Wg(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Wg(n,e,t),n=n.sibling;n!==null;)Wg(n,e,t),n=n.sibling}var vt=null,qn=!1;function ps(n,e,t){for(t=t.child;t!==null;)rS(n,e,t),t=t.sibling}function rS(n,e,t){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount(wf,t)}catch{}switch(t.tag){case 5:Mt||ua(t,e);case 6:var r=vt,s=qn;vt=null,ps(n,e,t),vt=r,qn=s,vt!==null&&(qn?(n=vt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):vt.removeChild(t.stateNode));break;case 18:vt!==null&&(qn?(n=vt,t=t.stateNode,n.nodeType===8?um(n.parentNode,t):n.nodeType===1&&um(n,t),Ec(n)):um(vt,t.stateNode));break;case 4:r=vt,s=qn,vt=t.stateNode.containerInfo,qn=!0,ps(n,e,t),vt=r,qn=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&$g(t,e,o),s=s.next}while(s!==r)}ps(n,e,t);break;case 1:if(!Mt&&(ua(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){qe(t,e,a)}ps(n,e,t);break;case 21:ps(n,e,t);break;case 22:t.mode&1?(Mt=(r=Mt)||t.memoizedState!==null,ps(n,e,t),Mt=r):ps(n,e,t);break;default:ps(n,e,t)}}function S_(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new AM),e.forEach(function(r){var s=BM.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function zn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vt=a.stateNode,qn=!1;break e;case 3:vt=a.stateNode.containerInfo,qn=!0;break e;case 4:vt=a.stateNode.containerInfo,qn=!0;break e}a=a.return}if(vt===null)throw Error(z(160));rS(i,o,s),vt=null,qn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){qe(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sS(e,n),e=e.sibling}function sS(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(zn(e,n),sr(n),r&4){try{sc(3,n,n.return),Nf(3,n)}catch(v){qe(n,n.return,v)}try{sc(5,n,n.return)}catch(v){qe(n,n.return,v)}}break;case 1:zn(e,n),sr(n),r&512&&t!==null&&ua(t,t.return);break;case 5:if(zn(e,n),sr(n),r&512&&t!==null&&ua(t,t.return),n.flags&32){var s=n.stateNode;try{vc(s,"")}catch(v){qe(n,n.return,v)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Sb(s,i),pg(a,o);var c=pg(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?Rb(s,h):u==="dangerouslySetInnerHTML"?Cb(s,h):u==="children"?vc(s,h):o0(s,u,h,c)}switch(a){case"input":cg(s,i);break;case"textarea":Ib(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?ga(s,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?ga(s,!!i.multiple,i.defaultValue,!0):ga(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ic]=i}catch(v){qe(n,n.return,v)}}break;case 6:if(zn(e,n),sr(n),r&4){if(n.stateNode===null)throw Error(z(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(v){qe(n,n.return,v)}}break;case 3:if(zn(e,n),sr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Ec(e.containerInfo)}catch(v){qe(n,n.return,v)}break;case 4:zn(e,n),sr(n);break;case 13:zn(e,n),sr(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(F0=Ge())),r&4&&S_(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(Mt=(c=Mt)||u,zn(e,n),Mt=c):zn(e,n),sr(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(J=n,u=n.child;u!==null;){for(h=J=u;J!==null;){switch(p=J,m=p.child,p.tag){case 0:case 11:case 14:case 15:sc(4,p,p.return);break;case 1:ua(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,t=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){qe(r,t,v)}}break;case 5:ua(p,p.return);break;case 22:if(p.memoizedState!==null){N_(h);continue}}m!==null?(m.return=p,J=m):N_(h)}u=u.sibling}e:for(u=null,h=n;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Ab("display",o))}catch(v){qe(n,n.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){qe(n,n.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:zn(e,n),sr(n),r&4&&S_(n);break;case 21:break;default:zn(e,n),sr(n)}}function sr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(nS(t)){var r=t;break e}t=t.return}throw Error(z(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(vc(s,""),r.flags&=-33);var i=T_(n);Wg(n,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=T_(n);zg(n,a,o);break;default:throw Error(z(161))}}catch(l){qe(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function PM(n,e,t){J=n,iS(n)}function iS(n,e,t){for(var r=(n.mode&1)!==0;J!==null;){var s=J,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||cd;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Mt;a=cd;var c=Mt;if(cd=o,(Mt=l)&&!c)for(J=s;J!==null;)o=J,l=o.child,o.tag===22&&o.memoizedState!==null?C_(s):l!==null?(l.return=o,J=l):C_(s);for(;i!==null;)J=i,iS(i),i=i.sibling;J=s,cd=a,Mt=c}I_(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,J=i):I_(n)}}function I_(n){for(;J!==null;){var e=J;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mt||Nf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Mt)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Wn(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&d_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}d_(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ec(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}Mt||e.flags&512&&Ug(e)}catch(p){qe(e,e.return,p)}}if(e===n){J=null;break}if(t=e.sibling,t!==null){t.return=e.return,J=t;break}J=e.return}}function N_(n){for(;J!==null;){var e=J;if(e===n){J=null;break}var t=e.sibling;if(t!==null){t.return=e.return,J=t;break}J=e.return}}function C_(n){for(;J!==null;){var e=J;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Nf(4,e)}catch(l){qe(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){qe(e,s,l)}}var i=e.return;try{Ug(e)}catch(l){qe(e,i,l)}break;case 5:var o=e.return;try{Ug(e)}catch(l){qe(e,o,l)}}}catch(l){qe(e,e.return,l)}if(e===n){J=null;break}var a=e.sibling;if(a!==null){a.return=e.return,J=a;break}J=e.return}}var DM=Math.ceil,Th=as.ReactCurrentDispatcher,j0=as.ReactCurrentOwner,Vn=as.ReactCurrentBatchConfig,we=0,ft=null,Ze=null,Tt=0,mn=0,da=pi(0),it=0,Dc=null,oo=0,Cf=0,L0=0,ic=null,sn=null,F0=0,Ma=1/0,Or=null,Sh=!1,qg=null,qs=null,ud=!1,Ms=null,Ih=0,oc=0,Hg=null,Ld=-1,Fd=0;function Kt(){return we&6?Ge():Ld!==-1?Ld:Ld=Ge()}function Hs(n){return n.mode&1?we&2&&Tt!==0?Tt&-Tt:gM.transition!==null?(Fd===0&&(Fd=zb()),Fd):(n=Ie,n!==0||(n=window.event,n=n===void 0?16:Jb(n.type)),n):1}function Jn(n,e,t,r){if(50<oc)throw oc=0,Hg=null,Error(z(185));au(n,t,r),(!(we&2)||n!==ft)&&(n===ft&&(!(we&2)&&(Cf|=t),it===4&&Ts(n,Tt)),un(n,r),t===1&&we===0&&!(e.mode&1)&&(Ma=Ge()+500,Tf&&mi()))}function un(n,e){var t=n.callbackNode;gD(n,e);var r=uh(n,n===ft?Tt:0);if(r===0)t!==null&&Lw(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Lw(t),e===1)n.tag===0?mM(A_.bind(null,n)):mT(A_.bind(null,n)),dM(function(){!(we&6)&&mi()}),t=null;else{switch(Wb(r)){case 1:t=d0;break;case 4:t=$b;break;case 16:t=ch;break;case 536870912:t=Ub;break;default:t=ch}t=fS(t,oS.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function oS(n,e){if(Ld=-1,Fd=0,we&6)throw Error(z(327));var t=n.callbackNode;if(_a()&&n.callbackNode!==t)return null;var r=uh(n,n===ft?Tt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Nh(n,r);else{e=r;var s=we;we|=2;var i=lS();(ft!==n||Tt!==e)&&(Or=null,Ma=Ge()+500,Ki(n,e));do try{VM();break}catch(a){aS(n,a)}while(!0);b0(),Th.current=i,we=s,Ze!==null?e=0:(ft=null,Tt=0,e=it)}if(e!==0){if(e===2&&(s=xg(n),s!==0&&(r=s,e=Kg(n,s))),e===1)throw t=Dc,Ki(n,0),Ts(n,r),un(n,Ge()),t;if(e===6)Ts(n,r);else{if(s=n.current.alternate,!(r&30)&&!MM(s)&&(e=Nh(n,r),e===2&&(i=xg(n),i!==0&&(r=i,e=Kg(n,i))),e===1))throw t=Dc,Ki(n,0),Ts(n,r),un(n,Ge()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:Ri(n,sn,Or);break;case 3:if(Ts(n,r),(r&130023424)===r&&(e=F0+500-Ge(),10<e)){if(uh(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){Kt(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=Ig(Ri.bind(null,n,sn,Or),e);break}Ri(n,sn,Or);break;case 4:if(Ts(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var o=31-Qn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*DM(r/1960))-r,10<r){n.timeoutHandle=Ig(Ri.bind(null,n,sn,Or),r);break}Ri(n,sn,Or);break;case 5:Ri(n,sn,Or);break;default:throw Error(z(329))}}}return un(n,Ge()),n.callbackNode===t?oS.bind(null,n):null}function Kg(n,e){var t=ic;return n.current.memoizedState.isDehydrated&&(Ki(n,e).flags|=256),n=Nh(n,e),n!==2&&(e=sn,sn=t,e!==null&&Gg(e)),n}function Gg(n){sn===null?sn=n:sn.push.apply(sn,n)}function MM(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!Xn(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ts(n,e){for(e&=~L0,e&=~Cf,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Qn(e),r=1<<t;n[t]=-1,e&=~r}}function A_(n){if(we&6)throw Error(z(327));_a();var e=uh(n,0);if(!(e&1))return un(n,Ge()),null;var t=Nh(n,e);if(n.tag!==0&&t===2){var r=xg(n);r!==0&&(e=r,t=Kg(n,r))}if(t===1)throw t=Dc,Ki(n,0),Ts(n,e),un(n,Ge()),t;if(t===6)throw Error(z(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ri(n,sn,Or),un(n,Ge()),null}function B0(n,e){var t=we;we|=1;try{return n(e)}finally{we=t,we===0&&(Ma=Ge()+500,Tf&&mi())}}function ao(n){Ms!==null&&Ms.tag===0&&!(we&6)&&_a();var e=we;we|=1;var t=Vn.transition,r=Ie;try{if(Vn.transition=null,Ie=1,n)return n()}finally{Ie=r,Vn.transition=t,we=e,!(we&6)&&mi()}}function $0(){mn=da.current,Oe(da)}function Ki(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,uM(t)),Ze!==null)for(t=Ze.return;t!==null;){var r=t;switch(_0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&mh();break;case 3:Pa(),Oe(ln),Oe(jt),A0();break;case 5:C0(r);break;case 4:Pa();break;case 13:Oe(Fe);break;case 19:Oe(Fe);break;case 10:T0(r.type._context);break;case 22:case 23:$0()}t=t.return}if(ft=n,Ze=n=Ks(n.current,null),Tt=mn=e,it=0,Dc=null,L0=Cf=oo=0,sn=ic=null,Ui!==null){for(e=0;e<Ui.length;e++)if(t=Ui[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}t.pending=r}Ui=null}return n}function aS(n,e){do{var t=Ze;try{if(b0(),Od.current=bh,kh){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}kh=!1}if(io=0,ut=rt=$e=null,rc=!1,Ac=0,j0.current=null,t===null||t.return===null){it=1,Dc=e,Ze=null;break}e:{var i=n,o=t.return,a=t,l=e;if(e=Tt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=y_(o);if(m!==null){m.flags&=-257,v_(m,o,a,i,e),m.mode&1&&g_(i,c,e),e=m,l=c;var y=e.updateQueue;if(y===null){var v=new Set;v.add(l),e.updateQueue=v}else y.add(l);break e}else{if(!(e&1)){g_(i,c,e),U0();break e}l=Error(z(426))}}else if(je&&a.mode&1){var w=y_(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),v_(w,o,a,i,e),E0(Da(l,a));break e}}i=l=Da(l,a),it!==4&&(it=2),ic===null?ic=[i]:ic.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=WT(i,l,e);u_(i,k);break e;case 1:a=l;var b=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(qs===null||!qs.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=qT(i,a,e);u_(i,C);break e}}i=i.return}while(i!==null)}uS(t)}catch(P){e=P,Ze===t&&t!==null&&(Ze=t=t.return);continue}break}while(!0)}function lS(){var n=Th.current;return Th.current=bh,n===null?bh:n}function U0(){(it===0||it===3||it===2)&&(it=4),ft===null||!(oo&268435455)&&!(Cf&268435455)||Ts(ft,Tt)}function Nh(n,e){var t=we;we|=2;var r=lS();(ft!==n||Tt!==e)&&(Or=null,Ki(n,e));do try{OM();break}catch(s){aS(n,s)}while(!0);if(b0(),we=t,Th.current=r,Ze!==null)throw Error(z(261));return ft=null,Tt=0,it}function OM(){for(;Ze!==null;)cS(Ze)}function VM(){for(;Ze!==null&&!aD();)cS(Ze)}function cS(n){var e=hS(n.alternate,n,mn);n.memoizedProps=n.pendingProps,e===null?uS(n):Ze=e,j0.current=null}function uS(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=CM(t,e),t!==null){t.flags&=32767,Ze=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{it=6,Ze=null;return}}else if(t=NM(t,e,mn),t!==null){Ze=t;return}if(e=e.sibling,e!==null){Ze=e;return}Ze=e=n}while(e!==null);it===0&&(it=5)}function Ri(n,e,t){var r=Ie,s=Vn.transition;try{Vn.transition=null,Ie=1,jM(n,e,t,r)}finally{Vn.transition=s,Ie=r}return null}function jM(n,e,t,r){do _a();while(Ms!==null);if(we&6)throw Error(z(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(z(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(yD(n,i),n===ft&&(Ze=ft=null,Tt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ud||(ud=!0,fS(ch,function(){return _a(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Vn.transition,Vn.transition=null;var o=Ie;Ie=1;var a=we;we|=4,j0.current=null,RM(n,t),sS(t,n),rM(Tg),dh=!!bg,Tg=bg=null,n.current=t,PM(t),lD(),we=a,Ie=o,Vn.transition=i}else n.current=t;if(ud&&(ud=!1,Ms=n,Ih=s),i=n.pendingLanes,i===0&&(qs=null),dD(t.stateNode),un(n,Ge()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(Sh)throw Sh=!1,n=qg,qg=null,n;return Ih&1&&n.tag!==0&&_a(),i=n.pendingLanes,i&1?n===Hg?oc++:(oc=0,Hg=n):oc=0,mi(),null}function _a(){if(Ms!==null){var n=Wb(Ih),e=Vn.transition,t=Ie;try{if(Vn.transition=null,Ie=16>n?16:n,Ms===null)var r=!1;else{if(n=Ms,Ms=null,Ih=0,we&6)throw Error(z(331));var s=we;for(we|=4,J=n.current;J!==null;){var i=J,o=i.child;if(J.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(J=c;J!==null;){var u=J;switch(u.tag){case 0:case 11:case 15:sc(8,u,i)}var h=u.child;if(h!==null)h.return=u,J=h;else for(;J!==null;){u=J;var p=u.sibling,m=u.return;if(tS(u),u===c){J=null;break}if(p!==null){p.return=m,J=p;break}J=m}}}var y=i.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}J=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,J=o;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:sc(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,J=k;break e}J=i.return}}var b=n.current;for(J=b;J!==null;){o=J;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,J=T;else e:for(o=b;J!==null;){if(a=J,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Nf(9,a)}}catch(P){qe(a,a.return,P)}if(a===o){J=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,J=C;break e}J=a.return}}if(we=s,mi(),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot(wf,n)}catch{}r=!0}return r}finally{Ie=t,Vn.transition=e}}return!1}function R_(n,e,t){e=Da(t,e),e=WT(n,e,1),n=Ws(n,e,1),e=Kt(),n!==null&&(au(n,1,e),un(n,e))}function qe(n,e,t){if(n.tag===3)R_(n,n,t);else for(;e!==null;){if(e.tag===3){R_(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qs===null||!qs.has(r))){n=Da(t,n),n=qT(e,n,1),e=Ws(e,n,1),n=Kt(),e!==null&&(au(e,1,n),un(e,n));break}}e=e.return}}function LM(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Kt(),n.pingedLanes|=n.suspendedLanes&t,ft===n&&(Tt&t)===t&&(it===4||it===3&&(Tt&130023424)===Tt&&500>Ge()-F0?Ki(n,0):L0|=t),un(n,e)}function dS(n,e){e===0&&(n.mode&1?(e=ed,ed<<=1,!(ed&130023424)&&(ed=4194304)):e=1);var t=Kt();n=Xr(n,e),n!==null&&(au(n,e,t),un(n,t))}function FM(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),dS(n,t)}function BM(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),dS(n,t)}var hS;hS=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ln.current)on=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return on=!1,IM(n,e,t);on=!!(n.flags&131072)}else on=!1,je&&e.flags&1048576&&gT(e,vh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;jd(n,e),n=e.pendingProps;var s=Ca(e,jt.current);wa(e,t),s=P0(null,e,r,n,s,t);var i=D0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(r)?(i=!0,gh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,I0(e),s.updater=If,e.stateNode=s,s._reactInternals=e,Mg(e,r,n,t),e=jg(null,e,r,!0,i,t)):(e.tag=0,je&&i&&w0(e),zt(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(jd(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=UM(r),n=Wn(r,n),s){case 0:e=Vg(null,e,r,n,t);break e;case 1:e=__(null,e,r,n,t);break e;case 11:e=x_(null,e,r,n,t);break e;case 14:e=w_(null,e,r,Wn(r.type,n),t);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Wn(r,s),Vg(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Wn(r,s),__(n,e,r,s,t);case 3:e:{if(QT(e),n===null)throw Error(z(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ET(n,e),_h(e,r,null,t);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Da(Error(z(423)),e),e=E_(n,e,r,t,s);break e}else if(r!==s){s=Da(Error(z(424)),e),e=E_(n,e,r,t,s);break e}else for(vn=zs(e.stateNode.containerInfo.firstChild),_n=e,je=!0,Hn=null,t=wT(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Aa(),r===s){e=Zr(n,e,t);break e}zt(n,e,r,t)}e=e.child}return e;case 5:return kT(e),n===null&&Rg(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,o=s.children,Sg(r,s)?o=null:i!==null&&Sg(r,i)&&(e.flags|=32),GT(n,e),zt(n,e,o,t),e.child;case 6:return n===null&&Rg(e),null;case 13:return JT(n,e,t);case 4:return N0(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Ra(e,null,r,t):zt(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Wn(r,s),x_(n,e,r,s,t);case 7:return zt(n,e,e.pendingProps,t),e.child;case 8:return zt(n,e,e.pendingProps.children,t),e.child;case 12:return zt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Pe(xh,r._currentValue),r._currentValue=o,i!==null)if(Xn(i.value,o)){if(i.children===s.children&&!ln.current){e=Zr(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Hr(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),Pg(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(z(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Pg(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,wa(e,t),s=Bn(s),r=r(s),e.flags|=1,zt(n,e,r,t),e.child;case 14:return r=e.type,s=Wn(r,e.pendingProps),s=Wn(r.type,s),w_(n,e,r,s,t);case 15:return HT(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Wn(r,s),jd(n,e),e.tag=1,cn(r)?(n=!0,gh(e)):n=!1,wa(e,t),zT(e,r,s),Mg(e,r,s,t),jg(null,e,r,!0,n,t);case 19:return YT(n,e,t);case 22:return KT(n,e,t)}throw Error(z(156,e.tag))};function fS(n,e){return Bb(n,e)}function $M(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(n,e,t,r){return new $M(n,e,t,r)}function z0(n){return n=n.prototype,!(!n||!n.isReactComponent)}function UM(n){if(typeof n=="function")return z0(n)?1:0;if(n!=null){if(n=n.$$typeof,n===l0)return 11;if(n===c0)return 14}return 2}function Ks(n,e){var t=n.alternate;return t===null?(t=Mn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Bd(n,e,t,r,s,i){var o=2;if(r=n,typeof n=="function")z0(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case ta:return Gi(t.children,s,i,e);case a0:o=8,s|=8;break;case sg:return n=Mn(12,t,e,s|2),n.elementType=sg,n.lanes=i,n;case ig:return n=Mn(13,t,e,s),n.elementType=ig,n.lanes=i,n;case og:return n=Mn(19,t,e,s),n.elementType=og,n.lanes=i,n;case kb:return Af(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case _b:o=10;break e;case Eb:o=9;break e;case l0:o=11;break e;case c0:o=14;break e;case ws:o=16,r=null;break e}throw Error(z(130,n==null?n:typeof n,""))}return e=Mn(o,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function Gi(n,e,t,r){return n=Mn(7,n,r,e),n.lanes=t,n}function Af(n,e,t,r){return n=Mn(22,n,r,e),n.elementType=kb,n.lanes=t,n.stateNode={isHidden:!1},n}function vm(n,e,t){return n=Mn(6,n,null,e),n.lanes=t,n}function xm(n,e,t){return e=Mn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function zM(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zp(0),this.expirationTimes=Zp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zp(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function W0(n,e,t,r,s,i,o,a,l){return n=new zM(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Mn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},I0(i),n}function WM(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ea,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function pS(n){if(!n)return ii;n=n._reactInternals;e:{if(Io(n)!==n||n.tag!==1)throw Error(z(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(n.tag===1){var t=n.type;if(cn(t))return pT(n,t,e)}return e}function mS(n,e,t,r,s,i,o,a,l){return n=W0(t,r,!0,n,s,i,o,a,l),n.context=pS(null),t=n.current,r=Kt(),s=Hs(t),i=Hr(r,s),i.callback=e??null,Ws(t,i,s),n.current.lanes=s,au(n,s,r),un(n,r),n}function Rf(n,e,t,r){var s=e.current,i=Kt(),o=Hs(s);return t=pS(t),e.context===null?e.context=t:e.pendingContext=t,e=Hr(i,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Ws(s,e,o),n!==null&&(Jn(n,s,o,i),Md(n,s,o)),o}function Ch(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function P_(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function q0(n,e){P_(n,e),(n=n.alternate)&&P_(n,e)}function qM(){return null}var gS=typeof reportError=="function"?reportError:function(n){console.error(n)};function H0(n){this._internalRoot=n}Pf.prototype.render=H0.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(z(409));Rf(n,e,null,null)};Pf.prototype.unmount=H0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ao(function(){Rf(null,n,null,null)}),e[Yr]=null}};function Pf(n){this._internalRoot=n}Pf.prototype.unstable_scheduleHydration=function(n){if(n){var e=Kb();n={blockedOn:null,target:n,priority:e};for(var t=0;t<bs.length&&e!==0&&e<bs[t].priority;t++);bs.splice(t,0,n),t===0&&Qb(n)}};function K0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Df(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function D_(){}function HM(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Ch(o);i.call(c)}}var o=mS(e,r,n,0,null,!1,!1,"",D_);return n._reactRootContainer=o,n[Yr]=o.current,Tc(n.nodeType===8?n.parentNode:n),ao(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Ch(l);a.call(c)}}var l=W0(n,0,!1,null,null,!1,!1,"",D_);return n._reactRootContainer=l,n[Yr]=l.current,Tc(n.nodeType===8?n.parentNode:n),ao(function(){Rf(e,l,t,r)}),l}function Mf(n,e,t,r,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Ch(o);a.call(l)}}Rf(e,o,n,s)}else o=HM(t,e,n,s,r);return Ch(o)}qb=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Bl(e.pendingLanes);t!==0&&(h0(e,t|1),un(e,Ge()),!(we&6)&&(Ma=Ge()+500,mi()))}break;case 13:ao(function(){var r=Xr(n,1);if(r!==null){var s=Kt();Jn(r,n,1,s)}}),q0(n,1)}};f0=function(n){if(n.tag===13){var e=Xr(n,134217728);if(e!==null){var t=Kt();Jn(e,n,134217728,t)}q0(n,134217728)}};Hb=function(n){if(n.tag===13){var e=Hs(n),t=Xr(n,e);if(t!==null){var r=Kt();Jn(t,n,e,r)}q0(n,e)}};Kb=function(){return Ie};Gb=function(n,e){var t=Ie;try{return Ie=n,e()}finally{Ie=t}};gg=function(n,e,t){switch(e){case"input":if(cg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=bf(r);if(!s)throw Error(z(90));Tb(r),cg(r,s)}}}break;case"textarea":Ib(n,t);break;case"select":e=t.value,e!=null&&ga(n,!!t.multiple,e,!1)}};Mb=B0;Ob=ao;var KM={usingClientEntryPoint:!1,Events:[cu,ia,bf,Pb,Db,B0]},Nl={findFiberByHostInstance:$i,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},GM={bundleType:Nl.bundleType,version:Nl.version,rendererPackageName:Nl.rendererPackageName,rendererConfig:Nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:as.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Lb(n),n===null?null:n.stateNode},findFiberByHostInstance:Nl.findFiberByHostInstance||qM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{wf=dd.inject(GM),fr=dd}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KM;Tn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K0(e))throw Error(z(200));return WM(n,e,null,t)};Tn.createRoot=function(n,e){if(!K0(n))throw Error(z(299));var t=!1,r="",s=gS;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=W0(n,1,!1,null,null,t,!1,r,s),n[Yr]=e.current,Tc(n.nodeType===8?n.parentNode:n),new H0(e)};Tn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(z(188)):(n=Object.keys(n).join(","),Error(z(268,n)));return n=Lb(e),n=n===null?null:n.stateNode,n};Tn.flushSync=function(n){return ao(n)};Tn.hydrate=function(n,e,t){if(!Df(e))throw Error(z(200));return Mf(null,n,e,!0,t)};Tn.hydrateRoot=function(n,e,t){if(!K0(n))throw Error(z(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",o=gS;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=mS(e,null,n,1,t??null,s,!1,i,o),n[Yr]=e.current,Tc(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Pf(e)};Tn.render=function(n,e,t){if(!Df(e))throw Error(z(200));return Mf(null,n,e,!1,t)};Tn.unmountComponentAtNode=function(n){if(!Df(n))throw Error(z(40));return n._reactRootContainer?(ao(function(){Mf(null,null,n,!1,function(){n._reactRootContainer=null,n[Yr]=null})}),!0):!1};Tn.unstable_batchedUpdates=B0;Tn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Df(t))throw Error(z(200));if(n==null||n._reactInternals===void 0)throw Error(z(38));return Mf(n,e,t,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function yS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yS)}catch(n){console.error(n)}}yS(),yb.exports=Tn;var vS=yb.exports;const QM=ib(vS);var M_=vS;ng.createRoot=M_.createRoot,ng.hydrateRoot=M_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mc(){return Mc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Mc.apply(this,arguments)}var Os;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Os||(Os={}));const O_="popstate";function JM(n){n===void 0&&(n={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Qg("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Ah(s)}return XM(e,t,null,n)}function tt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function xS(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function YM(){return Math.random().toString(36).substr(2,8)}function V_(n,e){return{usr:n.state,key:n.key,idx:e}}function Qg(n,e,t,r){return t===void 0&&(t=null),Mc({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?tl(e):e,{state:t,key:e&&e.key||r||YM()})}function Ah(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function tl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function XM(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=Os.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Mc({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){a=Os.Pop;let w=u(),k=w==null?null:w-c;c=w,l&&l({action:a,location:v.location,delta:k})}function p(w,k){a=Os.Push;let b=Qg(v.location,w,k);c=u()+1;let T=V_(b,c),C=v.createHref(b);try{o.pushState(T,"",C)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(C)}i&&l&&l({action:a,location:v.location,delta:1})}function m(w,k){a=Os.Replace;let b=Qg(v.location,w,k);c=u();let T=V_(b,c),C=v.createHref(b);o.replaceState(T,"",C),i&&l&&l({action:a,location:v.location,delta:0})}function y(w){let k=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof w=="string"?w:Ah(w);return b=b.replace(/ $/,"%20"),tt(k,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,k)}let v={get action(){return a},get location(){return n(s,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(O_,h),l=w,()=>{s.removeEventListener(O_,h),l=null}},createHref(w){return e(s,w)},createURL:y,encodeLocation(w){let k=y(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:p,replace:m,go(w){return o.go(w)}};return v}var j_;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(j_||(j_={}));function ZM(n,e,t){return t===void 0&&(t="/"),eO(n,e,t)}function eO(n,e,t,r){let s=typeof e=="string"?tl(e):e,i=G0(s.pathname||"/",t);if(i==null)return null;let o=wS(n);tO(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=fO(i);a=uO(o[l],c)}return a}function wS(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(tt(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Gs([r,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(tt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),wS(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:lO(c,i.index),routesMeta:u})};return n.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of _S(i.path))s(i,o,l)}),e}function _S(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=_S(r.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function tO(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:cO(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const nO=/^:[\w-]+$/,rO=3,sO=2,iO=1,oO=10,aO=-2,L_=n=>n==="*";function lO(n,e){let t=n.split("/"),r=t.length;return t.some(L_)&&(r+=aO),e&&(r+=sO),t.filter(s=>!L_(s)).reduce((s,i)=>s+(nO.test(i)?rO:i===""?iO:oO),r)}function cO(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function uO(n,e,t){let{routesMeta:r}=n,s={},i="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],c=a===r.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=dO({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Gs([i,h.pathname]),pathnameBase:yO(Gs([i,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(i=Gs([i,h.pathnameBase]))}return o}function dO(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=hO(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{let{paramName:p,isOptional:m}=u;if(p==="*"){let v=a[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const y=a[h];return m&&!y?c[p]=void 0:c[p]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:n}}function hO(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),xS(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function fO(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return xS(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function G0(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function pO(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?tl(n):n;return{pathname:t?t.startsWith("/")?t:mO(t,e):e,search:vO(r),hash:xO(s)}}function mO(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function wm(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gO(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ES(n,e){let t=gO(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function kS(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=tl(n):(s=Mc({},n),tt(!s.pathname||!s.pathname.includes("?"),wm("?","pathname","search",s)),tt(!s.pathname||!s.pathname.includes("#"),wm("#","pathname","hash",s)),tt(!s.search||!s.search.includes("#"),wm("#","search","hash",s)));let i=n===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;s.pathname=p.join("/")}a=h>=0?e[h]:"/"}let l=pO(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Gs=n=>n.join("/").replace(/\/\/+/g,"/"),yO=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),vO=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,xO=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function wO(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const bS=["post","put","patch","delete"];new Set(bS);const _O=["get",...bS];new Set(_O);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oc(){return Oc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Oc.apply(this,arguments)}const Q0=O.createContext(null),EO=O.createContext(null),No=O.createContext(null),Of=O.createContext(null),gi=O.createContext({outlet:null,matches:[],isDataRoute:!1}),TS=O.createContext(null);function kO(n,e){let{relative:t}=e===void 0?{}:e;du()||tt(!1);let{basename:r,navigator:s}=O.useContext(No),{hash:i,pathname:o,search:a}=IS(n,{relative:t}),l=o;return r!=="/"&&(l=o==="/"?r:Gs([r,o])),s.createHref({pathname:l,search:a,hash:i})}function du(){return O.useContext(Of)!=null}function hu(){return du()||tt(!1),O.useContext(Of).location}function SS(n){O.useContext(No).static||O.useLayoutEffect(n)}function bO(){let{isDataRoute:n}=O.useContext(gi);return n?LO():TO()}function TO(){du()||tt(!1);let n=O.useContext(Q0),{basename:e,future:t,navigator:r}=O.useContext(No),{matches:s}=O.useContext(gi),{pathname:i}=hu(),o=JSON.stringify(ES(s,t.v7_relativeSplatPath)),a=O.useRef(!1);return SS(()=>{a.current=!0}),O.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){r.go(c);return}let h=kS(c,JSON.parse(o),i,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Gs([e,h.pathname])),(u.replace?r.replace:r.push)(h,u.state,u)},[e,r,o,i,n])}function SO(){let{matches:n}=O.useContext(gi),e=n[n.length-1];return e?e.params:{}}function IS(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=O.useContext(No),{matches:s}=O.useContext(gi),{pathname:i}=hu(),o=JSON.stringify(ES(s,r.v7_relativeSplatPath));return O.useMemo(()=>kS(n,JSON.parse(o),i,t==="path"),[n,o,i,t])}function IO(n,e){return NO(n,e)}function NO(n,e,t,r){du()||tt(!1);let{navigator:s}=O.useContext(No),{matches:i}=O.useContext(gi),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=hu(),u;if(e){var h;let w=typeof e=="string"?tl(e):e;l==="/"||(h=w.pathname)!=null&&h.startsWith(l)||tt(!1),u=w}else u=c;let p=u.pathname||"/",m=p;if(l!=="/"){let w=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=ZM(n,{pathname:m}),v=DO(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:Gs([l,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:Gs([l,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,t,r);return e&&v?O.createElement(Of.Provider,{value:{location:Oc({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Os.Pop}},v):v}function CO(){let n=jO(),e=wO(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),t?O.createElement("pre",{style:s},t):null,null)}const AO=O.createElement(CO,null);class RO extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?O.createElement(gi.Provider,{value:this.props.routeContext},O.createElement(TS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function PO(n){let{routeContext:e,match:t,children:r}=n,s=O.useContext(Q0);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),O.createElement(gi.Provider,{value:e},r)}function DO(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,a=(s=t)==null?void 0:s.errors;if(a!=null){let u=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);u>=0||tt(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(t&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:p,errors:m}=t,y=h.route.loader&&p[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||y){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,p)=>{let m,y=!1,v=null,w=null;t&&(m=a&&h.route.id?a[h.route.id]:void 0,v=h.route.errorElement||AO,l&&(c<0&&p===0?(FO("route-fallback"),y=!0,w=null):c===p&&(y=!0,w=h.route.hydrateFallbackElement||null)));let k=e.concat(o.slice(0,p+1)),b=()=>{let T;return m?T=v:y?T=w:h.route.Component?T=O.createElement(h.route.Component,null):h.route.element?T=h.route.element:T=u,O.createElement(PO,{match:h,routeContext:{outlet:u,matches:k,isDataRoute:t!=null},children:T})};return t&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?O.createElement(RO,{location:t.location,revalidation:t.revalidation,component:v,error:m,children:b(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):b()},null)}var NS=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(NS||{}),CS=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(CS||{});function MO(n){let e=O.useContext(Q0);return e||tt(!1),e}function OO(n){let e=O.useContext(EO);return e||tt(!1),e}function VO(n){let e=O.useContext(gi);return e||tt(!1),e}function AS(n){let e=VO(),t=e.matches[e.matches.length-1];return t.route.id||tt(!1),t.route.id}function jO(){var n;let e=O.useContext(TS),t=OO(),r=AS();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function LO(){let{router:n}=MO(NS.UseNavigateStable),e=AS(CS.UseNavigateStable),t=O.useRef(!1);return SS(()=>{t.current=!0}),O.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Oc({fromRouteId:e},i)))},[n,e])}const F_={};function FO(n,e,t){F_[n]||(F_[n]=!0)}function BO(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Mr(n){tt(!1)}function $O(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Os.Pop,navigator:i,static:o=!1,future:a}=n;du()&&tt(!1);let l=e.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:i,static:o,future:Oc({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof r=="string"&&(r=tl(r));let{pathname:u="/",search:h="",hash:p="",state:m=null,key:y="default"}=r,v=O.useMemo(()=>{let w=G0(u,l);return w==null?null:{location:{pathname:w,search:h,hash:p,state:m,key:y},navigationType:s}},[l,u,h,p,m,y,s]);return v==null?null:O.createElement(No.Provider,{value:c},O.createElement(Of.Provider,{children:t,value:v}))}function UO(n){let{children:e,location:t}=n;return IO(Jg(e),t)}new Promise(()=>{});function Jg(n,e){e===void 0&&(e=[]);let t=[];return O.Children.forEach(n,(r,s)=>{if(!O.isValidElement(r))return;let i=[...e,s];if(r.type===O.Fragment){t.push.apply(t,Jg(r.props.children,i));return}r.type!==Mr&&tt(!1),!r.props.index||!r.props.children||tt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Jg(r.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yg(){return Yg=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Yg.apply(this,arguments)}function zO(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function WO(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function qO(n,e){return n.button===0&&(!e||e==="_self")&&!WO(n)}const HO=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],KO="6";try{window.__reactRouterVersion=KO}catch{}const GO="startTransition",B_=LP[GO];function QO(n){let{basename:e,children:t,future:r,window:s}=n,i=O.useRef();i.current==null&&(i.current=JM({window:s,v5Compat:!0}));let o=i.current,[a,l]=O.useState({action:o.action,location:o.location}),{v7_startTransition:c}=r||{},u=O.useCallback(h=>{c&&B_?B_(()=>l(h)):l(h)},[l,c]);return O.useLayoutEffect(()=>o.listen(u),[o,u]),O.useEffect(()=>BO(r),[r]),O.createElement($O,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:r})}const JO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",YO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gn=O.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,p=zO(e,HO),{basename:m}=O.useContext(No),y,v=!1;if(typeof c=="string"&&YO.test(c)&&(y=c,JO))try{let T=new URL(window.location.href),C=c.startsWith("//")?new URL(T.protocol+c):new URL(c),P=G0(C.pathname,m);C.origin===T.origin&&P!=null?c=P+C.search+C.hash:v=!0}catch{}let w=kO(c,{relative:s}),k=XO(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function b(T){r&&r(T),T.defaultPrevented||k(T)}return O.createElement("a",Yg({},p,{href:y||w,onClick:v||i?r:b,ref:t,target:l}))});var $_;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})($_||($_={}));var U_;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(U_||(U_={}));function XO(n,e){let{target:t,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=bO(),c=hu(),u=IS(n,{relative:o});return O.useCallback(h=>{if(qO(h,t)){h.preventDefault();let p=r!==void 0?r:Ah(c)===Ah(u);l(n,{replace:p,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,r,s,t,n,i,o,a])}let ZO={data:""},e2=n=>{if(typeof window=="object"){let e=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(n||document.head).appendChild(e),e.firstChild}return n||ZO},t2=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,n2=/\/\*[^]*?\*\/|  +/g,z_=/\n+/g,Ss=(n,e)=>{let t="",r="",s="";for(let i in n){let o=n[i];i[0]=="@"?i[1]=="i"?t=i+" "+o+";":r+=i[1]=="f"?Ss(o,i):i+"{"+Ss(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=Ss(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,a):a?a+" "+l:l)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Ss.p?Ss.p(i,o):i+":"+o+";")}return t+(e&&s?e+"{"+s+"}":s)+r},Pr={},RS=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+RS(n[t]);return e}return n},r2=(n,e,t,r,s)=>{let i=RS(n),o=Pr[i]||(Pr[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!Pr[o]){let l=i!==n?n:(c=>{let u,h,p=[{}];for(;u=t2.exec(c.replace(n2,""));)u[4]?p.shift():u[3]?(h=u[3].replace(z_," ").trim(),p.unshift(p[0][h]=p[0][h]||{})):p[0][u[1]]=u[2].replace(z_," ").trim();return p[0]})(n);Pr[o]=Ss(s?{["@keyframes "+o]:l}:l,t?"":"."+o)}let a=t&&Pr.g?Pr.g:null;return t&&(Pr.g=Pr[o]),((l,c,u,h)=>{h?c.data=c.data.replace(h,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Pr[o],e,r,a),o},s2=(n,e,t)=>n.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(t),l=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=l?"."+l:a&&typeof a=="object"?a.props?"":Ss(a,""):a===!1?"":a}return r+s+(o??"")},"");function Vf(n){let e=this||{},t=n.call?n(e.p):n;return r2(t.unshift?t.raw?s2(t,[].slice.call(arguments,1),e.p):t.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):t,e2(e.target),e.g,e.o,e.k)}let PS,Xg,Zg;Vf.bind({g:1});let es=Vf.bind({k:1});function i2(n,e,t,r){Ss.p=e,PS=n,Xg=t,Zg=r}function yi(n,e){let t=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),l=a.className||s.className;t.p=Object.assign({theme:Xg&&Xg()},a),t.o=/ *go\d+/.test(l),a.className=Vf.apply(t,r)+(l?" "+l:"");let c=n;return n[0]&&(c=a.as||n,delete a.as),Zg&&c[0]&&Zg(a),PS(c,a)}return s}}var o2=n=>typeof n=="function",Rh=(n,e)=>o2(n)?n(e):n,a2=(()=>{let n=0;return()=>(++n).toString()})(),DS=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),l2=20,J0="default",MS=(n,e)=>{let{toastLimit:t}=n.settings;switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,t)};case 1:return{...n,toasts:n.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return MS(n,{type:n.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...n,toasts:n.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},$d=[],OS={toasts:[],pausedAt:void 0,settings:{toastLimit:l2}},lr={},VS=(n,e=J0)=>{lr[e]=MS(lr[e]||OS,n),$d.forEach(([t,r])=>{t===e&&r(lr[e])})},jS=n=>Object.keys(lr).forEach(e=>VS(n,e)),c2=n=>Object.keys(lr).find(e=>lr[e].toasts.some(t=>t.id===n)),jf=(n=J0)=>e=>{VS(e,n)},u2={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},d2=(n={},e=J0)=>{let[t,r]=O.useState(lr[e]||OS),s=O.useRef(lr[e]);O.useEffect(()=>(s.current!==lr[e]&&r(lr[e]),$d.push([e,r]),()=>{let o=$d.findIndex(([a])=>a===e);o>-1&&$d.splice(o,1)}),[e]);let i=t.toasts.map(o=>{var a,l,c;return{...n,...n[o.type],...o,removeDelay:o.removeDelay||((a=n[o.type])==null?void 0:a.removeDelay)||(n==null?void 0:n.removeDelay),duration:o.duration||((l=n[o.type])==null?void 0:l.duration)||(n==null?void 0:n.duration)||u2[o.type],style:{...n.style,...(c=n[o.type])==null?void 0:c.style,...o.style}}});return{...t,toasts:i}},h2=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||a2()}),fu=n=>(e,t)=>{let r=h2(e,n,t);return jf(r.toasterId||c2(r.id))({type:2,toast:r}),r.id},st=(n,e)=>fu("blank")(n,e);st.error=fu("error");st.success=fu("success");st.loading=fu("loading");st.custom=fu("custom");st.dismiss=(n,e)=>{let t={type:3,toastId:n};e?jf(e)(t):jS(t)};st.dismissAll=n=>st.dismiss(void 0,n);st.remove=(n,e)=>{let t={type:4,toastId:n};e?jf(e)(t):jS(t)};st.removeAll=n=>st.remove(void 0,n);st.promise=(n,e,t)=>{let r=st.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(s=>{let i=e.success?Rh(e.success,s):void 0;return i?st.success(i,{id:r,...t,...t==null?void 0:t.success}):st.dismiss(r),s}).catch(s=>{let i=e.error?Rh(e.error,s):void 0;i?st.error(i,{id:r,...t,...t==null?void 0:t.error}):st.dismiss(r)}),n};var f2=1e3,p2=(n,e="default")=>{let{toasts:t,pausedAt:r}=d2(n,e),s=O.useRef(new Map).current,i=O.useCallback((h,p=f2)=>{if(s.has(h))return;let m=setTimeout(()=>{s.delete(h),o({type:4,toastId:h})},p);s.set(h,m)},[]);O.useEffect(()=>{if(r)return;let h=Date.now(),p=t.map(m=>{if(m.duration===1/0)return;let y=(m.duration||0)+m.pauseDuration-(h-m.createdAt);if(y<0){m.visible&&st.dismiss(m.id);return}return setTimeout(()=>st.dismiss(m.id,e),y)});return()=>{p.forEach(m=>m&&clearTimeout(m))}},[t,r,e]);let o=O.useCallback(jf(e),[e]),a=O.useCallback(()=>{o({type:5,time:Date.now()})},[o]),l=O.useCallback((h,p)=>{o({type:1,toast:{id:h,height:p}})},[o]),c=O.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),u=O.useCallback((h,p)=>{let{reverseOrder:m=!1,gutter:y=8,defaultPosition:v}=p||{},w=t.filter(T=>(T.position||v)===(h.position||v)&&T.height),k=w.findIndex(T=>T.id===h.id),b=w.filter((T,C)=>C<k&&T.visible).length;return w.filter(T=>T.visible).slice(...m?[b+1]:[0,b]).reduce((T,C)=>T+(C.height||0)+y,0)},[t]);return O.useEffect(()=>{t.forEach(h=>{if(h.dismissed)i(h.id,h.removeDelay);else{let p=s.get(h.id);p&&(clearTimeout(p),s.delete(h.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:l,startPause:a,endPause:c,calculateOffset:u}}},m2=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,g2=es`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,y2=es`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,v2=yi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${m2} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${g2} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${y2} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,x2=es`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,w2=yi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${x2} 1s linear infinite;
`,_2=es`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,E2=es`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,k2=yi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${_2} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${E2} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,b2=yi("div")`
  position: absolute;
`,T2=yi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,S2=es`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,I2=yi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${S2} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,N2=({toast:n})=>{let{icon:e,type:t,iconTheme:r}=n;return e!==void 0?typeof e=="string"?O.createElement(I2,null,e):e:t==="blank"?null:O.createElement(T2,null,O.createElement(w2,{...r}),t!=="loading"&&O.createElement(b2,null,t==="error"?O.createElement(v2,{...r}):O.createElement(k2,{...r})))},C2=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,A2=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,R2="0%{opacity:0;} 100%{opacity:1;}",P2="0%{opacity:1;} 100%{opacity:0;}",D2=yi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,M2=yi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,O2=(n,e)=>{let t=n.includes("top")?1:-1,[r,s]=DS()?[R2,P2]:[C2(t),A2(t)];return{animation:e?`${es(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${es(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},V2=O.memo(({toast:n,position:e,style:t,children:r})=>{let s=n.height?O2(n.position||e||"top-center",n.visible):{opacity:0},i=O.createElement(N2,{toast:n}),o=O.createElement(M2,{...n.ariaProps},Rh(n.message,n));return O.createElement(D2,{className:n.className,style:{...s,...t,...n.style}},typeof r=="function"?r({icon:i,message:o}):O.createElement(O.Fragment,null,i,o))});i2(O.createElement);var j2=({id:n,className:e,style:t,onHeightUpdate:r,children:s})=>{let i=O.useCallback(o=>{if(o){let a=()=>{let l=o.getBoundingClientRect().height;r(n,l)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,r]);return O.createElement("div",{ref:i,className:e,style:t},s)},L2=(n,e)=>{let t=n.includes("top"),r=t?{top:0}:{bottom:0},s=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:DS()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...s}},F2=Vf`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,hd=16,B2=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:l,handlers:c}=p2(t,i);return O.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:hd,left:hd,right:hd,bottom:hd,pointerEvents:"none",...o},className:a,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let h=u.position||e,p=c.calculateOffset(u,{reverseOrder:n,gutter:r,defaultPosition:e}),m=L2(h,p);return O.createElement(j2,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?F2:"",style:m},u.type==="custom"?Rh(u.message,u):s?s(u):O.createElement(V2,{toast:u,position:h}))}))},se=st,W_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},$2=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},FS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(p=64)),r.push(t[u],t[h],t[p],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(LS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):$2(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const h=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw new U2;const p=i<<2|a>>4;if(r.push(p),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const y=c<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class U2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const z2=function(n){const e=LS(n);return FS.encodeByteArray(e,!0)},Ph=function(n){return z2(n).replace(/\./g,"")},BS=function(n){try{return FS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2=()=>W2().__FIREBASE_DEFAULTS__,H2=()=>{if(typeof process>"u"||typeof W_>"u")return;const n=W_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},K2=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&BS(n[1]);return e&&JSON.parse(e)},Lf=()=>{try{return q2()||H2()||K2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$S=n=>{var e,t;return(t=(e=Lf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},US=n=>{const e=$S(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},zS=()=>{var n;return(n=Lf())===null||n===void 0?void 0:n.config},WS=n=>{var e;return(e=Lf())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ph(JSON.stringify(t)),Ph(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Q2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ot())}function J2(){var n;const e=(n=Lf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Y2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function X2(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Z2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eV(){const n=ot();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function HS(){return!J2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KS(){try{return typeof indexedDB=="object"}catch{return!1}}function tV(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nV="FirebaseError";class br extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=nV,Object.setPrototypeOf(this,br.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pu.prototype.create)}}class pu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?rV(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new br(s,a,r)}}function rV(n,e){return n.replace(sV,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const sV=/\{\$([^}]+)}/g;function iV(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Dh(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(q_(i)&&q_(o)){if(!Dh(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function q_(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ul(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function zl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function oV(n,e){const t=new aV(n,e);return t.subscribe.bind(t)}class aV{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");lV(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=_m),s.error===void 0&&(s.error=_m),s.complete===void 0&&(s.complete=_m);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lV(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function _m(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(n){return n&&n._delegate?n._delegate:n}class oi{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new G2;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dV(e))try{this.getOrInitializeService({instanceIdentifier:Pi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Pi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pi){return this.instances.has(e)}getOptions(e=Pi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:uV(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pi){return this.component?this.component.multipleInstances?e:Pi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uV(n){return n===Pi?void 0:n}function dV(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cV(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(me||(me={}));const fV={debug:me.DEBUG,verbose:me.VERBOSE,info:me.INFO,warn:me.WARN,error:me.ERROR,silent:me.SILENT},pV=me.INFO,mV={[me.DEBUG]:"log",[me.VERBOSE]:"log",[me.INFO]:"info",[me.WARN]:"warn",[me.ERROR]:"error"},gV=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=mV[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Y0{constructor(e){this.name=e,this._logLevel=pV,this._logHandler=gV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in me))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,me.DEBUG,...e),this._logHandler(this,me.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,me.VERBOSE,...e),this._logHandler(this,me.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,me.INFO,...e),this._logHandler(this,me.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,me.WARN,...e),this._logHandler(this,me.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,me.ERROR,...e),this._logHandler(this,me.ERROR,...e)}}const yV=(n,e)=>e.some(t=>n instanceof t);let H_,K_;function vV(){return H_||(H_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xV(){return K_||(K_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GS=new WeakMap,ey=new WeakMap,QS=new WeakMap,Em=new WeakMap,X0=new WeakMap;function wV(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Qs(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&GS.set(t,n)}).catch(()=>{}),X0.set(e,n),e}function _V(n){if(ey.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});ey.set(n,e)}let ty={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ey.get(n);if(e==="objectStoreNames")return n.objectStoreNames||QS.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function EV(n){ty=n(ty)}function kV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(km(this),e,...t);return QS.set(r,e.sort?e.sort():[e]),Qs(r)}:xV().includes(n)?function(...e){return n.apply(km(this),e),Qs(GS.get(this))}:function(...e){return Qs(n.apply(km(this),e))}}function bV(n){return typeof n=="function"?kV(n):(n instanceof IDBTransaction&&_V(n),yV(n,vV())?new Proxy(n,ty):n)}function Qs(n){if(n instanceof IDBRequest)return wV(n);if(Em.has(n))return Em.get(n);const e=bV(n);return e!==n&&(Em.set(n,e),X0.set(e,n)),e}const km=n=>X0.get(n);function TV(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Qs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Qs(o.result),l.oldVersion,l.newVersion,Qs(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const SV=["get","getKey","getAll","getAllKeys","count"],IV=["put","add","delete","clear"],bm=new Map;function G_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(bm.get(e))return bm.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=IV.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||SV.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return bm.set(e,i),i}EV(n=>({...n,get:(e,t,r)=>G_(e,t)||n.get(e,t,r),has:(e,t)=>!!G_(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(CV(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function CV(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ny="@firebase/app",Q_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts=new Y0("@firebase/app"),AV="@firebase/app-compat",RV="@firebase/analytics-compat",PV="@firebase/analytics",DV="@firebase/app-check-compat",MV="@firebase/app-check",OV="@firebase/auth",VV="@firebase/auth-compat",jV="@firebase/database",LV="@firebase/data-connect",FV="@firebase/database-compat",BV="@firebase/functions",$V="@firebase/functions-compat",UV="@firebase/installations",zV="@firebase/installations-compat",WV="@firebase/messaging",qV="@firebase/messaging-compat",HV="@firebase/performance",KV="@firebase/performance-compat",GV="@firebase/remote-config",QV="@firebase/remote-config-compat",JV="@firebase/storage",YV="@firebase/storage-compat",XV="@firebase/firestore",ZV="@firebase/vertexai-preview",ej="@firebase/firestore-compat",tj="firebase",nj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry="[DEFAULT]",rj={[ny]:"fire-core",[AV]:"fire-core-compat",[PV]:"fire-analytics",[RV]:"fire-analytics-compat",[MV]:"fire-app-check",[DV]:"fire-app-check-compat",[OV]:"fire-auth",[VV]:"fire-auth-compat",[jV]:"fire-rtdb",[LV]:"fire-data-connect",[FV]:"fire-rtdb-compat",[BV]:"fire-fn",[$V]:"fire-fn-compat",[UV]:"fire-iid",[zV]:"fire-iid-compat",[WV]:"fire-fcm",[qV]:"fire-fcm-compat",[HV]:"fire-perf",[KV]:"fire-perf-compat",[GV]:"fire-rc",[QV]:"fire-rc-compat",[JV]:"fire-gcs",[YV]:"fire-gcs-compat",[XV]:"fire-fst",[ej]:"fire-fst-compat",[ZV]:"fire-vertex","fire-js":"fire-js",[tj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=new Map,sj=new Map,sy=new Map;function J_(n,e){try{n.container.addComponent(e)}catch(t){ts.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function lo(n){const e=n.name;if(sy.has(e))return ts.debug(`There were multiple attempts to register component ${e}.`),!1;sy.set(e,n);for(const t of Mh.values())J_(t,n);for(const t of sj.values())J_(t,n);return!0}function Ff(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function cr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Js=new pu("app","Firebase",ij);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new oi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Js.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=nj;function JS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ry,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Js.create("bad-app-name",{appName:String(s)});if(t||(t=zS()),!t)throw Js.create("no-options");const i=Mh.get(s);if(i){if(Dh(t,i.options)&&Dh(r,i.config))return i;throw Js.create("duplicate-app",{appName:s})}const o=new hV(s);for(const l of sy.values())o.addComponent(l);const a=new oj(t,r,o);return Mh.set(s,a),a}function Z0(n=ry){const e=Mh.get(n);if(!e&&n===ry&&zS())return JS();if(!e)throw Js.create("no-app",{appName:n});return e}function mr(n,e,t){var r;let s=(r=rj[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ts.warn(a.join(" "));return}lo(new oi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj="firebase-heartbeat-database",lj=1,Vc="firebase-heartbeat-store";let Tm=null;function YS(){return Tm||(Tm=TV(aj,lj,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Js.create("idb-open",{originalErrorMessage:n.message})})),Tm}async function cj(n){try{const t=(await YS()).transaction(Vc),r=await t.objectStore(Vc).get(XS(n));return await t.done,r}catch(e){if(e instanceof br)ts.warn(e.message);else{const t=Js.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ts.warn(t.message)}}}async function Y_(n,e){try{const r=(await YS()).transaction(Vc,"readwrite");await r.objectStore(Vc).put(e,XS(n)),await r.done}catch(t){if(t instanceof br)ts.warn(t.message);else{const r=Js.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ts.warn(r.message)}}}function XS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj=1024,dj=30*24*60*60*1e3;class hj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pj(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=X_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=dj}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ts.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=X_(),{heartbeatsToSend:r,unsentEntries:s}=fj(this._heartbeatsCache.heartbeats),i=Ph(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ts.warn(t),""}}}function X_(){return new Date().toISOString().substring(0,10)}function fj(n,e=uj){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Z_(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Z_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class pj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KS()?tV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await cj(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Y_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Y_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Z_(n){return Ph(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(n){lo(new oi("platform-logger",e=>new NV(e),"PRIVATE")),lo(new oi("heartbeat",e=>new hj(e),"PRIVATE")),mr(ny,Q_,n),mr(ny,Q_,"esm2017"),mr("fire-js","")}mj("");function ev(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function ZS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const gj=ZS,eI=new pu("auth","Firebase",ZS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new Y0("@firebase/auth");function yj(n,...e){Oh.logLevel<=me.WARN&&Oh.warn(`Auth (${Co}): ${n}`,...e)}function Ud(n,...e){Oh.logLevel<=me.ERROR&&Oh.error(`Auth (${Co}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(n,...e){throw tv(n,...e)}function gr(n,...e){return tv(n,...e)}function tI(n,e,t){const r=Object.assign(Object.assign({},gj()),{[e]:t});return new pu("auth","Firebase",r).create(e,{appName:n.name})}function Kr(n){return tI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tv(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return eI.create(n,...e)}function ie(n,e,...t){if(!n)throw tv(e,...t)}function Br(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ud(e),new Error(e)}function ns(n,e){n||Br(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function vj(){return eE()==="http:"||eE()==="https:"}function eE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vj()||X2()||"connection"in navigator)?navigator.onLine:!0}function wj(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ns(t>e,"Short delay should be less than long delay!"),this.isMobile=Q2()||Z2()}get(){return xj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(n,e){ns(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Br("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Br("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Br("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ej=new gu(3e4,6e4);function ls(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function cs(n,e,t,r,s={}){return rI(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=mu(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},i);return Y2()||(c.referrerPolicy="no-referrer"),nI.fetch()(sI(n,n.config.apiHost,t,a),c)})}async function rI(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},_j),e);try{const s=new bj(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw fd(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw fd(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw fd(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw fd(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw tI(n,u,c);Zn(n,u)}}catch(s){if(s instanceof br)throw s;Zn(n,"network-request-failed",{message:String(s)})}}async function yu(n,e,t,r,s={}){const i=await cs(n,e,t,r,s);return"mfaPendingCredential"in i&&Zn(n,"multi-factor-auth-required",{_serverResponse:i}),i}function sI(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?nv(n.config,s):`${n.config.apiScheme}://${s}`}function kj(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bj{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(gr(this.auth,"network-request-failed")),Ej.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fd(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=gr(n,e,r);return s.customData._tokenResponse=t,s}function tE(n){return n!==void 0&&n.enterprise!==void 0}class Tj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kj(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Sj(n,e){return cs(n,"GET","/v2/recaptchaConfig",ls(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij(n,e){return cs(n,"POST","/v1/accounts:delete",e)}async function iI(n,e){return cs(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Nj(n,e=!1){const t=at(n),r=await t.getIdToken(e),s=rv(r);ie(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ac(Sm(s.auth_time)),issuedAtTime:ac(Sm(s.iat)),expirationTime:ac(Sm(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Sm(n){return Number(n)*1e3}function rv(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ud("JWT malformed, contained fewer than 3 sections"),null;try{const s=BS(t);return s?JSON.parse(s):(Ud("Failed to decode base64 JWT payload"),null)}catch(s){return Ud("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function nE(n){const e=rv(n);return ie(e,"internal-error"),ie(typeof e.exp<"u","internal-error"),ie(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof br&&Cj(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Cj({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ac(this.lastLoginAt),this.creationTime=ac(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(n){var e;const t=n.auth,r=await n.getIdToken(),s=await jc(n,iI(t,{idToken:r}));ie(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?oI(i.providerUserInfo):[],a=Pj(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new oy(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,h)}async function Rj(n){const e=at(n);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Pj(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function oI(n){return n.map(e=>{var{providerId:t}=e,r=ev(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dj(n,e){const t=await rI(n,{},async()=>{const r=mu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=sI(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",nI.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Mj(n,e){return cs(n,"POST","/v2/accounts:revokeToken",ls(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ie(e.idToken,"internal-error"),ie(typeof e.idToken<"u","internal-error"),ie(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ie(e.length!==0,"internal-error");const t=nE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ie(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await Dj(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Ea;return r&&(ie(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ie(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ie(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ea,this.toJSON())}_performRefresh(){return Br("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ms(n,e){ie(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class $r{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=ev(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Aj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new oy(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await jc(this,this.stsTokenManager.getToken(this.auth,e));return ie(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Nj(this,e)}reload(){return Rj(this)}_assign(e){this!==e&&(ie(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $r(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ie(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cr(this.auth.app))return Promise.reject(Kr(this.auth));const e=await this.getIdToken();return await jc(this,Ij(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,u;const h=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(s=t.email)!==null&&s!==void 0?s:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,v=(a=t.tenantId)!==null&&a!==void 0?a:void 0,w=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=t.createdAt)!==null&&c!==void 0?c:void 0,b=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:T,emailVerified:C,isAnonymous:P,providerData:D,stsTokenManager:_}=t;ie(T&&_,e,"internal-error");const E=Ea.fromJSON(this.name,_);ie(typeof T=="string",e,"internal-error"),ms(h,e.name),ms(p,e.name),ie(typeof C=="boolean",e,"internal-error"),ie(typeof P=="boolean",e,"internal-error"),ms(m,e.name),ms(y,e.name),ms(v,e.name),ms(w,e.name),ms(k,e.name),ms(b,e.name);const S=new $r({uid:T,auth:e,email:p,emailVerified:C,displayName:h,isAnonymous:P,photoURL:y,phoneNumber:m,tenantId:v,stsTokenManager:E,createdAt:k,lastLoginAt:b});return D&&Array.isArray(D)&&(S.providerData=D.map(N=>Object.assign({},N))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(e,t,r=!1){const s=new Ea;s.updateFromServerResponse(t);const i=new $r({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Vh(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ie(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?oI(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Ea;a.updateFromIdToken(r);const l=new $r({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new oy(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE=new Map;function Ur(n){ns(n instanceof Function,"Expected a class definition");let e=rE.get(n);return e?(ns(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,rE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}aI.type="NONE";const sE=aI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(n,e,t){return`firebase:${n}:${e}:${t}`}class ka{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=zd(this.userKey,s.apiKey,i),this.fullPersistenceKey=zd("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$r._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ka(Ur(sE),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ur(sE);const o=zd(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){const h=$r._fromJSON(e,u);c!==i&&(a=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new ka(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new ka(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fI(e))return"Blackberry";if(pI(e))return"Webos";if(cI(e))return"Safari";if((e.includes("chrome/")||uI(e))&&!e.includes("edge/"))return"Chrome";if(hI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function lI(n=ot()){return/firefox\//i.test(n)}function cI(n=ot()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uI(n=ot()){return/crios\//i.test(n)}function dI(n=ot()){return/iemobile/i.test(n)}function hI(n=ot()){return/android/i.test(n)}function fI(n=ot()){return/blackberry/i.test(n)}function pI(n=ot()){return/webos/i.test(n)}function sv(n=ot()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Oj(n=ot()){var e;return sv(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Vj(){return eV()&&document.documentMode===10}function mI(n=ot()){return sv(n)||hI(n)||pI(n)||fI(n)||/windows phone/i.test(n)||dI(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(n,e=[]){let t;switch(n){case"Browser":t=iE(ot());break;case"Worker":t=`${iE(ot())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Co}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(n,e={}){return cs(n,"GET","/v2/passwordPolicy",ls(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=6;class Bj{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:Fj,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oE(this),this.idTokenSubscription=new oE(this),this.beforeStateQueue=new jj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ur(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ka.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await iI(this,{idToken:e}),r=await $r._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(cr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ie(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=wj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cr(this.app))return Promise.reject(Kr(this));const t=e?at(e):null;return t&&ie(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ie(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cr(this.app)?Promise.reject(Kr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cr(this.app)?Promise.reject(Kr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ur(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Lj(this),t=new Bj(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Mj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ur(e)||this._popupRedirectResolver;ie(t,this,"argument-error"),this.redirectPersistenceManager=await ka.create(this,[Ur(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ie(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ie(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&yj(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function vi(n){return at(n)}class oE{constructor(e){this.auth=e,this.observer=null,this.addObserver=oV(t=>this.observer=t)}get next(){return ie(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Uj(n){Bf=n}function yI(n){return Bf.loadJS(n)}function zj(){return Bf.recaptchaEnterpriseScript}function Wj(){return Bf.gapiScript}function qj(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const Hj="recaptcha-enterprise",Kj="NO_RECAPTCHA";class Gj{constructor(e){this.type=Hj,this.auth=vi(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Sj(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new Tj(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;tE(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(Kj)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&tE(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=zj();l.length!==0&&(l+=a),yI(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function aE(n,e,t,r=!1){const s=new Gj(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function jh(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await aE(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await aE(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(n,e){const t=Ff(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Dh(i,e??{}))return s;Zn(s,"already-initialized")}return t.initialize({options:e})}function Jj(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Ur);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Yj(n,e,t){const r=vi(n);ie(r._canInitEmulator,r,"emulator-config-failed"),ie(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=vI(e),{host:o,port:a}=Xj(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),Zj()}function vI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Xj(n){const e=vI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:lE(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:lE(o)}}}function lE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Zj(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Br("not implemented")}_getIdTokenResponse(e){return Br("not implemented")}_linkToIdToken(e,t){return Br("not implemented")}_getReauthenticationResolver(e){return Br("not implemented")}}async function eL(n,e){return cs(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tL(n,e){return yu(n,"POST","/v1/accounts:signInWithPassword",ls(n,e))}async function nL(n,e){return cs(n,"POST","/v1/accounts:sendOobCode",ls(n,e))}async function rL(n,e){return nL(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sL(n,e){return yu(n,"POST","/v1/accounts:signInWithEmailLink",ls(n,e))}async function iL(n,e){return yu(n,"POST","/v1/accounts:signInWithEmailLink",ls(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc extends iv{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Lc(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Lc(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jh(e,t,"signInWithPassword",tL);case"emailLink":return sL(e,{email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jh(e,r,"signUpPassword",eL);case"emailLink":return iL(e,{idToken:t,email:this._email,oobCode:this._password});default:Zn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ba(n,e){return yu(n,"POST","/v1/accounts:signInWithIdp",ls(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oL="http://localhost";class co extends iv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=ev(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new co(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ba(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ba(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ba(e,t)}buildRequest(){const e={requestUri:oL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=mu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aL(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lL(n){const e=Ul(zl(n)).link,t=e?Ul(zl(e)).deep_link_id:null,r=Ul(zl(n)).deep_link_id;return(r?Ul(zl(r)).link:null)||r||t||e||n}class ov{constructor(e){var t,r,s,i,o,a;const l=Ul(zl(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(r=l.oobCode)!==null&&r!==void 0?r:null,h=aL((s=l.mode)!==null&&s!==void 0?s:null);ie(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=lL(e);try{return new ov(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(){this.providerId=nl.PROVIDER_ID}static credential(e,t){return Lc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ov.parseLink(t);return ie(r,"argument-error"),Lc._fromEmailAndCode(e,r.code,r.tenantId)}}nl.PROVIDER_ID="password";nl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";nl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends xI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends vu{constructor(){super("facebook.com")}static credential(e){return co._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch{return null}}}Is.FACEBOOK_SIGN_IN_METHOD="facebook.com";Is.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns extends vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return co._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ns.credential(t,r)}catch{return null}}}Ns.GOOGLE_SIGN_IN_METHOD="google.com";Ns.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends vu{constructor(){super("github.com")}static credential(e){return co._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cs.credential(e.oauthAccessToken)}catch{return null}}}Cs.GITHUB_SIGN_IN_METHOD="github.com";Cs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends vu{constructor(){super("twitter.com")}static credential(e,t){return co._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return As.credential(t,r)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(n,e){return yu(n,"POST","/v1/accounts:signUp",ls(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await $r._fromIdTokenResponse(e,r,s),o=cE(r);return new uo({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=cE(r);return new uo({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function cE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends br{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Lh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Lh(e,t,r,s)}}function wI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Lh._fromErrorAndOperation(n,i,e,r):i})}async function uL(n,e,t=!1){const r=await jc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return uo._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dL(n,e,t=!1){const{auth:r}=n;if(cr(r.app))return Promise.reject(Kr(r));const s="reauthenticate";try{const i=await jc(n,wI(r,s,e,n),t);ie(i.idToken,r,"internal-error");const o=rv(i.idToken);ie(o,r,"internal-error");const{sub:a}=o;return ie(n.uid===a,r,"user-mismatch"),uo._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Zn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _I(n,e,t=!1){if(cr(n.app))return Promise.reject(Kr(n));const r="signIn",s=await wI(n,r,e),i=await uo._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function hL(n,e){return _I(vi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EI(n){const e=vi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function fL(n,e,t){const r=vi(n);await jh(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",rL)}async function pL(n,e,t){if(cr(n.app))return Promise.reject(Kr(n));const r=vi(n),o=await jh(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cL).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&EI(n),l}),a=await uo._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function mL(n,e,t){return cr(n.app)?Promise.reject(Kr(n)):hL(at(n),nl.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&EI(n),r})}function gL(n,e,t,r){return at(n).onIdTokenChanged(e,t,r)}function yL(n,e,t){return at(n).beforeAuthStateChanged(e,t)}function vL(n,e,t,r){return at(n).onAuthStateChanged(e,t,r)}function xL(n){return at(n).signOut()}const Fh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fh,"1"),this.storage.removeItem(Fh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wL=1e3,_L=10;class bI extends kI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=mI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Vj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,_L):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},wL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}bI.type="LOCAL";const EL=bI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI extends kI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}TI.type="SESSION";const SI=TI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new $f(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await kL(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$f.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=av("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const p=h;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(){return window}function TL(n){yr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function II(){return typeof yr().WorkerGlobalScope<"u"&&typeof yr().importScripts=="function"}async function SL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function IL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function NL(){return II()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="firebaseLocalStorageDb",CL=1,Bh="firebaseLocalStorage",CI="fbase_key";class xu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Uf(n,e){return n.transaction([Bh],e?"readwrite":"readonly").objectStore(Bh)}function AL(){const n=indexedDB.deleteDatabase(NI);return new xu(n).toPromise()}function ay(){const n=indexedDB.open(NI,CL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Bh,{keyPath:CI})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Bh)?e(r):(r.close(),await AL(),e(await ay()))})})}async function uE(n,e,t){const r=Uf(n,!0).put({[CI]:e,value:t});return new xu(r).toPromise()}async function RL(n,e){const t=Uf(n,!1).get(e),r=await new xu(t).toPromise();return r===void 0?null:r.value}function dE(n,e){const t=Uf(n,!0).delete(e);return new xu(t).toPromise()}const PL=800,DL=3;class AI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ay(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>DL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return II()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$f._getInstance(NL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await SL(),!this.activeServiceWorker)return;this.sender=new bL(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||IL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ay();return await uE(e,Fh,"1"),await dE(e,Fh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>uE(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>RL(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>dE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Uf(s,!1).getAll();return new xu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AI.type="LOCAL";const ML=AI;new gu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(n,e){return e?Ur(e):(ie(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv extends iv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ba(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ba(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ba(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function VL(n){return _I(n.auth,new lv(n),n.bypassAuthState)}function jL(n){const{auth:e,user:t}=n;return ie(t,e,"internal-error"),dL(t,new lv(n),n.bypassAuthState)}async function LL(n){const{auth:e,user:t}=n;return ie(t,e,"internal-error"),uL(t,new lv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return VL;case"linkViaPopup":case"linkViaRedirect":return LL;case"reauthViaPopup":case"reauthViaRedirect":return jL;default:Zn(this.auth,"internal-error")}}resolve(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL=new gu(2e3,1e4);class ha extends RI{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ha.currentPopupAction&&ha.currentPopupAction.cancel(),ha.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ie(e,this.auth,"internal-error"),e}async onExecution(){ns(this.filter.length===1,"Popup operations only handle one event");const e=av();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(gr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ha.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,FL.get())};e()}}ha.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL="pendingRedirect",Wd=new Map;class $L extends RI{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Wd.get(this.auth._key());if(!e){try{const r=await UL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Wd.set(this.auth._key(),e)}return this.bypassAuthState||Wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function UL(n,e){const t=qL(e),r=WL(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function zL(n,e){Wd.set(n._key(),e)}function WL(n){return Ur(n._redirectPersistence)}function qL(n){return zd(BL,n.config.apiKey,n.name)}async function HL(n,e,t=!1){if(cr(n.app))return Promise.reject(Kr(n));const r=vi(n),s=OL(r,e),o=await new $L(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KL=10*60*1e3;class GL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!PI(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(gr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=KL&&this.cachedEventUids.clear(),this.cachedEventUids.has(hE(e))}saveEventToCache(e){this.cachedEventUids.add(hE(e)),this.lastProcessedEventTime=Date.now()}}function hE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PI({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function QL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PI(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JL(n,e={}){return cs(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XL=/^https?/;async function ZL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await JL(n);for(const t of e)try{if(e4(t))return}catch{}Zn(n,"unauthorized-domain")}function e4(n){const e=iy(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!XL.test(t))return!1;if(YL.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4=new gu(3e4,6e4);function fE(){const n=yr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function n4(n){return new Promise((e,t)=>{var r,s,i;function o(){fE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fE(),t(gr(n,"network-request-failed"))},timeout:t4.get()})}if(!((s=(r=yr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=yr().gapi)===null||i===void 0)&&i.load)o();else{const a=qj("iframefcb");return yr()[a]=()=>{gapi.load?o():t(gr(n,"network-request-failed"))},yI(`${Wj()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw qd=null,e})}let qd=null;function r4(n){return qd=qd||n4(n),qd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=new gu(5e3,15e3),i4="__/auth/iframe",o4="emulator/auth/iframe",a4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},l4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function c4(n){const e=n.config;ie(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?nv(e,o4):`https://${n.config.authDomain}/${i4}`,r={apiKey:e.apiKey,appName:n.name,v:Co},s=l4.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${mu(r).slice(1)}`}async function u4(n){const e=await r4(n),t=yr().gapi;return ie(t,n,"internal-error"),e.open({where:document.body,url:c4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a4,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=gr(n,"network-request-failed"),a=yr().setTimeout(()=>{i(o)},s4.get());function l(){yr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h4=500,f4=600,p4="_blank",m4="http://localhost";class pE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function g4(n,e,t,r=h4,s=f4){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},d4),{width:r.toString(),height:s.toString(),top:i,left:o}),c=ot().toLowerCase();t&&(a=uI(c)?p4:t),lI(c)&&(e=e||m4,l.scrollbars="yes");const u=Object.entries(l).reduce((p,[m,y])=>`${p}${m}=${y},`,"");if(Oj(c)&&a!=="_self")return y4(e||"",a),new pE(null);const h=window.open(e||"",a,u);ie(h,n,"popup-blocked");try{h.focus()}catch{}return new pE(h)}function y4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4="__/auth/handler",x4="emulator/auth/handler",w4=encodeURIComponent("fac");async function mE(n,e,t,r,s,i){ie(n.config.authDomain,n,"auth-domain-config-required"),ie(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Co,eventId:s};if(e instanceof xI){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",iV(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof vu){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${w4}=${encodeURIComponent(l)}`:"";return`${_4(n)}?${mu(a).slice(1)}${c}`}function _4({config:n}){return n.emulator?nv(n,x4):`https://${n.authDomain}/${v4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im="webStorageSupport";class E4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=SI,this._completeRedirectFn=HL,this._overrideRedirectResult=zL}async _openPopup(e,t,r,s){var i;ns((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await mE(e,t,r,iy(),s);return g4(e,o,av())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await mE(e,t,r,iy(),s);return TL(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ns(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await u4(e),r=new GL(e);return t.register("authEvent",s=>(ie(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Im,{type:Im},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Im];o!==void 0&&t(!!o),Zn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ZL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return mI()||cI()||sv()}}const k4=E4;var gE="@firebase/auth",yE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ie(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function S4(n){lo(new oi("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ie(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gI(n)},c=new $j(r,s,i,l);return Jj(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),lo(new oi("auth-internal",e=>{const t=vi(e.getProvider("auth").getImmediate());return(r=>new b4(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),mr(gE,yE,T4(n)),mr(gE,yE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4=5*60,N4=WS("authIdTokenMaxAge")||I4;let vE=null;const C4=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>N4)return;const s=t==null?void 0:t.token;vE!==s&&(vE=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function A4(n=Z0()){const e=Ff(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Qj(n,{popupRedirectResolver:k4,persistence:[ML,EL,SI]}),r=WS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=C4(i.toString());yL(t,o,()=>o(t.currentUser)),gL(t,a=>o(a))}}const s=$S("auth");return s&&Yj(t,`http://${s}`),t}function R4(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Uj({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=gr("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",R4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});S4("Browser");var P4="firebase",D4="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mr(P4,D4,"app");var xE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qi,DI;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,E){function S(){}S.prototype=E.prototype,_.D=E.prototype,_.prototype=new S,_.prototype.constructor=_,_.C=function(N,M,R){for(var A=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)A[ce-2]=arguments[ce];return E.prototype[M].apply(N,A)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(_,E,S){S||(S=0);var N=Array(16);if(typeof E=="string")for(var M=0;16>M;++M)N[M]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(M=0;16>M;++M)N[M]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=_.g[0],S=_.g[1],M=_.g[2];var R=_.g[3],A=E+(R^S&(M^R))+N[0]+3614090360&4294967295;E=S+(A<<7&4294967295|A>>>25),A=R+(M^E&(S^M))+N[1]+3905402710&4294967295,R=E+(A<<12&4294967295|A>>>20),A=M+(S^R&(E^S))+N[2]+606105819&4294967295,M=R+(A<<17&4294967295|A>>>15),A=S+(E^M&(R^E))+N[3]+3250441966&4294967295,S=M+(A<<22&4294967295|A>>>10),A=E+(R^S&(M^R))+N[4]+4118548399&4294967295,E=S+(A<<7&4294967295|A>>>25),A=R+(M^E&(S^M))+N[5]+1200080426&4294967295,R=E+(A<<12&4294967295|A>>>20),A=M+(S^R&(E^S))+N[6]+2821735955&4294967295,M=R+(A<<17&4294967295|A>>>15),A=S+(E^M&(R^E))+N[7]+4249261313&4294967295,S=M+(A<<22&4294967295|A>>>10),A=E+(R^S&(M^R))+N[8]+1770035416&4294967295,E=S+(A<<7&4294967295|A>>>25),A=R+(M^E&(S^M))+N[9]+2336552879&4294967295,R=E+(A<<12&4294967295|A>>>20),A=M+(S^R&(E^S))+N[10]+4294925233&4294967295,M=R+(A<<17&4294967295|A>>>15),A=S+(E^M&(R^E))+N[11]+2304563134&4294967295,S=M+(A<<22&4294967295|A>>>10),A=E+(R^S&(M^R))+N[12]+1804603682&4294967295,E=S+(A<<7&4294967295|A>>>25),A=R+(M^E&(S^M))+N[13]+4254626195&4294967295,R=E+(A<<12&4294967295|A>>>20),A=M+(S^R&(E^S))+N[14]+2792965006&4294967295,M=R+(A<<17&4294967295|A>>>15),A=S+(E^M&(R^E))+N[15]+1236535329&4294967295,S=M+(A<<22&4294967295|A>>>10),A=E+(M^R&(S^M))+N[1]+4129170786&4294967295,E=S+(A<<5&4294967295|A>>>27),A=R+(S^M&(E^S))+N[6]+3225465664&4294967295,R=E+(A<<9&4294967295|A>>>23),A=M+(E^S&(R^E))+N[11]+643717713&4294967295,M=R+(A<<14&4294967295|A>>>18),A=S+(R^E&(M^R))+N[0]+3921069994&4294967295,S=M+(A<<20&4294967295|A>>>12),A=E+(M^R&(S^M))+N[5]+3593408605&4294967295,E=S+(A<<5&4294967295|A>>>27),A=R+(S^M&(E^S))+N[10]+38016083&4294967295,R=E+(A<<9&4294967295|A>>>23),A=M+(E^S&(R^E))+N[15]+3634488961&4294967295,M=R+(A<<14&4294967295|A>>>18),A=S+(R^E&(M^R))+N[4]+3889429448&4294967295,S=M+(A<<20&4294967295|A>>>12),A=E+(M^R&(S^M))+N[9]+568446438&4294967295,E=S+(A<<5&4294967295|A>>>27),A=R+(S^M&(E^S))+N[14]+3275163606&4294967295,R=E+(A<<9&4294967295|A>>>23),A=M+(E^S&(R^E))+N[3]+4107603335&4294967295,M=R+(A<<14&4294967295|A>>>18),A=S+(R^E&(M^R))+N[8]+1163531501&4294967295,S=M+(A<<20&4294967295|A>>>12),A=E+(M^R&(S^M))+N[13]+2850285829&4294967295,E=S+(A<<5&4294967295|A>>>27),A=R+(S^M&(E^S))+N[2]+4243563512&4294967295,R=E+(A<<9&4294967295|A>>>23),A=M+(E^S&(R^E))+N[7]+1735328473&4294967295,M=R+(A<<14&4294967295|A>>>18),A=S+(R^E&(M^R))+N[12]+2368359562&4294967295,S=M+(A<<20&4294967295|A>>>12),A=E+(S^M^R)+N[5]+4294588738&4294967295,E=S+(A<<4&4294967295|A>>>28),A=R+(E^S^M)+N[8]+2272392833&4294967295,R=E+(A<<11&4294967295|A>>>21),A=M+(R^E^S)+N[11]+1839030562&4294967295,M=R+(A<<16&4294967295|A>>>16),A=S+(M^R^E)+N[14]+4259657740&4294967295,S=M+(A<<23&4294967295|A>>>9),A=E+(S^M^R)+N[1]+2763975236&4294967295,E=S+(A<<4&4294967295|A>>>28),A=R+(E^S^M)+N[4]+1272893353&4294967295,R=E+(A<<11&4294967295|A>>>21),A=M+(R^E^S)+N[7]+4139469664&4294967295,M=R+(A<<16&4294967295|A>>>16),A=S+(M^R^E)+N[10]+3200236656&4294967295,S=M+(A<<23&4294967295|A>>>9),A=E+(S^M^R)+N[13]+681279174&4294967295,E=S+(A<<4&4294967295|A>>>28),A=R+(E^S^M)+N[0]+3936430074&4294967295,R=E+(A<<11&4294967295|A>>>21),A=M+(R^E^S)+N[3]+3572445317&4294967295,M=R+(A<<16&4294967295|A>>>16),A=S+(M^R^E)+N[6]+76029189&4294967295,S=M+(A<<23&4294967295|A>>>9),A=E+(S^M^R)+N[9]+3654602809&4294967295,E=S+(A<<4&4294967295|A>>>28),A=R+(E^S^M)+N[12]+3873151461&4294967295,R=E+(A<<11&4294967295|A>>>21),A=M+(R^E^S)+N[15]+530742520&4294967295,M=R+(A<<16&4294967295|A>>>16),A=S+(M^R^E)+N[2]+3299628645&4294967295,S=M+(A<<23&4294967295|A>>>9),A=E+(M^(S|~R))+N[0]+4096336452&4294967295,E=S+(A<<6&4294967295|A>>>26),A=R+(S^(E|~M))+N[7]+1126891415&4294967295,R=E+(A<<10&4294967295|A>>>22),A=M+(E^(R|~S))+N[14]+2878612391&4294967295,M=R+(A<<15&4294967295|A>>>17),A=S+(R^(M|~E))+N[5]+4237533241&4294967295,S=M+(A<<21&4294967295|A>>>11),A=E+(M^(S|~R))+N[12]+1700485571&4294967295,E=S+(A<<6&4294967295|A>>>26),A=R+(S^(E|~M))+N[3]+2399980690&4294967295,R=E+(A<<10&4294967295|A>>>22),A=M+(E^(R|~S))+N[10]+4293915773&4294967295,M=R+(A<<15&4294967295|A>>>17),A=S+(R^(M|~E))+N[1]+2240044497&4294967295,S=M+(A<<21&4294967295|A>>>11),A=E+(M^(S|~R))+N[8]+1873313359&4294967295,E=S+(A<<6&4294967295|A>>>26),A=R+(S^(E|~M))+N[15]+4264355552&4294967295,R=E+(A<<10&4294967295|A>>>22),A=M+(E^(R|~S))+N[6]+2734768916&4294967295,M=R+(A<<15&4294967295|A>>>17),A=S+(R^(M|~E))+N[13]+1309151649&4294967295,S=M+(A<<21&4294967295|A>>>11),A=E+(M^(S|~R))+N[4]+4149444226&4294967295,E=S+(A<<6&4294967295|A>>>26),A=R+(S^(E|~M))+N[11]+3174756917&4294967295,R=E+(A<<10&4294967295|A>>>22),A=M+(E^(R|~S))+N[2]+718787259&4294967295,M=R+(A<<15&4294967295|A>>>17),A=S+(R^(M|~E))+N[9]+3951481745&4294967295,_.g[0]=_.g[0]+E&4294967295,_.g[1]=_.g[1]+(M+(A<<21&4294967295|A>>>11))&4294967295,_.g[2]=_.g[2]+M&4294967295,_.g[3]=_.g[3]+R&4294967295}r.prototype.u=function(_,E){E===void 0&&(E=_.length);for(var S=E-this.blockSize,N=this.B,M=this.h,R=0;R<E;){if(M==0)for(;R<=S;)s(this,_,R),R+=this.blockSize;if(typeof _=="string"){for(;R<E;)if(N[M++]=_.charCodeAt(R++),M==this.blockSize){s(this,N),M=0;break}}else for(;R<E;)if(N[M++]=_[R++],M==this.blockSize){s(this,N),M=0;break}}this.h=M,this.o+=E},r.prototype.v=function(){var _=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);_[0]=128;for(var E=1;E<_.length-8;++E)_[E]=0;var S=8*this.o;for(E=_.length-8;E<_.length;++E)_[E]=S&255,S/=256;for(this.u(_),_=Array(16),E=S=0;4>E;++E)for(var N=0;32>N;N+=8)_[S++]=this.g[E]>>>N&255;return _};function i(_,E){var S=a;return Object.prototype.hasOwnProperty.call(S,_)?S[_]:S[_]=E(_)}function o(_,E){this.h=E;for(var S=[],N=!0,M=_.length-1;0<=M;M--){var R=_[M]|0;N&&R==E||(S[M]=R,N=!1)}this.g=S}var a={};function l(_){return-128<=_&&128>_?i(_,function(E){return new o([E|0],0>E?-1:0)}):new o([_|0],0>_?-1:0)}function c(_){if(isNaN(_)||!isFinite(_))return h;if(0>_)return w(c(-_));for(var E=[],S=1,N=0;_>=S;N++)E[N]=_/S|0,S*=4294967296;return new o(E,0)}function u(_,E){if(_.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(_.charAt(0)=="-")return w(u(_.substring(1),E));if(0<=_.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(E,8)),N=h,M=0;M<_.length;M+=8){var R=Math.min(8,_.length-M),A=parseInt(_.substring(M,M+R),E);8>R?(R=c(Math.pow(E,R)),N=N.j(R).add(c(A))):(N=N.j(S),N=N.add(c(A)))}return N}var h=l(0),p=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();for(var _=0,E=1,S=0;S<this.g.length;S++){var N=this.i(S);_+=(0<=N?N:4294967296+N)*E,E*=4294967296}return _},n.toString=function(_){if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(y(this))return"0";if(v(this))return"-"+w(this).toString(_);for(var E=c(Math.pow(_,6)),S=this,N="";;){var M=C(S,E).g;S=k(S,M.j(E));var R=((0<S.g.length?S.g[0]:S.h)>>>0).toString(_);if(S=M,y(S))return R+N;for(;6>R.length;)R="0"+R;N=R+N}},n.i=function(_){return 0>_?0:_<this.g.length?this.g[_]:this.h};function y(_){if(_.h!=0)return!1;for(var E=0;E<_.g.length;E++)if(_.g[E]!=0)return!1;return!0}function v(_){return _.h==-1}n.l=function(_){return _=k(this,_),v(_)?-1:y(_)?0:1};function w(_){for(var E=_.g.length,S=[],N=0;N<E;N++)S[N]=~_.g[N];return new o(S,~_.h).add(p)}n.abs=function(){return v(this)?w(this):this},n.add=function(_){for(var E=Math.max(this.g.length,_.g.length),S=[],N=0,M=0;M<=E;M++){var R=N+(this.i(M)&65535)+(_.i(M)&65535),A=(R>>>16)+(this.i(M)>>>16)+(_.i(M)>>>16);N=A>>>16,R&=65535,A&=65535,S[M]=A<<16|R}return new o(S,S[S.length-1]&-2147483648?-1:0)};function k(_,E){return _.add(w(E))}n.j=function(_){if(y(this)||y(_))return h;if(v(this))return v(_)?w(this).j(w(_)):w(w(this).j(_));if(v(_))return w(this.j(w(_)));if(0>this.l(m)&&0>_.l(m))return c(this.m()*_.m());for(var E=this.g.length+_.g.length,S=[],N=0;N<2*E;N++)S[N]=0;for(N=0;N<this.g.length;N++)for(var M=0;M<_.g.length;M++){var R=this.i(N)>>>16,A=this.i(N)&65535,ce=_.i(M)>>>16,ke=_.i(M)&65535;S[2*N+2*M]+=A*ke,b(S,2*N+2*M),S[2*N+2*M+1]+=R*ke,b(S,2*N+2*M+1),S[2*N+2*M+1]+=A*ce,b(S,2*N+2*M+1),S[2*N+2*M+2]+=R*ce,b(S,2*N+2*M+2)}for(N=0;N<E;N++)S[N]=S[2*N+1]<<16|S[2*N];for(N=E;N<2*E;N++)S[N]=0;return new o(S,0)};function b(_,E){for(;(_[E]&65535)!=_[E];)_[E+1]+=_[E]>>>16,_[E]&=65535,E++}function T(_,E){this.g=_,this.h=E}function C(_,E){if(y(E))throw Error("division by zero");if(y(_))return new T(h,h);if(v(_))return E=C(w(_),E),new T(w(E.g),w(E.h));if(v(E))return E=C(_,w(E)),new T(w(E.g),E.h);if(30<_.g.length){if(v(_)||v(E))throw Error("slowDivide_ only works with positive integers.");for(var S=p,N=E;0>=N.l(_);)S=P(S),N=P(N);var M=D(S,1),R=D(N,1);for(N=D(N,2),S=D(S,2);!y(N);){var A=R.add(N);0>=A.l(_)&&(M=M.add(S),R=A),N=D(N,1),S=D(S,1)}return E=k(_,M.j(E)),new T(M,E)}for(M=h;0<=_.l(E);){for(S=Math.max(1,Math.floor(_.m()/E.m())),N=Math.ceil(Math.log(S)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),R=c(S),A=R.j(E);v(A)||0<A.l(_);)S-=N,R=c(S),A=R.j(E);y(R)&&(R=p),M=M.add(R),_=k(_,A)}return new T(M,_)}n.A=function(_){return C(this,_).h},n.and=function(_){for(var E=Math.max(this.g.length,_.g.length),S=[],N=0;N<E;N++)S[N]=this.i(N)&_.i(N);return new o(S,this.h&_.h)},n.or=function(_){for(var E=Math.max(this.g.length,_.g.length),S=[],N=0;N<E;N++)S[N]=this.i(N)|_.i(N);return new o(S,this.h|_.h)},n.xor=function(_){for(var E=Math.max(this.g.length,_.g.length),S=[],N=0;N<E;N++)S[N]=this.i(N)^_.i(N);return new o(S,this.h^_.h)};function P(_){for(var E=_.g.length+1,S=[],N=0;N<E;N++)S[N]=_.i(N)<<1|_.i(N-1)>>>31;return new o(S,_.h)}function D(_,E){var S=E>>5;E%=32;for(var N=_.g.length-S,M=[],R=0;R<N;R++)M[R]=0<E?_.i(R+S)>>>E|_.i(R+S+1)<<32-E:_.i(R+S);return new o(M,_.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,DI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Qi=o}).apply(typeof xE<"u"?xE:typeof self<"u"?self:typeof window<"u"?window:{});var pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var MI,Wl,OI,Hd,ly,VI,jI,LI;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,g,x){return d==Array.prototype||d==Object.prototype||(d[g]=x.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof pd=="object"&&pd];for(var g=0;g<d.length;++g){var x=d[g];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=t(this);function s(d,g){if(g)e:{var x=r;d=d.split(".");for(var I=0;I<d.length-1;I++){var V=d[I];if(!(V in x))break e;x=x[V]}d=d[d.length-1],I=x[d],g=g(I),g!=I&&g!=null&&e(x,d,{configurable:!0,writable:!0,value:g})}}function i(d,g){d instanceof String&&(d+="");var x=0,I=!1,V={next:function(){if(!I&&x<d.length){var L=x++;return{value:g(L,d[L]),done:!1}}return I=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}s("Array.prototype.values",function(d){return d||function(){return i(this,function(g,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(d){var g=typeof d;return g=g!="object"?g:d?Array.isArray(d)?"array":g:"null",g=="array"||g=="object"&&typeof d.length=="number"}function c(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function u(d,g,x){return d.call.apply(d.bind,arguments)}function h(d,g,x){if(!d)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,I),d.apply(g,V)}}return function(){return d.apply(g,arguments)}}function p(d,g,x){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,p.apply(null,arguments)}function m(d,g){var x=Array.prototype.slice.call(arguments,1);return function(){var I=x.slice();return I.push.apply(I,arguments),d.apply(this,I)}}function y(d,g){function x(){}x.prototype=g.prototype,d.aa=g.prototype,d.prototype=new x,d.prototype.constructor=d,d.Qb=function(I,V,L){for(var W=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)W[Ae-2]=arguments[Ae];return g.prototype[V].apply(I,W)}}function v(d){const g=d.length;if(0<g){const x=Array(g);for(let I=0;I<g;I++)x[I]=d[I];return x}return[]}function w(d,g){for(let x=1;x<arguments.length;x++){const I=arguments[x];if(l(I)){const V=d.length||0,L=I.length||0;d.length=V+L;for(let W=0;W<L;W++)d[V+W]=I[W]}else d.push(I)}}class k{constructor(g,x){this.i=g,this.j=x,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function b(d){return/^[\s\xa0]*$/.test(d)}function T(){var d=a.navigator;return d&&(d=d.userAgent)?d:""}function C(d){return C[" "](d),d}C[" "]=function(){};var P=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function D(d,g,x){for(const I in d)g.call(x,d[I],I,d)}function _(d,g){for(const x in d)g.call(void 0,d[x],x,d)}function E(d){const g={};for(const x in d)g[x]=d[x];return g}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(d,g){let x,I;for(let V=1;V<arguments.length;V++){I=arguments[V];for(x in I)d[x]=I[x];for(let L=0;L<S.length;L++)x=S[L],Object.prototype.hasOwnProperty.call(I,x)&&(d[x]=I[x])}}function M(d){var g=1;d=d.split(":");const x=[];for(;0<g&&d.length;)x.push(d.shift()),g--;return d.length&&x.push(d.join(":")),x}function R(d){a.setTimeout(()=>{throw d},0)}function A(){var d=G;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class ce{constructor(){this.h=this.g=null}add(g,x){const I=ke.get();I.set(g,x),this.h?this.h.next=I:this.g=I,this.h=I}}var ke=new k(()=>new H,d=>d.reset());class H{constructor(){this.next=this.g=this.h=null}set(g,x){this.h=g,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let te,B=!1,G=new ce,oe=()=>{const d=a.Promise.resolve(void 0);te=()=>{d.then(Ne)}};var Ne=()=>{for(var d;d=A();){try{d.h.call(d.g)}catch(x){R(x)}var g=ke;g.j(d),100>g.h&&(g.h++,d.next=g.g,g.g=d)}B=!1};function _e(){this.s=this.s,this.C=this.C}_e.prototype.s=!1,_e.prototype.ma=function(){this.s||(this.s=!0,this.N())},_e.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ye(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}ye.prototype.h=function(){this.defaultPrevented=!0};var Sr=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};a.addEventListener("test",x,g),a.removeEventListener("test",x,g)}catch{}return d}();function Ir(d,g){if(ye.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var x=this.type=d.type,I=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget){if(P){e:{try{C(g.nodeName);var V=!0;break e}catch{}V=!1}V||(g=null)}}else x=="mouseover"?g=d.fromElement:x=="mouseout"&&(g=d.toElement);this.relatedTarget=g,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Nr[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Ir.aa.h.call(this)}}y(Ir,ye);var Nr={2:"touch",3:"pen",4:"mouse"};Ir.prototype.h=function(){Ir.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Cr="closure_listenable_"+(1e6*Math.random()|0),qR=0;function HR(d,g,x,I,V){this.listener=d,this.proxy=null,this.src=g,this.type=x,this.capture=!!I,this.ha=V,this.key=++qR,this.da=this.fa=!1}function Ru(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Pu(d){this.src=d,this.g={},this.h=0}Pu.prototype.add=function(d,g,x,I,V){var L=d.toString();d=this.g[L],d||(d=this.g[L]=[],this.h++);var W=Sp(d,g,I,V);return-1<W?(g=d[W],x||(g.fa=!1)):(g=new HR(g,this.src,L,!!I,V),g.fa=x,d.push(g)),g};function Tp(d,g){var x=g.type;if(x in d.g){var I=d.g[x],V=Array.prototype.indexOf.call(I,g,void 0),L;(L=0<=V)&&Array.prototype.splice.call(I,V,1),L&&(Ru(g),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Sp(d,g,x,I){for(var V=0;V<d.length;++V){var L=d[V];if(!L.da&&L.listener==g&&L.capture==!!x&&L.ha==I)return V}return-1}var Ip="closure_lm_"+(1e6*Math.random()|0),Np={};function Ix(d,g,x,I,V){if(Array.isArray(g)){for(var L=0;L<g.length;L++)Ix(d,g[L],x,I,V);return null}return x=Ax(x),d&&d[Cr]?d.K(g,x,c(I)?!!I.capture:!1,V):KR(d,g,x,!1,I,V)}function KR(d,g,x,I,V,L){if(!g)throw Error("Invalid event type");var W=c(V)?!!V.capture:!!V,Ae=Ap(d);if(Ae||(d[Ip]=Ae=new Pu(d)),x=Ae.add(g,x,I,W,L),x.proxy)return x;if(I=GR(),x.proxy=I,I.src=d,I.listener=x,d.addEventListener)Sr||(V=W),V===void 0&&(V=!1),d.addEventListener(g.toString(),I,V);else if(d.attachEvent)d.attachEvent(Cx(g.toString()),I);else if(d.addListener&&d.removeListener)d.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return x}function GR(){function d(x){return g.call(d.src,d.listener,x)}const g=QR;return d}function Nx(d,g,x,I,V){if(Array.isArray(g))for(var L=0;L<g.length;L++)Nx(d,g[L],x,I,V);else I=c(I)?!!I.capture:!!I,x=Ax(x),d&&d[Cr]?(d=d.i,g=String(g).toString(),g in d.g&&(L=d.g[g],x=Sp(L,x,I,V),-1<x&&(Ru(L[x]),Array.prototype.splice.call(L,x,1),L.length==0&&(delete d.g[g],d.h--)))):d&&(d=Ap(d))&&(g=d.g[g.toString()],d=-1,g&&(d=Sp(g,x,I,V)),(x=-1<d?g[d]:null)&&Cp(x))}function Cp(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[Cr])Tp(g.i,d);else{var x=d.type,I=d.proxy;g.removeEventListener?g.removeEventListener(x,I,d.capture):g.detachEvent?g.detachEvent(Cx(x),I):g.addListener&&g.removeListener&&g.removeListener(I),(x=Ap(g))?(Tp(x,d),x.h==0&&(x.src=null,g[Ip]=null)):Ru(d)}}}function Cx(d){return d in Np?Np[d]:Np[d]="on"+d}function QR(d,g){if(d.da)d=!0;else{g=new Ir(g,this);var x=d.listener,I=d.ha||d.src;d.fa&&Cp(d),d=x.call(I,g)}return d}function Ap(d){return d=d[Ip],d instanceof Pu?d:null}var Rp="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ax(d){return typeof d=="function"?d:(d[Rp]||(d[Rp]=function(g){return d.handleEvent(g)}),d[Rp])}function It(){_e.call(this),this.i=new Pu(this),this.M=this,this.F=null}y(It,_e),It.prototype[Cr]=!0,It.prototype.removeEventListener=function(d,g,x,I){Nx(this,d,g,x,I)};function $t(d,g){var x,I=d.F;if(I)for(x=[];I;I=I.F)x.push(I);if(d=d.M,I=g.type||g,typeof g=="string")g=new ye(g,d);else if(g instanceof ye)g.target=g.target||d;else{var V=g;g=new ye(I,d),N(g,V)}if(V=!0,x)for(var L=x.length-1;0<=L;L--){var W=g.g=x[L];V=Du(W,I,!0,g)&&V}if(W=g.g=d,V=Du(W,I,!0,g)&&V,V=Du(W,I,!1,g)&&V,x)for(L=0;L<x.length;L++)W=g.g=x[L],V=Du(W,I,!1,g)&&V}It.prototype.N=function(){if(It.aa.N.call(this),this.i){var d=this.i,g;for(g in d.g){for(var x=d.g[g],I=0;I<x.length;I++)Ru(x[I]);delete d.g[g],d.h--}}this.F=null},It.prototype.K=function(d,g,x,I){return this.i.add(String(d),g,!1,x,I)},It.prototype.L=function(d,g,x,I){return this.i.add(String(d),g,!0,x,I)};function Du(d,g,x,I){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();for(var V=!0,L=0;L<g.length;++L){var W=g[L];if(W&&!W.da&&W.capture==x){var Ae=W.listener,yt=W.ha||W.src;W.fa&&Tp(d.i,W),V=Ae.call(yt,I)!==!1&&V}}return V&&!I.defaultPrevented}function Rx(d,g,x){if(typeof d=="function")x&&(d=p(d,x));else if(d&&typeof d.handleEvent=="function")d=p(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(d,g||0)}function Px(d){d.g=Rx(()=>{d.g=null,d.i&&(d.i=!1,Px(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class JR extends _e{constructor(g,x){super(),this.m=g,this.l=x,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Px(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ll(d){_e.call(this),this.h=d,this.g={}}y(ll,_e);var Dx=[];function Mx(d){D(d.g,function(g,x){this.g.hasOwnProperty(x)&&Cp(g)},d),d.g={}}ll.prototype.N=function(){ll.aa.N.call(this),Mx(this)},ll.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pp=a.JSON.stringify,YR=a.JSON.parse,XR=class{stringify(d){return a.JSON.stringify(d,void 0)}parse(d){return a.JSON.parse(d,void 0)}};function Dp(){}Dp.prototype.h=null;function Ox(d){return d.h||(d.h=d.i())}function Vx(){}var cl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Mp(){ye.call(this,"d")}y(Mp,ye);function Op(){ye.call(this,"c")}y(Op,ye);var Ti={},jx=null;function Mu(){return jx=jx||new It}Ti.La="serverreachability";function Lx(d){ye.call(this,Ti.La,d)}y(Lx,ye);function ul(d){const g=Mu();$t(g,new Lx(g))}Ti.STAT_EVENT="statevent";function Fx(d,g){ye.call(this,Ti.STAT_EVENT,d),this.stat=g}y(Fx,ye);function Ut(d){const g=Mu();$t(g,new Fx(g,d))}Ti.Ma="timingevent";function Bx(d,g){ye.call(this,Ti.Ma,d),this.size=g}y(Bx,ye);function dl(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){d()},g)}function hl(){this.g=!0}hl.prototype.xa=function(){this.g=!1};function ZR(d,g,x,I,V,L){d.info(function(){if(d.g)if(L)for(var W="",Ae=L.split("&"),yt=0;yt<Ae.length;yt++){var Ee=Ae[yt].split("=");if(1<Ee.length){var Nt=Ee[0];Ee=Ee[1];var Ct=Nt.split("_");W=2<=Ct.length&&Ct[1]=="type"?W+(Nt+"="+Ee+"&"):W+(Nt+"=redacted&")}}else W=null;else W=L;return"XMLHTTP REQ ("+I+") [attempt "+V+"]: "+g+`
`+x+`
`+W})}function eP(d,g,x,I,V,L,W){d.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+V+"]: "+g+`
`+x+`
`+L+" "+W})}function Oo(d,g,x,I){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+nP(d,x)+(I?" "+I:"")})}function tP(d,g){d.info(function(){return"TIMEOUT: "+g})}hl.prototype.info=function(){};function nP(d,g){if(!d.g)return g;if(!g)return null;try{var x=JSON.parse(g);if(x){for(d=0;d<x.length;d++)if(Array.isArray(x[d])){var I=x[d];if(!(2>I.length)){var V=I[1];if(Array.isArray(V)&&!(1>V.length)){var L=V[0];if(L!="noop"&&L!="stop"&&L!="close")for(var W=1;W<V.length;W++)V[W]=""}}}}return Pp(x)}catch{return g}}var Ou={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$x={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Vp;function Vu(){}y(Vu,Dp),Vu.prototype.g=function(){return new XMLHttpRequest},Vu.prototype.i=function(){return{}},Vp=new Vu;function ds(d,g,x,I){this.j=d,this.i=g,this.l=x,this.R=I||1,this.U=new ll(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ux}function Ux(){this.i=null,this.g="",this.h=!1}var zx={},jp={};function Lp(d,g,x){d.L=1,d.v=Bu(Ar(g)),d.m=x,d.P=!0,Wx(d,null)}function Wx(d,g){d.F=Date.now(),ju(d),d.A=Ar(d.v);var x=d.A,I=d.R;Array.isArray(I)||(I=[String(I)]),sw(x.i,"t",I),d.C=0,x=d.j.J,d.h=new Ux,d.g=Ew(d.j,x?g:null,!d.m),0<d.O&&(d.M=new JR(p(d.Y,d,d.g),d.O)),g=d.U,x=d.g,I=d.ca;var V="readystatechange";Array.isArray(V)||(V&&(Dx[0]=V.toString()),V=Dx);for(var L=0;L<V.length;L++){var W=Ix(x,V[L],I||g.handleEvent,!1,g.h||g);if(!W)break;g.g[W.key]=W}g=d.H?E(d.H):{},d.m?(d.u||(d.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,g)):(d.u="GET",d.g.ea(d.A,d.u,null,g)),ul(),ZR(d.i,d.u,d.A,d.l,d.R,d.m)}ds.prototype.ca=function(d){d=d.target;const g=this.M;g&&Rr(d)==3?g.j():this.Y(d)},ds.prototype.Y=function(d){try{if(d==this.g)e:{const Ct=Rr(this.g);var g=this.g.Ba();const Lo=this.g.Z();if(!(3>Ct)&&(Ct!=3||this.g&&(this.h.h||this.g.oa()||dw(this.g)))){this.J||Ct!=4||g==7||(g==8||0>=Lo?ul(3):ul(2)),Fp(this);var x=this.g.Z();this.X=x;t:if(qx(this)){var I=dw(this.g);d="";var V=I.length,L=Rr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Si(this),fl(this);var W="";break t}this.h.i=new a.TextDecoder}for(g=0;g<V;g++)this.h.h=!0,d+=this.h.i.decode(I[g],{stream:!(L&&g==V-1)});I.length=0,this.h.g+=d,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=x==200,eP(this.i,this.u,this.A,this.l,this.R,Ct,x),this.o){if(this.T&&!this.K){t:{if(this.g){var Ae,yt=this.g;if((Ae=yt.g?yt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Ae)){var Ee=Ae;break t}}Ee=null}if(x=Ee)Oo(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Bp(this,x);else{this.o=!1,this.s=3,Ut(12),Si(this),fl(this);break e}}if(this.P){x=!0;let Un;for(;!this.J&&this.C<W.length;)if(Un=rP(this,W),Un==jp){Ct==4&&(this.s=4,Ut(14),x=!1),Oo(this.i,this.l,null,"[Incomplete Response]");break}else if(Un==zx){this.s=4,Ut(15),Oo(this.i,this.l,W,"[Invalid Chunk]"),x=!1;break}else Oo(this.i,this.l,Un,null),Bp(this,Un);if(qx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ct!=4||W.length!=0||this.h.h||(this.s=1,Ut(16),x=!1),this.o=this.o&&x,!x)Oo(this.i,this.l,W,"[Invalid Chunked Response]"),Si(this),fl(this);else if(0<W.length&&!this.W){this.W=!0;var Nt=this.j;Nt.g==this&&Nt.ba&&!Nt.M&&(Nt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Hp(Nt),Nt.M=!0,Ut(11))}}else Oo(this.i,this.l,W,null),Bp(this,W);Ct==4&&Si(this),this.o&&!this.J&&(Ct==4?vw(this.j,this):(this.o=!1,ju(this)))}else wP(this.g),x==400&&0<W.indexOf("Unknown SID")?(this.s=3,Ut(12)):(this.s=0,Ut(13)),Si(this),fl(this)}}}catch{}finally{}};function qx(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function rP(d,g){var x=d.C,I=g.indexOf(`
`,x);return I==-1?jp:(x=Number(g.substring(x,I)),isNaN(x)?zx:(I+=1,I+x>g.length?jp:(g=g.slice(I,I+x),d.C=I+x,g)))}ds.prototype.cancel=function(){this.J=!0,Si(this)};function ju(d){d.S=Date.now()+d.I,Hx(d,d.I)}function Hx(d,g){if(d.B!=null)throw Error("WatchDog timer not null");d.B=dl(p(d.ba,d),g)}function Fp(d){d.B&&(a.clearTimeout(d.B),d.B=null)}ds.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(tP(this.i,this.A),this.L!=2&&(ul(),Ut(17)),Si(this),this.s=2,fl(this)):Hx(this,this.S-d)};function fl(d){d.j.G==0||d.J||vw(d.j,d)}function Si(d){Fp(d);var g=d.M;g&&typeof g.ma=="function"&&g.ma(),d.M=null,Mx(d.U),d.g&&(g=d.g,d.g=null,g.abort(),g.ma())}function Bp(d,g){try{var x=d.j;if(x.G!=0&&(x.g==d||$p(x.h,d))){if(!d.K&&$p(x.h,d)&&x.G==3){try{var I=x.Da.g.parse(g)}catch{I=null}if(Array.isArray(I)&&I.length==3){var V=I;if(V[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<d.F)Hu(x),Wu(x);else break e;qp(x),Ut(18)}}else x.za=V[1],0<x.za-x.T&&37500>V[2]&&x.F&&x.v==0&&!x.C&&(x.C=dl(p(x.Za,x),6e3));if(1>=Qx(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Ni(x,11)}else if((d.K||x.g==d)&&Hu(x),!b(g))for(V=x.Da.g.parse(g),g=0;g<V.length;g++){let Ee=V[g];if(x.T=Ee[0],Ee=Ee[1],x.G==2)if(Ee[0]=="c"){x.K=Ee[1],x.ia=Ee[2];const Nt=Ee[3];Nt!=null&&(x.la=Nt,x.j.info("VER="+x.la));const Ct=Ee[4];Ct!=null&&(x.Aa=Ct,x.j.info("SVER="+x.Aa));const Lo=Ee[5];Lo!=null&&typeof Lo=="number"&&0<Lo&&(I=1.5*Lo,x.L=I,x.j.info("backChannelRequestTimeoutMs_="+I)),I=x;const Un=d.g;if(Un){const Gu=Un.g?Un.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gu){var L=I.h;L.g||Gu.indexOf("spdy")==-1&&Gu.indexOf("quic")==-1&&Gu.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Up(L,L.h),L.h=null))}if(I.D){const Kp=Un.g?Un.g.getResponseHeader("X-HTTP-Session-Id"):null;Kp&&(I.ya=Kp,De(I.I,I.D,Kp))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-d.F,x.j.info("Handshake RTT: "+x.R+"ms")),I=x;var W=d;if(I.qa=_w(I,I.J?I.ia:null,I.W),W.K){Jx(I.h,W);var Ae=W,yt=I.L;yt&&(Ae.I=yt),Ae.B&&(Fp(Ae),ju(Ae)),I.g=W}else gw(I);0<x.i.length&&qu(x)}else Ee[0]!="stop"&&Ee[0]!="close"||Ni(x,7);else x.G==3&&(Ee[0]=="stop"||Ee[0]=="close"?Ee[0]=="stop"?Ni(x,7):Wp(x):Ee[0]!="noop"&&x.l&&x.l.ta(Ee),x.v=0)}}ul(4)}catch{}}var sP=class{constructor(d,g){this.g=d,this.map=g}};function Kx(d){this.l=d||10,a.PerformanceNavigationTiming?(d=a.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gx(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Qx(d){return d.h?1:d.g?d.g.size:0}function $p(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function Up(d,g){d.g?d.g.add(g):d.h=g}function Jx(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}Kx.prototype.cancel=function(){if(this.i=Yx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Yx(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const x of d.g.values())g=g.concat(x.D);return g}return v(d.i)}function iP(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(l(d)){for(var g=[],x=d.length,I=0;I<x;I++)g.push(d[I]);return g}g=[],x=0;for(I in d)g[x++]=d[I];return g}function oP(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(l(d)||typeof d=="string"){var g=[];d=d.length;for(var x=0;x<d;x++)g.push(x);return g}g=[],x=0;for(const I in d)g[x++]=I;return g}}}function Xx(d,g){if(d.forEach&&typeof d.forEach=="function")d.forEach(g,void 0);else if(l(d)||typeof d=="string")Array.prototype.forEach.call(d,g,void 0);else for(var x=oP(d),I=iP(d),V=I.length,L=0;L<V;L++)g.call(void 0,I[L],x&&x[L],d)}var Zx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function aP(d,g){if(d){d=d.split("&");for(var x=0;x<d.length;x++){var I=d[x].indexOf("="),V=null;if(0<=I){var L=d[x].substring(0,I);V=d[x].substring(I+1)}else L=d[x];g(L,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Ii(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Ii){this.h=d.h,Lu(this,d.j),this.o=d.o,this.g=d.g,Fu(this,d.s),this.l=d.l;var g=d.i,x=new gl;x.i=g.i,g.g&&(x.g=new Map(g.g),x.h=g.h),ew(this,x),this.m=d.m}else d&&(g=String(d).match(Zx))?(this.h=!1,Lu(this,g[1]||"",!0),this.o=pl(g[2]||""),this.g=pl(g[3]||"",!0),Fu(this,g[4]),this.l=pl(g[5]||"",!0),ew(this,g[6]||"",!0),this.m=pl(g[7]||"")):(this.h=!1,this.i=new gl(null,this.h))}Ii.prototype.toString=function(){var d=[],g=this.j;g&&d.push(ml(g,tw,!0),":");var x=this.g;return(x||g=="file")&&(d.push("//"),(g=this.o)&&d.push(ml(g,tw,!0),"@"),d.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&d.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(ml(x,x.charAt(0)=="/"?uP:cP,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",ml(x,hP)),d.join("")};function Ar(d){return new Ii(d)}function Lu(d,g,x){d.j=x?pl(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function Fu(d,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);d.s=g}else d.s=null}function ew(d,g,x){g instanceof gl?(d.i=g,fP(d.i,d.h)):(x||(g=ml(g,dP)),d.i=new gl(g,d.h))}function De(d,g,x){d.i.set(g,x)}function Bu(d){return De(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function pl(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ml(d,g,x){return typeof d=="string"?(d=encodeURI(d).replace(g,lP),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function lP(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var tw=/[#\/\?@]/g,cP=/[#\?:]/g,uP=/[#\?]/g,dP=/[#\?@]/g,hP=/#/g;function gl(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function hs(d){d.g||(d.g=new Map,d.h=0,d.i&&aP(d.i,function(g,x){d.add(decodeURIComponent(g.replace(/\+/g," ")),x)}))}n=gl.prototype,n.add=function(d,g){hs(this),this.i=null,d=Vo(this,d);var x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(g),this.h+=1,this};function nw(d,g){hs(d),g=Vo(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function rw(d,g){return hs(d),g=Vo(d,g),d.g.has(g)}n.forEach=function(d,g){hs(this),this.g.forEach(function(x,I){x.forEach(function(V){d.call(g,V,I,this)},this)},this)},n.na=function(){hs(this);const d=Array.from(this.g.values()),g=Array.from(this.g.keys()),x=[];for(let I=0;I<g.length;I++){const V=d[I];for(let L=0;L<V.length;L++)x.push(g[I])}return x},n.V=function(d){hs(this);let g=[];if(typeof d=="string")rw(this,d)&&(g=g.concat(this.g.get(Vo(this,d))));else{d=Array.from(this.g.values());for(let x=0;x<d.length;x++)g=g.concat(d[x])}return g},n.set=function(d,g){return hs(this),this.i=null,d=Vo(this,d),rw(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},n.get=function(d,g){return d?(d=this.V(d),0<d.length?String(d[0]):g):g};function sw(d,g,x){nw(d,g),0<x.length&&(d.i=null,d.g.set(Vo(d,g),v(x)),d.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(var x=0;x<g.length;x++){var I=g[x];const L=encodeURIComponent(String(I)),W=this.V(I);for(I=0;I<W.length;I++){var V=L;W[I]!==""&&(V+="="+encodeURIComponent(String(W[I]))),d.push(V)}}return this.i=d.join("&")};function Vo(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function fP(d,g){g&&!d.j&&(hs(d),d.i=null,d.g.forEach(function(x,I){var V=I.toLowerCase();I!=V&&(nw(this,I),sw(this,V,x))},d)),d.j=g}function pP(d,g){const x=new hl;if(a.Image){const I=new Image;I.onload=m(fs,x,"TestLoadImage: loaded",!0,g,I),I.onerror=m(fs,x,"TestLoadImage: error",!1,g,I),I.onabort=m(fs,x,"TestLoadImage: abort",!1,g,I),I.ontimeout=m(fs,x,"TestLoadImage: timeout",!1,g,I),a.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=d}else g(!1)}function mP(d,g){const x=new hl,I=new AbortController,V=setTimeout(()=>{I.abort(),fs(x,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:I.signal}).then(L=>{clearTimeout(V),L.ok?fs(x,"TestPingServer: ok",!0,g):fs(x,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(V),fs(x,"TestPingServer: error",!1,g)})}function fs(d,g,x,I,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),I(x)}catch{}}function gP(){this.g=new XR}function yP(d,g,x){const I=x||"";try{Xx(d,function(V,L){let W=V;c(V)&&(W=Pp(V)),g.push(I+L+"="+encodeURIComponent(W))})}catch(V){throw g.push(I+"type="+encodeURIComponent("_badmap")),V}}function $u(d){this.l=d.Ub||null,this.j=d.eb||!1}y($u,Dp),$u.prototype.g=function(){return new Uu(this.l,this.j)},$u.prototype.i=function(d){return function(){return d}}({});function Uu(d,g){It.call(this),this.D=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Uu,It),n=Uu.prototype,n.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=g,this.readyState=1,vl(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(g.body=d),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,yl(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,vl(this)),this.g&&(this.readyState=3,vl(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;iw(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function iw(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?yl(this):vl(this),this.readyState==3&&iw(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,yl(this))},n.Qa=function(d){this.g&&(this.response=d,yl(this))},n.ga=function(){this.g&&yl(this)};function yl(d){d.readyState=4,d.l=null,d.j=null,d.v=null,vl(d)}n.setRequestHeader=function(d,g){this.u.append(d,g)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var x=g.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=g.next();return d.join(`\r
`)};function vl(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Uu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function ow(d){let g="";return D(d,function(x,I){g+=I,g+=":",g+=x,g+=`\r
`}),g}function zp(d,g,x){e:{for(I in x){var I=!1;break e}I=!0}I||(x=ow(x),typeof d=="string"?x!=null&&encodeURIComponent(String(x)):De(d,g,x))}function We(d){It.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(We,It);var vP=/^https?$/i,xP=["POST","PUT"];n=We.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,g,x,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vp.g(),this.v=this.o?Ox(this.o):Ox(Vp),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(L){aw(this,L);return}if(d=x||"",x=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var V in I)x.set(V,I[V]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const L of I.keys())x.set(L,I.get(L));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(x.keys()).find(L=>L.toLowerCase()=="content-type"),V=a.FormData&&d instanceof a.FormData,!(0<=Array.prototype.indexOf.call(xP,g,void 0))||I||V||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,W]of x)this.g.setRequestHeader(L,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{uw(this),this.u=!0,this.g.send(d),this.u=!1}catch(L){aw(this,L)}};function aw(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.m=5,lw(d),zu(d)}function lw(d){d.A||(d.A=!0,$t(d,"complete"),$t(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,$t(this,"complete"),$t(this,"abort"),zu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zu(this,!0)),We.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?cw(this):this.bb())},n.bb=function(){cw(this)};function cw(d){if(d.h&&typeof o<"u"&&(!d.v[1]||Rr(d)!=4||d.Z()!=2)){if(d.u&&Rr(d)==4)Rx(d.Ea,0,d);else if($t(d,"readystatechange"),Rr(d)==4){d.h=!1;try{const W=d.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var x;if(!(x=g)){var I;if(I=W===0){var V=String(d.D).match(Zx)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),I=!vP.test(V?V.toLowerCase():"")}x=I}if(x)$t(d,"complete"),$t(d,"success");else{d.m=6;try{var L=2<Rr(d)?d.g.statusText:""}catch{L=""}d.l=L+" ["+d.Z()+"]",lw(d)}}finally{zu(d)}}}}function zu(d,g){if(d.g){uw(d);const x=d.g,I=d.v[0]?()=>{}:null;d.g=null,d.v=null,g||$t(d,"ready");try{x.onreadystatechange=I}catch{}}}function uw(d){d.I&&(a.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function Rr(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<Rr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),YR(g)}};function dw(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function wP(d){const g={};d=(d.g&&2<=Rr(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<d.length;I++){if(b(d[I]))continue;var x=M(d[I]);const V=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const L=g[V]||[];g[V]=L,L.push(x)}_(g,function(I){return I.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xl(d,g,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||g}function hw(d){this.Aa=0,this.i=[],this.j=new hl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xl("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xl("baseRetryDelayMs",5e3,d),this.cb=xl("retryDelaySeedMs",1e4,d),this.Wa=xl("forwardChannelMaxRetries",2,d),this.wa=xl("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new Kx(d&&d.concurrentRequestLimit),this.Da=new gP,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hw.prototype,n.la=8,n.G=1,n.connect=function(d,g,x,I){Ut(0),this.W=d,this.H=g||{},x&&I!==void 0&&(this.H.OSID=x,this.H.OAID=I),this.F=this.X,this.I=_w(this,null,this.W),qu(this)};function Wp(d){if(fw(d),d.G==3){var g=d.U++,x=Ar(d.I);if(De(x,"SID",d.K),De(x,"RID",g),De(x,"TYPE","terminate"),wl(d,x),g=new ds(d,d.j,g),g.L=2,g.v=Bu(Ar(x)),x=!1,a.navigator&&a.navigator.sendBeacon)try{x=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!x&&a.Image&&(new Image().src=g.v,x=!0),x||(g.g=Ew(g.j,null),g.g.ea(g.v)),g.F=Date.now(),ju(g)}ww(d)}function Wu(d){d.g&&(Hp(d),d.g.cancel(),d.g=null)}function fw(d){Wu(d),d.u&&(a.clearTimeout(d.u),d.u=null),Hu(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&a.clearTimeout(d.s),d.s=null)}function qu(d){if(!Gx(d.h)&&!d.s){d.s=!0;var g=d.Ga;te||oe(),B||(te(),B=!0),G.add(g,d),d.B=0}}function _P(d,g){return Qx(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=g.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=dl(p(d.Ga,d,g),xw(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const V=new ds(this,this.j,d);let L=this.o;if(this.S&&(L?(L=E(L),N(L,this.S)):L=this.S),this.m!==null||this.O||(V.H=L,L=null),this.P)e:{for(var g=0,x=0;x<this.i.length;x++){t:{var I=this.i[x];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(g+=I,4096<g){g=x;break e}if(g===4096||x===this.i.length-1){g=x+1;break e}}g=1e3}else g=1e3;g=mw(this,V,g),x=Ar(this.I),De(x,"RID",d),De(x,"CVER",22),this.D&&De(x,"X-HTTP-Session-Id",this.D),wl(this,x),L&&(this.O?g="headers="+encodeURIComponent(String(ow(L)))+"&"+g:this.m&&zp(x,this.m,L)),Up(this.h,V),this.Ua&&De(x,"TYPE","init"),this.P?(De(x,"$req",g),De(x,"SID","null"),V.T=!0,Lp(V,x,null)):Lp(V,x,g),this.G=2}}else this.G==3&&(d?pw(this,d):this.i.length==0||Gx(this.h)||pw(this))};function pw(d,g){var x;g?x=g.l:x=d.U++;const I=Ar(d.I);De(I,"SID",d.K),De(I,"RID",x),De(I,"AID",d.T),wl(d,I),d.m&&d.o&&zp(I,d.m,d.o),x=new ds(d,d.j,x,d.B+1),d.m===null&&(x.H=d.o),g&&(d.i=g.D.concat(d.i)),g=mw(d,x,1e3),x.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Up(d.h,x),Lp(x,I,g)}function wl(d,g){d.H&&D(d.H,function(x,I){De(g,I,x)}),d.l&&Xx({},function(x,I){De(g,I,x)})}function mw(d,g,x){x=Math.min(d.i.length,x);var I=d.l?p(d.l.Na,d.l,d):null;e:{var V=d.i;let L=-1;for(;;){const W=["count="+x];L==-1?0<x?(L=V[0].g,W.push("ofs="+L)):L=0:W.push("ofs="+L);let Ae=!0;for(let yt=0;yt<x;yt++){let Ee=V[yt].g;const Nt=V[yt].map;if(Ee-=L,0>Ee)L=Math.max(0,V[yt].g-100),Ae=!1;else try{yP(Nt,W,"req"+Ee+"_")}catch{I&&I(Nt)}}if(Ae){I=W.join("&");break e}}}return d=d.i.splice(0,x),g.D=d,I}function gw(d){if(!d.g&&!d.u){d.Y=1;var g=d.Fa;te||oe(),B||(te(),B=!0),G.add(g,d),d.v=0}}function qp(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=dl(p(d.Fa,d),xw(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,yw(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=dl(p(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ut(10),Wu(this),yw(this))};function Hp(d){d.A!=null&&(a.clearTimeout(d.A),d.A=null)}function yw(d){d.g=new ds(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var g=Ar(d.qa);De(g,"RID","rpc"),De(g,"SID",d.K),De(g,"AID",d.T),De(g,"CI",d.F?"0":"1"),!d.F&&d.ja&&De(g,"TO",d.ja),De(g,"TYPE","xmlhttp"),wl(d,g),d.m&&d.o&&zp(g,d.m,d.o),d.L&&(d.g.I=d.L);var x=d.g;d=d.ia,x.L=1,x.v=Bu(Ar(g)),x.m=null,x.P=!0,Wx(x,d)}n.Za=function(){this.C!=null&&(this.C=null,Wu(this),qp(this),Ut(19))};function Hu(d){d.C!=null&&(a.clearTimeout(d.C),d.C=null)}function vw(d,g){var x=null;if(d.g==g){Hu(d),Hp(d),d.g=null;var I=2}else if($p(d.h,g))x=g.D,Jx(d.h,g),I=1;else return;if(d.G!=0){if(g.o)if(I==1){x=g.m?g.m.length:0,g=Date.now()-g.F;var V=d.B;I=Mu(),$t(I,new Bx(I,x)),qu(d)}else gw(d);else if(V=g.s,V==3||V==0&&0<g.X||!(I==1&&_P(d,g)||I==2&&qp(d)))switch(x&&0<x.length&&(g=d.h,g.i=g.i.concat(x)),V){case 1:Ni(d,5);break;case 4:Ni(d,10);break;case 3:Ni(d,6);break;default:Ni(d,2)}}}function xw(d,g){let x=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(x*=2),x*g}function Ni(d,g){if(d.j.info("Error code "+g),g==2){var x=p(d.fb,d),I=d.Xa;const V=!I;I=new Ii(I||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Lu(I,"https"),Bu(I),V?pP(I.toString(),x):mP(I.toString(),x)}else Ut(2);d.G=0,d.l&&d.l.sa(g),ww(d),fw(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Ut(2)):(this.j.info("Failed to ping google.com"),Ut(1))};function ww(d){if(d.G=0,d.ka=[],d.l){const g=Yx(d.h);(g.length!=0||d.i.length!=0)&&(w(d.ka,g),w(d.ka,d.i),d.h.i.length=0,v(d.i),d.i.length=0),d.l.ra()}}function _w(d,g,x){var I=x instanceof Ii?Ar(x):new Ii(x);if(I.g!="")g&&(I.g=g+"."+I.g),Fu(I,I.s);else{var V=a.location;I=V.protocol,g=g?g+"."+V.hostname:V.hostname,V=+V.port;var L=new Ii(null);I&&Lu(L,I),g&&(L.g=g),V&&Fu(L,V),x&&(L.l=x),I=L}return x=d.D,g=d.ya,x&&g&&De(I,x,g),De(I,"VER",d.la),wl(d,I),I}function Ew(d,g,x){if(g&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Ca&&!d.pa?new We(new $u({eb:x})):new We(d.pa),g.Ha(d.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function kw(){}n=kw.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ku(){}Ku.prototype.g=function(d,g){return new pn(d,g)};function pn(d,g){It.call(this),this.g=new hw(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(d?d["X-WebChannel-Client-Profile"]=g.va:d={"X-WebChannel-Client-Profile":g.va}),this.g.S=d,(d=g&&g.Sb)&&!b(d)&&(this.g.m=d),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!b(g)&&(this.g.D=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new jo(this)}y(pn,It),pn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){Wp(this.g)},pn.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.u&&(x={},x.__data__=Pp(d),d=x);g.i.push(new sP(g.Ya++,d)),g.G==3&&qu(g)},pn.prototype.N=function(){this.g.l=null,delete this.j,Wp(this.g),delete this.g,pn.aa.N.call(this)};function bw(d){Mp.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const x in g){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}y(bw,Mp);function Tw(){Op.call(this),this.status=1}y(Tw,Op);function jo(d){this.g=d}y(jo,kw),jo.prototype.ua=function(){$t(this.g,"a")},jo.prototype.ta=function(d){$t(this.g,new bw(d))},jo.prototype.sa=function(d){$t(this.g,new Tw)},jo.prototype.ra=function(){$t(this.g,"b")},Ku.prototype.createWebChannel=Ku.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,LI=function(){return new Ku},jI=function(){return Mu()},VI=Ti,ly={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ou.NO_ERROR=0,Ou.TIMEOUT=8,Ou.HTTP_ERROR=6,Hd=Ou,$x.COMPLETE="complete",OI=$x,Vx.EventType=cl,cl.OPEN="a",cl.CLOSE="b",cl.ERROR="c",cl.MESSAGE="d",It.prototype.listen=It.prototype.K,Wl=Vx,We.prototype.listenOnce=We.prototype.L,We.prototype.getLastError=We.prototype.Ka,We.prototype.getLastErrorCode=We.prototype.Ba,We.prototype.getStatus=We.prototype.Z,We.prototype.getResponseJson=We.prototype.Oa,We.prototype.getResponseText=We.prototype.oa,We.prototype.send=We.prototype.ea,We.prototype.setWithCredentials=We.prototype.Ha,MI=We}).apply(typeof pd<"u"?pd:typeof self<"u"?self:typeof window<"u"?window:{});const wE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};wt.UNAUTHENTICATED=new wt(null),wt.GOOGLE_CREDENTIALS=new wt("google-credentials-uid"),wt.FIRST_PARTY=new wt("first-party-uid"),wt.MOCK_USER=new wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=new Y0("@firebase/firestore");function Ko(){return ho.logLevel}function U(n,...e){if(ho.logLevel<=me.DEBUG){const t=e.map(cv);ho.debug(`Firestore (${rl}): ${n}`,...t)}}function Wt(n,...e){if(ho.logLevel<=me.ERROR){const t=e.map(cv);ho.error(`Firestore (${rl}): ${n}`,...t)}}function fo(n,...e){if(ho.logLevel<=me.WARN){const t=e.map(cv);ho.warn(`Firestore (${rl}): ${n}`,...t)}}function cv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(n="Unexpected state"){const e=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: `+n;throw Wt(e),new Error(e)}function Z(n,e){n||X()}function le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends br{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class M4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(wt.UNAUTHENTICATED))}shutdown(){}}class O4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class V4{constructor(e){this.t=e,this.currentUser=wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Z(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new vr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new vr)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Z(typeof r.accessToken=="string"),new FI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Z(e===null||typeof e=="string"),new wt(e)}}class j4{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=wt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class L4{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new j4(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class B4{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Z(this.o===void 0);const r=i=>{i.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Z(typeof t.token=="string"),this.R=t.token,new F4(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=$4(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function ue(n,e){return n<e?-1:n>e?1:0}function Oa(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function $I(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new q(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new q(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new q(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ue.fromMillis(Date.now())}static fromDate(e){return Ue.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Ue(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Ue(0,0))}static max(){return new ne(new Ue(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,t,r){t===void 0?t=0:t>e.length&&X(),r===void 0?r=e.length-t:r>e.length-t&&X(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Fc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fc?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class be extends Fc{construct(e,t,r){return new be(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new q(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new be(t)}static emptyPath(){return new be([])}}const U4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Be extends Fc{construct(e,t,r){return new Be(e,t,r)}static isValidIdentifier(e){return U4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Be.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Be(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new q(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new q(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new q(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new q(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Be(t)}static emptyPath(){return new Be([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.path=e}static fromPath(e){return new K(be.fromString(e))}static fromName(e){return new K(be.fromString(e).popFirst(5))}static empty(){return new K(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return be.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new K(new be(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function cy(n){return n.fields.find(e=>e.kind===2)}function Di(n){return n.fields.filter(e=>e.kind!==2)}$h.UNKNOWN_ID=-1;class Kd{constructor(e,t){this.fieldPath=e,this.kind=t}}class Bc{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Bc(0,bn.min())}}function z4(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=ne.fromTimestamp(r===1e9?new Ue(t+1,0):new Ue(t,r));return new bn(s,K.empty(),e)}function UI(n){return new bn(n.readTime,n.key,-1)}class bn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new bn(ne.min(),K.empty(),-1)}static max(){return new bn(ne.max(),K.empty(),-1)}}function uv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=K.comparator(n.documentKey,e.documentKey),t!==0?t:ue(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==zI)throw n;U("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new j((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof j?t:j.resolve(t)}catch(t){return j.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):j.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):j.reject(t)}static resolve(e){return new j((t,r)=>{t(e)})}static reject(e){return new j((t,r)=>{r(e)})}static waitFor(e){return new j((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=j.resolve(!1);for(const r of e)t=t.next(s=>s?j.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new j((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,t){return new j((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new vr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new lc(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=dv(r.target.error);this.V.reject(new lc(e,s))}}static open(e,t,r,s){try{return new zf(t,e.transaction(s,r))}catch(i){throw new lc(t,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new q4(t)}}class Ys{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Ys.S(ot())===12.2&&Wt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),Oi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!KS())return!1;if(Ys.v())return!0;const e=ot(),t=Ys.S(e),r=0<t&&t<10,s=qI(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(U("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;t(o)},s.onblocked=()=>{r(new lc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new q(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new q(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new lc(e,o))},s.onupgradeneeded=i=>{U("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{U("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const i=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=zf.open(this.db,e,i?"readonly":"readwrite",r),l=s(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),j.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(U("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function qI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class W4{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Oi(this.B.delete())}}class lc extends q{constructor(e,t){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function xi(n){return n.name==="IndexedDbTransactionError"}class q4{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Oi(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),Oi(this.store.add(e))}get(e){return Oi(this.store.get(e)).next(t=>(t===void 0&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),Oi(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),Oi(this.store.count())}U(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new j((o,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{o(l.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new j((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,t){U("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.W(s,t)}Y(e){const t=this.cursor({});return new j((r,s)=>{t.onerror=i=>{const o=dv(i.target.error);s(o)},t.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new j((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const l=new W4(a),c=t(a.primaryKey,a.value,l);if(c instanceof j){const u=c.catch(h=>(l.done(),j.reject(h)));r.push(u)}l.isDone?s():l.K===null?a.continue():a.continue(l.K)}}).next(()=>j.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Oi(n){return new j((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=dv(r.target.error);t(s)}})}let _E=!1;function dv(n){const e=Ys.S(ot());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _E||(_E=!0,setTimeout(()=>{throw r},0)),r}}return n}class H4{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){U("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{U("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){xi(t)?U("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Ao(t)}await this.X(6e4)})}}class K4{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let s=t,i=!0;return j.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return U("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>t-s)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(U("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((s,i)=>{const o=UI(i);uv(o,r)>0&&(r=o)}),new bn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}On.oe=-1;function Wf(n){return n==null}function $c(n){return n===0&&1/n==-1/0}function G4(n){return typeof n=="number"&&Number.isInteger(n)&&!$c(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=EE(e)),e=Q4(n.get(t),e);return EE(e)}function Q4(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const i=n.charAt(s);switch(i){case"\0":t+="";break;case"":t+="";break;default:t+=i}}return t}function EE(n){return n+""}function ur(n){const e=n.length;if(Z(e>=2),e===2)return Z(n.charAt(0)===""&&n.charAt(1)===""),be.emptyPath();const t=e-2,r=[];let s="";for(let i=0;i<e;){const o=n.indexOf("",i);switch((o<0||o>t)&&X(),n.charAt(o+1)){case"":const a=n.substring(i,o);let l;s.length===0?l=a:(s+=a,l=s,s=""),r.push(l);break;case"":s+=n.substring(i,o),s+="\0";break;case"":s+=n.substring(i,o+1);break;default:X()}i=o+2}return new be(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(n,e){return[n,Gt(e)]}function HI(n,e,t){return[n,Gt(e),t]}const J4={},Y4=["prefixPath","collectionGroup","readTime","documentId"],X4=["prefixPath","collectionGroup","documentId"],Z4=["collectionGroup","readTime","prefixPath","documentId"],eF=["canonicalId","targetId"],tF=["targetId","path"],nF=["path","targetId"],rF=["collectionId","parent"],sF=["indexId","uid"],iF=["uid","sequenceNumber"],oF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aF=["indexId","uid","orderedDocumentKey"],lF=["userId","collectionPath","documentId"],cF=["userId","collectionPath","largestBatchId"],uF=["userId","collectionGroup","largestBatchId"],KI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],dF=[...KI,"documentOverlays"],GI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],QI=GI,hv=[...QI,"indexConfiguration","indexState","indexEntries"],hF=hv,fF=[...hv,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy extends WI{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function lt(n,e){const t=le(n);return Ys.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ro(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function JI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,t){this.comparator=e,this.root=t||_t.EMPTY}insert(e,t){return new Le(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new Le(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new md(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new md(this.root,e,this.comparator,!1)}getReverseIterator(){return new md(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new md(this.root,e,this.comparator,!0)}}class md{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=i??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new _t(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw X();const e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw X()}get value(){throw X()}get color(){throw X()}get left(){throw X()}get right(){throw X()}copy(e,t,r,s,i){return this}insert(e,t,r){return new _t(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new TE(this.data.getIterator())}getIteratorFrom(e){return new TE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Ce)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ce(this.comparator);return t.data=e,t}}class TE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Bo(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new an([])}unionWith(e){let t=new Ce(Be.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new an(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Oa(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new YI("Invalid base64 string: "+i):i}}(e);return new nt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new nt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nt.EMPTY_BYTE_STRING=new nt("");const pF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rs(n){if(Z(!!n),typeof n=="string"){let e=0;const t=pF.exec(n);if(Z(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ve(n.seconds),nanos:Ve(n.nanos)}}function Ve(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ai(n){return typeof n=="string"?nt.fromBase64String(n):nt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function pv(n){const e=n.mapValue.fields.__previous_value__;return fv(e)?pv(e):e}function Uc(n){const e=rs(n.mapValue.fields.__local_write_time__.timestampValue);return new Ue(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class po{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new po("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof po&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Qd={nullValue:"NULL_VALUE"};function mo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?fv(n)?4:XI(n)?9007199254740991:qf(n)?10:11:X()}function wr(n,e){if(n===e)return!0;const t=mo(n);if(t!==mo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Uc(n).isEqual(Uc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=rs(s.timestampValue),a=rs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return ai(s.bytesValue).isEqual(ai(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return Ve(s.geoPointValue.latitude)===Ve(i.geoPointValue.latitude)&&Ve(s.geoPointValue.longitude)===Ve(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ve(s.integerValue)===Ve(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ve(s.doubleValue),a=Ve(i.doubleValue);return o===a?$c(o)===$c(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Oa(n.arrayValue.values||[],e.arrayValue.values||[],wr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(bE(o)!==bE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!wr(o[l],a[l])))return!1;return!0}(n,e);default:return X()}}function zc(n,e){return(n.values||[]).find(t=>wr(t,e))!==void 0}function li(n,e){if(n===e)return 0;const t=mo(n),r=mo(e);if(t!==r)return ue(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ue(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ve(i.integerValue||i.doubleValue),l=Ve(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return SE(n.timestampValue,e.timestampValue);case 4:return SE(Uc(n),Uc(e));case 5:return ue(n.stringValue,e.stringValue);case 6:return function(i,o){const a=ai(i),l=ai(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=ue(a[c],l[c]);if(u!==0)return u}return ue(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ue(Ve(i.latitude),Ve(o.latitude));return a!==0?a:ue(Ve(i.longitude),Ve(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return IE(n.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,u;const h=i.fields||{},p=o.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,v=ue(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((u=y==null?void 0:y.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:IE(m,y)}(n.mapValue,e.mapValue);case 11:return function(i,o){if(i===Vs.mapValue&&o===Vs.mapValue)return 0;if(i===Vs.mapValue)return 1;if(o===Vs.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const p=ue(l[h],u[h]);if(p!==0)return p;const m=li(a[l[h]],c[u[h]]);if(m!==0)return m}return ue(l.length,u.length)}(n.mapValue,e.mapValue);default:throw X()}}function SE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ue(n,e);const t=rs(n),r=rs(e),s=ue(t.seconds,r.seconds);return s!==0?s:ue(t.nanos,r.nanos)}function IE(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=li(t[s],r[s]);if(i)return i}return ue(t.length,r.length)}function Va(n){return dy(n)}function dy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=rs(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ai(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return K.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=dy(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${dy(t.fields[o])}`;return s+"}"}(n.mapValue):X()}function Wc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function hy(n){return!!n&&"integerValue"in n}function qc(n){return!!n&&"arrayValue"in n}function NE(n){return!!n&&"nullValue"in n}function CE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jd(n){return!!n&&"mapValue"in n}function qf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function cc(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ro(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=cc(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cc(n.arrayValue.values[t]);return e}return Object.assign({},n)}function XI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const ZI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function gF(n){return"nullValue"in n?Qd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Wc(po.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?qf(n)?ZI:{mapValue:{}}:X()}function yF(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Wc(po.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?ZI:"mapValue"in n?qf(n)?{mapValue:{}}:Vs:X()}function AE(n,e){const t=li(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function RE(n,e){const t=li(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.value=e}static empty(){return new Ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cc(t)}setAll(e){let t=Be.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=cc(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Jd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ro(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ot(cc(this.value))}}function eN(n){const e=[];return Ro(n.fields,(t,r)=>{const s=new Be([t]);if(Jd(r)){const i=eN(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new an(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ke(e,0,ne.min(),ne.min(),ne.min(),Ot.empty(),0)}static newFoundDocument(e,t,r,s){return new Ke(e,1,t,ne.min(),r,s,0)}static newNoDocument(e,t){return new Ke(e,2,t,ne.min(),ne.min(),Ot.empty(),0)}static newUnknownDocument(e,t){return new Ke(e,3,t,ne.min(),ne.min(),Ot.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ke&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ke(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,t){this.position=e,this.inclusive=t}}function PE(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=K.comparator(K.fromName(o.referenceValue),t.key):r=li(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function DE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!wr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,t="asc"){this.field=e,this.dir=t}}function vF(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{}class ge extends tN{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new xF(e,t,r):t==="array-contains"?new EF(e,r):t==="in"?new aN(e,r):t==="not-in"?new kF(e,r):t==="array-contains-any"?new bF(e,r):new ge(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new wF(e,r):new _F(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(li(t,this.value)):t!==null&&mo(this.value)===mo(t)&&this.matchesComparison(li(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Se extends tN{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Se(e,t)}matches(e){return La(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function La(n){return n.op==="and"}function fy(n){return n.op==="or"}function mv(n){return nN(n)&&La(n)}function nN(n){for(const e of n.filters)if(e instanceof Se)return!1;return!0}function py(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+Va(n.value);if(mv(n))return n.filters.map(e=>py(e)).join(",");{const e=n.filters.map(t=>py(t)).join(",");return`${n.op}(${e})`}}function rN(n,e){return n instanceof ge?function(r,s){return s instanceof ge&&r.op===s.op&&r.field.isEqual(s.field)&&wr(r.value,s.value)}(n,e):n instanceof Se?function(r,s){return s instanceof Se&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&rN(o,s.filters[a]),!0):!1}(n,e):void X()}function sN(n,e){const t=n.filters.concat(e);return Se.create(t,n.op)}function iN(n){return n instanceof ge?function(t){return`${t.field.canonicalString()} ${t.op} ${Va(t.value)}`}(n):n instanceof Se?function(t){return t.op.toString()+" {"+t.getFilters().map(iN).join(" ,")+"}"}(n):"Filter"}class xF extends ge{constructor(e,t,r){super(e,t,r),this.key=K.fromName(r.referenceValue)}matches(e){const t=K.comparator(e.key,this.key);return this.matchesComparison(t)}}class wF extends ge{constructor(e,t){super(e,"in",t),this.keys=oN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class _F extends ge{constructor(e,t){super(e,"not-in",t),this.keys=oN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function oN(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>K.fromName(r.referenceValue))}class EF extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qc(t)&&zc(t.arrayValue,this.value)}}class aN extends ge{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&zc(this.value.arrayValue,t)}}class kF extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!zc(this.value.arrayValue,t)}}class bF extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>zc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function my(n,e=null,t=[],r=[],s=null,i=null,o=null){return new TF(n,e,t,r,s,i,o)}function go(n){const e=le(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>py(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Wf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Va(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Va(r)).join(",")),e.ue=t}return e.ue}function wu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!vF(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!DE(n.startAt,e.startAt)&&DE(n.endAt,e.endAt)}function Uh(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function zh(n,e){return n.filters.filter(t=>t instanceof ge&&t.field.isEqual(e))}function ME(n,e,t){let r=Qd,s=!0;for(const i of zh(n,e)){let o=Qd,a=!0;switch(i.op){case"<":case"<=":o=gF(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Qd}AE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];AE({value:r,inclusive:s},{value:o,inclusive:t.inclusive})<0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}function OE(n,e,t){let r=Vs,s=!0;for(const i of zh(n,e)){let o=Vs,a=!0;switch(i.op){case">=":case">":o=yF(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Vs}RE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(t!==null){for(let i=0;i<n.orderBy.length;++i)if(n.orderBy[i].field.isEqual(e)){const o=t.position[i];RE({value:r,inclusive:s},{value:o,inclusive:t.inclusive})>0&&(r=o,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function SF(n,e,t,r,s,i,o,a){return new sl(n,e,t,r,s,i,o,a)}function Hf(n){return new sl(n)}function VE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lN(n){return n.collectionGroup!==null}function uc(n){const e=le(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ce(Be.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Hc(i,r))}),t.has(Be.keyField().canonicalString())||e.ce.push(new Hc(Be.keyField(),r))}return e.ce}function jn(n){const e=le(n);return e.le||(e.le=IF(e,uc(n))),e.le}function IF(n,e){if(n.limitType==="F")return my(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Hc(s.field,i)});const t=n.endAt?new ja(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ja(n.startAt.position,n.startAt.inclusive):null;return my(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function gy(n,e){const t=n.filters.concat([e]);return new sl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Wh(n,e,t){return new sl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Kf(n,e){return wu(jn(n),jn(e))&&n.limitType===e.limitType}function cN(n){return`${go(jn(n))}|lt:${n.limitType}`}function Go(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>iN(s)).join(", ")}]`),Wf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Va(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Va(s)).join(",")),`Target(${r})`}(jn(n))}; limitType=${n.limitType})`}function _u(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):K.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of uc(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=PE(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,uc(r),s)||r.endAt&&!function(o,a,l){const c=PE(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,uc(r),s))}(n,e)}function NF(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function uN(n){return(e,t)=>{let r=!1;for(const s of uc(n)){const i=CF(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function CF(n,e,t){const r=n.field.isKeyField()?K.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?li(l,c):X()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ro(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return JI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=new Le(K.comparator);function xn(){return AF}const dN=new Le(K.comparator);function ql(...n){let e=dN;for(const t of n)e=e.insert(t.key,t);return e}function hN(n){let e=dN;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function dr(){return dc()}function fN(){return dc()}function dc(){return new wi(n=>n.toString(),(n,e)=>n.isEqual(e))}const RF=new Le(K.comparator),PF=new Ce(K.comparator);function fe(...n){let e=PF;for(const t of n)e=e.add(t);return e}const DF=new Ce(ue);function MF(){return DF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$c(e)?"-0":e}}function pN(n){return{integerValue:""+n}}function OF(n,e){return G4(e)?pN(e):gv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(){this._=void 0}}function VF(n,e,t){return n instanceof Fa?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&fv(i)&&(i=pv(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Ba?gN(n,e):n instanceof $a?yN(n,e):function(s,i){const o=mN(s,i),a=jE(o)+jE(s.Pe);return hy(o)&&hy(s.Pe)?pN(a):gv(s.serializer,a)}(n,e)}function jF(n,e,t){return n instanceof Ba?gN(n,e):n instanceof $a?yN(n,e):t}function mN(n,e){return n instanceof Kc?function(r){return hy(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Fa extends Gf{}class Ba extends Gf{constructor(e){super(),this.elements=e}}function gN(n,e){const t=vN(e);for(const r of n.elements)t.some(s=>wr(s,r))||t.push(r);return{arrayValue:{values:t}}}class $a extends Gf{constructor(e){super(),this.elements=e}}function yN(n,e){let t=vN(e);for(const r of n.elements)t=t.filter(s=>!wr(s,r));return{arrayValue:{values:t}}}class Kc extends Gf{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function jE(n){return Ve(n.integerValue||n.doubleValue)}function vN(n){return qc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,t){this.field=e,this.transform=t}}function LF(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Ba&&s instanceof Ba||r instanceof $a&&s instanceof $a?Oa(r.elements,s.elements,wr):r instanceof Kc&&s instanceof Kc?wr(r.Pe,s.Pe):r instanceof Fa&&s instanceof Fa}(n.transform,e.transform)}class FF{constructor(e,t){this.version=e,this.transformResults=t}}class Ht{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ht}static exists(e){return new Ht(void 0,e)}static updateTime(e){return new Ht(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Yd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Qf{}function wN(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Jf(n.key,Ht.none()):new il(n.key,n.data,Ht.none());{const t=n.data,r=Ot.empty();let s=new Ce(Be.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new us(n.key,r,new an(s.toArray()),Ht.none())}}function BF(n,e,t){n instanceof il?function(s,i,o){const a=s.value.clone(),l=FE(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof us?function(s,i,o){if(!Yd(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=FE(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(_N(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function hc(n,e,t,r){return n instanceof il?function(i,o,a,l){if(!Yd(i.precondition,o))return a;const c=i.value.clone(),u=BE(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof us?function(i,o,a,l){if(!Yd(i.precondition,o))return a;const c=BE(i.fieldTransforms,l,o),u=o.data;return u.setAll(_N(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(n,e,t,r):function(i,o,a){return Yd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function $F(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=mN(r.transform,s||null);i!=null&&(t===null&&(t=Ot.empty()),t.set(r.field,i))}return t||null}function LE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Oa(r,s,(i,o)=>LF(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class il extends Qf{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class us extends Qf{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _N(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function FE(n,e,t){const r=new Map;Z(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,jF(o,a,t[s]))}return r}function BE(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,VF(i,o,e))}return r}class Jf extends Qf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class EN extends Qf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&BF(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=hc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=hc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=fN();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=wN(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&Oa(this.mutations,e.mutations,(t,r)=>LE(t,r))&&Oa(this.baseMutations,e.baseMutations,(t,r)=>LE(t,r))}}class vv{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Z(e.mutations.length===r.length);let s=function(){return RF}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new vv(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye,ve;function zF(n){switch(n){default:return X();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function kN(n){if(n===void 0)return Wt("GRPC error has no .code"),F.UNKNOWN;switch(n){case Ye.OK:return F.OK;case Ye.CANCELLED:return F.CANCELLED;case Ye.UNKNOWN:return F.UNKNOWN;case Ye.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Ye.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Ye.INTERNAL:return F.INTERNAL;case Ye.UNAVAILABLE:return F.UNAVAILABLE;case Ye.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Ye.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Ye.NOT_FOUND:return F.NOT_FOUND;case Ye.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Ye.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Ye.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Ye.ABORTED:return F.ABORTED;case Ye.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Ye.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Ye.DATA_LOSS:return F.DATA_LOSS;default:return X()}}(ve=Ye||(Ye={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=new Qi([4294967295,4294967295],0);function $E(n){const e=WF().encode(n),t=new DI;return t.update(e),new Uint8Array(t.digest())}function UE(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Qi([t,r],0),new Qi([s,i],0)]}class wv{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Hl(`Invalid padding: ${t}`);if(r<0)throw new Hl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hl(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Hl(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Qi.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(Qi.fromNumber(r)));return s.compare(qF)===1&&(s=new Qi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=$E(e),[r,s]=UE(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new wv(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=$E(e),[r,s]=UE(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Hl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Eu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Yf(ne.min(),s,new Le(ue),xn(),fe())}}class Eu{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Eu(r,t,fe(),fe(),fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class bN{constructor(e,t){this.targetId=e,this.me=t}}class TN{constructor(e,t,r=nt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class zE{constructor(){this.fe=0,this.ge=qE(),this.pe=nt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=fe(),t=fe(),r=fe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:X()}}),new Eu(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=qE()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class HF{constructor(e){this.Le=e,this.Be=new Map,this.ke=xn(),this.qe=WE(),this.Qe=new Le(ue)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:X()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(Uh(i))if(r===0){const o=new K(i.path);this.Ue(t,o,Ke.newNoDocument(o,ne.min()))}else Z(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=ai(r).toUint8Array()}catch(l){if(l instanceof YI)return fo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new wv(o,s,i)}catch(l){return fo(l instanceof Hl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&Uh(a.target)){const l=new K(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ke.newNoDocument(l,e))}i.be&&(t.set(o,i.ve()),i.Ce())}});let r=fe();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Yf(e,t,this.Qe,this.ke,r);return this.ke=xn(),this.qe=WE(),this.Qe=new Le(ue),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new zE,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ce(ue),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new zE),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function WE(){return new Le(K.comparator)}function qE(){return new Le(K.comparator)}const KF={asc:"ASCENDING",desc:"DESCENDING"},GF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},QF={and:"AND",or:"OR"};class JF{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yy(n,e){return n.useProto3Json||Wf(e)?e:{value:e}}function Ua(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function SN(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function YF(n,e){return Ua(n,e.toTimestamp())}function Qt(n){return Z(!!n),ne.fromTimestamp(function(t){const r=rs(t);return new Ue(r.seconds,r.nanos)}(n))}function _v(n,e){return vy(n,e).canonicalString()}function vy(n,e){const t=function(s){return new be(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function IN(n){const e=be.fromString(n);return Z(VN(e)),e}function qh(n,e){return _v(n.databaseId,e.path)}function Ji(n,e){const t=IN(e);if(t.get(1)!==n.databaseId.projectId)throw new q(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new q(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(AN(t))}function NN(n,e){return _v(n.databaseId,e)}function CN(n){const e=IN(n);return e.length===4?be.emptyPath():AN(e)}function xy(n){return new be(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function AN(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function HE(n,e,t){return{name:qh(n,e),fields:t.value.mapValue.fields}}function XF(n,e,t){const r=Ji(n,e.name),s=Qt(e.updateTime),i=e.createTime?Qt(e.createTime):ne.min(),o=new Ot({mapValue:{fields:e.fields}}),a=Ke.newFoundDocument(r,s,i,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function ZF(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:X()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Z(u===void 0||typeof u=="string"),nt.fromBase64String(u||"")):(Z(u===void 0||u instanceof Buffer||u instanceof Uint8Array),nt.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?F.UNKNOWN:kN(c.code);return new q(u,c.message||"")}(o);t=new TN(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ji(n,r.document.name),i=Qt(r.document.updateTime),o=r.document.createTime?Qt(r.document.createTime):ne.min(),a=new Ot({mapValue:{fields:r.document.fields}}),l=Ke.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Xd(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ji(n,r.document),i=r.readTime?Qt(r.readTime):ne.min(),o=Ke.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Xd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ji(n,r.document),i=r.removedTargetIds||[];t=new Xd([],i,s,null)}else{if(!("filter"in e))return X();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new UF(s,i),a=r.targetId;t=new bN(a,o)}}return t}function Hh(n,e){let t;if(e instanceof il)t={update:HE(n,e.key,e.value)};else if(e instanceof Jf)t={delete:qh(n,e.key)};else if(e instanceof us)t={update:HE(n,e.key,e.data),updateMask:i3(e.fieldMask)};else{if(!(e instanceof EN))return X();t={verify:qh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Fa)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ba)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof $a)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Kc)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw X()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:YF(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:X()}(n,e.precondition)),t}function wy(n,e){const t=e.currentDocument?function(i){return i.updateTime!==void 0?Ht.updateTime(Qt(i.updateTime)):i.exists!==void 0?Ht.exists(i.exists):Ht.none()}(e.currentDocument):Ht.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let l=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME"),l=new Fa;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new Ba(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new $a(u)}else"increment"in a?l=new Kc(o,a.increment):X();const c=Be.fromServerFormat(a.fieldPath);return new xN(c,l)}(n,s)):[];if(e.update){e.update.name;const s=Ji(n,e.update.name),i=new Ot({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new an(c.map(u=>Be.fromServerFormat(u)))}(e.updateMask);return new us(s,i,o,t,r)}return new il(s,i,t,r)}if(e.delete){const s=Ji(n,e.delete);return new Jf(s,t)}if(e.verify){const s=Ji(n,e.verify);return new EN(s,t)}return X()}function e3(n,e){return n&&n.length>0?(Z(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Qt(s.updateTime):Qt(i);return o.isEqual(ne.min())&&(o=Qt(i)),new FF(o,s.transformResults||[])}(t,e))):[]}function RN(n,e){return{documents:[NN(n,e.path)]}}function PN(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=NN(n,s);const i=function(c){if(c.length!==0)return ON(Se.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(p){return{field:Qo(p.field),direction:n3(p.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=yy(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function DN(n){let e=CN(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Z(r===1);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(h){const p=MN(h);return p instanceof Se&&mv(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(h){return h.map(p=>function(y){return new Hc(Jo(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,Wf(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(h){const p=!!h.before,m=h.values||[];return new ja(m,p)}(t.startAt));let c=null;return t.endAt&&(c=function(h){const p=!h.before,m=h.values||[];return new ja(m,p)}(t.endAt)),SF(e,s,o,i,a,"F",l,c)}function t3(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function MN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Jo(t.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Jo(t.unaryFilter.field);return ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Jo(t.unaryFilter.field);return ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Jo(t.unaryFilter.field);return ge.create(o,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(n):n.fieldFilter!==void 0?function(t){return ge.create(Jo(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Se.create(t.compositeFilter.filters.map(r=>MN(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return X()}}(t.compositeFilter.op))}(n):X()}function n3(n){return KF[n]}function r3(n){return GF[n]}function s3(n){return QF[n]}function Qo(n){return{fieldPath:n.canonicalString()}}function Jo(n){return Be.fromServerFormat(n.fieldPath)}function ON(n){return n instanceof ge?function(t){if(t.op==="=="){if(CE(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NAN"}};if(NE(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(CE(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NOT_NAN"}};if(NE(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qo(t.field),op:r3(t.op),value:t.value}}}(n):n instanceof Se?function(t){const r=t.getFilters().map(s=>ON(s));return r.length===1?r[0]:{compositeFilter:{op:s3(t.op),filters:r}}}(n):X()}function i3(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function VN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,t,r,s,i=ne.min(),o=ne.min(),a=nt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.ct=e}}function o3(n,e){let t;if(e.document)t=XF(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=K.fromSegments(e.noDocument.path),s=vo(e.noDocument.readTime);t=Ke.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return X();{const r=K.fromSegments(e.unknownDocument.path),s=vo(e.unknownDocument.version);t=Ke.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const i=new Ue(s[0],s[1]);return ne.fromTimestamp(i)}(e.readTime)),t}function KE(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Kh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:qh(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ua(i,o.version.toTimestamp()),createTime:Ua(i,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:yo(e.version)};else{if(!e.isUnknownDocument())return X();r.unknownDocument={path:t.path.toArray(),version:yo(e.version)}}return r}function Kh(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function yo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function vo(n){const e=new Ue(n.seconds,n.nanoseconds);return ne.fromTimestamp(e)}function Vi(n,e){const t=(e.baseMutations||[]).map(i=>wy(n.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>wy(n.ct,i)),s=Ue.fromMillis(e.localWriteTimeMs);return new yv(e.batchId,s,t,r)}function Kl(n){const e=vo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?vo(n.lastLimboFreeSnapshotVersion):ne.min();let r;return r=function(i){return i.documents!==void 0}(n.query)?function(i){return Z(i.documents.length===1),jn(Hf(CN(i.documents[0])))}(n.query):function(i){return jn(DN(i))}(n.query),new zr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,nt.fromBase64String(n.resumeToken))}function LN(n,e){const t=yo(e.snapshotVersion),r=yo(e.lastLimboFreeSnapshotVersion);let s;s=Uh(e.target)?RN(n.ct,e.target):PN(n.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:go(e.target),readTime:t,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function FN(n){const e=DN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Wh(e,e.limit,"L"):e}function Nm(n,e){return new xv(e.largestBatchId,wy(n.ct,e.overlayMutation))}function GE(n,e){const t=e.path.lastSegment();return[n,Gt(e.path.popLast()),t]}function QE(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:yo(r.readTime),documentKey:Gt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{getBundleMetadata(e,t){return JE(e).get(t).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:vo(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,t){return JE(e).put(function(s){return{bundleId:s.id,createTime:yo(Qt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return YE(e).get(t).next(r=>{if(r)return function(i){return{name:i.name,query:FN(i.bundledQuery),readTime:vo(i.readTime)}}(r)})}saveNamedQuery(e,t){return YE(e).put(function(s){return{name:s.name,readTime:yo(Qt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function JE(n){return lt(n,"bundles")}function YE(n){return lt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new Xf(e,r)}getOverlay(e,t){return Cl(e).get(GE(this.userId,t)).next(r=>r?Nm(this.serializer,r):null)}getOverlays(e,t){const r=dr();return j.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((i,o)=>{const a=new xv(t,o);s.push(this.ht(e,a))}),j.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(o=>s.add(Gt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Cl(e).j("collectionPathOverlayIndex",a))}),j.waitFor(i)}getOverlaysForCollection(e,t,r){const s=dr(),i=Gt(t),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Cl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Nm(this.serializer,l);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const i=dr();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Cl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,u)=>{const h=Nm(this.serializer,c);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ht(e,t){return Cl(e).put(function(s,i,o){const[a,l,c]=GE(i,o.mutation.key);return{userId:i,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Hh(s.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Cl(n){return lt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{Pt(e){return lt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?nt.fromUint8Array(r):nt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ve(e.integerValue));else if("doubleValue"in e){const r=Ve(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),$c(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=rs(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(ai(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?XI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):qf(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):X()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const s of Object.keys(r))this.Vt(s,t),this.Tt(r[s],t)}wt(e,t){var r,s;const i=e.fields||{};this.dt(t,53);const o="value",a=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.dt(t,15),t.At(Ve(a)),this.Vt(o,t),this.Tt(i[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const s of r)this.Tt(s,t)}yt(e,t){this.dt(t,37),K.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}ji.vt=new ji;function c3(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function XE(n){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=c3(255&r[i]);if(s+=o,o!==8)break}return s}(n);return Math.ceil(e/8)}class u3{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=t.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const s=t.codePointAt(0);this.Ot(240|s>>>18),this.Ot(128|63&s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s)}}this.Nt()}kt(e){const t=this.qt(e),r=XE(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}Kt(e){const t=this.qt(e),r=XE(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class d3{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class h3{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Al{constructor(){this.jt=new u3,this.Ht=new d3(this.jt),this.Jt=new h3(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,t,r,s){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=s}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Li(this.indexId,this.documentKey,this.arrayValue,r)}}function gs(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=ZE(n.arrayValue,e.arrayValue),t!==0?t:(t=ZE(n.directionalValue,e.directionalValue),t!==0?t:K.comparator(n.documentKey,e.documentKey)))}function ZE(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.Xt=new Ce((t,r)=>Be.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Z(e.collectionGroup===this.collectionId),this.nn)return!1;const t=cy(e);if(t!==void 0&&!this.sn(t))return!1;const r=Di(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const l=r[i];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ce(Be.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Kd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Kd(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Kd(r.field,r.dir==="asc"?0:1)));return new $h($h.UNKNOWN_ID,this.collectionId,t,Bc.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(n){var e,t;if(Z(n instanceof ge||n instanceof Se),n instanceof ge){if(n instanceof aN){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(i=>ge.create(n.field,"==",i)))||[];return Se.create(s,"or")}return n}const r=n.filters.map(s=>BN(s));return Se.create(r,n.op)}function f3(n){if(n.getFilters().length===0)return[];const e=ky(BN(n));return Z($N(e)),_y(e)||Ey(e)?[e]:e.getFilters()}function _y(n){return n instanceof ge}function Ey(n){return n instanceof Se&&mv(n)}function $N(n){return _y(n)||Ey(n)||function(t){if(t instanceof Se&&fy(t)){for(const r of t.getFilters())if(!_y(r)&&!Ey(r))return!1;return!0}return!1}(n)}function ky(n){if(Z(n instanceof ge||n instanceof Se),n instanceof ge)return n;if(n.filters.length===1)return ky(n.filters[0]);const e=n.filters.map(r=>ky(r));let t=Se.create(e,n.op);return t=Gh(t),$N(t)?t:(Z(t instanceof Se),Z(La(t)),Z(t.filters.length>1),t.filters.reduce((r,s)=>Ev(r,s)))}function Ev(n,e){let t;return Z(n instanceof ge||n instanceof Se),Z(e instanceof ge||e instanceof Se),t=n instanceof ge?e instanceof ge?function(s,i){return Se.create([s,i],"and")}(n,e):tk(n,e):e instanceof ge?tk(e,n):function(s,i){if(Z(s.filters.length>0&&i.filters.length>0),La(s)&&La(i))return sN(s,i.getFilters());const o=fy(s)?s:i,a=fy(s)?i:s,l=o.filters.map(c=>Ev(c,a));return Se.create(l,"or")}(n,e),Gh(t)}function tk(n,e){if(La(e))return sN(e,n.getFilters());{const t=e.filters.map(r=>Ev(n,r));return Se.create(t,"or")}}function Gh(n){if(Z(n instanceof ge||n instanceof Se),n instanceof ge)return n;const e=n.getFilters();if(e.length===1)return Gh(e[0]);if(nN(n))return n;const t=e.map(s=>Gh(s)),r=[];return t.forEach(s=>{s instanceof ge?r.push(s):s instanceof Se&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Se.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(){this.un=new kv}addToCollectionParentIndex(e,t){return this.un.add(t),j.resolve()}getCollectionParents(e,t){return j.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return j.resolve()}deleteFieldIndex(e,t){return j.resolve()}deleteAllFieldIndexes(e){return j.resolve()}createTargetIndexes(e,t){return j.resolve()}getDocumentsMatchingTarget(e,t){return j.resolve(null)}getIndexType(e,t){return j.resolve(0)}getFieldIndexes(e,t){return j.resolve([])}getNextCollectionGroupToUpdate(e){return j.resolve(null)}getMinOffset(e,t){return j.resolve(bn.min())}getMinOffsetFromCollectionGroup(e,t){return j.resolve(bn.min())}updateCollectionGroup(e,t,r){return j.resolve()}updateIndexEntries(e,t){return j.resolve()}}class kv{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ce(be.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ce(be.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gd=new Uint8Array(0);class m3{constructor(e,t){this.databaseId=t,this.cn=new kv,this.ln=new wi(r=>go(r),(r,s)=>wu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const i={collectionId:r,parent:Gt(s)};return nk(e).put(i)}return j.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[$I(t),""],!1,!0);return nk(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==t)break;r.push(ur(o.parent))}return r})}addFieldIndex(e,t){const r=Rl(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete s.indexId;const i=r.add(s);if(t.indexState){const o=Uo(e);return i.next(a=>{o.put(QE(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){const r=Rl(e),s=Uo(e),i=$o(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Rl(e),r=$o(e),s=Uo(e);return t.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,t){return j.forEach(this.hn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new ek(r).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,t){const r=$o(e);let s=!0;const i=new Map;return j.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=fe();const a=[];return j.forEach(i,(l,c)=>{U("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(C=>`${C.fieldPath}:${C.kind}`).join(",")}`}(l)} to execute ${go(t)}`);const u=function(T,C){const P=cy(C);if(P===void 0)return null;for(const D of zh(T,P.fieldPath))switch(D.op){case"array-contains-any":return D.value.arrayValue.values||[];case"array-contains":return[D.value]}return null}(c,l),h=function(T,C){const P=new Map;for(const D of Di(C))for(const _ of zh(T,D.fieldPath))switch(_.op){case"==":case"in":P.set(D.fieldPath.canonicalString(),_.value);break;case"not-in":case"!=":return P.set(D.fieldPath.canonicalString(),_.value),Array.from(P.values())}return null}(c,l),p=function(T,C){const P=[];let D=!0;for(const _ of Di(C)){const E=_.kind===0?ME(T,_.fieldPath,T.startAt):OE(T,_.fieldPath,T.startAt);P.push(E.value),D&&(D=E.inclusive)}return new ja(P,D)}(c,l),m=function(T,C){const P=[];let D=!0;for(const _ of Di(C)){const E=_.kind===0?OE(T,_.fieldPath,T.endAt):ME(T,_.fieldPath,T.endAt);P.push(E.value),D&&(D=E.inclusive)}return new ja(P,D)}(c,l),y=this.In(l,c,p),v=this.In(l,c,m),w=this.Tn(l,c,h),k=this.En(l.indexId,u,y,p.inclusive,v,m.inclusive,w);return j.forEach(k,b=>r.G(b,t.limit).next(T=>{T.forEach(C=>{const P=K.fromSegments(C.documentKey);o.has(P)||(o=o.add(P),a.push(P))})}))}).next(()=>a)}return j.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=f3(Se.create(e.filters,"and")).map(r=>my(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,s,i,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,i.length),c=l/(t!=null?t.length:1),u=[];for(let h=0;h<l;++h){const p=t?this.dn(t[h/c]):gd,m=this.An(e,p,r[h%c],s),y=this.Rn(e,p,i[h%c],o),v=a.map(w=>this.An(e,p,w,!0));u.push(...this.createRange(m,y,v))}return u}An(e,t,r,s){const i=new Li(e,K.empty(),t,r);return s?i:i.Zt()}Rn(e,t,r,s){const i=new Li(e,K.empty(),t,r);return s?i.Zt():i}Pn(e,t){const r=new ek(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const s=this.hn(t);return j.forEach(s,i=>this.Pn(e,i).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new Ce(Be.comparator),u=!1;for(const h of l.filters)for(const p of h.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?u=!0:c=c.add(p.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&s.length>1&&r===2?1:r)}Vn(e,t){const r=new Al;for(const s of Di(e)){const i=t.data.field(s.fieldPath);if(i==null)return null;const o=r.Yt(s.kind);ji.vt.It(i,o)}return r.zt()}dn(e){const t=new Al;return ji.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Al;return ji.vt.It(Wc(this.databaseId,t),r.Yt(function(i){const o=Di(i);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let s=[];s.push(new Al);let i=0;for(const o of Di(e)){const a=r[i++];for(const l of s)if(this.fn(t,o.fieldPath)&&qc(a))s=this.gn(s,o,a);else{const c=l.Yt(o.kind);ji.vt.It(a,c)}}return this.pn(s)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const l=new Al;l.seed(a.zt()),ji.vt.It(o,l.Yt(t.kind)),i.push(l)}return i}fn(e,t){return!!e.filters.find(r=>r instanceof ge&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Rl(e),s=Uo(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(i=>{const o=[];return j.forEach(i,a=>s.get([a.indexId,this.uid]).next(l=>{o.push(function(u,h){const p=h?new Bc(h.sequenceNumber,new bn(vo(h.readTime),new K(ur(h.documentKey)),h.largestBatchId)):Bc.empty(),m=u.fields.map(([y,v])=>new Kd(Be.fromServerFormat(y),v));return new $h(u.indexId,u.collectionGroup,m,p)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ue(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=Rl(e),i=Uo(e);return this.yn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>j.forEach(a,l=>i.put(QE(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return j.forEach(t,(s,i)=>{const o=r.get(s.collectionGroup);return(o?j.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),j.forEach(a,l=>this.wn(e,s,l).next(c=>{const u=this.Sn(i,l);return c.isEqual(u)?j.resolve():this.bn(e,i,l,c,u)}))))})}Dn(e,t,r,s){return $o(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,s){return $o(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const s=$o(e);let i=new Ce(gs);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{i=i.add(new Li(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>i)}Sn(e,t){let r=new Ce(gs);const s=this.Vn(t,e);if(s==null)return r;const i=cy(t);if(i!=null){const o=e.data.field(i.fieldPath);if(qc(o))for(const a of o.arrayValue.values||[])r=r.add(new Li(t.indexId,e.key,this.dn(a),s))}else r=r.add(new Li(t.indexId,e.key,gd,s));return r}bn(e,t,r,s,i){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,c,u,h,p){const m=l.getIterator(),y=c.getIterator();let v=Bo(m),w=Bo(y);for(;v||w;){let k=!1,b=!1;if(v&&w){const T=u(v,w);T<0?b=!0:T>0&&(k=!0)}else v!=null?b=!0:k=!0;k?(h(w),w=Bo(y)):b?(p(v),v=Bo(m)):(v=Bo(m),w=Bo(y))}}(s,i,gs,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),j.waitFor(o)}yn(e){let t=1;return Uo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>gs(o,a)).filter((o,a,l)=>!a||gs(o,l[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=gs(o,e),l=gs(o,t);if(a===0)s[0]=e.Zt();else if(a>0&&l<0)s.push(o),s.push(o.Zt());else if(l>0)break}s.push(t);const i=[];for(let o=0;o<s.length;o+=2){if(this.Cn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,gd,[]],l=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,gd,[]];i.push(IDBKeyRange.bound(a,l))}return i}Cn(e,t){return gs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(rk)}getMinOffset(e,t){return j.mapArray(this.hn(t),r=>this.Pn(e,r).next(s=>s||X())).next(rk)}}function nk(n){return lt(n,"collectionParents")}function $o(n){return lt(n,"indexEntries")}function Rl(n){return lt(n,"indexConfiguration")}function Uo(n){return lt(n,"indexState")}function rk(n){Z(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;uv(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new bn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class rn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new rn(e,rn.DEFAULT_COLLECTION_PERCENTILE,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(n,e,t){const r=n.store("mutations"),s=n.store("documentMutations"),i=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(u,h,p)=>(a++,p.delete()));i.push(l.next(()=>{Z(a===1)}));const c=[];for(const u of t.mutations){const h=HI(e,u.key.path,t.batchId);i.push(s.delete(h)),c.push(u.key)}return j.waitFor(i).next(()=>c)}function Qh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw X();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rn.DEFAULT_COLLECTION_PERCENTILE=10,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rn.DEFAULT=new rn(41943040,rn.DEFAULT_COLLECTION_PERCENTILE,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rn.DISABLED=new rn(-1,0,0);class Zf{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Fn={}}static lt(e,t,r,s){Z(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Zf(i,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ys(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const i=Yo(e),o=ys(e);return o.add({}).next(a=>{Z(typeof a=="number");const l=new yv(a,t,r,s),c=function(m,y,v){const w=v.baseMutations.map(b=>Hh(m.ct,b)),k=v.mutations.map(b=>Hh(m.ct,b));return{userId:y,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:k}}(this.serializer,this.userId,l),u=[];let h=new Ce((p,m)=>ue(p.canonicalString(),m.canonicalString()));for(const p of s){const m=HI(this.userId,p.key.path,a);h=h.add(p.key.path.popLast()),u.push(o.put(c)),u.push(i.put(m,J4))}return h.forEach(p=>{u.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),j.waitFor(u).next(()=>l)})}lookupMutationBatch(e,t){return ys(e).get(t).next(r=>r?(Z(r.userId===this.userId),Vi(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?j.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.Fn[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return ys(e).J({index:"userMutationsIndex",range:s},(o,a,l)=>{a.userId===this.userId&&(Z(a.batchId>=r),i=Vi(this.serializer,a)),l.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ys(e).J({index:"userMutationsIndex",range:t,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ys(e).U("userMutationsIndex",t).next(r=>r.map(s=>Vi(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Gd(this.userId,t.path),s=IDBKeyRange.lowerBound(r),i=[];return Yo(e).J({range:s},(o,a,l)=>{const[c,u,h]=o,p=ur(u);if(c===this.userId&&t.path.isEqual(p))return ys(e).get(h).next(m=>{if(!m)throw X();Z(m.userId===this.userId),i.push(Vi(this.serializer,m))});l.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(ue);const s=[];return t.forEach(i=>{const o=Gd(this.userId,i.path),a=IDBKeyRange.lowerBound(o),l=Yo(e).J({range:a},(c,u,h)=>{const[p,m,y]=c,v=ur(m);p===this.userId&&i.path.isEqual(v)?r=r.add(y):h.done()});s.push(l)}),j.waitFor(s).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,i=Gd(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Ce(ue);return Yo(e).J({range:o},(l,c,u)=>{const[h,p,m]=l,y=ur(p);h===this.userId&&r.isPrefixOf(y)?y.length===s&&(a=a.add(m)):u.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],s=[];return t.forEach(i=>{s.push(ys(e).get(i).next(o=>{if(o===null)throw X();Z(o.userId===this.userId),r.push(Vi(this.serializer,o))}))}),j.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return UN(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),j.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return j.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Yo(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const l=ur(i[1]);s.push(l)}else a.done()}).next(()=>{Z(s.length===0)})})}containsKey(e,t){return zN(e,this.userId,t)}Nn(e){return WN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function zN(n,e,t){const r=Gd(e,t.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Yo(n).J({range:i,H:!0},(a,l,c)=>{const[u,h,p]=a;u===e&&h===s&&(o=!0),c.done()}).next(()=>o)}function ys(n){return lt(n,"mutations")}function Yo(n){return lt(n,"documentMutations")}function WN(n){return lt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new xo(0)}static kn(){return new xo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new xo(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ne.fromTimestamp(new Ue(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Qn(e,s)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>zo(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Z(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let s=0;const i=[];return zo(e).J((o,a)=>{const l=Kl(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(s++,i.push(this.removeTargetData(e,l)))}).next(()=>j.waitFor(i)).next(()=>s)}forEachTarget(e,t){return zo(e).J((r,s)=>{const i=Kl(s);t(i)})}qn(e){return ik(e).get("targetGlobalKey").next(t=>(Z(t!==null),t))}Qn(e,t){return ik(e).put("targetGlobalKey",t)}Kn(e,t){return zo(e).put(LN(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=go(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return zo(e).J({range:s,index:"queryTargetsIndex"},(o,a,l)=>{const c=Kl(a);wu(t,c.target)&&(i=c,l.done())}).next(()=>i)}addMatchingKeys(e,t,r){const s=[],i=Rs(e);return t.forEach(o=>{const a=Gt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),j.waitFor(s)}removeMatchingKeys(e,t,r){const s=Rs(e);return j.forEach(t,i=>{const o=Gt(i.path);return j.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,t){const r=Rs(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Rs(e);let i=fe();return s.J({range:r,H:!0},(o,a,l)=>{const c=ur(o[1]),u=new K(c);i=i.add(u)}).next(()=>i)}containsKey(e,t){const r=Gt(t.path),s=IDBKeyRange.bound([r],[$I(r)],!1,!0);let i=0;return Rs(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],l,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}ot(e,t){return zo(e).get(t).next(r=>r?Kl(r):null)}}function zo(n){return lt(n,"targets")}function ik(n){return lt(n,"targetGlobal")}function Rs(n){return lt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok([n,e],[t,r]){const s=ue(n,t);return s===0?ue(e,r):s}class y3{constructor(e){this.Un=e,this.buffer=new Ce(ok),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ok(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class v3{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){xi(t)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Ao(t)}await this.Hn(3e5)})}}class x3{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return j.resolve(On.oe);const r=new y3(t);return this.Jn.forEachTarget(e,s=>r.zn(s.sequenceNumber)).next(()=>this.Jn.Zn(e,s=>r.zn(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),j.resolve(sk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sk):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(i=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),Ko()<=me.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),j.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function w3(n,e){return new x3(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(e,t){this.db=e,this.garbageCollector=w3(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,s)=>t(s))}addReference(e,t,r){return yd(e,r)}removeReference(e,t,r){return yd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return yd(e,t)}nr(e,t){return function(s,i){let o=!1;return WN(s).Y(a=>zN(s,a,i).next(l=>(l&&(o=!0),j.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ne.min()),Rs(e).delete(function(h){return[0,Gt(h.path)]}(o))))});s.push(l)}}).next(()=>j.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return yd(e,t)}tr(e,t){const r=Rs(e);let s,i=On.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(i!==On.oe&&t(new K(ur(s)),i),i=c,s=l):i=On.oe}).next(()=>{i!==On.oe&&t(new K(ur(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function yd(n,e){return Rs(n).put(function(r,s){return{targetId:0,path:Gt(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(){this.changes=new wi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ke.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?j.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ci(e).put(r)}removeEntry(e,t,r){return Ci(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Kh(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Ke.newInvalidDocument(t);return Ci(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Pl(t))},(s,i)=>{r=this.ir(t,i)}).next(()=>r)}sr(e,t){let r={size:0,document:Ke.newInvalidDocument(t)};return Ci(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Pl(t))},(s,i)=>{r={document:this.ir(t,i),size:Qh(i)}}).next(()=>r)}getEntries(e,t){let r=xn();return this._r(e,t,(s,i)=>{const o=this.ir(s,i);r=r.insert(s,o)}).next(()=>r)}ar(e,t){let r=xn(),s=new Le(K.comparator);return this._r(e,t,(i,o)=>{const a=this.ir(i,o);r=r.insert(i,a),s=s.insert(i,Qh(o))}).next(()=>({documents:r,ur:s}))}_r(e,t,r){if(t.isEmpty())return j.resolve();let s=new Ce(ck);t.forEach(l=>s=s.add(l));const i=IDBKeyRange.bound(Pl(s.first()),Pl(s.last())),o=s.getIterator();let a=o.getNext();return Ci(e).J({index:"documentKeyIndex",range:i},(l,c,u)=>{const h=K.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&ck(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.$(Pl(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,i){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Kh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ci(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{i==null||i.incrementDocumentReadCount(c.length);let u=xn();for(const h of c){const p=this.ir(K.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);p.isFoundDocument()&&(_u(t,p)||s.has(p.key))&&(u=u.insert(p.key,p))}return u})}getAllFromCollectionGroup(e,t,r,s){let i=xn();const o=lk(t,r),a=lk(t,bn.max());return Ci(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const h=this.ir(K.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new k3(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return ak(e).get("remoteDocumentGlobalKey").next(t=>(Z(!!t),t))}rr(e,t){return ak(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=o3(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ne.min())))return r}return Ke.newInvalidDocument(e)}}function HN(n){return new E3(n)}class k3 extends qN{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new wi(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new Ce((i,o)=>ue(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const l=KE(this.cr.serializer,o);s=s.add(i.path.popLast());const c=Qh(l);r+=c-a.size,t.push(this.cr.addEntry(e,i,l))}else if(r-=a.size,this.trackRemovals){const l=KE(this.cr.serializer,o.convertToNoDocument(ne.min()));t.push(this.cr.addEntry(e,i,l))}}),s.forEach(i=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),t.push(this.cr.updateMetadata(e,r)),j.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:s})=>(s.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function ak(n){return lt(n,"remoteDocumentGlobal")}function Ci(n){return lt(n,"remoteDocumentsV14")}function Pl(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lk(n,e){const t=e.documentKey.path.toArray();return[n,Kh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ck(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<t.length-2&&i<r.length-2;++i)if(s=ue(t[i],r[i]),s)return s;return s=ue(t.length,r.length),s||(s=ue(t[t.length-2],r[r.length-2]),s||ue(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&hc(r.mutation,s,an.empty(),Ue.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,t,r=fe()){const s=dr();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=ql();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=dr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,fe()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=xn();const o=dc(),a=function(){return dc()}();return t.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof us)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),hc(u.mutation,c,u.mutation.getFieldMask(),Ue.now())):o.set(c.key,an.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var h;return a.set(c,new b3(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){const r=dc();let s=new Le((o,a)=>o-a),i=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||an.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||fe()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=fN();u.forEach(p=>{if(!i.has(p)){const m=wN(t.get(p),r.get(p));m!==null&&h.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return j.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lN(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):j.resolve(dr());let a=-1,l=i;return o.next(c=>j.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?j.resolve():this.remoteDocumentCache.getEntry(e,u).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,fe())).next(u=>({batchId:a,changes:hN(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(r=>{let s=ql();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=ql();return this.indexManager.getCollectionParents(e,i).next(a=>j.forEach(a,l=>{const c=function(h,p){return new sl(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Ke.newInvalidDocument(u)))});let a=ql();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&hc(u.mutation,c,an.empty(),Ue.now()),_u(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return j.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Qt(s.createTime)}}(t)),j.resolve()}getNamedQuery(e,t){return j.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:FN(s.bundledQuery),readTime:Qt(s.readTime)}}(t)),j.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(){this.overlays=new Le(K.comparator),this.Ir=new Map}getOverlay(e,t){return j.resolve(this.overlays.get(t))}getOverlays(e,t){const r=dr();return j.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),j.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),j.resolve()}getOverlaysForCollection(e,t,r){const s=dr(),i=t.length+1,o=new K(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return j.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Le((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=dr(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=dr(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return j.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new xv(t,r));let i=this.Ir.get(t);i===void 0&&(i=fe(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3{constructor(){this.sessionToken=nt.EMPTY_BYTE_STRING}getSessionToken(e){return j.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,j.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(){this.Tr=new Ce(ct.Er),this.dr=new Ce(ct.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new ct(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ct(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new K(new be([])),r=new ct(t,e),s=new ct(t,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new K(new be([])),r=new ct(t,e),s=new ct(t,e+1);let i=fe();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new ct(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ct{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return K.comparator(e.key,t.key)||ue(e.wr,t.wr)}static Ar(e,t){return ue(e.wr,t.wr)||K.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ce(ct.Er)}checkEmpty(e){return j.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yv(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new ct(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return j.resolve(o)}lookupMutationBatch(e,t){return j.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return j.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return j.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return j.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ct(t,0),s=new ct(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const a=this.Dr(o.wr);i.push(a)}),j.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ce(ue);return t.forEach(s=>{const i=new ct(s,0),o=new ct(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{r=r.add(a.wr)})}),j.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;K.isDocumentKey(i)||(i=i.child(""));const o=new ct(new K(i),0);let a=new Ce(ue);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.wr)),!0)},o),j.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return j.forEach(t.mutations,s=>{const i=new ct(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new ct(t,0),s=this.br.firstAfterOrEqual(r);return j.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,j.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{constructor(e){this.Mr=e,this.docs=function(){return new Le(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return j.resolve(r?r.document.mutableCopy():Ke.newInvalidDocument(t))}getEntries(e,t){let r=xn();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ke.newInvalidDocument(s))}),j.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=xn();const o=t.path,a=new K(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||uv(UI(u),r)<=0||(s.has(u.key)||_u(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return j.resolve(i)}getAllFromCollectionGroup(e,t,r,s){X()}Or(e,t){return j.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new A3(this)}getSize(e){return j.resolve(this.size)}}class A3 extends qN{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),j.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e){this.persistence=e,this.Nr=new wi(t=>go(t),wu),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new bv,this.targetCount=0,this.kr=xo.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),j.resolve()}getLastRemoteSnapshotVersion(e){return j.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return j.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),j.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),j.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new xo(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,j.resolve()}updateTargetData(e,t){return this.Kn(t),j.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,j.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),j.waitFor(i).next(()=>s)}getTargetCount(e){return j.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return j.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),j.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),j.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),j.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return j.resolve(r)}containsKey(e,t){return j.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,t){this.qr={},this.overlays={},this.Qr=new On(0),this.Kr=!1,this.Kr=!0,this.$r=new I3,this.referenceDelegate=e(this),this.Ur=new R3(this),this.indexManager=new p3,this.remoteDocumentCache=function(s){return new C3(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new jN(t),this.Gr=new T3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new S3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new N3(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);const s=new P3(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return j.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class P3 extends WI{constructor(e){super(),this.currentSequenceNumber=e}}class ep{constructor(e){this.persistence=e,this.Jr=new bv,this.Yr=null}static Zr(e){return new ep(e)}get Xr(){if(this.Yr)return this.Yr;throw X()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),j.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),j.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),j.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return j.forEach(this.Xr,r=>{const s=K.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,ne.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return j.or([()=>j.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(e){this.serializer=e}O(e,t,r,s){const i=new zf("createOrUpgrade",t);r<1&&s>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",kE,{unique:!0}),l.createObjectStore("documentMutations")}(e),uk(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=j.resolve();return r<3&&s>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),uk(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ne.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(u=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",kE,{unique:!0});const h=c.store("mutations"),p=u.map(m=>h.put(m));return j.waitFor(p)})}(e,i))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.ni(i))),r<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),r<7&&s>=7&&(o=o.next(()=>this.ii(i))),r<8&&s>=8&&(o=o.next(()=>this.si(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.oi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:lF});c.createIndex("collectionPathOverlayIndex",cF,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",uF,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:Y4});c.createIndex("documentKeyIndex",X4),c.createIndex("collectionGroupIndex",Z4)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ai(e,i))),r<15&&s>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:sF}).createIndex("sequenceNumberIndex",iF,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:oF}).createIndex("documentKeyIndex",aF,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,s)=>{t+=Qh(s)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(s=>j.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>j.forEach(a,l=>{Z(l.userId===i.userId);const c=Vi(this.serializer,l);return UN(e,i.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const l=new be(o),c=function(h){return[0,Gt(h)]}(l);i.push(t.get(c).next(u=>u?j.resolve():(h=>t.put({targetId:0,path:Gt(h),sequenceNumber:s.highestListenSequenceNumber}))(l)))}).next(()=>j.waitFor(i))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:rF});const r=t.store("collectionParents"),s=new kv,i=o=>{if(s.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Gt(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new be(o);return i(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],c)=>{const u=ur(a);return i(u.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,s)=>{const i=Kl(s),o=LN(this.serializer,i);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=t.store("remoteDocumentsV14"),l=function(h){return h.document?new K(be.fromString(h.document.name).popFirst(5)):h.noDocument?K.fromSegments(h.noDocument.path):h.unknownDocument?K.fromSegments(h.unknownDocument.path):X()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(c))}).next(()=>j.waitFor(s))}ai(e,t){const r=t.store("mutations"),s=HN(this.serializer),i=new GN(ep.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let u=(c=a.get(l.userId))!==null&&c!==void 0?c:fe();Vi(this.serializer,l).keys().forEach(h=>u=u.add(h)),a.set(l.userId,u)}),j.forEach(a,(l,c)=>{const u=new wt(c),h=Xf.lt(this.serializer,u),p=i.getIndexManager(u),m=Zf.lt(u,this.serializer,p,i.referenceDelegate);return new KN(s,m,h,p).recalculateAndSaveOverlaysForDocumentKeys(new uy(t,On.oe),l).next()})})}}function uk(n){n.createObjectStore("targetDocuments",{keyPath:tF}).createIndex("documentTargetsIndex",nF,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",eF,{unique:!0}),n.createObjectStore("targetGlobal")}const Cm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Tv{constructor(e,t,r,s,i,o,a,l,c,u,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=i,this.window=o,this.document=a,this.ci=c,this.li=u,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=p=>Promise.resolve(),!Tv.D())throw new q(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _3(this,s),this.Ai=t+"main",this.serializer=new jN(l),this.Ri=new Ys(this.Ai,this.hi,new D3(this.serializer)),this.$r=new l3,this.Ur=new g3(this.referenceDelegate,this.serializer),this.remoteDocumentCache=HN(this.serializer),this.Gr=new a3,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,u===!1&&Wt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new q(F.FAILED_PRECONDITION,Cm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new On(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>vd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(xi(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Dl(e).get("owner").next(t=>j.resolve(this.vi(t)))}Ci(e){return vd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=lt(t,"clientMetadata");return r.U().next(s=>{const i=this.xi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return j.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?j.resolve(!0):Dl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new q(F.FAILED_PRECONDITION,Cm);return!1}}return!(!this.networkEnabled||!this.inForeground)||vd(e).U().next(r=>this.xi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new uy(e,On.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>vd(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Zf.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new m3(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Xf.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",i=function(l){return l===17?fF:l===16?hF:l===15?hv:l===14?QI:l===13?GI:l===12?dF:l===11?KI:void X()}(this.hi);let o;return this.Ri.runTransaction(e,s,i,a=>(o=new uy(a,this.Qr?this.Qr.next():On.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Wt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new q(F.FAILED_PRECONDITION,zI);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Dl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new q(F.FAILED_PRECONDITION,Cm)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Dl(e).put("owner",t)}static D(){return Ys.D()}bi(e){const t=Dl(e);return t.get("owner").next(r=>this.vi(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):j.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Wt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;HS()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Wt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Wt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Dl(n){return lt(n,"owner")}function vd(n){return lt(n,"clientMetadata")}function M3(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=fe(),s=fe();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Sv(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return HS()?8:qI(ot())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new O3;return this.Xi(e,t,o).next(a=>{if(i.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(Ko()<=me.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",Go(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),j.resolve()):(Ko()<=me.DEBUG&&U("QueryEngine","Query:",Go(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Ko()<=me.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",Go(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jn(t))):j.resolve())}Yi(e,t){if(VE(t))return j.resolve(null);let r=jn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Wh(t,null,"F"),r=jn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=fe(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,o,l.readTime)?this.Yi(e,Wh(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,s){return VE(t)||s.isEqual(ne.min())?j.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(t,i);return this.ns(t,o,r,s)?j.resolve(null):(Ko()<=me.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Go(t)),this.rs(e,o,t,z4(s,-1)).next(a=>a))})}ts(e,t){let r=new Ce(uN(e));return t.forEach((s,i)=>{_u(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return Ko()<=me.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Go(t)),this.Ji.getDocumentsMatchingQuery(e,t,bn.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Le(ue),this._s=new wi(i=>go(i),wu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function JN(n,e,t,r){return new V3(n,e,t,r)}async function YN(n,e){const t=le(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=fe();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function j3(n,e){const t=le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const h=c.batch,p=h.keys();let m=j.resolve();return p.forEach(y=>{m=m.next(()=>u.getEntry(l,y)).next(v=>{const w=c.docVersions.get(y);Z(w!==null),v.version.compareTo(w)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=fe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function XN(n){const e=le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function L3(n,e){const t=le(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const a=[];e.targetChanges.forEach((u,h)=>{const p=s.get(h);if(!p)return;a.push(t.Ur.removeMatchingKeys(i,u.removedDocuments,h).next(()=>t.Ur.addMatchingKeys(i,u.addedDocuments,h)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(nt.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,r)),s=s.insert(h,m),function(v,w,k){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(p,m,u)&&a.push(t.Ur.updateTargetData(i,m))});let l=xn(),c=fe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(F3(i,o,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!r.isEqual(ne.min())){const u=t.Ur.getLastRemoteSnapshotVersion(i).next(h=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return j.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.os=s,i))}function F3(n,e,t){let r=fe(),s=fe();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=xn();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ne.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):U("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:s}})}function B3(n,e){const t=le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function $3(n,e){const t=le(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,j.resolve(s)):t.Ur.allocateTargetId(r).next(o=>(s=new zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function by(n,e,t){const r=le(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!xi(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function dk(n,e,t){const r=le(n);let s=ne.min(),i=fe();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const h=le(l),p=h._s.get(u);return p!==void 0?j.resolve(h.os.get(p)):h.Ur.getTargetData(c,u)}(r,o,jn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?s:ne.min(),t?i:fe())).next(a=>(U3(r,NF(e),a),{documents:a,Ts:i})))}function U3(n,e,t){let r=n.us.get(e)||ne.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}class hk{constructor(){this.activeTargetIds=MF()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZN{constructor(){this.so=new hk,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new hk,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xd=null;function Am(){return xd===null?xd=function(){return 268435456+Math.round(2147483648*Math.random())}():xd++,"0x"+xd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pt="WebChannelConnection";class H3 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,o){const a=Am(),l=this.xo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(t,l,c,s).then(u=>(U("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw fo("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(t,r,s,i,o,a){return this.Mo(t,r,s,i,o)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}xo(t,r){const s=W3[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=Am();return new Promise((o,a)=>{const l=new MI;l.setWithCredentials(!0),l.listenOnce(OI.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Hd.NO_ERROR:const u=l.getResponseJson();U(Pt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case Hd.TIMEOUT:U(Pt,`RPC '${e}' ${i} timed out`),a(new q(F.DEADLINE_EXCEEDED,"Request time out"));break;case Hd.HTTP_ERROR:const h=l.getStatus();if(U(Pt,`RPC '${e}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const y=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(k)>=0?k:F.UNKNOWN}(m.status);a(new q(y,m.message))}else a(new q(F.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new q(F.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{U(Pt,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);U(Pt,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const s=Am(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=LI(),a=jI(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=i.join("");U(Pt,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=o.createWebChannel(u,l);let p=!1,m=!1;const y=new q3({Io:w=>{m?U(Pt,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(p||(U(Pt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),p=!0),U(Pt,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},To:()=>h.close()}),v=(w,k,b)=>{w.listen(k,T=>{try{b(T)}catch(C){setTimeout(()=>{throw C},0)}})};return v(h,Wl.EventType.OPEN,()=>{m||(U(Pt,`RPC '${e}' stream ${s} transport opened.`),y.yo())}),v(h,Wl.EventType.CLOSE,()=>{m||(m=!0,U(Pt,`RPC '${e}' stream ${s} transport closed`),y.So())}),v(h,Wl.EventType.ERROR,w=>{m||(m=!0,fo(Pt,`RPC '${e}' stream ${s} transport errored:`,w),y.So(new q(F.UNAVAILABLE,"The operation could not be completed")))}),v(h,Wl.EventType.MESSAGE,w=>{var k;if(!m){const b=w.data[0];Z(!!b);const T=b,C=T.error||((k=T[0])===null||k===void 0?void 0:k.error);if(C){U(Pt,`RPC '${e}' stream ${s} received error:`,C);const P=C.status;let D=function(S){const N=Ye[S];if(N!==void 0)return kN(N)}(P),_=C.message;D===void 0&&(D=F.INTERNAL,_="Unknown error status: "+P+" with message "+C.message),m=!0,y.So(new q(D,_)),h.close()}else U(Pt,`RPC '${e}' stream ${s} received:`,b),y.bo(b)}}),v(a,VI.STAT_EVENT,w=>{w.stat===ly.PROXY?U(Pt,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===ly.NOPROXY&&U(Pt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K3(){return typeof window<"u"?window:null}function Zd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(n){return new JF(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&U("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e,t,r,s,i,o,a,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new eC(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Wt(t.toString()),Wt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new q(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class G3 extends tC{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=ZF(this.serializer,e),r=function(i){if(!("targetChange"in i))return ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?Qt(o.readTime):ne.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=xy(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=Uh(l)?{documents:RN(i,l)}:{query:PN(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=SN(i,o.resumeToken);const c=yy(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ne.min())>0){a.readTime=Ua(i,o.snapshotVersion.toTimestamp());const c=yy(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=t3(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=xy(this.serializer),t.removeTarget=e,this.a_(t)}}class Q3 extends tC{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Z(!!e.streamToken),this.lastStreamToken=e.streamToken,Z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=e3(e.writeResults,e.commitTime),r=Qt(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=xy(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Hh(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3 extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new q(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,vy(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new q(F.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,vy(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Y3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Wt(t),this.D_=!1):U("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{Po(this)&&(U("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=le(l);c.L_.add(4),await ku(c),c.q_.set("Unknown"),c.L_.delete(4),await np(c)}(this))})}),this.q_=new Y3(r,s)}}async function np(n){if(Po(n))for(const e of n.B_)await e(!0)}async function ku(n){for(const e of n.B_)await e(!1)}function nC(n,e){const t=le(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Av(t)?Cv(t):ol(t).r_()&&Nv(t,e))}function Iv(n,e){const t=le(n),r=ol(t);t.N_.delete(e),r.r_()&&rC(t,e),t.N_.size===0&&(r.r_()?r.o_():Po(t)&&t.q_.set("Unknown"))}function Nv(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ol(n).A_(e)}function rC(n,e){n.Q_.xe(e),ol(n).R_(e)}function Cv(n){n.Q_=new HF({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ol(n).start(),n.q_.v_()}function Av(n){return Po(n)&&!ol(n).n_()&&n.N_.size>0}function Po(n){return le(n).L_.size===0}function sC(n){n.Q_=void 0}async function Z3(n){n.q_.set("Online")}async function e6(n){n.N_.forEach((e,t)=>{Nv(n,e)})}async function t6(n,e){sC(n),Av(n)?(n.q_.M_(e),Cv(n)):n.q_.set("Unknown")}async function n6(n,e,t){if(n.q_.set("Online"),e instanceof TN&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Jh(n,r)}else if(e instanceof Xd?n.Q_.Ke(e):e instanceof bN?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ne.min()))try{const r=await XN(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(nt.EMPTY_BYTE_STRING,u.snapshotVersion)),rC(i,l);const h=new zr(u.target,l,c,u.sequenceNumber);Nv(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){U("RemoteStore","Failed to raise snapshot:",r),await Jh(n,r)}}async function Jh(n,e,t){if(!xi(e))throw e;n.L_.add(1),await ku(n),n.q_.set("Offline"),t||(t=()=>XN(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{U("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await np(n)})}function iC(n,e){return e().catch(t=>Jh(n,t,e))}async function bu(n){const e=le(n),t=ci(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;r6(e);)try{const s=await B3(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,s6(e,s)}catch(s){await Jh(e,s)}oC(e)&&aC(e)}function r6(n){return Po(n)&&n.O_.length<10}function s6(n,e){n.O_.push(e);const t=ci(n);t.r_()&&t.V_&&t.m_(e.mutations)}function oC(n){return Po(n)&&!ci(n).n_()&&n.O_.length>0}function aC(n){ci(n).start()}async function i6(n){ci(n).p_()}async function o6(n){const e=ci(n);for(const t of n.O_)e.m_(t.mutations)}async function a6(n,e,t){const r=n.O_.shift(),s=vv.from(r,e,t);await iC(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await bu(n)}async function l6(n,e){e&&ci(n).V_&&await async function(r,s){if(function(o){return zF(o)&&o!==F.ABORTED}(s.code)){const i=r.O_.shift();ci(r).s_(),await iC(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await bu(r)}}(n,e),oC(n)&&aC(n)}async function pk(n,e){const t=le(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");const r=Po(t);t.L_.add(3),await ku(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await np(t)}async function c6(n,e){const t=le(n);e?(t.L_.delete(2),await np(t)):e||(t.L_.add(2),await ku(t),t.q_.set("Unknown"))}function ol(n){return n.K_||(n.K_=function(t,r,s){const i=le(t);return i.w_(),new G3(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:Z3.bind(null,n),Ro:e6.bind(null,n),mo:t6.bind(null,n),d_:n6.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Av(n)?Cv(n):n.q_.set("Unknown")):(await n.K_.stop(),sC(n))})),n.K_}function ci(n){return n.U_||(n.U_=function(t,r,s){const i=le(t);return i.w_(),new Q3(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:i6.bind(null,n),mo:l6.bind(null,n),f_:o6.bind(null,n),g_:a6.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await bu(n)):(await n.U_.stop(),n.O_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Rv(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pv(n,e){if(Wt("AsyncQueue",`${e}: ${n}`),xi(n))return new q(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.comparator=e?(t,r)=>e(t,r)||K.comparator(t.key,r.key):(t,r)=>K.comparator(t.key,r.key),this.keyedMap=ql(),this.sortedSet=new Le(this.comparator)}static emptySet(e){return new Ta(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ta)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ta;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(){this.W_=new Le(K.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):X():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class za{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new za(e,t,Ta.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class d6{constructor(){this.queries=gk(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=le(t),i=s.queries;s.queries=gk(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new q(F.ABORTED,"Firestore shutting down"))}}function gk(){return new wi(n=>cN(n),Kf)}async function lC(n,e){const t=le(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new u6,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=Pv(o,`Initialization of query '${Go(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&Dv(t)}async function cC(n,e){const t=le(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function h6(n,e){const t=le(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(r=!0);o.z_=s}}r&&Dv(t)}function f6(n,e,t){const r=le(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function Dv(n){n.Y_.forEach(e=>{e.next()})}var Ty,yk;(yk=Ty||(Ty={})).ea="default",yk.Cache="cache";class uC{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new za(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=za.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ty.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.key=e}}class hC{constructor(e){this.key=e}}class p6{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=fe(),this.mutatedKeys=fe(),this.Aa=uN(e),this.Ra=new Ta(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new mk,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const p=s.get(u),m=_u(this.query,h)?h:null,y=!!p&&this.mutatedKeys.has(p.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;p&&m?p.data.isEqual(m.data)?y!==v&&(r.track({type:3,doc:m}),w=!0):this.ga(p,m)||(r.track({type:2,doc:m}),w=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(a=!0)):!p&&m?(r.track({type:0,doc:m}),w=!0):p&&!m&&(r.track({type:1,doc:p}),w=!0,(l||c)&&(a=!0)),w&&(m?(o=o.add(m),i=v?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Ra:o,fa:r,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,h)=>function(m,y){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return v(m)-v(y)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(r),s=s!=null&&s;const a=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new za(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new mk,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=fe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new hC(r))}),this.da.forEach(r=>{e.has(r)||t.push(new dC(r))}),t}ba(e){this.Ta=e.Ts,this.da=fe();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return za.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class m6{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class g6{constructor(e){this.key=e,this.va=!1}}class y6{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new wi(a=>cN(a),Kf),this.Ma=new Map,this.xa=new Set,this.Oa=new Le(K.comparator),this.Na=new Map,this.La=new bv,this.Ba={},this.ka=new Map,this.qa=xo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function v6(n,e,t=!0){const r=vC(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await fC(r,e,t,!0),s}async function x6(n,e){const t=vC(n);await fC(t,e,!0,!1)}async function fC(n,e,t,r){const s=await $3(n.localStore,jn(e)),i=s.targetId,o=n.sharedClientState.addLocalQueryTarget(i,t);let a;return r&&(a=await w6(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&nC(n.remoteStore,s),a}async function w6(n,e,t,r,s){n.Ka=(h,p,m)=>async function(v,w,k,b){let T=w.view.ma(k);T.ns&&(T=await dk(v.localStore,w.query,!1).then(({documents:_})=>w.view.ma(_,T)));const C=b&&b.targetChanges.get(w.targetId),P=b&&b.targetMismatches.get(w.targetId)!=null,D=w.view.applyChanges(T,v.isPrimaryClient,C,P);return xk(v,w.targetId,D.wa),D.snapshot}(n,h,p,m);const i=await dk(n.localStore,e,!0),o=new p6(e,i.Ts),a=o.ma(i.documents),l=Eu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);xk(n,t,c.wa);const u=new m6(e,t,o);return n.Fa.set(e,u),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function _6(n,e,t){const r=le(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Kf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await by(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Iv(r.remoteStore,s.targetId),Sy(r,s.targetId)}).catch(Ao)):(Sy(r,s.targetId),await by(r.localStore,s.targetId,!0))}async function E6(n,e){const t=le(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Iv(t.remoteStore,r.targetId))}async function k6(n,e,t){const r=xC(n);try{const s=await function(o,a){const l=le(o),c=Ue.now(),u=a.reduce((m,y)=>m.add(y.key),fe());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=xn(),v=fe();return l.cs.getEntries(m,u).next(w=>{y=w,y.forEach((k,b)=>{b.isValidDocument()||(v=v.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(w=>{h=w;const k=[];for(const b of a){const T=$F(b,h.get(b.key).overlayedDocument);T!=null&&k.push(new us(b.key,T,eN(T.value.mapValue),Ht.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,k,a)}).next(w=>{p=w;const k=w.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(m,w.batchId,k)})}).then(()=>({batchId:p.batchId,changes:hN(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new Le(ue)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,s.batchId,t),await Tu(r,s.changes),await bu(r.remoteStore)}catch(s){const i=Pv(s,"Failed to persist write");t.reject(i)}}async function pC(n,e){const t=le(n);try{const r=await L3(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Na.get(i);o&&(Z(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Z(o.va):s.removedDocuments.size>0&&(Z(o.va),o.va=!1))}),await Tu(t,r,e)}catch(r){await Ao(r)}}function vk(n,e,t){const r=le(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=le(o);l.onlineState=a;let c=!1;l.queries.forEach((u,h)=>{for(const p of h.j_)p.Z_(a)&&(c=!0)}),c&&Dv(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function b6(n,e,t){const r=le(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new Le(K.comparator);o=o.insert(i,Ke.newNoDocument(i,ne.min()));const a=fe().add(i),l=new Yf(ne.min(),new Map,new Le(ue),o,a);await pC(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Mv(r)}else await by(r.localStore,e,!1).then(()=>Sy(r,e,t)).catch(Ao)}async function T6(n,e){const t=le(n),r=e.batch.batchId;try{const s=await j3(t.localStore,e);gC(t,r,null),mC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Tu(t,s)}catch(s){await Ao(s)}}async function S6(n,e,t){const r=le(n);try{const s=await function(o,a){const l=le(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(Z(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);gC(r,e,t),mC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Tu(r,s)}catch(s){await Ao(s)}}function mC(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function gC(n,e,t){const r=le(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Sy(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||yC(n,r)})}function yC(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Iv(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Mv(n))}function xk(n,e,t){for(const r of t)r instanceof dC?(n.La.addReference(r.key,e),I6(n,r)):r instanceof hC?(U("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||yC(n,r.key)):X()}function I6(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(U("SyncEngine","New document in limbo: "+t),n.xa.add(r),Mv(n))}function Mv(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new K(be.fromString(e)),r=n.qa.next();n.Na.set(r,new g6(t)),n.Oa=n.Oa.insert(t,r),nC(n.remoteStore,new zr(jn(Hf(t.path)),r,"TargetPurposeLimboResolution",On.oe))}}async function Tu(n,e,t){const r=le(n),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(c=>{var u;if((c||t)&&r.isPrimaryClient){const h=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=Sv.Wi(l.targetId,c);i.push(h)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(l,c){const u=le(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>j.forEach(c,p=>j.forEach(p.$i,m=>u.persistence.referenceDelegate.addReference(h,p.targetId,m)).next(()=>j.forEach(p.Ui,m=>u.persistence.referenceDelegate.removeReference(h,p.targetId,m)))))}catch(h){if(!xi(h))throw h;U("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const p=h.targetId;if(!h.fromCache){const m=u.os.get(p),y=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(y);u.os=u.os.insert(p,v)}}}(r.localStore,i))}async function N6(n,e){const t=le(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());const r=await YN(t.localStore,e);t.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new q(F.CANCELLED,o))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Tu(t,r.hs)}}function C6(n,e){const t=le(n),r=t.Na.get(e);if(r&&r.va)return fe().add(r.key);{let s=fe();const i=t.Ma.get(e);if(!i)return s;for(const o of i){const a=t.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}function vC(n){const e=le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=pC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=C6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b6.bind(null,e),e.Ca.d_=h6.bind(null,e.eventManager),e.Ca.$a=f6.bind(null,e.eventManager),e}function xC(n){const e=le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=T6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=S6.bind(null,e),e}class Gc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return JN(this.persistence,new QN,e.initialUser,this.serializer)}Ga(e){return new GN(ep.Zr,this.serializer)}Wa(e){return new ZN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gc.provider={build:()=>new Gc};class A6 extends Gc{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await xC(this.Ja.syncEngine),await bu(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return JN(this.persistence,new QN,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new v3(r,e.asyncQueue,t)}Ha(e,t){const r=new K4(t,this.persistence);return new H4(e.asyncQueue,r)}Ga(e){const t=M3(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?rn.withCacheSize(this.cacheSizeBytes):rn.DEFAULT;return new Tv(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,K3(),Zd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new ZN}}class Yh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>vk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=N6.bind(null,this.syncEngine),await c6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new d6}()}createDatastore(e){const t=tp(e.databaseInfo.databaseId),r=function(i){return new H3(i)}(e.databaseInfo);return function(i,o,a,l){return new J3(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new X3(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>vk(this.syncEngine,t,0),function(){return fk.D()?new fk:new z3}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,u){const h=new y6(s,i,o,a,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=le(s);U("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ku(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Yh.provider={build:()=>new Yh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Wt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=wt.UNAUTHENTICATED,this.clientId=BI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{U("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(U("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Pv(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Rm(n,e){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await YN(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function wk(n,e){n.asyncQueue.verifyOperationInProgress();const t=await P6(n);U("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>pk(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>pk(e.remoteStore,s)),n._onlineComponents=e}async function P6(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{await Rm(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;fo("Error using user provided cache. Falling back to memory cache: "+t),await Rm(n,new Gc)}}else U("FirestoreClient","Using default OfflineComponentProvider"),await Rm(n,new Gc);return n._offlineComponents}async function _C(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),await wk(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),await wk(n,new Yh))),n._onlineComponents}function D6(n){return _C(n).then(e=>e.syncEngine)}async function EC(n){const e=await _C(n),t=e.eventManager;return t.onListen=v6.bind(null,e.syncEngine),t.onUnlisten=_6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=x6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=E6.bind(null,e.syncEngine),t}function M6(n,e,t={}){const r=new vr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new wC({next:p=>{u.Za(),o.enqueueAndForget(()=>cC(i,h));const m=p.docs.has(a);!m&&p.fromCache?c.reject(new q(F.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?c.reject(new q(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new uC(Hf(a.path),u,{includeMetadataChanges:!0,_a:!0});return lC(i,h)}(await EC(n),n.asyncQueue,e,t,r)),r.promise}function O6(n,e,t={}){const r=new vr;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new wC({next:p=>{u.Za(),o.enqueueAndForget(()=>cC(i,h)),p.fromCache&&l.source==="server"?c.reject(new q(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(p)},error:p=>c.reject(p)}),h=new uC(a,u,{includeMetadataChanges:!0,_a:!0});return lC(i,h)}(await EC(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(n,e,t){if(!t)throw new q(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function V6(n,e,t,r){if(e===!0&&r===!0)throw new q(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Ek(n){if(!K.isDocumentKey(n))throw new q(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function kk(n){if(K.isDocumentKey(n))throw new q(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function rp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":X()}function er(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new q(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=rp(n);throw new q(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function j6(n,e){if(e<=0)throw new q(F.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new q(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new q(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}V6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sp{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bk({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new q(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bk(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new M4;switch(r.type){case"firstParty":return new L4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new q(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=_k.get(t);r&&(U("ComponentProvider","Removing Datastore"),_k.delete(t),r.terminate())}(this),Promise.resolve()}}function L6(n,e,t,r={}){var s;const i=(n=er(n,sp))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&fo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=wt.MOCK_USER;else{a=qS(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new q(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new wt(c)}n._authCredentials=new O4(new FI(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _i(this.firestore,e,this._query)}}class Jt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jt(this.firestore,e,this._key)}}class Xs extends _i{constructor(e,t,r){super(e,t,Hf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jt(this.firestore,null,new K(e))}withConverter(e){return new Xs(this.firestore,e,this._path)}}function An(n,e,...t){if(n=at(n),bC("collection","path",e),n instanceof sp){const r=be.fromString(e,...t);return kk(r),new Xs(n,null,r)}{if(!(n instanceof Jt||n instanceof Xs))throw new q(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(be.fromString(e,...t));return kk(r),new Xs(n.firestore,null,r)}}function Qe(n,e,...t){if(n=at(n),arguments.length===1&&(e=BI.newId()),bC("doc","path",e),n instanceof sp){const r=be.fromString(e,...t);return Ek(r),new Jt(n,null,new K(r))}{if(!(n instanceof Jt||n instanceof Xs))throw new q(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(be.fromString(e,...t));return Ek(r),new Jt(n.firestore,n instanceof Xs?n.converter:null,new K(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new eC(this,"async_queue_retry"),this.Vu=()=>{const r=Zd();r&&U("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Zd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Zd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new vr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!xi(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Wt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=Rv.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&X()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Do extends sp{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Tk,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Tk(e),this._firestoreClient=void 0,await e}}}function F6(n,e){const t=typeof n=="object"?n:Z0(),r=typeof n=="string"?n:"(default)",s=Ff(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=US("firestore");i&&L6(s,...i)}return s}function Ov(n){if(n._terminated)throw new q(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||TC(n),n._firestoreClient}function TC(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,u){return new mF(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,kC(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new R6(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function B6(n,e){fo("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return $6(n,Yh.provider,{build:r=>new A6(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function $6(n,e,t){if((n=er(n,Do))._firestoreClient||n._terminated)throw new q(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new q(F.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},TC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wa(nt.fromBase64String(e))}catch(t){throw new q(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wa(nt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new q(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new q(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new q(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=/^__.*__$/;class z6{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new us(e,this.data,this.fieldMask,t,this.fieldTransforms):new il(e,this.data,t,this.fieldTransforms)}}class SC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new us(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}class Lv{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Lv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Xh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(IC(this.Cu)&&U6.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class W6{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||tp(e)}Qu(e,t,r,s=!1){return new Lv({Cu:e,methodName:t,qu:r,path:Be.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fv(n){const e=n._freezeSettings(),t=tp(n._databaseId);return new W6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function q6(n,e,t,r,s,i={}){const o=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);$v("Data must be an object, but it was:",o,r);const a=NC(r,o);let l,c;if(i.merge)l=new an(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const p=Iy(e,h,t);if(!o.contains(p))throw new q(F.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);AC(u,p)||u.push(p)}l=new an(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new z6(new Ot(a),l,c)}class ap extends op{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ap}}class Bv extends op{_toFieldTransform(e){return new xN(e.path,new Fa)}isEqual(e){return e instanceof Bv}}function H6(n,e,t,r){const s=n.Qu(1,e,t);$v("Data must be an object, but it was:",s,r);const i=[],o=Ot.empty();Ro(r,(l,c)=>{const u=Uv(e,l,t);c=at(c);const h=s.Nu(u);if(c instanceof ap)i.push(u);else{const p=Su(c,h);p!=null&&(i.push(u),o.set(u,p))}});const a=new an(i);return new SC(o,a,s.fieldTransforms)}function K6(n,e,t,r,s,i){const o=n.Qu(1,e,t),a=[Iy(e,r,t)],l=[s];if(i.length%2!=0)throw new q(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(Iy(e,i[p])),l.push(i[p+1]);const c=[],u=Ot.empty();for(let p=a.length-1;p>=0;--p)if(!AC(c,a[p])){const m=a[p];let y=l[p];y=at(y);const v=o.Nu(m);if(y instanceof ap)c.push(m);else{const w=Su(y,v);w!=null&&(c.push(m),u.set(m,w))}}const h=new an(c);return new SC(u,h,o.fieldTransforms)}function G6(n,e,t,r=!1){return Su(t,n.Qu(r?4:3,e))}function Su(n,e){if(CC(n=at(n)))return $v("Unsupported field value:",e,n),NC(n,e);if(n instanceof op)return function(r,s){if(!IC(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Su(a,s.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=at(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OF(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ue.fromDate(r);return{timestampValue:Ua(s.serializer,i)}}if(r instanceof Ue){const i=new Ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ua(s.serializer,i)}}if(r instanceof Vv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Wa)return{bytesValue:SN(s.serializer,r._byteString)};if(r instanceof Jt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:_v(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof jv)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return gv(a.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${rp(r)}`)}(n,e)}function NC(n,e){const t={};return JI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ro(n,(r,s)=>{const i=Su(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function CC(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ue||n instanceof Vv||n instanceof Wa||n instanceof Jt||n instanceof op||n instanceof jv)}function $v(n,e,t){if(!CC(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=rp(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Iy(n,e,t){if((e=at(e))instanceof ip)return e._internalPath;if(typeof e=="string")return Uv(n,e);throw Xh("Field path arguments must be of type string or ",n,!1,void 0,t)}const Q6=new RegExp("[~\\*/\\[\\]]");function Uv(n,e,t){if(e.search(Q6)>=0)throw Xh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ip(...e.split("."))._internalPath}catch{throw Xh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xh(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new q(F.INVALID_ARGUMENT,a+n+l)}function AC(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new J6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class J6 extends RC{data(){return super.data()}}function lp(n,e){return typeof e=="string"?Uv(n,e):e instanceof ip?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y6(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new q(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zv{}class Wv extends zv{}function Rn(n,e,...t){let r=[];e instanceof zv&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof qv).length,a=i.filter(l=>l instanceof cp).length;if(o>1||o>0&&a>0)throw new q(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class cp extends Wv{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new cp(e,t,r)}_apply(e){const t=this._parse(e);return PC(e._query,t),new _i(e.firestore,e.converter,gy(e._query,t))}_parse(e){const t=Fv(e.firestore);return function(i,o,a,l,c,u,h){let p;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new q(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Nk(h,u);const m=[];for(const y of h)m.push(Ik(l,i,y));p={arrayValue:{values:m}}}else p=Ik(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Nk(h,u),p=G6(a,o,h,u==="in"||u==="not-in");return ge.create(c,u,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dt(n,e,t){const r=e,s=lp("where",n);return cp._create(s,r,t)}class qv extends zv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qv(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Se.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)PC(o,l),o=gy(o,l)}(e._query,t),new _i(e.firestore,e.converter,gy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hv extends Wv{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hv(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new q(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new q(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hc(i,o)}(e._query,this._field,this._direction);return new _i(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new sl(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function Wr(n,e="asc"){const t=e,r=lp("orderBy",n);return Hv._create(r,t)}class Kv extends Wv{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Kv(e,t,r)}_apply(e){return new _i(e.firestore,e.converter,Wh(e._query,this._limit,this._limitType))}}function Sk(n){return j6("limit",n),Kv._create("limit",n,"F")}function Ik(n,e,t){if(typeof(t=at(t))=="string"){if(t==="")throw new q(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lN(e)&&t.indexOf("/")!==-1)throw new q(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(be.fromString(t));if(!K.isDocumentKey(r))throw new q(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wc(n,new K(r))}if(t instanceof Jt)return Wc(n,t._key);throw new q(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rp(t)}.`)}function Nk(n,e){if(!Array.isArray(n)||n.length===0)throw new q(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PC(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new q(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new q(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class X6{convertValue(e,t="none"){switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ve(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw X()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ro(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>Ve(o.doubleValue));return new jv(i)}convertGeoPoint(e){return new Vv(Ve(e.latitude),Ve(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=pv(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Uc(e));default:return null}}convertTimestamp(e){const t=rs(e);return new Ue(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=be.fromString(e);Z(VN(r));const s=new po(r.get(1),r.get(3)),i=new K(r.popFirst(5));return s.isEqual(t)||Wt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z6(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class DC extends RC{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(lp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class eh extends DC{data(e={}){return super.data(e)}}class eB{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Gl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new eh(this._firestore,this._userDataWriter,r.key,r,new Gl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new q(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new eh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Gl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new eh(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Gl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:tB(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function tB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(n){n=er(n,Jt);const e=er(n.firestore,Do);return M6(Ov(e),n._key).then(t=>nB(e,n,t))}class MC extends X6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Jt(this.firestore,null,t)}}function Pn(n){n=er(n,_i);const e=er(n.firestore,Do),t=Ov(e),r=new MC(e);return Y6(n._query),O6(t,n._query).then(s=>new eB(e,r,n,s))}function xr(n,e,t){n=er(n,Jt);const r=er(n.firestore,Do),s=Z6(n.converter,e,t);return Qv(r,[q6(Fv(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Ht.none())])}function OC(n,e,t,...r){n=er(n,Jt);const s=er(n.firestore,Do),i=Fv(s);let o;return o=typeof(e=at(e))=="string"||e instanceof ip?K6(i,"updateDoc",n._key,e,t,r):H6(i,"updateDoc",n._key,e),Qv(s,[o.toMutation(n._key,Ht.exists(!0))])}function qa(n){return Qv(er(n.firestore,Do),[new Jf(n._key,Ht.none())])}function Qv(n,e){return function(r,s){const i=new vr;return r.asyncQueue.enqueueAndForget(async()=>k6(await D6(r),s,i)),i.promise}(Ov(n),e)}function nB(n,e,t){const r=t.docs.get(e._key),s=new MC(n);return new DC(n,s,e._key,r,new Gl(t.hasPendingWrites,t.fromCache),e.converter)}function Yn(){return new Bv("serverTimestamp")}(function(e,t=!0){(function(s){rl=s})(Co),lo(new oi("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Do(new V4(r.getProvider("auth-internal")),new B4(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new q(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new po(c.options.projectId,u)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),mr(wE,"4.7.3",e),mr(wE,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC="firebasestorage.googleapis.com",rB="storageBucket",sB=2*60*1e3,iB=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr extends br{constructor(e,t,r=0){super(Pm(e),`Firebase Storage: ${t} (${Pm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Tr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var _r;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(_r||(_r={}));function Pm(n){return"storage/"+n}function oB(){const n="An unknown error occurred, please check the error payload for server response.";return new Tr(_r.UNKNOWN,n)}function aB(){return new Tr(_r.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function lB(){return new Tr(_r.CANCELED,"User canceled the upload/download.")}function cB(n){return new Tr(_r.INVALID_URL,"Invalid URL '"+n+"'.")}function uB(n){return new Tr(_r.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Ck(n){return new Tr(_r.INVALID_ARGUMENT,n)}function jC(){return new Tr(_r.APP_DELETED,"The Firebase app was deleted.")}function dB(n){return new Tr(_r.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Gn.makeFromUrl(e,t)}catch{return new Gn(e,"")}if(r.path==="")return r;throw uB(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(C){C.path_=decodeURIComponent(C.path)}const u="v[A-Za-z0-9_]+",h=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${s}/o${p}`,"i"),y={bucket:1,path:3},v=t===VC?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",k=new RegExp(`^https?://${v}/${s}/${w}`,"i"),T=[{regex:a,indices:l,postModify:i},{regex:m,indices:y,postModify:c},{regex:k,indices:{bucket:1,path:2},postModify:c}];for(let C=0;C<T.length;C++){const P=T[C],D=P.regex.exec(e);if(D){const _=D[P.indices.bucket];let E=D[P.indices.path];E||(E=""),r=new Gn(_,E),P.postModify(r);break}}if(r==null)throw cB(e);return r}}class hB{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fB(n,e,t){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...w){c||(c=!0,e.apply(null,w))}function h(w){s=setTimeout(()=>{s=null,n(m,l())},w)}function p(){i&&clearTimeout(i)}function m(w,...k){if(c){p();return}if(w){p(),u.call(null,w,...k);return}if(l()||o){p(),u.call(null,w,...k);return}r<64&&(r*=2);let T;a===1?(a=2,T=0):T=(r+Math.random())*1e3,h(T)}let y=!1;function v(w){y||(y=!0,p(),!c&&(s!==null?(w||(a=2),clearTimeout(s),h(0)):w||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,v(!0)},t),v}function pB(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(n){return n!==void 0}function Ak(n,e,t,r){if(r<e)throw Ck(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ck(`Invalid value for '${n}'. Expected ${t} or less.`)}function gB(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var Zh;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Zh||(Zh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vB{constructor(e,t,r,s,i,o,a,l,c,u,h,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,y)=>{this.resolve_=m,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new wd(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Zh.NO_ERROR,l=i.getStatus();if(!a||yB(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Zh.ABORT;r(!1,new wd(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new wd(c,i))})},t=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());mB(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=oB();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?jC():lB();o(l)}else{const l=aB();o(l)}};this.canceled_?t(!1,new wd(!1,null,!0)):this.backoffId_=fB(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&pB(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class wd{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function xB(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function wB(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function _B(n,e){e&&(n["X-Firebase-GMPID"]=e)}function EB(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function kB(n,e,t,r,s,i,o=!0){const a=gB(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return _B(c,e),xB(c,t),wB(c,i),EB(c,r),new vB(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bB(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function TB(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,t){this._service=e,t instanceof Gn?this._location=t:this._location=Gn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ef(e,t)}get root(){const e=new Gn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return TB(this._location.path)}get storage(){return this._service}get parent(){const e=bB(this._location.path);if(e===null)return null;const t=new Gn(this._location.bucket,e);return new ef(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw dB(e)}}function Rk(n,e){const t=e==null?void 0:e[rB];return t==null?null:Gn.makeFromBucketSpec(t,n)}function SB(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:qS(s,n.app.options.projectId))}class IB{constructor(e,t,r,s,i){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=VC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=sB,this._maxUploadRetryTime=iB,this._requests=new Set,s!=null?this._bucket=Gn.makeFromBucketSpec(s,this._host):this._bucket=Rk(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Gn.makeFromBucketSpec(this._url,e):this._bucket=Rk(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ak("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ak("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ef(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new hB(jC());{const o=kB(e,this._appId,r,s,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const Pk="@firebase/storage",Dk="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="storage";function NB(n=Z0(),e){n=at(n);const r=Ff(n,LC).getImmediate({identifier:e}),s=US("storage");return s&&CB(r,...s),r}function CB(n,e,t,r={}){SB(n,e,t,r)}function AB(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new IB(t,r,s,e,Co)}function RB(){lo(new oi(LC,AB,"PUBLIC").setMultipleInstances(!0)),mr(Pk,Dk,""),mr(Pk,Dk,"esm2017")}RB();const PB={apiKey:"AIzaSyA27iKEalAwT1wgZFkfYNzqTpyIh7DfL10",authDomain:"personal-development-d15b5.firebaseapp.com",projectId:"personal-development-d15b5",storageBucket:"personal-development-d15b5.firebasestorage.app",messagingSenderId:"926131095327",appId:"1:926131095327:web:f11083575d57529d3a522a"},Jv=JS(PB),Ml=A4(Jv),xe=F6(Jv);NB(Jv);B6(xe).catch(n=>{n.code==="failed-precondition"?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):n.code==="unimplemented"&&console.warn("The current browser does not support offline persistence.")});const DB=["pmdunn78@gmail.com"],FC=O.createContext({}),fn=()=>{const n=O.useContext(FC);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},MB=({children:n})=>{const[e,t]=O.useState(null),[r,s]=O.useState(!0),[i,o]=O.useState(null),a=async(y,v)=>{if(!DB.includes(y.toLowerCase()))throw new Error("This email is not authorized to create an account.");try{const{user:w}=await pL(Ml,y,v);await xr(Qe(xe,"users",w.uid),{email:w.email,createdAt:Yn(),settings:{theme:"light",emailNotifications:!0,journalReminders:!1}});const k=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"];for(const b of k)await xr(Qe(xe,"lifeSubsections",`${w.uid}_${b}`),{name:b,userId:w.uid,winState:{description:"",targetValue:0,currentValue:0,unit:"",metrics:[]},createdAt:Yn()});return se.success("Account created successfully!"),w}catch(w){throw console.error("Signup error:",w),se.error(w.message),w}},l=async(y,v)=>{try{const{user:w}=await mL(Ml,y,v);return se.success("Welcome back!"),w}catch(w){throw console.error("Login error:",w),se.error("Invalid email or password"),w}},c=async()=>{try{await xL(Ml),se.success("Logged out successfully")}catch(y){throw console.error("Logout error:",y),se.error("Error logging out"),y}},u=async y=>{try{await fL(Ml,y),se.success("Password reset email sent!")}catch(v){throw console.error("Password reset error:",v),se.error("Error sending password reset email"),v}},h=async y=>{try{const v=await Gv(Qe(xe,"users",y));v.exists()&&o({id:v.id,...v.data()})}catch(v){console.error("Error fetching user profile:",v)}},p=async y=>{if(e)try{const v={settings:{theme:y.theme,emailNotifications:y.emailNotifications,journalReminders:y.journalReminders,goalDeadlineAlerts:y.goalDeadlineAlerts,weeklyReports:y.weeklyReports}};y.displayName!==void 0&&(v.displayName=y.displayName),await xr(Qe(xe,"users",e.uid),v,{merge:!0}),o(w=>({...w,...v})),se.success("Settings updated")}catch(v){throw console.error("Error updating settings:",v),se.error("Failed to update settings"),v}};O.useEffect(()=>vL(Ml,async v=>{t(v),v?await h(v.uid):o(null),s(!1)}),[]);const m={currentUser:e,userProfile:i,signup:a,login:l,logout:c,resetPassword:u,updateUserSettings:p,loading:r};return f.jsx(FC.Provider,{value:m,children:n})},BC=O.createContext({}),$C=()=>{const n=O.useContext(BC);if(!n)throw new Error("useTheme must be used within a ThemeProvider");return n},OB=({children:n})=>{const[e,t]=O.useState(()=>{const a=localStorage.getItem("theme");return a||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});O.useEffect(()=>{const a=window.document.documentElement;a.classList.remove("light","dark"),a.classList.add(e),localStorage.setItem("theme",e)},[e]);const o={theme:e,toggleTheme:()=>{t(a=>a==="light"?"dark":"light")},setLightTheme:()=>t("light"),setDarkTheme:()=>t("dark"),isDark:e==="dark",isLight:e==="light"};return f.jsx(BC.Provider,{value:o,children:n})};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jB=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Mk=n=>{const e=jB(n);return e.charAt(0).toUpperCase()+e.slice(1)},UC=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),LB=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var FB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=O.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...a},l)=>O.createElement("svg",{ref:l,...FB,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:UC("lucide",s),...!i&&!LB(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>O.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=(n,e)=>{const t=O.forwardRef(({className:r,...s},i)=>O.createElement(BB,{ref:i,iconNode:e,className:UC(`lucide-${VB(Mk(n))}`,`lucide-${n}`,r),...s}));return t.displayName=Mk(n),t};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],UB=re("award",$B);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]],WB=re("bed",zB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qB=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],HB=re("bell",qB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],GB=re("bold",KB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QB=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Yi=re("book-open",QB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wo=re("calendar",JB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Yv=re("chevron-down",YB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ny=re("chevron-right",XB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],e$=re("chevron-up",ZB);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],n$=re("circle-check",t$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],s$=re("circle",r$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],zC=re("clock",i$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o$=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],a$=re("coffee",o$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l$=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],c$=re("dollar-sign",l$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u$=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],WC=re("download",u$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],h$=re("eye-off",d$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],p$=re("eye",f$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m$=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],g$=re("flag",m$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],v$=re("grid-3x3",y$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x$=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],w$=re("italic",x$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _$=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],E$=re("link-2",_$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k$=[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]],b$=re("list-ordered",k$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T$=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],qC=re("list",T$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S$=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Cy=re("loader-circle",S$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I$=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],N$=re("lock",I$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C$=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ay=re("log-out",C$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A$=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ry=re("mail",A$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R$=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],P$=re("menu",R$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D$=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],Xv=re("moon",D$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M$=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],up=re("pen",M$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O$=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],tr=re("plus",O$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V$=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],j$=re("redo",V$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L$=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Qc=re("save",L$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F$=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],B$=re("search",F$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $$=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],U$=re("settings",$$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z$=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],W$=re("shield",z$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q$=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],HC=re("square-check-big",q$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],K$=re("square",H$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G$=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],tf=re("sun",G$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q$=[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],J$=re("sunrise",Q$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y$=[["path",{d:"M12 10V2",key:"16sf7g"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m16 6-4 4-4-4",key:"6wukr"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]],X$=re("sunset",Y$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z$=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],KC=re("tag",Z$);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ui=re("target",eU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_o=re("trash-2",tU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],rU=re("trending-down",nU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sU=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Zv=re("trending-up",sU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iU=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oU=re("triangle-alert",iU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],lU=re("trophy",aU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cU=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],uU=re("underline",cU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dU=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],hU=re("undo",dU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fU=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],GC=re("user",fU);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pU=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ss=re("x",pU),mU=()=>{const[n,e]=O.useState(""),[t,r]=O.useState(""),[s,i]=O.useState(!1),[o,a]=O.useState(!1),[l,c]=O.useState(!1),[u,h]=O.useState(!1),{login:p,signup:m,resetPassword:y}=fn(),v=async k=>{if(k.preventDefault(),!n||!t){se.error("Please fill in all fields");return}c(!0);try{o?await m(n,t):await p(n,t)}catch(b){console.error("Auth error:",b)}finally{c(!1)}},w=async k=>{if(k.preventDefault(),!n){se.error("Please enter your email address");return}c(!0);try{await y(n),h(!1)}catch(b){console.error("Reset password error:",b)}finally{c(!1)}};return u?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-4",children:f.jsx("div",{className:"max-w-md w-full",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Reset Password"}),f.jsxs("form",{onSubmit:w,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"email",value:n,onChange:k=>e(k.target.value),className:"input pl-10",placeholder:"you@example.com",disabled:l}),f.jsx(Ry,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),f.jsx("button",{type:"submit",disabled:l,className:"w-full btn-primary flex items-center justify-center",children:l?f.jsx(Cy,{className:"h-5 w-5 animate-spin"}):"Send Reset Email"}),f.jsx("button",{type:"button",onClick:()=>h(!1),className:"w-full text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:"Back to login"})]})]})})}):f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 px-4",children:f.jsx("div",{className:"max-w-md w-full",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:o?"Create Account":"Welcome Back"}),f.jsxs("form",{onSubmit:v,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"email",value:n,onChange:k=>e(k.target.value),className:"input pl-10",placeholder:"you@example.com",disabled:l}),f.jsx(Ry,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:s?"text":"password",value:t,onChange:k=>r(k.target.value),className:"input pl-10 pr-10",placeholder:"",disabled:l}),f.jsx(N$,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),f.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-2.5",children:s?f.jsx(h$,{className:"h-5 w-5 text-gray-400"}):f.jsx(p$,{className:"h-5 w-5 text-gray-400"})})]})]}),!o&&f.jsx("div",{className:"text-right",children:f.jsx("button",{type:"button",onClick:()=>h(!0),className:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:"Forgot password?"})}),f.jsx("button",{type:"submit",disabled:l,className:"w-full btn-primary flex items-center justify-center",children:l?f.jsx(Cy,{className:"h-5 w-5 animate-spin"}):o?"Sign Up":"Sign In"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("button",{onClick:()=>a(!o),className:"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:o?"Already have an account? Sign in":"Don't have an account? Sign up"})}),o&&f.jsx("div",{className:"mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:f.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200",children:"Note: Only whitelisted emails can create accounts. Contact the administrator if you need access."})})]})})})},gU=({children:n})=>{const{currentUser:e,loading:t}=fn();return t?f.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Cy,{className:"h-12 w-12 animate-spin text-primary-600 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading..."})]})}):e?f.jsx(f.Fragment,{children:n}):f.jsx(mU,{})},yU=()=>{var m;const{currentUser:n,userProfile:e,logout:t}=fn(),{theme:r,toggleTheme:s}=$C(),[i,o]=O.useState(!1),[a,l]=O.useState(!1),c=hu(),u=[{name:"Dashboard",href:"/"},{name:"Journal",href:"/journal"},{name:"Goals",href:"/goals"},{name:"My Week",href:"/my-week"},{name:"Expenses",href:"/expenses"},{name:"Stats",href:"/stats"}],h=[{name:"Finances",href:"/subsection/finances"},{name:"Fitness",href:"/subsection/fitness"},{name:"Jiu Jitsu",href:"/subsection/jiu-jitsu"},{name:"Women",href:"/subsection/women"},{name:"Attractiveness",href:"/subsection/attractiveness"},{name:"Nutrition",href:"/subsection/nutrition"},{name:"Philosophy",href:"/subsection/philosophy"},{name:"Languages",href:"/subsection/languages"}],p=y=>c.pathname===y;return f.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-md sticky top-0 z-50",children:f.jsxs("nav",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[f.jsxs("div",{className:"flex justify-between h-16",children:[f.jsxs("div",{className:"flex",children:[f.jsx("div",{className:"flex-shrink-0 flex items-center",children:f.jsxs(gn,{to:"/",className:"flex items-center space-x-2",children:[f.jsx(ui,{className:"h-8 w-8 text-primary-600"}),f.jsx("span",{className:"font-bold text-xl text-gray-900 dark:text-white hidden sm:block",children:"PDT"})]})}),f.jsxs("div",{className:"hidden md:ml-8 md:flex md:space-x-4",children:[u.map(y=>f.jsx(gn,{to:y.href,className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors ${p(y.href)?"text-primary-600 bg-primary-50 dark:text-primary-400 dark:bg-primary-900/20":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:y.name},y.name)),f.jsxs("div",{className:"relative group inline-flex",children:[f.jsxs("button",{className:"inline-flex items-center px-3 py-2 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:["Life Areas",f.jsx(Yv,{className:"ml-1 h-4 w-4"})]}),f.jsx("div",{className:"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200",children:f.jsx("div",{className:"py-1",children:h.map(y=>f.jsx(gn,{to:y.href,className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:y.name},y.name))})})]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("button",{onClick:s,className:"p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Toggle theme",children:r==="light"?f.jsx(Xv,{className:"h-5 w-5"}):f.jsx(tf,{className:"h-5 w-5"})}),f.jsxs("div",{className:"hidden md:block relative",children:[f.jsxs("button",{onClick:()=>l(!a),className:"flex items-center space-x-2 p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[f.jsx(GC,{className:"h-5 w-5"}),f.jsx("span",{className:"text-sm",children:(e==null?void 0:e.displayName)||((m=n==null?void 0:n.email)==null?void 0:m.split("@")[0])})]}),a&&f.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5",children:f.jsxs("div",{className:"py-1",children:[f.jsxs(gn,{to:"/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>l(!1),children:[f.jsx(U$,{className:"h-4 w-4 mr-2"}),"Settings"]}),f.jsxs("button",{onClick:()=>{t(),l(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[f.jsx(Ay,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})})]}),f.jsx("button",{onClick:()=>o(!i),className:"md:hidden p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:i?f.jsx(ss,{className:"h-6 w-6"}):f.jsx(P$,{className:"h-6 w-6"})})]})]}),i&&f.jsx("div",{className:"md:hidden py-4 border-t border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"space-y-1",children:[u.map(y=>f.jsx(gn,{to:y.href,className:`block px-3 py-2 rounded-md text-base font-medium ${p(y.href)?"text-primary-600 bg-primary-50 dark:text-primary-400 dark:bg-primary-900/20":"text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:()=>o(!1),children:y.name},y.name)),f.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-2 mt-2",children:[f.jsx("p",{className:"px-3 py-1 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Life Areas"}),h.map(y=>f.jsx(gn,{to:y.href,className:"block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>o(!1),children:y.name},y.name))]}),f.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-2 mt-2",children:[f.jsx(gn,{to:"/settings",className:"block px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>o(!1),children:"Settings"}),f.jsx("button",{onClick:()=>{t(),o(!1)},className:"block w-full text-left px-3 py-2 text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700",children:"Sign Out"})]})]})})]})})};function Je(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function nr(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function Py(n,e){const t=Je(n);return isNaN(e)?nr(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function vU(n,e){const t=Je(n);if(isNaN(e))return nr(n,NaN);if(!e)return t;const r=t.getDate(),s=nr(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const i=s.getDate();return r>=i?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const QC=6048e5,xU=864e5;let wU={};function Iu(){return wU}function di(n,e){var a,l,c,u;const t=Iu(),r=(e==null?void 0:e.weekStartsOn)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Je(n),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function nf(n){return di(n,{weekStartsOn:1})}function JC(n){const e=Je(n),t=e.getFullYear(),r=nr(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=nf(r),i=nr(n,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const o=nf(i);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Ok(n){const e=Je(n);return e.setHours(0,0,0,0),e}function Vk(n){const e=Je(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function _U(n,e){const t=Ok(n),r=Ok(e),s=+t-Vk(t),i=+r-Vk(r);return Math.round((s-i)/xU)}function EU(n){const e=JC(n),t=nr(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),nf(t)}function ex(n){return nr(n,Date.now())}function kU(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function bU(n){if(!kU(n)&&typeof n!="number")return!1;const e=Je(n);return!isNaN(Number(e))}function rf(n){const e=Je(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function sf(n){const e=Je(n);return e.setDate(1),e.setHours(0,0,0,0),e}function TU(n){const e=Je(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function YC(n){const e=Je(n),t=nr(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function SU(n,e){var a,l;const t=Iu(),r=t.weekStartsOn??((l=(a=t.locale)==null?void 0:a.options)==null?void 0:l.weekStartsOn)??0,s=Je(n),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const IU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},NU=(n,e,t)=>{let r;const s=IU[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function Dm(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const CU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},AU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},RU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},PU={date:Dm({formats:CU,defaultWidth:"full"}),time:Dm({formats:AU,defaultWidth:"full"}),dateTime:Dm({formats:RU,defaultWidth:"full"})},DU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},MU=(n,e,t,r)=>DU[n];function Ol(n){return(e,t)=>{const r=t!=null&&t.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,a=t!=null&&t.width?String(t.width):o;s=n.formattingValues[a]||n.formattingValues[o]}else{const o=n.defaultWidth,a=t!=null&&t.width?String(t.width):n.defaultWidth;s=n.values[a]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(e):e;return s[i]}}const OU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},VU={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},jU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},LU={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},FU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},BU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},$U=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},UU={ordinalNumber:$U,era:Ol({values:OU,defaultWidth:"wide"}),quarter:Ol({values:VU,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Ol({values:jU,defaultWidth:"wide"}),day:Ol({values:LU,defaultWidth:"wide"}),dayPeriod:Ol({values:FU,defaultWidth:"wide",formattingValues:BU,defaultFormattingWidth:"wide"})};function Vl(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(a)?WU(a,h=>h.test(o)):zU(a,h=>h.test(o));let c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function zU(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function WU(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function qU(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],i=e.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const HU=/^(\d+)(th|st|nd|rd)?/i,KU=/\d+/i,GU={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},QU={any:[/^b/i,/^(a|c)/i]},JU={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},YU={any:[/1/i,/2/i,/3/i,/4/i]},XU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ZU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},e5={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},t5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},n5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},r5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},s5={ordinalNumber:qU({matchPattern:HU,parsePattern:KU,valueCallback:n=>parseInt(n,10)}),era:Vl({matchPatterns:GU,defaultMatchWidth:"wide",parsePatterns:QU,defaultParseWidth:"any"}),quarter:Vl({matchPatterns:JU,defaultMatchWidth:"wide",parsePatterns:YU,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Vl({matchPatterns:XU,defaultMatchWidth:"wide",parsePatterns:ZU,defaultParseWidth:"any"}),day:Vl({matchPatterns:e5,defaultMatchWidth:"wide",parsePatterns:t5,defaultParseWidth:"any"}),dayPeriod:Vl({matchPatterns:n5,defaultMatchWidth:"any",parsePatterns:r5,defaultParseWidth:"any"})},i5={code:"en-US",formatDistance:NU,formatLong:PU,formatRelative:MU,localize:UU,match:s5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function o5(n){const e=Je(n);return _U(e,YC(e))+1}function a5(n){const e=Je(n),t=+nf(e)-+EU(e);return Math.round(t/QC)+1}function XC(n,e){var u,h,p,m;const t=Je(n),r=t.getFullYear(),s=Iu(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(p=s.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,o=nr(n,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const a=di(o,e),l=nr(n,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=di(l,e);return t.getTime()>=a.getTime()?r+1:t.getTime()>=c.getTime()?r:r-1}function l5(n,e){var a,l,c,u;const t=Iu(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(a=e==null?void 0:e.locale)==null?void 0:a.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((u=(c=t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=XC(n,e),i=nr(n,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),di(i,e)}function c5(n,e){const t=Je(n),r=+di(t,e)-+l5(t,e);return Math.round(r/QC)+1}function Te(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const vs={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return Te(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Te(t+1,2)},d(n,e){return Te(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Te(n.getHours()%12||12,e.length)},H(n,e){return Te(n.getHours(),e.length)},m(n,e){return Te(n.getMinutes(),e.length)},s(n,e){return Te(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return Te(s,e.length)}},Wo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},jk={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return vs.y(n,e)},Y:function(n,e,t,r){const s=XC(n,r),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return Te(o,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):Te(i,e.length)},R:function(n,e){const t=JC(n);return Te(t,e.length)},u:function(n,e){const t=n.getFullYear();return Te(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return Te(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return Te(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return vs.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return Te(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=c5(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):Te(s,e.length)},I:function(n,e,t){const r=a5(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):Te(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):vs.d(n,e)},D:function(n,e,t){const r=o5(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):Te(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Te(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Te(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return Te(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=Wo.noon:r===0?s=Wo.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=Wo.evening:r>=12?s=Wo.afternoon:r>=4?s=Wo.morning:s=Wo.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return vs.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):vs.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):Te(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):Te(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):vs.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):vs.s(n,e)},S:function(n,e){return vs.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Fk(r);case"XXXX":case"XX":return Mi(r);case"XXXXX":case"XXX":default:return Mi(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return Fk(r);case"xxxx":case"xx":return Mi(r);case"xxxxx":case"xxx":default:return Mi(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Lk(r,":");case"OOOO":default:return"GMT"+Mi(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Lk(r,":");case"zzzz":default:return"GMT"+Mi(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return Te(r,e.length)},T:function(n,e,t){const r=n.getTime();return Te(r,e.length)}};function Lk(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),i=r%60;return i===0?t+String(s):t+String(s)+e+Te(i,2)}function Fk(n,e){return n%60===0?(n>0?"-":"+")+Te(Math.abs(n)/60,2):Mi(n,e)}function Mi(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Te(Math.trunc(r/60),2),i=Te(r%60,2);return t+s+e+i}const Bk=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},ZC=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},u5=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return Bk(n,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Bk(r,e)).replace("{{time}}",ZC(s,e))},d5={p:ZC,P:u5},h5=/^D+$/,f5=/^Y+$/,p5=["D","DD","YY","YYYY"];function m5(n){return h5.test(n)}function g5(n){return f5.test(n)}function y5(n,e,t){const r=v5(n,e,t);if(console.warn(r),p5.includes(n))throw new RangeError(r)}function v5(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const x5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,w5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_5=/^'([^]*?)'?$/,E5=/''/g,k5=/[a-zA-Z]/;function qt(n,e,t){var u,h,p,m;const r=Iu(),s=r.locale??i5,i=r.firstWeekContainsDate??((h=(u=r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,o=r.weekStartsOn??((m=(p=r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??0,a=Je(n);if(!bU(a))throw new RangeError("Invalid time value");let l=e.match(w5).map(y=>{const v=y[0];if(v==="p"||v==="P"){const w=d5[v];return w(y,s.formatLong)}return y}).join("").match(x5).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const v=y[0];if(v==="'")return{isToken:!1,value:b5(y)};if(jk[v])return{isToken:!0,value:y};if(v.match(k5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:y}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(y=>{if(!y.isToken)return y.value;const v=y.value;(g5(v)||m5(v))&&y5(v,e,String(n));const w=jk[v[0]];return w(a,v,s.localize,c)}).join("")}function b5(n){const e=n.match(_5);return e?e[1].replace(E5,"'"):n}function T5(n,e,t){const r=di(n,t),s=di(e,t);return+r==+s}function S5(n,e){const t=Je(n),r=Je(e);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function I5(n,e){const t=Je(n),r=Je(e);return t.getFullYear()===r.getFullYear()}function N5(n){return S5(n,ex(n))}function C5(n,e){return T5(n,ex(n),e)}function A5(n){return I5(n,ex(n))}function $k(n,e){return Py(n,-e)}function th(n,e){return vU(n,-e)}const Uk=({todos:n,title:e,onAddTodo:t,onToggleTodo:r,onDeleteTodo:s,showDate:i=!0,compact:o=!1})=>{const[a,l]=O.useState(!1),[c,u]=O.useState(""),h=p=>{p.preventDefault(),c.trim()&&(t(c.trim()),u(""),l(!1))};return f.jsxs("div",{className:o?"":"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:e}),!a&&f.jsx("button",{onClick:()=>l(!0),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:f.jsx(tr,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})})]}),a&&f.jsxs("form",{onSubmit:h,className:"flex items-center space-x-2 mb-3",children:[f.jsx("input",{type:"text",value:c,onChange:p=>u(p.target.value),placeholder:"Add a todo...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-primary-500",autoFocus:!0}),f.jsx("button",{type:"submit",className:"p-2 bg-primary-600 text-white rounded hover:bg-primary-700 transition-colors",children:f.jsx(tr,{className:"h-4 w-4"})}),f.jsx("button",{type:"button",onClick:()=>{l(!1),u("")},className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:f.jsx(ss,{className:"h-4 w-4"})})]}),f.jsx("div",{className:`space-y-${o?"1":"2"}`,children:n.length===0?f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No todos yet"}):n.map(p=>f.jsxs("div",{className:`flex items-center space-x-2 ${o?"py-1":"p-2 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg"} transition-colors cursor-pointer group`,onClick:()=>r(p.id),children:[p.completed?f.jsx(HC,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0"}):f.jsx(K$,{className:"h-5 w-5 text-gray-400 dark:text-gray-600 flex-shrink-0"}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:`text-sm ${p.completed?"line-through text-gray-500 dark:text-gray-500":"text-gray-900 dark:text-white"}`,children:p.text}),i&&p.createdAt&&f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Added"," ",qt(p.createdAt.toDate?p.createdAt.toDate():new Date(p.createdAt),"MMM d")]})]}),p.priority&&f.jsx(g$,{className:`h-4 w-4 flex-shrink-0 ${p.priority==="high"?"text-red-500":p.priority==="medium"?"text-yellow-500":"text-gray-400"}`}),f.jsx("button",{onClick:m=>{m.stopPropagation(),s(p.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded transition-all",children:f.jsx(ss,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})})]},p.id))})]})},R5=()=>{var D;const{currentUser:n,userProfile:e}=fn(),[t,r]=O.useState([]),[s,i]=O.useState([]),[o,a]=O.useState([]),[l,c]=O.useState([]),[u,h]=O.useState({totalGoals:0,completedGoals:0,journalStreak:0,weeklyProgress:0}),[p,m]=O.useState(!0),y=[{id:"finances",name:"Finances",icon:"",color:"bg-green-500"},{id:"fitness",name:"Fitness",icon:"",color:"bg-blue-500"},{id:"jiu-jitsu",name:"Jiu Jitsu",icon:"",color:"bg-purple-500"},{id:"women",name:"Women",icon:"",color:"bg-pink-500"},{id:"attractiveness",name:"Attractiveness",icon:"",color:"bg-yellow-500"},{id:"nutrition",name:"Nutrition",icon:"",color:"bg-green-400"},{id:"philosophy",name:"Philosophy",icon:"",color:"bg-indigo-500"},{id:"languages",name:"Languages",icon:"",color:"bg-teal-500"}];O.useEffect(()=>{v()},[n]);const v=async()=>{if(n)try{const _=Rn(An(xe,"goals"),dt("userId","==",n.uid),dt("status","==","active"),Wr("createdAt","desc"),Sk(5)),S=(await Pn(_)).docs.map(ye=>({id:ye.id,...ye.data()}));r(S);const N=Rn(An(xe,"journalEntries"),dt("userId","==",n.uid),Wr("createdAt","desc"),Sk(3)),R=(await Pn(N)).docs.map(ye=>({id:ye.id,...ye.data()}));i(R);const A=Rn(An(xe,"todos"),dt("userId","==",n.uid),dt("type","==","today"),Wr("createdAt","desc")),ke=(await Pn(A)).docs.map(ye=>({id:ye.id.replace(`${n.uid}_`,""),...ye.data()}));a(ke);const H=Rn(An(xe,"todos"),dt("userId","==",n.uid),dt("type","==","weekly"),Wr("createdAt","desc")),B=(await Pn(H)).docs.map(ye=>({id:ye.id.replace(`${n.uid}_`,""),...ye.data()}));c(B);const G=Rn(An(xe,"goals"),dt("userId","==",n.uid)),oe=await Pn(G),Ne=oe.size,_e=oe.docs.filter(ye=>ye.data().status==="completed").length;h({totalGoals:Ne,completedGoals:_e,journalStreak:w(R),weeklyProgress:k(S)})}catch(_){console.error("Error fetching dashboard data:",_)}finally{m(!1)}},w=_=>{var M;if(_.length===0)return 0;const E=new Date,S=((M=_[0].createdAt)==null?void 0:M.toDate())||new Date;return Math.floor((E-S)/(1e3*60*60*24))===0?1:0},k=_=>{if(_.length===0)return 0;const E=_.reduce((S,N)=>S+(N.progress||0),0);return Math.round(E/_.length)},b=async(_,E)=>{if(!n)return;const S=`todo_${Date.now()}`,N={text:_,type:E,completed:!1,userId:n.uid,createdAt:Yn()};try{await xr(Qe(xe,"todos",`${n.uid}_${S}`),N);const M={id:S,...N,createdAt:{toDate:()=>new Date}};E==="today"?a([M,...o]):c([M,...l])}catch(M){console.error("Error adding todo:",M)}},T=async(_,E)=>{if(!n)return;const S=E==="today"?o:l,N=S.find(M=>M.id===_);if(N)try{await OC(Qe(xe,"todos",`${n.uid}_${_}`),{completed:!N.completed});const M=S.map(R=>R.id===_?{...R,completed:!R.completed}:R);E==="today"?a(M):c(M)}catch(M){console.error("Error toggling todo:",M)}},C=async(_,E)=>{if(n)try{await qa(Qe(xe,"todos",`${n.uid}_${_}`)),E==="today"?a(o.filter(S=>S.id!==_)):c(l.filter(S=>S.id!==_))}catch(S){console.error("Error deleting todo:",S)}},P=async _=>{const E=_==="today"?o:l,S=`Are you sure you want to clear all ${_==="today"?"today's":"weekly"} todos? This cannot be undone.`;if(E.length!==0&&confirm(S))try{const N=E.map(M=>qa(Qe(xe,"todos",`${n.uid}_${M.id}`)));await Promise.all(N),_==="today"?a([]):c([]),se.success(`All ${_==="today"?"today's":"weekly"} todos cleared`)}catch(N){console.error("Error clearing todos:",N),se.error("Failed to clear todos")}};return p?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg p-6 text-white",children:[f.jsxs("h1",{className:"text-3xl font-bold mb-2",children:["Welcome back,"," ",(e==null?void 0:e.displayName)||((D=n==null?void 0:n.email)==null?void 0:D.split("@")[0]),"!"]}),f.jsx("p",{className:"opacity-90",children:qt(new Date,"EEEE, MMMM d, yyyy")})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Active Goals"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.length})]}),f.jsx(ui,{className:"h-8 w-8 text-primary-600"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Completed"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:u.completedGoals})]}),f.jsx(UB,{className:"h-8 w-8 text-green-600"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Journal Streak"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[u.journalStreak," days"]})]}),f.jsx(Yi,{className:"h-8 w-8 text-purple-600"})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Weekly Progress"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[u.weeklyProgress,"%"]})]}),f.jsx(Zv,{className:"h-8 w-8 text-blue-600"})]})})]}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Life Areas"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:y.map(_=>f.jsx(gn,{to:`/subsection/${_.id}`,className:"card hover:scale-105 transition-transform duration-200",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:`w-16 h-16 ${_.color} rounded-full flex items-center justify-center text-2xl mb-3`,children:_.icon}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:_.name})]})},_.id))})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Active Goals"}),f.jsxs(gn,{to:"/goals",className:"text-primary-600 hover:text-primary-700 flex items-center text-sm",children:["View all",f.jsx(Ny,{className:"h-4 w-4 ml-1"})]})]}),t.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(ui,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No active goals yet"}),f.jsxs(gn,{to:"/goals",className:"btn-primary inline-flex items-center",children:[f.jsx(tr,{className:"h-4 w-4 mr-2"}),"Create Goal"]})]}):f.jsx("div",{className:"space-y-3",children:t.map(_=>f.jsxs("div",{className:"border-l-4 border-primary-500 pl-4 py-2",children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:_.title}),f.jsxs("div",{className:"flex items-center justify-between mt-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:_.timeframe}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-24 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:f.jsx("div",{className:"h-full bg-primary-500 rounded-full",style:{width:`${_.progress||0}%`}})}),f.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[_.progress||0,"%"]})]})]})]},_.id))})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Recent Journal Entries"}),f.jsxs(gn,{to:"/journal",className:"text-primary-600 hover:text-primary-700 flex items-center text-sm",children:["View all",f.jsx(Ny,{className:"h-4 w-4 ml-1"})]})]}),s.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(Yi,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No journal entries yet"}),f.jsxs(gn,{to:"/journal",className:"btn-primary inline-flex items-center",children:[f.jsx(tr,{className:"h-4 w-4 mr-2"}),"Write Entry"]})]}):f.jsx("div",{className:"space-y-3",children:s.map(_=>{var E;return f.jsxs("div",{className:"border-l-4 border-purple-500 pl-4 py-2",children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:_.title||"Untitled Entry"}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:[(E=_.content)==null?void 0:E.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),f.jsxs("div",{className:"flex items-center mt-2 text-xs text-gray-500 dark:text-gray-400",children:[f.jsx(zC,{className:"h-3 w-3 mr-1"}),_.createdAt&&qt(_.createdAt.toDate(),"MMM d, yyyy")]})]},_.id)})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[f.jsx(HC,{className:"h-5 w-5 mr-2 text-blue-600"}),"Today's Todos"]}),o.length>0&&f.jsxs("button",{onClick:()=>P("today"),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",title:"Clear all today's todos",children:[f.jsx(_o,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),f.jsx(Uk,{todos:o,title:"",onAddTodo:_=>b(_,"today"),onToggleTodo:_=>T(_,"today"),onDeleteTodo:_=>C(_,"today"),showDate:!1,compact:!0})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[f.jsx(wo,{className:"h-5 w-5 mr-2 text-purple-600"}),"Weekly Todos"]}),l.length>0&&f.jsxs("button",{onClick:()=>P("weekly"),className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",title:"Clear all weekly todos",children:[f.jsx(_o,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),f.jsx(Uk,{todos:l,title:"",onAddTodo:_=>b(_,"weekly"),onToggleTodo:_=>T(_,"weekly"),onDeleteTodo:_=>C(_,"weekly"),showDate:!1,compact:!0})]})]})]})};function xt(n){this.content=n}xt.prototype={constructor:xt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new xt(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new xt(t)},addToStart:function(n,e){return new xt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new xt(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new xt(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=xt.from(n),n.size?new xt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=xt.from(n),n.size?new xt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=xt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};xt.from=function(n){if(n instanceof xt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new xt(e)};function eA(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=eA(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function tA(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=tA(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class ${constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new $(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new $(r,s)}cutByIndex(e,t){return e==t?$.empty:e==0&&t==this.content.length?this:new $(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new $(s,i)}addToStart(e){return new $([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new $(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return eA(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return tA(this,e,t,r)}findIndex(e){if(e==0)return _d(0,e);if(e==this.size)return _d(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let s=this.child(t),i=r+s.nodeSize;if(i>=e)return i==e?_d(t+1,i):_d(t,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return $.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new $(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return $.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new $(t||e,r)}static from(e){if(!e)return $.empty;if(e instanceof $)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new $([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}$.empty=new $([],0);const Mm={index:0,offset:0};function _d(n,e){return Mm.index=n,Mm.offset=e,Mm}function of(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!of(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!of(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Re=class Dy{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&of(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let s=r.create(t.attrs);return r.checkAttrs(s.attrs),s}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Dy.none;if(e instanceof Dy)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Re.none=[];class af extends Error{}class Q{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=rA(this.content,e+this.openStart,t);return r&&new Q(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Q(nA(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Q.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Q($.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new Q(e,r,s)}}Q.empty=new Q($.empty,0,0);function nA(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(nA(i.content,e-s-1,t-s-1)))}function rA(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=rA(o.content,e-i-1,t,o);return a&&n.replaceChild(s,o.copy(a))}function P5(n,e,t){if(t.openStart>n.depth)throw new af("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new af("Inconsistent open depths");return sA(n,e,t,0)}function sA(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=sA(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return Zi(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=D5(t,n);return Zi(i,oA(n,o,a,e,r))}else return Zi(i,lf(n,e,r))}function iA(n,e){if(!e.type.compatibleContent(n.type))throw new af("Cannot join "+e.type.name+" onto "+n.type.name)}function My(n,e,t){let r=n.node(t);return iA(r,e.node(t)),r}function Xi(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function fc(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Xi(n.nodeAfter,r),i++));for(let a=i;a<o;a++)Xi(s.child(a),r);e&&e.depth==t&&e.textOffset&&Xi(e.nodeBefore,r)}function Zi(n,e){return n.type.checkContent(e),n.copy(e)}function oA(n,e,t,r,s){let i=n.depth>s&&My(n,e,s+1),o=r.depth>s&&My(t,r,s+1),a=[];return fc(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(iA(i,o),Xi(Zi(i,oA(n,e,t,r,s+1)),a)):(i&&Xi(Zi(i,lf(n,e,s+1)),a),fc(e,t,s,a),o&&Xi(Zi(o,lf(t,r,s+1)),a)),fc(r,null,s,a),new $(a)}function lf(n,e,t){let r=[];if(fc(null,n,t,r),n.depth>t){let s=My(n,e,t+1);Xi(Zi(s,lf(n,e,t+1)),r)}return fc(e,null,t,r),new $(r)}function D5(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy($.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class Jc{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Re.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new cf(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new Jc(t,r,i)}static resolveCached(e,t){let r=zk.get(e);if(r)for(let i=0;i<r.elts.length;i++){let o=r.elts[i];if(o.pos==t)return o}else zk.set(e,r=new M5);let s=r.elts[r.i]=Jc.resolve(e,t);return r.i=(r.i+1)%O5,s}}class M5{constructor(){this.elts=[],this.i=0}}const O5=12,zk=new WeakMap;class cf{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const V5=Object.create(null);let Zs=class Oy{constructor(e,t,r,s=Re.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||$.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&of(this.attrs,t||e.defaultAttrs||V5)&&Re.sameSet(this.marks,r||Re.none)}copy(e=null){return e==this.content?this:new Oy(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Oy(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return Q.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new Q(c,s.depth-o,i.depth-o)}replace(e,t,r){return P5(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return Jc.resolveCached(this,e)}resolveNoCache(e){return Jc.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),aA(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=$.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Re.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Re.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=$.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,s,r);return i.type.checkAttrs(i.attrs),i}};Zs.prototype.text=void 0;class uf extends Zs{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):aA(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new uf(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new uf(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function aA(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Eo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new j5(e,t);if(r.next==null)return Eo.empty;let s=lA(r);r.next&&r.err("Unexpected trailing text");let i=W5(z5(s));return q5(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return $.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:h}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(h)==-1){s.push(h);let p=i(h,a.concat(u));if(p)return p}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Eo.empty=new Eo(!0);class j5{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function lA(n){let e=[];do e.push(L5(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function L5(n){let e=[];do e.push(F5(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function F5(n){let e=U5(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=B5(n,e);else break;return e}function Wk(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function B5(n,e){let t=Wk(n),r=t;return n.eat(",")&&(n.next!="}"?r=Wk(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function $5(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.isInGroup(e)&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function U5(n){if(n.eat("(")){let e=lA(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=$5(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function z5(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function cA(n,e){return e-n}function qk(n,e){let t=[];return r(e),t.sort(cA);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function W5(n){let e=Object.create(null);return t(qk(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);qk(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new Eo(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(cA);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function q5(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function uA(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function dA(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function hA(n,e,t,r){for(let s in e)if(!(s in n))throw new RangeError(`Unsupported attribute ${s} for ${t} of type ${s}`);for(let s in n){let i=n[s];i.validate&&i.validate(e[s])}}function fA(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new K5(n,r,e[r]);return t}let Hk=class pA{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=fA(e,r.attrs),this.defaultAttrs=uA(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Eo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:dA(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Zs(this,this.computeAttrs(e),$.from(t),Re.setFrom(r))}createChecked(e=null,t,r){return t=$.from(t),this.checkContent(t),new Zs(this,this.computeAttrs(e),t,Re.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=$.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore($.empty,!0);return i?new Zs(this,e,t.append(i),Re.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){hA(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Re.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new pA(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function H5(n,e,t){let r=t.split("|");return s=>{let i=s===null?"null":typeof s;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${i}`)}}class K5{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?H5(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class dp{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=fA(e,s.attrs),this.excluded=null;let i=uA(this.attrs);this.instance=i?new Re(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Re(this,dA(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new dp(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){hA(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class mA{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=xt.from(e.nodes),t.marks=xt.from(e.marks||{}),this.nodes=Hk.compile(this.spec.nodes,this),this.marks=dp.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Eo.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?Kk(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:Kk(this,o.split(" "))}this.nodeFromJSON=s=>Zs.fromJSON(this,s),this.markFromJSON=s=>Re.fromJSON(this,s),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Hk){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new uf(r,r.defaultAttrs,e,Re.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Kk(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function G5(n){return n.tag!=null}function Q5(n){return n.style!=null}class ei{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(s=>{if(G5(s))this.tags.push(s);else if(Q5(s)){let i=/[^=]*/.exec(s.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(s)}}),this.normalizeLists=!this.tags.some(s=>{if(!/^(ul|ol)\b/.test(s.tag)||!s.node)return!1;let i=e.nodes[s.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Qk(this,t,!1);return r.addAll(e,Re.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Qk(this,t,!0);return r.addAll(e,Re.none,t.from,t.to),Q.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(X5(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Jk(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Jk(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ei(e,ei.schemaRules(e)))}}const gA={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},J5={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},yA={ol:!0,ul:!0},Yc=1,Vy=2,pc=4;function Gk(n,e,t){return e!=null?(e?Yc:0)|(e==="full"?Vy:0):n&&n.whitespace=="pre"?Yc|Vy:t&~pc}class Ed{constructor(e,t,r,s,i,o){this.type=e,this.attrs=t,this.marks=r,this.solid=s,this.options=o,this.content=[],this.activeMarks=Re.none,this.match=i||(o&pc?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore($.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Yc)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=$.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore($.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!gA.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Qk{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let s=t.topNode,i,o=Gk(null,t.preserveWhitespace,0)|(r?pc:0);s?i=new Ed(s.type,s.attrs,Re.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new Ed(null,null,Re.none,!0,null,o):i=new Ed(e.schema.topNodeType,null,Re.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,s=this.top,i=s.options&Vy?"full":this.localPreserveWS||(s.options&Yc)>0,{schema:o}=this.parser;if(i==="full"||s.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)if(i==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let a=r.split(/\r?\n|\r/);for(let l=0;l<a.length;l++)l&&this.insertNode(o.linebreakReplacement.create(),t,!0),a[l]&&this.insertNode(o.text(a[l]),t,!/\S/.test(a[l]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let a=s.content[s.content.length-1],l=e.previousSibling;(!a||l&&l.nodeName=="BR"||a.isText&&/[ \t\r\n\u000c]$/.test(a.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let s=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),a;yA.hasOwnProperty(o)&&this.parser.normalizeLists&&Y5(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:J5.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(gA.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let h=l&&l.skip?t:this.readStyles(e,t);h&&this.addAll(e,h),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=s}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let s=0;s<this.parser.matchedStyles.length;s++){let i=this.parser.matchedStyles[s],o=r.getPropertyValue(i);if(o)for(let a=void 0;;){let l=this.parser.matchStyle(i,o,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,s){let i,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(o,t.attrs||null,r,t.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(s)this.addElement(e,r,s);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,r,s){let i=r||0;for(let o=r?e.childNodes[r]:e.firstChild,a=s==null?null:e.childNodes[s];o!=a;o=o.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(o,t);this.findAtPoint(e,i)}findPlace(e,t,r){let s,i;for(let o=this.open,a=0;o>=0;o--){let l=this.nodes[o],c=l.findWrapping(e);if(c&&(!s||s.length>c.length+a)&&(s=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!s)return null;this.sync(i);for(let o=0;o<s.length;o++)t=this.enterInner(s[o],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let s=this.findPlace(e,t,r);if(s){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Re.none;for(let a of s.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):Yk(a.type,e.type))&&(o=a.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,s){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,s)),i}enterInner(e,t,r,s=!1,i){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let a=Gk(e,i,o.options);o.options&pc&&o.content.length==0&&(a|=pc);let l=Re.none;return r=r.filter(c=>(o.type?o.type.allowsMarkType(c.type):Yk(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Ed(e,t,l,s,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Yc)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function Y5(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&yA.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function X5(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Jk(n){let e={};for(let t in n)e[t]=n[t];return e}function Yk(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}class Mo{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Om(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=nh(Om(t),this.nodes[e.type.name](e),null,e.attrs);if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&nh(Om(r),s(e,t),null,e.attrs)}static renderSpec(e,t,r=null,s){return nh(e,t,r,s)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Mo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Xk(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Xk(e.marks)}}function Xk(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Om(n){return n.document||window.document}const Zk=new WeakMap;function Z5(n){let e=Zk.get(n);return e===void 0&&Zk.set(n,e=ez(n)),e}function ez(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let s=0;s<r.length;s++)t(r[s]);else for(let s in r)t(r[s])}return t(n),e}function nh(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let s=e[0],i;if(typeof s!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=Z5(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=s.indexOf(" ");o>0&&(t=s.slice(0,o),s=s.slice(o+1));let a,l=t?n.createElementNS(t,s):n.createElement(s),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let h in c)if(c[h]!=null){let p=h.indexOf(" ");p>0?l.setAttributeNS(h.slice(0,p),h.slice(p+1),c[h]):h=="style"&&l.style?l.style.cssText=c[h]:l.setAttribute(h,c[h])}}for(let h=u;h<e.length;h++){let p=e[h];if(p===0){if(h<e.length-1||h>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:m,contentDOM:y}=nh(n,p,t,r);if(l.appendChild(m),y){if(a)throw new RangeError("Multiple content holes");a=y}}}return{dom:l,contentDOM:a}}const vA=65535,xA=Math.pow(2,16);function tz(n,e){return n+e*xA}function e1(n){return n&vA}function nz(n){return(n-(n&vA))/xA}const wA=1,_A=2,rh=4,EA=8;class jy{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&EA)>0}get deletedBefore(){return(this.delInfo&(wA|rh))>0}get deletedAfter(){return(this.delInfo&(_A|rh))>0}get deletedAcross(){return(this.delInfo&rh)>0}}class yn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&yn.empty)return yn.empty}recover(e){let t=0,r=e1(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+nz(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],h=l+c;if(e<=h){let p=c?e==l?-1:e==h?1:t:t,m=l+s+(p<0?0:u);if(r)return m;let y=e==(t<0?l:h)?null:tz(a/3,e-l),v=e==l?_A:e==h?wA:rh;return(t<0?e!=l:e!=h)&&(v|=EA),new jy(m,v,y)}s+=u-c}return r?e+s:new jy(e+s,0,null)}touches(e,t){let r=0,s=e1(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],u=this.ranges[s+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new yn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?yn.empty:new yn(e<0?[0,-e,0]:[0,0,e])}}yn.empty=new yn([]);class Xc{constructor(e,t,r=0,s=e?e.length:0){this.mirror=t,this.from=r,this.to=s,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Xc(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let s=e.getMirror(t);this.appendMap(e._maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e._maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new Xc;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this._maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new jy(e,s,null)}}const Vm=Object.create(null);class Bt{getMap(){return yn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Vm[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Vm)throw new RangeError("Duplicate use of step JSON ID "+e);return Vm[e]=t,t.prototype.jsonID=e,t}}class et{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new et(e,null)}static fail(e){return new et(null,e)}static fromReplace(e,t,r,s){try{return et.ok(e.replace(t,r,s))}catch(i){if(i instanceof af)return et.fail(i.message);throw i}}}function tx(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(tx(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return $.fromArray(r)}class js extends Bt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new Q(tx(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return et.fromReplace(e,this.from,this.to,i)}invert(){return new hr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new js(t.pos,r.pos,this.mark)}merge(e){return e instanceof js&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new js(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new js(t.from,t.to,e.markFromJSON(t.mark))}}Bt.jsonID("addMark",js);class hr extends Bt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new Q(tx(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return et.fromReplace(e,this.from,this.to,r)}invert(){return new js(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new hr(t.pos,r.pos,this.mark)}merge(e){return e instanceof hr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new hr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new hr(t.from,t.to,e.markFromJSON(t.mark))}}Bt.jsonID("removeMark",hr);class Ls extends Bt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return et.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return et.fromReplace(e,this.pos,this.pos+1,new Q($.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new Ls(this.pos,t.marks[s]);return new Ls(this.pos,this.mark)}}return new ko(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ls(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ls(t.pos,e.markFromJSON(t.mark))}}Bt.jsonID("addNodeMark",Ls);class ko extends Bt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return et.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return et.fromReplace(e,this.pos,this.pos+1,new Q($.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Ls(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ko(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ko(t.pos,e.markFromJSON(t.mark))}}Bt.jsonID("removeNodeMark",ko);class ht extends Bt{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&Ly(e,this.from,this.to)?et.fail("Structure replace would overwrite content"):et.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new yn([this.from,this.to-this.from,this.slice.size])}invert(e){return new ht(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ht(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof ht)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?Q.empty:new Q(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ht(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?Q.empty:new Q(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ht(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ht(t.from,t.to,Q.fromJSON(e,t.slice),!!t.structure)}}Bt.jsonID("replace",ht);class pt extends Bt{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Ly(e,this.from,this.gapFrom)||Ly(e,this.gapTo,this.to)))return et.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return et.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?et.fromReplace(e,this.from,this.to,r):et.fail("Content does not fit in gap")}getMap(){return new yn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new pt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new pt(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new pt(t.from,t.to,t.gapFrom,t.gapTo,Q.fromJSON(e,t.slice),t.insert,!!t.structure)}}Bt.jsonID("replaceAround",pt);function Ly(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function rz(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let h=l.marks;if(!r.isInSet(h)&&u.type.allowsMarkType(r.type)){let p=Math.max(c,e),m=Math.min(c+l.nodeSize,t),y=r.addToSet(h);for(let v=0;v<h.length;v++)h[v].isInSet(y)||(o&&o.to==p&&o.mark.eq(h[v])?o.to=m:s.push(o=new hr(p,m,h[v])));a&&a.to==p?a.to=m:i.push(a=new js(p,m,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function sz(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof dp){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let h=l[u],p;for(let m=0;m<s.length;m++){let y=s[m];y.step==i-1&&h.eq(s[m].style)&&(p=y)}p?(p.to=c,p.step=i):s.push({style:h,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new hr(o.from,o.to,o.style)))}function nx(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,h=r.matchType(c.type);if(!h)o.push(new ht(a,u,Q.empty));else{r=h;for(let p=0;p<c.marks.length;p++)t.allowsMarkType(c.marks[p].type)||n.step(new hr(a,u,c.marks[p]));if(s&&c.isText&&t.whitespace!="pre"){let p,m=/\r?\n|\r/g,y;for(;p=m.exec(c.text);)y||(y=new Q($.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new ht(a+p.index,a+p.index+p[0].length,y))}}a=u}if(!r.validEnd){let l=r.fillBefore($.empty,!0);n.replace(a,a,new Q(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function iz(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function al(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!iz(s,i,o))break}return null}function oz(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=$.empty,h=0;for(let y=i,v=!1;y>t;y--)v||r.index(y)>0?(v=!0,u=$.from(r.node(y).copy(u)),h++):l--;let p=$.empty,m=0;for(let y=i,v=!1;y>t;y--)v||s.after(y+1)<s.end(y)?(v=!0,p=$.from(s.node(y).copy(p)),m++):c++;n.step(new pt(l,c,o,a,new Q(u.append(p),h,m),u.size-h,!0))}function rx(n,e,t=null,r=n){let s=az(n,e),i=s&&lz(r,e);return i?s.map(t1).concat({type:e,attrs:t}).concat(i.map(t1)):null}function t1(n){return{type:n,attrs:null}}function az(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function lz(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function cz(n,e,t){let r=$.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=$.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new pt(s,i,s,i,new Q(r,0,0),t.length,!0))}function uz(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{let l=typeof s=="function"?s(o):s;if(o.isTextblock&&!o.hasMarkup(r,l)&&dz(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let m=r.whitespace=="pre",y=!!r.contentMatch.matchType(r.schema.linebreakReplacement);m&&!y?c=!1:!m&&y&&(c=!0)}c===!1&&bA(n,o,a,i),nx(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let u=n.mapping.slice(i),h=u.map(a,1),p=u.map(a+o.nodeSize,1);return n.step(new pt(h,p,h+1,p-1,new Q($.from(r.create(l,null,o.marks)),0,0),1,!0)),c===!0&&kA(n,o,a,i),!1}})}function kA(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function bA(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function dz(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function hz(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new pt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new Q($.from(o),0,0),1,!0))}function Gr(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>i;c--,u--){let h=s.node(c),p=s.index(c);if(h.type.spec.isolating)return!1;let m=h.content.cutByIndex(p,h.childCount),y=r&&r[u+1];y&&(m=m.replaceChild(0,y.type.create(y.attrs)));let v=r&&r[u]||h;if(!h.canReplace(p+1,h.childCount)||!v.type.validContent(m))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function fz(n,e,t=1,r){let s=n.doc.resolve(e),i=$.empty,o=$.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=$.from(s.node(a).copy(i));let u=r&&r[c];o=$.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}n.step(new ht(e,e,new Q(i.append(o),t,t),!0))}function Ei(n,e){let t=n.resolve(e),r=t.index();return TA(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function pz(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let s=0;s<e.childCount;s++){let i=e.child(s),o=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(o),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function TA(n,e){return!!(n&&e&&!n.isLeaf&&pz(n,e))}function hp(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&TA(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function mz(n,e,t){let r=null,{linebreakReplacement:s}=n.doc.type.schema,i=n.doc.resolve(e-t),o=i.node().type;if(s&&o.inlineContent){let u=o.whitespace=="pre",h=!!o.contentMatch.matchType(s);u&&!h?r=!1:!u&&h&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);bA(n,u.node(),u.before(),a)}o.inlineContent&&nx(n,e+t-1,o,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new ht(c,l.map(e+t,-1),Q.empty,!0)),r===!0){let u=n.doc.resolve(c);kA(n,u.node(),u.before(),n.steps.length)}return n}function gz(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function SA(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let h=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=h&&c.canReplaceWith(l,l,h[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function fp(n,e,t=e,r=Q.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return IA(s,i,r)?new ht(e,t,r):new yz(s,i,r).fit()}function IA(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class yz{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=$.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=$.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new Q(i,o,a);return e>-1?new pt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new ht(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=jm(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,h=null;if(t==1&&(o?c.matchType(o.type)||(h=c.fillBefore($.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:h};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=jm(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new Q(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=jm(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new Q(Ql(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new Q(Ql(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let v=0;v<i.length;v++)this.openFrontierNode(i[v]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:h,type:p}=this.frontier[t];if(s){for(let v=0;v<s.childCount;v++)u.push(s.child(v));h=h.matchFragment(s)}let m=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let v=a.child(c),w=h.matchType(v.type);if(!w)break;c++,(c>1||l==0||v.content.size)&&(h=w,u.push(NA(v.mark(p.allowedMarks(v.marks)),c==1?l:0,c==a.childCount?m:-1)))}let y=c==a.childCount;y||(m=-1),this.placed=Jl(this.placed,t,$.from(u)),this.frontier[t].match=h,y&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,w=a;v<m;v++){let k=w.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),w=k.content}this.unplaced=y?e==0?Q.empty:new Q(Ql(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new Q(Ql(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Lm(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Lm(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Lm(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Jl(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Jl(this.placed,this.depth,$.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore($.empty,!0);t.childCount&&(this.placed=Jl(this.placed,this.frontier.length,t))}}function Ql(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Ql(n.firstChild.content,e-1,t)))}function Jl(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Jl(n.lastChild.content,e-1,t)))}function jm(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function NA(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,NA(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore($.empty,!0)))),n.copy(r)}function Lm(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!vz(t,i.content,o)?a:null}function vz(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function xz(n){return n.spec.defining||n.spec.definingForContent}function wz(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if(IA(s,i,r))return n.step(new ht(e,t,r));let o=AA(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let p=s.depth,m=s.pos-1;p>0;p--,m--){let y=s.node(p).type.spec;if(y.defining||y.definingAsContext||y.isolating)break;o.indexOf(p)>-1?a=p:s.before(p)==m&&o.splice(1,0,-p)}let l=o.indexOf(a),c=[],u=r.openStart;for(let p=r.content,m=0;;m++){let y=p.firstChild;if(c.push(y),m==r.openStart)break;p=y.content}for(let p=u-1;p>=0;p--){let m=c[p],y=xz(m.type);if(y&&!m.sameMarkup(s.node(Math.abs(a)-1)))u=p;else if(y||!m.type.isTextblock)break}for(let p=r.openStart;p>=0;p--){let m=(p+u+1)%(r.openStart+1),y=c[m];if(y)for(let v=0;v<o.length;v++){let w=o[(v+l)%o.length],k=!0;w<0&&(k=!1,w=-w);let b=s.node(w-1),T=s.index(w-1);if(b.canReplaceWith(T,T,y.type,y.marks))return n.replace(s.before(w),k?i.after(w):t,new Q(CA(r.content,0,r.openStart,m),m,r.openEnd))}}let h=n.steps.length;for(let p=o.length-1;p>=0&&(n.replace(e,t,r),!(n.steps.length>h));p--){let m=o[p];m<0||(e=s.before(m),t=i.after(m))}}function CA(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(CA(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore($.empty,!0))}return n}function _z(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=gz(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new Q($.from(r),0,0))}function Ez(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=AA(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o&&r.start(o-1)==s.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),s.index(o-1)))return n.delete(r.before(o),t);n.delete(e,t)}function AA(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Sa extends Bt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return et.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return et.fromReplace(e,this.pos,this.pos+1,new Q($.from(s),0,t.isLeaf?0:1))}getMap(){return yn.empty}invert(e){return new Sa(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Sa(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Sa(t.pos,t.attr,t.value)}}Bt.jsonID("attr",Sa);class Zc extends Bt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return et.ok(r)}getMap(){return yn.empty}invert(e){return new Zc(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Zc(t.attr,t.value)}}Bt.jsonID("docAttr",Zc);let Ha=class extends Error{};Ha=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Ha.prototype=Object.create(Error.prototype);Ha.prototype.constructor=Ha;Ha.prototype.name="TransformError";class kz{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Xc}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Ha(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=Q.empty){let s=fp(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new Q($.from(r),0,0))}delete(e,t){return this.replace(e,t,Q.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return wz(this,e,t,r),this}replaceRangeWith(e,t,r){return _z(this,e,t,r),this}deleteRange(e,t){return Ez(this,e,t),this}lift(e,t){return oz(this,e,t),this}join(e,t=1){return mz(this,e,t),this}wrap(e,t){return cz(this,e,t),this}setBlockType(e,t=e,r,s=null){return uz(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return hz(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Sa(e,t,r)),this}setDocAttribute(e,t){return this.step(new Zc(e,t)),this}addNodeMark(e,t){return this.step(new Ls(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Re)t.isInSet(r.marks)&&this.step(new ko(e,t));else{let s=r.marks,i,o=[];for(;i=t.isInSet(s);)o.push(new ko(e,i)),s=i.removeFromSet(s);for(let a=o.length-1;a>=0;a--)this.step(o[a])}return this}split(e,t=1,r){return fz(this,e,t,r),this}addMark(e,t,r){return rz(this,e,t,r),this}removeMark(e,t,r){return sz(this,e,t,r),this}clearIncompatible(e,t,r){return nx(this,e,t,r),this}}const Fm=Object.create(null);class de{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new bz(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=Q.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?Q.empty:t),a==0&&s1(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),s1(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ae(e):Xo(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?Xo(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):Xo(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new En(e.node(0))}static atStart(e){return Xo(e,e,0,0,1)||new En(e)}static atEnd(e){return Xo(e,e,e.content.size,e.childCount,-1)||new En(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Fm[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Fm)throw new RangeError("Duplicate use of selection JSON ID "+e);return Fm[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ae.between(this.$anchor,this.$head).getBookmark()}}de.prototype.visible=!0;class bz{constructor(e,t){this.$from=e,this.$to=t}}let n1=!1;function r1(n){!n1&&!n.parent.inlineContent&&(n1=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ae extends de{constructor(e,t=e){r1(e),r1(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return de.near(r);let s=e.resolve(t.map(this.anchor));return new ae(s.parent.inlineContent?s:r,r)}replace(e,t=Q.empty){if(super.replace(e,t),t==Q.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ae&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new pp(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ae(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=de.findFrom(t,r,!0)||de.findFrom(t,-r,!0);if(i)t=i.$head;else return de.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(de.findFrom(e,-r,!0)||de.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ae(e,t)}}de.jsonID("text",ae);class pp{constructor(e,t){this.anchor=e,this.head=t}map(e){return new pp(e.map(this.anchor),e.map(this.head))}resolve(e){return ae.between(e.resolve(this.anchor),e.resolve(this.head))}}class ee extends de{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?de.near(i):new ee(i)}content(){return new Q($.from(this.node),0,0)}eq(e){return e instanceof ee&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new sx(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ee(e.resolve(t.anchor))}static create(e,t){return new ee(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ee.prototype.visible=!1;de.jsonID("node",ee);class sx{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new pp(r,r):new sx(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&ee.isSelectable(r)?new ee(t):de.near(t)}}class En extends de{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=Q.empty){if(t==Q.empty){e.delete(0,e.doc.content.size);let r=de.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new En(e)}map(e){return new En(e)}eq(e){return e instanceof En}getBookmark(){return Tz}}de.jsonID("all",En);const Tz={map(){return this},resolve(n){return new En(n)}};function Xo(n,e,t,r,s,i=!1){if(e.inlineContent)return ae.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&ee.isSelectable(a))return ee.create(n,t-(s<0?a.nodeSize:0))}else{let l=Xo(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function s1(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof ht||s instanceof pt))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(de.near(n.doc.resolve(o),t))}const i1=1,kd=2,o1=4;class Sz extends kz{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|i1)&~kd,this.storedMarks=null,this}get selectionSet(){return(this.updated&i1)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=kd,this}ensureMarks(e){return Re.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&kd)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~kd,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Re.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),!this.selection.empty&&this.selection.to==t+e.length&&this.setSelection(de.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=o1,this}get scrolledIntoView(){return(this.updated&o1)>0}}function a1(n,e){return!e||!n?n:n.bind(e)}class Yl{constructor(e,t,r){this.name=e,this.init=a1(t.init,r),this.apply=a1(t.apply,r)}}const Iz=[new Yl("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Yl("selection",{init(n,e){return n.selection||de.atStart(e.doc)},apply(n){return n.selection}}),new Yl("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Yl("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Bm{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Iz.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Yl(r.key,r.spec.state,r))})}}class fa{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let h=0;h<this.config.plugins.length;h++)s.push(h<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new fa(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new Sz(this)}static create(e){let t=new Bm(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new fa(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new Bm(this.schema,e.plugins),r=t.fields,s=new fa(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Bm(e.schema,e.plugins),i=new fa(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=Zs.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=de.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function RA(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=RA(s,e,{})),t[r]=s}return t}class nn{constructor(e){this.spec=e,this.props={},e.props&&RA(e.props,this,this.props),this.key=e.key?e.key.key:PA("plugin")}getState(e){return e[this.key]}}const $m=Object.create(null);function PA(n){return n in $m?n+"$"+ ++$m[n]:($m[n]=0,n+"$")}class rr{constructor(e="key"){this.key=PA(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const kt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Ka=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Fy=null;const Vr=function(n,e,t){let r=Fy||(Fy=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},Nz=function(){Fy=null},bo=function(n,e,t,r){return t&&(l1(n,e,t,r,-1)||l1(n,e,t,r,1))},Cz=/^(img|br|input|textarea|hr)$/i;function l1(n,e,t,r,s){for(var i;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Dn(n))){let o=n.parentNode;if(!o||o.nodeType!=1||Nu(n)||Cz.test(n.nodeName)||n.contentEditable=="false")return!1;e=kt(n)+(s<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[e+(s<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((i=o.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=s;else return!1;else n=o,e=s<0?Dn(n):0}else return!1}}function Dn(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Az(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Dn(n)}else if(n.parentNode&&!Nu(n))e=kt(n),n=n.parentNode;else return null}}function Rz(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Nu(n))e=kt(n)+1,n=n.parentNode;else return null}}function Pz(n,e,t){for(let r=e==0,s=e==Dn(n);r||s;){if(n==t)return!0;let i=kt(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==Dn(n)}}function Nu(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const mp=function(n){return n.focusNode&&bo(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Fi(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function Dz(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Mz(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(Dn(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(Dn(r.startContainer),r.startOffset)}}}const Er=typeof navigator<"u"?navigator:null,c1=typeof document<"u"?document:null,ki=Er&&Er.userAgent||"",By=/Edge\/(\d+)/.exec(ki),DA=/MSIE \d/.exec(ki),$y=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ki),dn=!!(DA||$y||By),ti=DA?document.documentMode:$y?+$y[1]:By?+By[1]:0,Ln=!dn&&/gecko\/(\d+)/i.test(ki);Ln&&+(/Firefox\/(\d+)/.exec(ki)||[0,0])[1];const Uy=!dn&&/Chrome\/(\d+)/.exec(ki),Vt=!!Uy,MA=Uy?+Uy[1]:0,Yt=!dn&&!!Er&&/Apple Computer/.test(Er.vendor),Ga=Yt&&(/Mobile\/\w+/.test(ki)||!!Er&&Er.maxTouchPoints>2),In=Ga||(Er?/Mac/.test(Er.platform):!1),Oz=Er?/Win/.test(Er.platform):!1,qr=/Android \d/.test(ki),Cu=!!c1&&"webkitFontSmoothing"in c1.documentElement.style,Vz=Cu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function jz(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Dr(n,e){return typeof n=="number"?n:n[e]}function Lz(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function u1(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;){if(o.nodeType!=1){o=Ka(o);continue}let a=o,l=a==i.body,c=l?jz(i):Lz(a),u=0,h=0;if(e.top<c.top+Dr(r,"top")?h=-(c.top-e.top+Dr(s,"top")):e.bottom>c.bottom-Dr(r,"bottom")&&(h=e.bottom-e.top>c.bottom-c.top?e.top+Dr(s,"top")-c.top:e.bottom-c.bottom+Dr(s,"bottom")),e.left<c.left+Dr(r,"left")?u=-(c.left-e.left+Dr(s,"left")):e.right>c.right-Dr(r,"right")&&(u=e.right-c.right+Dr(s,"right")),u||h)if(l)i.defaultView.scrollBy(u,h);else{let m=a.scrollLeft,y=a.scrollTop;h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u);let v=a.scrollLeft-m,w=a.scrollTop-y;e={left:e.left-v,top:e.top-w,right:e.right-v,bottom:e.bottom-w}}let p=l?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(p))break;o=p=="absolute"?o.offsetParent:Ka(o)}}function Fz(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:OA(n.dom)}}function OA(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Ka(r));return e}function Bz({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;VA(t,r==0?0:r-e)}function VA(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let qo=null;function $z(n){if(n.setActive)return n.setActive();if(qo)return n.focus(qo);let e=OA(n);n.focus(qo==null?{get preventScroll(){return qo={preventScroll:!0},!0}}:void 0),qo||(qo=!1,VA(e,0))}function jA(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,h=0;u;u=u.nextSibling,h++){let p;if(u.nodeType==1)p=u.getClientRects();else if(u.nodeType==3)p=Vr(u).getClientRects();else continue;for(let m=0;m<p.length;m++){let y=p[m];if(y.top<=o&&y.bottom>=a){o=Math.max(y.bottom,o),a=Math.min(y.top,a);let v=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(v<r){t=u,r=v,s=v&&t.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,u.nodeType==1&&v&&(i=h+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!l&&y.left<=e.left&&y.right>=e.left&&(l=u,c={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!t&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(i=h+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?Uz(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:jA(t,s)}function Uz(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=xs(r,1);if(i.top!=i.bottom&&ix(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function ix(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function zz(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Wz(n,e,t){let{node:r,offset:s}=jA(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function qz(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function LA(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(ix(e,c))return LA(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function Hz(n,e){let t=n.dom.ownerDocument,r,s=0,i=Mz(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!ix(e,c)||(o=LA(n.dom,e,c),!o))return null}if(Yt)for(let c=o;r&&c;c=Ka(c))c.draggable&&(r=void 0);if(o=zz(o,e),r){if(Ln&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],h;u.nodeName=="IMG"&&(h=u.getBoundingClientRect()).right<=e.left&&h.bottom>e.top&&s++}let c;Cu&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=qz(n,r,s,e))}a==null&&(a=Wz(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function d1(n){return n.top<n.bottom||n.left<n.right}function xs(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(d1(r))return r}return Array.prototype.find.call(t,d1)||n.getBoundingClientRect()}const Kz=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function FA(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=Cu||Ln;if(r.nodeType==3)if(o&&(Kz.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=xs(Vr(r,s,s),t);if(Ln&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=xs(Vr(r,s-1,s-1),-1);if(c.top==l.top){let u=xs(Vr(r,s,s+1),-1);if(u.top!=l.top)return jl(u,u.left<c.left)}}return l}else{let l=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(l--,u=1):t<0?l--:c++,jl(xs(Vr(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==Dn(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return Um(l.getBoundingClientRect(),!1)}if(i==null&&s<Dn(r)){let l=r.childNodes[s];if(l.nodeType==1)return Um(l.getBoundingClientRect(),!0)}return Um(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==Dn(r))){let l=r.childNodes[s-1],c=l.nodeType==3?Vr(l,Dn(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return jl(xs(c,1),!1)}if(i==null&&s<Dn(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Vr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return jl(xs(c,-1),!0)}return jl(xs(r.nodeType==3?Vr(r):r,-t),t>=0)}function jl(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Um(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function BA(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function Gz(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return BA(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=FA(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Vr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const Qz=/[\u0590-\u08ac]/;function Jz(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return a?!Qz.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:BA(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:h}=n.domSelectionRange(),p=a.caretBidiLevel;a.modify("move",t,"character");let m=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:y,focusOffset:v}=n.domSelectionRange(),w=y&&!m.contains(y.nodeType==1?y:y.parentNode)||l==y&&c==v;try{a.collapse(u,h),l&&(l!=u||c!=h)&&a.extend&&a.extend(l,c)}catch{}return p!=null&&(a.caretBidiLevel=p),w}):r.pos==r.start()||r.pos==r.end()}let h1=null,f1=null,p1=!1;function Yz(n,e,t){return h1==e&&f1==t?p1:(h1=e,f1=t,p1=t=="up"||t=="down"?Gz(n,e,t):Jz(n,e,t))}const Fn=0,m1=1,Wi=2,kr=3;class Au{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=Fn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>kt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)for(let o=0;o<s.children.length;o++){let a=s.children[o];if(a.size){s=a;break}}return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof UA){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof $A&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?kt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?kt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let h=a;h>0;h--){let p=this.children[h-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){s=kt(p.dom)+1;break}e-=p.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let h=this.children[u];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){i=kt(h.dom);break}t+=h.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let m=0,y=0;m<this.children.length;m++){let v=this.children[m],w=y+v.size;if(i>y&&o<w)return v.setSelection(e-y-v.border,t-y-v.border,r,s);y=w}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),h=!1;if((Ln||Yt)&&e==t){let{node:m,offset:y}=a;if(m.nodeType==3){if(h=!!(y&&m.nodeValue[y-1]==`
`),h&&y==m.nodeValue.length)for(let v=m,w;v;v=v.parentNode){if(w=v.nextSibling){w.nodeName=="BR"&&(a=l={node:w.parentNode,offset:kt(w)+1});break}let k=v.pmViewDesc;if(k&&k.node&&k.node.isBlock)break}}else{let v=m.childNodes[y-1];h=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(Ln&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let m=u.focusNode.childNodes[u.focusOffset];m&&m.contentEditable=="false"&&(s=!0)}if(!(s||h&&Yt)&&bo(a.node,a.offset,u.anchorNode,u.anchorOffset)&&bo(l.node,l.offset,u.focusNode,u.focusOffset))return;let p=!1;if((c.extend||e==t)&&!(h&&Ln)){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),p=!0}catch{}}if(!p){if(e>t){let y=a;a=l,l=y}let m=document.createRange();m.setEnd(l.node,l.offset),m.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?Wi:m1,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=kr:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Wi:kr}r=o}this.dirty=Wi}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Wi:m1;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class $A extends Au{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==Fn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Xz extends Au{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class To extends Au{constructor(e,t,r,s,i){super(e,[],r,s),this.mark=t,this.spec=i}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=Mo.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new To(e,t,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&kr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=kr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Fn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Fn}}slice(e,t,r){let s=To.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=Wy(i,t,o,r)),e>0&&(i=Wy(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ni extends Au{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,h=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:h}=Mo.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!h&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let p=u;return u=qA(u,r,t),c?l=new Zz(e,t,r,s,u,h||null,p,c,i,o+1):t.isText?new gp(e,t,r,s,u,p,i):new ni(e,t,r,s,u,h||null,p,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>$.empty)}return e}matchesNode(e,t,r){return this.dirty==Fn&&e.eq(this.node)&&df(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new t9(this,o&&o.node,e);s9(this.node,this.innerDeco,(c,u,h)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!h&&l.syncToMarks(u==this.node.childCount?Re.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,h,p)=>{l.syncToMarks(c.marks,r,e);let m;l.findNodeMatch(c,u,h,p)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(m=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,h,m,e)||l.updateNextNode(c,u,h,e,p,s)||l.addNode(c,u,h,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Wi)&&(o&&this.protectLocalComposition(e,o),zA(this.contentDOM,this.children,e),Ga&&i9(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ae)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=o9(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new Xz(this,i,t,s);e.input.compositionNodes.push(o),this.children=Wy(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==kr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Fn}updateOuterDeco(e){if(df(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=WA(this.dom,this.nodeDOM,zy(this.outerDeco,this.node,t),zy(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function g1(n,e,t,r,s){qA(r,e,n);let i=new ni(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class gp extends ni{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==kr||this.dirty!=Fn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Fn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Fn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new gp(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=kr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class UA extends Au{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Fn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Zz extends ni{constructor(e,t,r,s,i,o,a,l,c,u){super(e,t,r,s,i,o,a,c,u),this.spec=l}update(e,t,r,s){if(this.dirty==kr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function zA(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=y1(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof To){let l=r?r.previousSibling:n.lastChild;zA(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=y1(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const mc=function(n){n&&(this.nodeName=n)};mc.prototype=Object.create(null);const qi=[new mc];function zy(n,e,t){if(n.length==0)return qi;let r=t?qi[0]:new mc,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new mc(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new mc(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function WA(n,e,t,r){if(t==qi&&r==qi)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=qi[0]),s=l}e9(s,a||qi[0],o)}return s}function e9(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function qA(n,e,t){return WA(n,n,qi,zy(e,t,n.nodeType!=1))}function df(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function y1(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class t9{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=n9(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=Fn,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=To.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==kr&&o.dom==o.contentDOM&&(o.dirty=Wi),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof ni){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,h,p=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=kr&&df(t,l.outerDeco));if(!p&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!p&&(h=this.recreateWrapper(l,e,t,r,s,o)))return this.destroyBetween(this.index,a),this.top.children[this.index]=h,h.contentDOM&&(h.dirty=Wi,h.updateChildren(s,o+1),h.dirty=Fn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!df(r,e.outerDeco)||!s.eq(e.innerDeco))return null;let a=ni.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=ni.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new $A(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof To;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof gp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Yt||Vt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new UA(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function n9(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof To)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function r9(n,e){return n.type.side-e.type.side}function s9(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,h;for(;o<s.length&&s[o].to==i;){let w=s[o++];w.widget&&(u?(h||(h=[u])).push(w):u=w)}if(u)if(h){h.sort(r9);for(let w=0;w<h.length;w++)t(h[w],c,!!l)}else t(u,c,!!l);let p,m;if(l)m=-1,p=l,l=null;else if(c<n.childCount)m=c,p=n.child(c++);else break;for(let w=0;w<a.length;w++)a[w].to<=i&&a.splice(w--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let y=i+p.nodeSize;if(p.isText){let w=y;o<s.length&&s[o].from<w&&(w=s[o].from);for(let k=0;k<a.length;k++)a[k].to<w&&(w=a[k].to);w<y&&(l=p.cut(w-i),p=p.cut(0,w-i),y=w,m=-1)}else for(;o<s.length&&s[o].to<y;)o++;let v=p.isInline&&!p.isLeaf?a.filter(w=>!w.inline):a.slice();r(p,v,e.forChild(i,p),m),i=y}}function i9(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function o9(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Wy(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function ox(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(mp(t)){for(l=o;s&&!s.node;)s=s.parent;let h=s.node;if(s&&h.isAtom&&ee.isSelectable(h)&&s.parent&&!(h.isInline&&Pz(t.focusNode,t.focusOffset,s.dom))){let p=s.posBefore;c=new ee(o==p?a:r.resolve(p))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let h=o,p=o;for(let m=0;m<t.rangeCount;m++){let y=t.getRangeAt(m);h=Math.min(h,n.docView.posFromDOM(y.startContainer,y.startOffset,1)),p=Math.max(p,n.docView.posFromDOM(y.endContainer,y.endOffset,-1))}if(h<0)return null;[l,o]=p==n.state.selection.anchor?[p,h]:[h,p],a=r.resolve(o)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let h=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=ax(n,u,a,h)}return c}function HA(n){return n.editable?n.hasFocus():GA(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Qr(n,e=!1){let t=n.state.selection;if(KA(n,t),!!HA(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Vt){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&bo(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)l9(n);else{let{anchor:r,head:s}=t,i,o;v1&&!(t instanceof ae)&&(t.$from.parent.inlineContent||(i=x1(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=x1(n,t.to))),n.docView.setSelection(r,s,n,e),v1&&(i&&w1(i),o&&w1(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&a9(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const v1=Yt||Vt&&MA<63;function x1(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(Yt&&s&&s.contentEditable=="false")return zm(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return zm(s);if(i)return zm(i)}}function zm(n){return n.contentEditable="true",Yt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function w1(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function a9(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!HA(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function l9(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,kt(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&dn&&ti<=11&&(t.disabled=!0,t.disabled=!1)}function KA(n,e){if(e instanceof ee){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(_1(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else _1(n)}function _1(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function ax(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ae.between(e,t,r)}function E1(n){return n.editable&&!n.hasFocus()?!1:GA(n)}function GA(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function c9(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return bo(e.node,e.offset,t.anchorNode,t.anchorOffset)}function qy(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&de.findFrom(i,e)}function Es(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function k1(n,e,t){let r=n.state.selection;if(r instanceof ae)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return Es(n,new ae(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=qy(n.state,e);return s&&s instanceof ee?Es(n,s):!1}else if(!(In&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?ee.isSelectable(i)?Es(n,new ee(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):Cu?Es(n,new ae(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ee&&r.node.isInline)return Es(n,new ae(e>0?r.$to:r.$from));{let s=qy(n.state,e);return s?Es(n,s):!1}}}function hf(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function gc(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Ho(n,e){return e<0?u9(n):d9(n)}function u9(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(Ln&&t.nodeType==1&&r<hf(t)&&gc(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(gc(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(QA(t))break;{let a=t.previousSibling;for(;a&&gc(a,-1);)s=t.parentNode,i=kt(a),a=a.previousSibling;if(a)t=a,r=hf(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Hy(n,t,r):s&&Hy(n,s,i)}function d9(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=hf(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(gc(a,1))i=t,o=++r;else break}else{if(QA(t))break;{let a=t.nextSibling;for(;a&&gc(a,1);)i=a.parentNode,o=kt(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=hf(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&Hy(n,i,o)}function QA(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function h9(n,e){for(;n&&e==n.childNodes.length&&!Nu(n);)e=kt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function f9(n,e){for(;n&&!e&&!Nu(n);)e=kt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Hy(n,e,t){if(e.nodeType!=3){let i,o;(o=h9(e,t))?(e=o,t=0):(i=f9(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(mp(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&Qr(n)},50)}function b1(n,e){let t=n.state.doc.resolve(e);if(!(Vt||Oz)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function T1(n,e,t){let r=n.state.selection;if(r instanceof ae&&!r.empty||t.indexOf("s")>-1||In&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=qy(n.state,e);if(o&&o instanceof ee)return Es(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof En?de.near(o,e):de.findFrom(o,e);return a?Es(n,a):!1}return!1}function S1(n,e){if(!(n.state.selection instanceof ae))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function I1(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function p9(n){if(!Yt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;I1(n,r,"true"),setTimeout(()=>I1(n,r,"false"),20)}return!1}function m9(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function g9(n,e){let t=e.keyCode,r=m9(e);if(t==8||In&&t==72&&r=="c")return S1(n,-1)||Ho(n,-1);if(t==46&&!e.shiftKey||In&&t==68&&r=="c")return S1(n,1)||Ho(n,1);if(t==13||t==27)return!0;if(t==37||In&&t==66&&r=="c"){let s=t==37?b1(n,n.state.selection.from)=="ltr"?-1:1:-1;return k1(n,s,r)||Ho(n,s)}else if(t==39||In&&t==70&&r=="c"){let s=t==39?b1(n,n.state.selection.from)=="ltr"?1:-1:1;return k1(n,s,r)||Ho(n,s)}else{if(t==38||In&&t==80&&r=="c")return T1(n,-1,r)||Ho(n,-1);if(t==40||In&&t==78&&r=="c")return p9(n)||T1(n,1,r)||Ho(n,1);if(r==(In?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function lx(n,e){n.someProp("transformCopied",m=>{e=m(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=n.someProp("clipboardSerializer")||Mo.fromSchema(n.state.schema),a=tR(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,h=0;for(;c&&c.nodeType==1&&(u=eR[c.nodeName.toLowerCase()]);){for(let m=u.length-1;m>=0;m--){let y=a.createElement(u[m]);for(;l.firstChild;)y.appendChild(l.firstChild);l.appendChild(y),h++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${h?` -${h}`:""} ${JSON.stringify(t)}`);let p=n.someProp("clipboardTextSerializer",m=>m(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:p,slice:e}}function JA(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=!!e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",p=>{e=p(e,i||r,n)}),i)return a=new Q($.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",p=>{a=p(a,n,!0)}),a;let h=n.someProp("clipboardTextParser",p=>p(e,s,r,n));if(h)a=h;else{let p=s.marks(),{schema:m}=n.state,y=Mo.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let w=o.appendChild(document.createElement("p"));v&&w.appendChild(y.serializeNode(m.text(v,p)))})}}else n.someProp("transformPastedHTML",h=>{t=h(t,n)}),o=w9(t),Cu&&_9(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||ei.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!y9.test(p.parentNode.nodeName)?{ignore:!0}:null}})),u)a=E9(N1(a,+u[1],+u[2]),u[4]);else if(a=Q.maxOpen(v9(a.content,s),!0),a.openStart||a.openEnd){let h=0,p=0;for(let m=a.content.firstChild;h<a.openStart&&!m.type.spec.isolating;h++,m=m.firstChild);for(let m=a.content.lastChild;p<a.openEnd&&!m.type.spec.isolating;p++,m=m.lastChild);a=N1(a,h,p)}return n.someProp("transformPasted",h=>{a=h(a,n,l)}),a}const y9=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function v9(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&XA(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=ZA(o[o.length-1],i.length));let u=YA(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return $.from(o)}return n}function YA(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,$.from(n));return n}function XA(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=XA(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append($.from(YA(t,n,s+1))))}}function ZA(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,ZA(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore($.empty,!0);return n.copy(t.append(r))}function Ky(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=Ky(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore($.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function N1(n,e,t){return e<n.openStart&&(n=new Q(Ky(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new Q(Ky(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const eR={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let C1=null;function tR(){return C1||(C1=document.implementation.createHTMLDocument("title"))}let Wm=null;function x9(n){let e=window.trustedTypes;return e?(Wm||(Wm=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Wm.createHTML(n)):n}function w9(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=tR().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&eR[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=x9(n),s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function _9(n){let e=n.querySelectorAll(Vt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function E9(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=$.from(l.create(r[a+1],s)),i++,o++}return new Q(s,i,o)}const Xt={},Zt={},k9={touchstart:!0,touchmove:!0};class b9{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function T9(n){for(let e in Xt){let t=Xt[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{I9(n,r)&&!cx(n,r)&&(n.editable||!(r.type in Zt))&&t(n,r)},k9[e]?{passive:!0}:void 0)}Yt&&n.dom.addEventListener("input",()=>null),Gy(n)}function Fs(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function S9(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Gy(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>cx(n,r))})}function cx(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function I9(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function N9(n,e){!cx(n,e)&&Xt[e.type]&&(n.editable||!(e.type in Zt))&&Xt[e.type](n,e)}Zt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!rR(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(qr&&Vt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Ga&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,Fi(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||g9(n,t)?t.preventDefault():Fs(n,"key")};Zt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Zt.keypress=(n,e)=>{let t=e;if(rR(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||In&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ae)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode),i=()=>n.state.tr.insertText(s).scrollIntoView();!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,s,i))&&n.dispatch(i()),t.preventDefault()}};function yp(n){return{left:n.clientX,top:n.clientY}}function C9(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function ux(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Ia(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function A9(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&ee.isSelectable(r)?(Ia(n,new ee(t)),!0):!1}function R9(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof ee&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(ee.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Ia(n,ee.create(n.state.doc,s)),!0):!1}function P9(n,e,t,r,s){return ux(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?R9(n,t):A9(n,t))}function D9(n,e,t,r){return ux(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function M9(n,e,t,r){return ux(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||O9(n,t,r)}function O9(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Ia(n,ae.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Ia(n,ae.create(r,a+1,a+1+o.content.size));else if(ee.isSelectable(o))Ia(n,ee.create(r,a));else continue;return!0}}function dx(n){return ff(n)}const nR=In?"metaKey":"ctrlKey";Xt.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=dx(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&C9(t,n.input.lastClick)&&!t[nR]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i,button:t.button};let o=n.posAtCoords(yp(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new V9(n,o,t,!!r)):(i=="doubleClick"?D9:M9)(n,o.pos,o.inside,t)?t.preventDefault():Fs(n,"pointer"))};class V9{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[nR],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof ee&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ln&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Fs(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Qr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(yp(e))),this.updateAllowDefault(e),this.allowDefault||!t?Fs(this.view,"pointer"):P9(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Yt&&this.mightDrag&&!this.mightDrag.node.isAtom||Vt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ia(this.view,de.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Fs(this.view,"pointer")}move(e){this.updateAllowDefault(e),Fs(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Xt.touchstart=n=>{n.input.lastTouch=Date.now(),dx(n),Fs(n,"pointer")};Xt.touchmove=n=>{n.input.lastTouch=Date.now(),Fs(n,"pointer")};Xt.contextmenu=n=>dx(n);function rR(n,e){return n.composing?!0:Yt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const j9=qr?5e3:-1;Zt.compositionstart=Zt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof ae&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),ff(n,!0),n.markCursor=null;else if(ff(n,!e.selection.empty),Ln&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){let a=n.domSelection();a&&a.collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}sR(n,j9)};Zt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,sR(n,20))};function sR(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>ff(n),e))}function iR(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=F9());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function L9(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=Az(e.focusNode,e.focusOffset),r=Rz(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function F9(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function ff(n,e=!1){if(!(qr&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),iR(n),e||n.docView&&n.docView.dirty){let t=ox(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function B9(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const eu=dn&&ti<15||Ga&&Vz<604;Xt.copy=Zt.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=eu?null:t.clipboardData,o=r.content(),{dom:a,text:l}=lx(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):B9(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function $9(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function U9(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?tu(n,r.value,null,s,e):tu(n,r.textContent,r.innerHTML,s,e)},50)}function tu(n,e,t,r,s){let i=JA(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||Q.empty)))return!0;if(!i)return!1;let o=$9(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function oR(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Zt.paste=(n,e)=>{let t=e;if(n.composing&&!qr)return;let r=eu?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&tu(n,oR(r),r.getData("text/html"),s,t)?t.preventDefault():U9(n,t)};class aR{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const z9=In?"altKey":"ctrlKey";function lR(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[z9]}Xt.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(yp(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof ee?s.to-1:s.to))){if(r&&r.mightDrag)o=ee.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let h=n.docView.nearestDesc(t.target,!0);h&&h.node.type.spec.draggable&&h!=n.docView&&(o=ee.create(n.state.doc,h.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=lx(n,a);(!t.dataTransfer.files.length||!Vt||MA>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(eu?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",eu||t.dataTransfer.setData("text/plain",c),n.dragging=new aR(u,lR(n,t),o)};Xt.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Zt.dragover=Zt.dragenter=(n,e)=>e.preventDefault();Zt.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(yp(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",y=>{o=y(o,n,!1)}):o=JA(n,oR(t.dataTransfer),eu?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&lR(n,t));if(n.someProp("handleDrop",y=>y(n,t,o||Q.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?SA(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:y}=r;y?y.replace(c):c.deleteSelection()}let u=c.mapping.map(l),h=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=c.doc;if(h?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(p))return;let m=c.doc.resolve(u);if(h&&ee.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new ee(m));else{let y=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((v,w,k,b)=>y=b),c.setSelection(ax(n,m,c.doc.resolve(y)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Xt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Qr(n)},20))};Xt.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Xt.beforeinput=(n,e)=>{if(Vt&&qr&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,Fi(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Zt)Xt[n]=Zt[n];function nu(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class pf{constructor(e,t){this.toDOM=e,this.spec=t||eo,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new wn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof pf&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&nu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class ri{constructor(e,t){this.attrs=e,this.spec=t||eo}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new wn(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof ri&&nu(this.attrs,e.attrs)&&nu(this.spec,e.spec)}static is(e){return e.type instanceof ri}destroy(){}}class hx{constructor(e,t){this.attrs=e,this.spec=t||eo}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new wn(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof hx&&nu(this.attrs,e.attrs)&&nu(this.spec,e.spec)}destroy(){}}class wn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new wn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new wn(e,e,new pf(t,r))}static inline(e,t,r,s){return new wn(e,t,new ri(r,s))}static node(e,t,r,s){return new wn(e,t,new hx(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof ri}get widget(){return this.type instanceof pf}}const Zo=[],eo={};class Xe{constructor(e,t){this.local=e.length?e:Zo,this.children=t.length?t:Zo}static create(e,t){return t.length?mf(t,e,0,eo):Dt}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==Dt||e.maps.length==0?this:this.mapInner(e,t,0,0,r||eo)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?W9(this.children,o||[],e,t,r,s,i):o?new Xe(o.sort(to),Zo):Dt}add(e,t){return t.length?this==Dt?Xe.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=uR(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,mf(u,a,c+1,eo)),i+=3}});let o=cR(i?dR(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new Xe(o.length?this.local.concat(o).sort(to):this.local,s||this.children)}remove(e){return e.length==0||this==Dt?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let u=0,h;u<e.length;u++)(h=e[u])&&h.from>a&&h.to<l&&(e[u]=null,(o||(o=[])).push(h));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=Dt?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new Xe(s,r):Dt}forChild(e,t){if(this==Dt)return this;if(t.isLeaf)return Xe.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof ri){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new Xe(s.sort(to),Zo);return r?new Ps([a,r]):a}return r||Dt}eq(e){if(this==e)return!0;if(!(e instanceof Xe)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return fx(this.localsInner(e))}localsInner(e){if(this==Dt)return Zo;if(e.inlineContent||!this.local.some(ri.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof ri||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Xe.empty=new Xe([],[]);Xe.removeOverlap=fx;const Dt=Xe.empty;class Ps{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,eo));return Ps.from(r)}forChild(e,t){if(t.isLeaf)return Xe.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=Dt&&(i instanceof Ps?r=r.concat(i.members):r.push(i))}return Ps.from(r)}eq(e){if(!(e instanceof Ps)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?fx(r?t:t.sort(to)):Zo}static from(e){switch(e.length){case 0:return Dt;case 1:return e[0];default:return new Ps(e.every(t=>t instanceof Xe)?e:e.reduce((t,r)=>t.concat(r instanceof Xe?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function W9(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let h=0;t.maps[c].forEach((p,m,y,v)=>{let w=v-y-(m-p);for(let k=0;k<a.length;k+=3){let b=a[k+1];if(b<0||p>b+u-h)continue;let T=a[k]+u-h;m>=T?a[k+1]=p<=T?-2:-1:p>=u&&w&&(a[k]+=w,a[k+1]+=w)}h+=w}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),h=u-s;if(h<0||h>=r.content.size){l=!0;continue}let p=t.map(n[c+1]+i,-1),m=p-s,{index:y,offset:v}=r.content.findIndex(h),w=r.maybeChild(y);if(w&&v==h&&v+w.nodeSize==m){let k=a[c+2].mapInner(t,w,u+1,n[c]+i+1,o);k!=Dt?(a[c]=h,a[c+1]=m,a[c+2]=k):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=q9(a,n,e,t,s,i,o),u=mf(c,r,0,o);e=u.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,p=0;h<u.children.length;h+=3){let m=u.children[h];for(;p<a.length&&a[p]<m;)p+=3;a.splice(p,0,u.children[h],u.children[h+1],u.children[h+2])}}return new Xe(e.sort(to),a)}function cR(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new wn(s.from+e,s.to+e,s.type))}return t}function q9(n,e,t,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let h=l.local[u].map(r,s,c);h?t.push(h):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function uR(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function dR(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function mf(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=uR(n,a,l+t);if(c){i=!0;let u=mf(c,a,t+l+1,r);u!=Dt&&s.push(l,l+a.nodeSize,u)}});let o=cR(i?dR(n):n,-t).sort(to);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new Xe(o,s):Dt}function to(n,e){return n.from-e.from||n.to-e.to}function fx(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),A1(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),A1(e,s,r.copy(i.from,r.to)));break}}}return e}function A1(n,e,t){for(;e<n.length&&to(t,n[e])>0;)e++;n.splice(e,0,t)}function qm(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Dt&&e.push(r)}),n.cursorWrapper&&e.push(Xe.create(n.state.doc,[n.cursorWrapper.deco])),Ps.from(e)}const H9={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},K9=dn&&ti<=11;class G9{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Q9{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new G9,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);dn&&ti<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),K9&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,H9)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(E1(this.view)){if(this.suppressingSelectionUpdates)return Qr(this.view);if(dn&&ti<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&bo(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=Ka(i))t.add(i);for(let i=e.anchorNode;i;i=Ka(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&E1(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let h=this.registerMutation(t[u],l);h&&(i=i<0?h.from:Math.min(h.from,i),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(a=!0))}if(Ln&&l.length){let u=l.filter(h=>h.nodeName=="BR");if(u.length==2){let[h,p]=u;h.parentNode&&h.parentNode.parentNode==p.parentNode?p.remove():h.remove()}else{let{focusNode:h}=this.currentSelection;for(let p of u){let m=p.parentNode;m&&m.nodeName=="LI"&&(!h||X9(e,h)!=m)&&p.remove()}}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&mp(r)&&(c=ox(e))&&c.eq(de.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Qr(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),J9(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Qr(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let h=e.addedNodes[u];t.push(h),h.nodeType==3&&(this.lastChangedTextNode=h)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(dn&&ti<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:h,nextSibling:p}=e.addedNodes[u];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(i=p)}let o=s&&s.parentNode==e.target?kt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?kt(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let R1=new WeakMap,P1=!1;function J9(n){if(!R1.has(n)&&(R1.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Ln,P1)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),P1=!0}}function D1(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return bo(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function Y9(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return D1(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?D1(n,t):null}function X9(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function Z9(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],mp(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Vt&&n.input.lastKeyCode===8)for(let w=i;w>s;w--){let k=r.childNodes[w-1],b=k.pmViewDesc;if(k.nodeName=="BR"&&!b){i=w;break}if(!b||b.size)break}let h=n.state.doc,p=n.someProp("domParser")||ei.fromSchema(n.state.schema),m=h.resolve(o),y=null,v=p.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:eW,context:m});if(c&&c[0].pos!=null){let w=c[0].pos,k=c[1]&&c[1].pos;k==null&&(k=w),y={anchor:w+o,head:k+o}}return{doc:v,sel:y,from:o,to:a}}function eW(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Yt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Yt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const tW=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function nW(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let _=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,E=ox(n,_);if(E&&!n.state.selection.eq(E)){if(Vt&&qr&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",N=>N(n,Fi(13,"Enter"))))return;let S=n.state.tr.setSelection(E);_=="pointer"?S.setMeta("pointer",!0):_=="key"&&S.scrollIntoView(),i&&S.setMeta("composition",i),n.dispatch(S)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=Z9(n,e,t),u=n.state.doc,h=u.slice(c.from,c.to),p,m;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(p=n.state.selection.to,m="end"):(p=n.state.selection.from,m="start"),n.input.lastKeyCode=null;let y=iW(h.content,c.doc.content,c.from,p,m);if(y&&n.input.domChangeCount++,(Ga&&n.input.lastIOSEnter>Date.now()-225||qr)&&s.some(_=>_.nodeType==1&&!tW.test(_.nodeName))&&(!y||y.endA>=y.endB)&&n.someProp("handleKeyDown",_=>_(n,Fi(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!y)if(r&&l instanceof ae&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))y={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let _=M1(n,n.state.doc,c.sel);if(_&&!_.eq(n.state.selection)){let E=n.state.tr.setSelection(_);i&&E.setMeta("composition",i),n.dispatch(E)}}return}n.state.selection.from<n.state.selection.to&&y.start==y.endB&&n.state.selection instanceof ae&&(y.start>n.state.selection.from&&y.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?y.start=n.state.selection.from:y.endA<n.state.selection.to&&y.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(y.endB+=n.state.selection.to-y.endA,y.endA=n.state.selection.to)),dn&&ti<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>c.from&&c.doc.textBetween(y.start-c.from-1,y.start-c.from+1)==" "&&(y.start--,y.endA--,y.endB--);let v=c.doc.resolveNoCache(y.start-c.from),w=c.doc.resolveNoCache(y.endB-c.from),k=u.resolve(y.start),b=v.sameParent(w)&&v.parent.inlineContent&&k.end()>=y.endA;if((Ga&&n.input.lastIOSEnter>Date.now()-225&&(!b||s.some(_=>_.nodeName=="DIV"||_.nodeName=="P"))||!b&&v.pos<c.doc.content.size&&(!v.sameParent(w)||!v.parent.inlineContent)&&v.pos<w.pos&&!/\S/.test(c.doc.textBetween(v.pos,w.pos,"","")))&&n.someProp("handleKeyDown",_=>_(n,Fi(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>y.start&&sW(u,y.start,y.endA,v,w)&&n.someProp("handleKeyDown",_=>_(n,Fi(8,"Backspace")))){qr&&Vt&&n.domObserver.suppressSelectionUpdates();return}Vt&&y.endB==y.start&&(n.input.lastChromeDelete=Date.now()),qr&&!b&&v.start()!=w.start()&&w.parentOffset==0&&v.depth==w.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==y.endA&&(y.endB-=2,w=c.doc.resolveNoCache(y.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(_){return _(n,Fi(13,"Enter"))})},20));let T=y.start,C=y.endA,P=_=>{let E=_||n.state.tr.replace(T,C,c.doc.slice(y.start-c.from,y.endB-c.from));if(c.sel){let S=M1(n,E.doc,c.sel);S&&!(Vt&&n.composing&&S.empty&&(y.start!=y.endB||n.input.lastChromeDelete<Date.now()-100)&&(S.head==T||S.head==E.mapping.map(C)-1)||dn&&S.empty&&S.head==T)&&E.setSelection(S)}return i&&E.setMeta("composition",i),E.scrollIntoView()},D;if(b)if(v.pos==w.pos){dn&&ti<=11&&v.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Qr(n),20));let _=P(n.state.tr.delete(T,C)),E=u.resolve(y.start).marksAcross(u.resolve(y.endA));E&&_.ensureMarks(E),n.dispatch(_)}else if(y.endA==y.endB&&(D=rW(v.parent.content.cut(v.parentOffset,w.parentOffset),k.parent.content.cut(k.parentOffset,y.endA-k.start())))){let _=P(n.state.tr);D.type=="add"?_.addMark(T,C,D.mark):_.removeMark(T,C,D.mark),n.dispatch(_)}else if(v.parent.child(v.index()).isText&&v.index()==w.index()-(w.textOffset?0:1)){let _=v.parent.textBetween(v.parentOffset,w.parentOffset),E=()=>P(n.state.tr.insertText(_,T,C));n.someProp("handleTextInput",S=>S(n,T,C,_,E))||n.dispatch(E())}else n.dispatch(P());else n.dispatch(P())}function M1(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:ax(n,e.resolve(t.anchor),e.resolve(t.head))}function rW(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if($.from(c).eq(n))return{mark:a,type:o}}function sW(n,e,t,r,s){if(t-e<=s.pos-r.pos||Hm(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(Hm(i,!0,!0));return!o.parent.isTextblock||o.pos>t||Hm(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Hm(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function iW(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&O1(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&O1(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function O1(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class hR{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new b9,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(B1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=L1(this),j1(this),this.nodeViews=F1(this),this.docView=g1(this.state.doc,V1(this),qm(this),this.dom,this),this.domObserver=new Q9(this,(r,s,i,o)=>nW(this,r,s,i,o)),this.domObserver.start(),T9(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Gy(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(B1),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(iR(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let m=F1(this);aW(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&Gy(this),this.editable=L1(this),j1(this);let l=qm(this),c=V1(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",h=i||!this.docView.matchesNode(e.doc,c,l);(h||!e.selection.eq(s.selection))&&(o=!0);let p=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&Fz(this);if(o){this.domObserver.stop();let m=h&&(dn||Vt)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&oW(s.selection,e.selection);if(h){let y=Vt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=L9(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=g1(e.doc,c,l,this.dom,this)),y&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&c9(this))?Qr(this,m):(KA(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():p&&Bz(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof ee){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&u1(this,t.getBoundingClientRect(),e)}else u1(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new aR(e.slice,e.move,s<0?void 0:ee.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(dn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&$z(this.dom),Qr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Hz(this,e)}coordsAtPos(e,t=1){return FA(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return Yz(this,t||this.state,e)}pasteHTML(e,t){return tu(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return tu(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return lx(this,e)}destroy(){this.docView&&(S9(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],qm(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Nz())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return N9(this,e)}domSelectionRange(){let e=this.domSelection();return e?Yt&&this.root.nodeType===11&&Dz(this.dom.ownerDocument)==this.dom&&Y9(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}hR.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function V1(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[wn.node(0,n.state.doc.content.size,e)]}function j1(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:wn.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function L1(n){return!n.someProp("editable",e=>e(n.state)===!1)}function oW(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function F1(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function aW(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function B1(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var hi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},gf={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},lW=typeof navigator<"u"&&/Mac/.test(navigator.platform),cW=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var bt=0;bt<10;bt++)hi[48+bt]=hi[96+bt]=String(bt);for(var bt=1;bt<=24;bt++)hi[bt+111]="F"+bt;for(var bt=65;bt<=90;bt++)hi[bt]=String.fromCharCode(bt+32),gf[bt]=String.fromCharCode(bt);for(var Km in hi)gf.hasOwnProperty(Km)||(gf[Km]=hi[Km]);function uW(n){var e=lW&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||cW&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?gf:hi)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const dW=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),hW=typeof navigator<"u"&&/Win/.test(navigator.platform);function fW(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))dW?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function pW(n){let e=Object.create(null);for(let t in n)e[fW(t)]=n[t];return e}function Gm(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function mW(n){return new nn({props:{handleKeyDown:fR(n)}})}function fR(n){let e=pW(n);return function(t,r){let s=uW(r),i,o=e[Gm(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[Gm(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(hW&&r.ctrlKey&&r.altKey)&&(i=hi[r.keyCode])&&i!=s){let a=e[Gm(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const px=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function pR(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const mR=(n,e,t)=>{let r=pR(n,t);if(!r)return!1;let s=mx(r);if(!s){let o=r.blockRange(),a=o&&al(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(bR(n,s,e,-1))return!0;if(r.parent.content.size==0&&(Qa(i,"end")||ee.isSelectable(i)))for(let o=r.depth;;o--){let a=fp(n.doc,r.before(o),r.after(o),Q.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Qa(i,"end")?de.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):ee.create(l.doc,s.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},gW=(n,e,t)=>{let r=pR(n,t);if(!r)return!1;let s=mx(r);return s?gR(n,s,e):!1},yW=(n,e,t)=>{let r=vR(n,t);if(!r)return!1;let s=gx(r);return s?gR(n,s,e):!1};function gR(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=fp(n.doc,i,l,Q.empty);if(!c||c.from!=i||c instanceof ht&&c.slice.size>=l-i)return!1;if(t){let u=n.tr.step(c);u.setSelection(ae.create(u.doc,i)),t(u.scrollIntoView())}return!0}function Qa(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const yR=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=mx(r)}let o=i&&i.nodeBefore;return!o||!ee.isSelectable(o)?!1:(e&&e(n.tr.setSelection(ee.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function mx(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function vR(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const xR=(n,e,t)=>{let r=vR(n,t);if(!r)return!1;let s=gx(r);if(!s)return!1;let i=s.nodeAfter;if(bR(n,s,e,1))return!0;if(r.parent.content.size==0&&(Qa(i,"start")||ee.isSelectable(i))){let o=fp(n.doc,r.before(),r.after(),Q.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Qa(i,"start")?de.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):ee.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},wR=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=gx(r)}let o=i&&i.nodeAfter;return!o||!ee.isSelectable(o)?!1:(e&&e(n.tr.setSelection(ee.create(n.doc,i.pos)).scrollIntoView()),!0)};function gx(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const vW=(n,e)=>{let t=n.selection,r=t instanceof ee,s;if(r){if(t.node.isTextblock||!Ei(n.doc,t.from))return!1;s=t.from}else if(s=hp(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(ee.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},xW=(n,e)=>{let t=n.selection,r;if(t instanceof ee){if(t.node.isTextblock||!Ei(n.doc,t.to))return!1;r=t.to}else if(r=hp(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},wW=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&al(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},_R=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function yx(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const _W=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=yx(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(de.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},ER=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof En||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=yx(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(ae.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},kR=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Gr(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&al(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)};function EW(n){return(e,t)=>{let{$from:r,$to:s}=e.selection;if(e.selection instanceof ee&&e.selection.node.isBlock)return!r.parentOffset||!Gr(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],o,a,l=!1,c=!1;for(let m=r.depth;;m--)if(r.node(m).isBlock){l=r.end(m)==r.pos+(r.depth-m),c=r.start(m)==r.pos-(r.depth-m),a=yx(r.node(m-1).contentMatchAt(r.indexAfter(m-1))),i.unshift(l&&a?{type:a}:null),o=m;break}else{if(m==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof ae||e.selection instanceof En)&&u.deleteSelection();let h=u.mapping.map(r.pos),p=Gr(u.doc,h,i.length,i);if(p||(i[0]=a?{type:a}:null,p=Gr(u.doc,h,i.length,i)),!p)return!1;if(u.split(h,i.length,i),!l&&c&&r.node(o).type!=a){let m=u.mapping.map(r.before(o)),y=u.doc.resolve(m);a&&r.node(o-1).canReplaceWith(y.index(),y.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(o)),a)}return t&&t(u.scrollIntoView()),!0}}const kW=EW(),bW=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(ee.create(n.doc,s))),!0)};function TW(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||Ei(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function bR(n,e,t,r){let s=e.nodeBefore,i=e.nodeAfter,o,a,l=s.type.spec.isolating||i.type.spec.isolating;if(!l&&TW(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(a=s.contentMatchAt(s.childCount)).findWrapping(i.type))&&a.matchType(o[0]||i.type).validEnd){if(t){let m=e.pos+i.nodeSize,y=$.empty;for(let k=o.length-1;k>=0;k--)y=$.from(o[k].create(null,y));y=$.from(s.copy(y));let v=n.tr.step(new pt(e.pos-1,m,e.pos,m,new Q(y,1,0),o.length,!0)),w=v.doc.resolve(m+2*o.length);w.nodeAfter&&w.nodeAfter.type==s.type&&Ei(v.doc,w.pos)&&v.join(w.pos),t(v.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:de.findFrom(e,1),h=u&&u.$from.blockRange(u.$to),p=h&&al(h);if(p!=null&&p>=e.depth)return t&&t(n.tr.lift(h,p).scrollIntoView()),!0;if(c&&Qa(i,"start",!0)&&Qa(s,"end")){let m=s,y=[];for(;y.push(m),!m.isTextblock;)m=m.lastChild;let v=i,w=1;for(;!v.isTextblock;v=v.firstChild)w++;if(m.canReplace(m.childCount,m.childCount,v.content)){if(t){let k=$.empty;for(let T=y.length-1;T>=0;T--)k=$.from(y[T].copy(k));let b=n.tr.step(new pt(e.pos-y.length,e.pos+i.nodeSize,e.pos+w,e.pos+i.nodeSize-w,new Q(k,y.length,0),0,!0));t(b.scrollIntoView())}return!0}}return!1}function TR(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(ae.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const SW=TR(-1),IW=TR(1);function NW(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&rx(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function $1(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let u=t.doc.resolve(c),h=u.index();s=u.parent.canReplaceWith(h,h+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}function vx(...n){return function(e,t,r){for(let s=0;s<n.length;s++)if(n[s](e,t,r))return!0;return!1}}vx(px,mR,yR);vx(px,xR,wR);vx(_R,ER,kR,kW);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function CW(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i);if(!o)return!1;let a=r?t.tr:null;return AW(a,o,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function AW(n,e,t,r=null){let s=!1,i=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=o.resolve(e.start-2);i=new cf(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new cf(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),s=!0}let a=rx(i,t,r,e);return a?(n&&RW(n,e,a,s,t),!0):!1}function RW(n,e,t,r,s){let i=$.empty;for(let u=t.length-1;u>=0;u--)i=$.from(t[u].type.create(t[u].attrs,i));n.step(new pt(e.start-(r?2:0),e.end,e.start,e.end,new Q(i,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==s&&(o=u+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,h=e.endIndex,p=!0;u<h;u++,p=!1)!p&&Gr(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function PW(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?DW(e,t,n,i):MW(e,t,i):!0:!1}}function DW(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new pt(i-1,o,i,o,new Q($.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new cf(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=al(r);if(a==null)return!1;s.lift(r,a);let l=s.doc.resolve(s.mapping.map(i,-1)-1);return Ei(s.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&s.join(l.pos),e(s.scrollIntoView()),!0}function MW(n,e,t){let r=n.tr,s=t.parent;for(let m=t.end,y=t.endIndex-1,v=t.startIndex;y>v;y--)m-=s.child(y).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?$.empty:$.from(s))))return!1;let h=i.pos,p=h+o.nodeSize;return r.step(new pt(h-(a?1:0),p+(l?1:0),h+1,p-1,new Q((a?$.empty:$.from(s.copy($.empty))).append(l?$.empty:$.from(s.copy($.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function OW(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=$.from(c?n.create():null),h=new Q($.from(n.create(null,$.from(a.type.create(null,u)))),c?3:1,0),p=i.start,m=i.end;t(e.tr.step(new pt(p-(c?3:1),m,p,m,h,1,!0)).scrollIntoView())}return!0}}function vp(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}class xp{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const h=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(p=>p===!0)),h={...Object.fromEntries(Object.entries(r).map(([p,m])=>[p,(...v)=>{const w=this.buildProps(c,t),k=m(...v)(w);return a.push(k),h}])),run:u};return h}createCan(e){const{rawCommands:t,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:vp({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class VW{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}once(e,t){const r=(...s)=>{this.off(e,r),t.apply(this,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function Y(n,e,t){return n.config[e]===void 0&&n.parent?Y(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Y(n.parent,e,t):null}):n.config[e]}function wp(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function SR(n){const e=[],{nodeExtensions:t,markExtensions:r}=wp(n),s=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage,extensions:s},l=Y(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(h=>{Object.entries(u.attributes).forEach(([p,m])=>{e.push({type:h,name:p,attribute:{...i,...m}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=Y(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,h])=>{const p={...i,...h};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,e.push({type:o.name,name:u,attribute:p})})}),e}function gt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function Lt(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?String(i).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[h,p]=u.split(":").map(m=>m.trim());c.set(h,p)}),a.forEach(u=>{const[h,p]=u.split(":").map(m=>m.trim());c.set(h,p)}),r[s]=Array.from(c.entries()).map(([u,h])=>`${u}: ${h}`).join("; ")}else r[s]=i}),r},{})}function Qy(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>Lt(t,r),{})}function IR(n){return typeof n=="function"}function he(n,e=void 0,...t){return IR(n)?e?n.bind(e)(...t):n(...t):n}function jW(n={}){return Object.keys(n).length===0&&n.constructor===Object}function LW(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function U1(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):LW(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function z1(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&jW(t)?!1:t!=null))}function FW(n,e){var t;const r=SR(n),{nodeExtensions:s,markExtensions:i}=wp(n),o=(t=s.find(c=>Y(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(k=>k.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},p=n.reduce((k,b)=>{const T=Y(b,"extendNodeSchema",h);return{...k,...T?T(c):{}}},{}),m=z1({...p,content:he(Y(c,"content",h)),marks:he(Y(c,"marks",h)),group:he(Y(c,"group",h)),inline:he(Y(c,"inline",h)),atom:he(Y(c,"atom",h)),selectable:he(Y(c,"selectable",h)),draggable:he(Y(c,"draggable",h)),code:he(Y(c,"code",h)),whitespace:he(Y(c,"whitespace",h)),linebreakReplacement:he(Y(c,"linebreakReplacement",h)),defining:he(Y(c,"defining",h)),isolating:he(Y(c,"isolating",h)),attrs:Object.fromEntries(u.map(k=>{var b;return[k.name,{default:(b=k==null?void 0:k.attribute)===null||b===void 0?void 0:b.default}]}))}),y=he(Y(c,"parseHTML",h));y&&(m.parseDOM=y.map(k=>U1(k,u)));const v=Y(c,"renderHTML",h);v&&(m.toDOM=k=>v({node:k,HTMLAttributes:Qy(k,u)}));const w=Y(c,"renderText",h);return w&&(m.toText=w),[c.name,m]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(w=>w.type===c.name),h={name:c.name,options:c.options,storage:c.storage,editor:e},p=n.reduce((w,k)=>{const b=Y(k,"extendMarkSchema",h);return{...w,...b?b(c):{}}},{}),m=z1({...p,inclusive:he(Y(c,"inclusive",h)),excludes:he(Y(c,"excludes",h)),group:he(Y(c,"group",h)),spanning:he(Y(c,"spanning",h)),code:he(Y(c,"code",h)),attrs:Object.fromEntries(u.map(w=>{var k;return[w.name,{default:(k=w==null?void 0:w.attribute)===null||k===void 0?void 0:k.default}]}))}),y=he(Y(c,"parseHTML",h));y&&(m.parseDOM=y.map(w=>U1(w,u)));const v=Y(c,"renderHTML",h);return v&&(m.toDOM=w=>v({mark:w,HTMLAttributes:Qy(w,u)})),[c.name,m]}));return new mA({topNode:o,nodes:a,marks:l})}function Qm(n,e){return e.nodes[n]||e.marks[n]||null}function W1(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function xx(n,e){const t=Mo.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}const BW=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";t+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-i))}),t};function wx(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class _p{constructor(e){this.find=e.find,this.handler=e.handler}}const $W=(n,e)=>{if(wx(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function bd(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code))return!1;let u=!1;const h=BW(c)+i;return o.forEach(p=>{if(u)return;const m=$W(h,p.find);if(!m)return;const y=l.state.tr,v=vp({state:l.state,transaction:y}),w={from:r-(m[0].length-i.length),to:s},{commands:k,chain:b,can:T}=new xp({editor:t,state:v});p.handler({state:v,range:w,match:m,commands:k,chain:b,can:T})===null||!y.steps.length||(y.setMeta(a,{transform:y,from:r,to:s,text:i}),l.dispatch(y),u=!0)}),u}function UW(n){const{editor:e,rules:t}=n,r=new nn({state:{init(){return null},apply(s,i,o){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=xx($.from(u),o.schema);const{from:h}=l,p=h+u.length;bd({editor:e,from:h,to:p,text:u,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return bd({editor:e,from:i,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&bd({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?bd({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function zW(n){return Object.prototype.toString.call(n).slice(8,-1)}function Td(n){return zW(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Ep(n,e){const t={...n};return Td(n)&&Td(e)&&Object.keys(e).forEach(r=>{Td(e[r])&&Td(n[r])?t[r]=Ep(n[r],e[r]):t[r]=e[r]}),t}class is{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=he(Y(this,"addOptions",{name:this.name}))),this.storage=he(Y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new is(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Ep(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new is(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=he(Y(t,"addOptions",{name:t.name})),t.storage=he(Y(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}function WW(n){return typeof n=="number"}class qW{constructor(e){this.find=e.find,this.handler=e.handler}}const HW=(n,e,t)=>{if(wx(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function KW(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new xp({editor:e,state:t}),h=[];return t.doc.nodesBetween(r,s,(m,y)=>{if(!m.isTextblock||m.type.spec.code)return;const v=Math.max(r,y),w=Math.min(s,y+m.content.size),k=m.textBetween(v-y,w-y,void 0,"");HW(k,i.find,o).forEach(T=>{if(T.index===void 0)return;const C=v+T.index+1,P=C+T[0].length,D={from:t.tr.mapping.map(C),to:t.tr.mapping.map(P)},_=i.handler({state:t,range:D,match:T,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});h.push(_)})}),h.every(m=>m!==null)}let Sd=null;const GW=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function QW(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:h,to:p,rule:m,pasteEvt:y})=>{const v=u.tr,w=vp({state:u,transaction:v});if(!(!KW({editor:e,state:w,from:Math.max(h-1,0),to:p.b-1,rule:m,pasteEvent:y,dropEvent:a})||!v.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return t.map(u=>new nn({view(h){const p=y=>{var v;r=!((v=h.dom.parentElement)===null||v===void 0)&&v.contains(y.target)?h.dom.parentElement:null,r&&(Sd=e)},m=()=>{Sd&&(Sd=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(h,p)=>{if(i=r===h.dom.parentElement,a=p,!i){const m=Sd;m!=null&&m.isEditable&&setTimeout(()=>{const y=m.state.selection;y&&m.commands.deleteRange({from:y.from,to:y.to})},10)}return!1},paste:(h,p)=>{var m;const y=(m=p.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return o=p,s=!!(y!=null&&y.includes("data-pm-slice")),!1}}},appendTransaction:(h,p,m)=>{const y=h[0],v=y.getMeta("uiEvent")==="paste"&&!s,w=y.getMeta("uiEvent")==="drop"&&!i,k=y.getMeta("applyPasteRules"),b=!!k;if(!v&&!w&&!b)return;if(b){let{text:P}=k;typeof P=="string"?P=P:P=xx($.from(P),m.schema);const{from:D}=k,_=D+P.length,E=GW(P);return l({rule:u,state:m,from:D,to:{b:_},pasteEvt:E})}const T=p.doc.content.findDiffStart(m.doc.content),C=p.doc.content.findDiffEnd(m.doc.content);if(!(!WW(T)||!C||T===C.b))return l({rule:u,state:m,from:T,to:C,pasteEvt:o})}}))}function JW(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class pa{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=pa.resolve(e),this.schema=FW(this.extensions,t),this.setupExtensions()}static resolve(e){const t=pa.sort(pa.flatten(e)),r=JW(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=Y(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=Y(r,"priority")||100,o=Y(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Qm(t.name,this.schema)},s=Y(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=pa.sort([...this.extensions].reverse()),r=[],s=[],i=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:Qm(o.name,this.schema)},l=[],c=Y(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&Y(o,"exitable",a)&&(u.ArrowRight=()=>is.handleExit({editor:e,mark:o})),c){const v=Object.fromEntries(Object.entries(c()).map(([w,k])=>[w,()=>k({editor:e})]));u={...u,...v}}const h=mW(u);l.push(h);const p=Y(o,"addInputRules",a);W1(o,e.options.enableInputRules)&&p&&r.push(...p());const m=Y(o,"addPasteRules",a);W1(o,e.options.enablePasteRules)&&m&&s.push(...m());const y=Y(o,"addProseMirrorPlugins",a);if(y){const v=y();l.push(...v)}return l}).flat();return[UW({editor:e,rules:r}),...QW({editor:e,rules:s}),...i]}get attributes(){return SR(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=wp(this.extensions);return Object.fromEntries(t.filter(r=>!!Y(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:gt(r.name,this.schema)},o=Y(r,"addNodeView",i);if(!o)return[];const a=(l,c,u,h,p)=>{const m=Qy(l,s);return o()({node:l,view:c,getPos:u,decorations:h,innerDecorations:p,editor:e,extension:r,HTMLAttributes:m})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Qm(e.name,this.schema)};e.type==="mark"&&(!((t=he(Y(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=Y(e,"onBeforeCreate",r),i=Y(e,"onCreate",r),o=Y(e,"onUpdate",r),a=Y(e,"onSelectionUpdate",r),l=Y(e,"onTransaction",r),c=Y(e,"onFocus",r),u=Y(e,"onBlur",r),h=Y(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),h&&this.editor.on("destroy",h)})}}class Ft{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=he(Y(this,"addOptions",{name:this.name}))),this.storage=he(Y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ft(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Ep(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Ft({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=he(Y(t,"addOptions",{name:t.name})),t.storage=he(Y(t,"addStorage",{name:t.name,options:t.options})),t}}function NR(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="";return n.nodesBetween(r,s,(l,c,u,h)=>{var p;l.isBlock&&c>r&&(a+=i);const m=o==null?void 0:o[l.type.name];if(m)return u&&(a+=m({node:l,pos:c,parent:u,index:h,range:e})),!1;l.isText&&(a+=(p=l==null?void 0:l.text)===null||p===void 0?void 0:p.slice(Math.max(r,c)-c,s-c))}),a}function CR(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const YW=Ft.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new nn({key:new rr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=CR(t);return NR(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),XW=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),ZW=(n=!1)=>({commands:e})=>e.setContent("",n),e7=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,h=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),m=h.blockRange(p);if(!m)return;const y=al(m);if(a.type.isTextblock){const{defaultType:v}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(m.start,v)}(y||y===0)&&e.lift(m,y)})}),!0},t7=n=>e=>n(e),n7=()=>({state:n,dispatch:e})=>ER(n,e),r7=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new ae(r.doc.resolve(Math.max(o-1,0)))),!0},s7=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},i7=n=>({tr:e,state:t,dispatch:r})=>{const s=gt(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},o7=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},a7=()=>({state:n,dispatch:e})=>px(n,e),l7=()=>({commands:n})=>n.keyboardShortcut("Enter"),c7=()=>({state:n,dispatch:e})=>_W(n,e);function yf(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:wx(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function AR(n,e,t={}){return n.find(r=>r.type===e&&yf(Object.fromEntries(Object.keys(t).map(s=>[s,r.attrs[s]])),t))}function q1(n,e,t={}){return!!AR(n,e,t)}function _x(n,e,t){var r;if(!n||!e)return;let s=n.parent.childAfter(n.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=n.parent.childBefore(n.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(t=t||((r=s.node.marks[0])===null||r===void 0?void 0:r.attrs),!AR([...s.node.marks],e,t)))return;let o=s.index,a=n.start()+s.offset,l=o+1,c=a+s.node.nodeSize;for(;o>0&&q1([...n.parent.child(o-1).marks],e,t);)o-=1,a-=n.parent.child(o).nodeSize;for(;l<n.parent.childCount&&q1([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function bi(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const u7=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=bi(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(s){const h=_x(l,i,e);if(h&&h.from<=c&&h.to>=u){const p=ae.create(o,h.from,h.to);t.setSelection(p)}}return!0},d7=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function RR(n){return n instanceof ae}function Hi(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function PR(n,e=null){if(!e)return null;const t=de.atStart(n),r=de.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?ae.create(n,Hi(0,s,i),Hi(n.content.size,s,i)):ae.create(n,Hi(e,s,i),Hi(e,s,i))}function h7(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Ex(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const f7=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{(Ex()||h7())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!RR(t.state.selection))return o(),!0;const a=PR(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},p7=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),m7=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),DR=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&DR(r)}return n};function Id(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return DR(t)}function ru(n,e,t){if(n instanceof Zs||n instanceof $)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return $.fromArray(n.map(a=>e.nodeFromJSON(a)));const o=e.nodeFromJSON(n);return t.errorOnInvalidContent&&o.check(),o}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),ru("",e,t)}if(s){if(t.errorOnInvalidContent){let o=!1,a="";const l=new mA({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?ei.fromSchema(l).parseSlice(Id(n),t.parseOptions):ei.fromSchema(l).parse(Id(n),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=ei.fromSchema(e);return t.slice?i.parseSlice(Id(n),t.parseOptions).content:i.parse(Id(n),t.parseOptions)}return ru("",e,t)}function g7(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof ht||s instanceof pt))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(de.near(n.doc.resolve(o),t))}const y7=n=>!("type"in n),v7=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{var o;if(s){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=w=>{i.emit("contentError",{editor:i,error:w,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{ru(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(w){l(w)}try{a=ru(e,i.schema,{parseOptions:c,errorOnInvalidContent:(o=t.errorOnInvalidContent)!==null&&o!==void 0?o:i.options.enableContentCheck})}catch(w){return l(w),!1}let{from:u,to:h}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},p=!0,m=!0;if((y7(a)?a:[a]).forEach(w=>{w.check(),p=p?w.isText&&w.marks.length===0:!1,m=m?w.isBlock:!1}),u===h&&m){const{parent:w}=r.doc.resolve(u);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(u-=1,h+=1)}let v;if(p){if(Array.isArray(e))v=e.map(w=>w.text||"").join("");else if(e instanceof $){let w="";e.forEach(k=>{k.text&&(w+=k.text)}),v=w}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,u,h)}else v=a,r.replaceWith(u,h,v);t.updateSelection&&g7(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:v}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:v})}return!0},x7=()=>({state:n,dispatch:e})=>vW(n,e),w7=()=>({state:n,dispatch:e})=>xW(n,e),_7=()=>({state:n,dispatch:e})=>mR(n,e),E7=()=>({state:n,dispatch:e})=>xR(n,e),k7=()=>({state:n,dispatch:e,tr:t})=>{try{const r=hp(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},b7=()=>({state:n,dispatch:e,tr:t})=>{try{const r=hp(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},T7=()=>({state:n,dispatch:e})=>gW(n,e),S7=()=>({state:n,dispatch:e})=>yW(n,e);function MR(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function I7(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Ex()||MR()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const N7=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=I7(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function su(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?gt(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(h,p)=>{if(h.isText)return;const m=Math.max(r,p),y=Math.min(s,p+h.nodeSize);a.push({node:h,from:m,to:y})});const l=s-r,c=a.filter(h=>o?o.name===h.node.type.name:!0).filter(h=>yf(h.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((h,p)=>h+p.to-p.from,0)>=l}const C7=(n,e={})=>({state:t,dispatch:r})=>{const s=gt(n,t.schema);return su(t,s,e)?wW(t,r):!1},A7=()=>({state:n,dispatch:e})=>kR(n,e),R7=n=>({state:e,dispatch:t})=>{const r=gt(n,e.schema);return PW(r)(e,t)},P7=()=>({state:n,dispatch:e})=>_R(n,e);function kp(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function H1(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const D7=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=kp(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=gt(n,r.schema)),a==="mark"&&(o=bi(n,r.schema)),s&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,H1(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(h=>{o===h.type&&t.addMark(u,u+c.nodeSize,o.create(H1(h.attrs,e)))})})}),!0):!1},M7=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),O7=()=>({tr:n,dispatch:e})=>{if(e){const t=new En(n.doc);n.setSelection(t)}return!0},V7=()=>({state:n,dispatch:e})=>yR(n,e),j7=()=>({state:n,dispatch:e})=>wR(n,e),L7=()=>({state:n,dispatch:e})=>bW(n,e),F7=()=>({state:n,dispatch:e})=>IW(n,e),B7=()=>({state:n,dispatch:e})=>SW(n,e);function Jy(n,e,t={},r={}){return ru(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const $7=(n,e=!1,t={},r={})=>({editor:s,tr:i,dispatch:o,commands:a})=>{var l,c;const{doc:u}=i;if(t.preserveWhitespace!=="full"){const h=Jy(n,s.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck});return o&&i.replaceWith(0,u.content.size,h).setMeta("preventUpdate",!e),!0}return o&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck})};function OR(n,e){const t=bi(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function U7(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function z7(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function kx(n){return e=>z7(e.$from,n)}function W7(n,e){const t={from:0,to:n.content.size};return NR(n,t,e)}function q7(n,e){const t=gt(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function H7(n,e){const t=kp(typeof e=="string"?e:e.name,n.schema);return t==="node"?q7(n,e):t==="mark"?OR(n,e):{}}function VR(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n),o=_x(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function sh(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function Yy(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?bi(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(h=>i?i.name===h.type.name:!0).find(h=>yf(h.attrs,t,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:h,$to:p})=>{const m=h.pos,y=p.pos;n.doc.nodesBetween(m,y,(v,w)=>{if(!v.isText&&!v.marks.length)return;const k=Math.max(m,w),b=Math.min(y,w+v.nodeSize),T=b-k;o+=T,a.push(...v.marks.map(C=>({mark:C,from:k,to:b})))})}),o===0)return!1;const l=a.filter(h=>i?i.name===h.mark.type.name:!0).filter(h=>yf(h.mark.attrs,t,{strict:!1})).reduce((h,p)=>h+p.to-p.from,0),c=a.filter(h=>i?h.mark.type!==i&&h.mark.type.excludes(i):!0).reduce((h,p)=>h+p.to-p.from,0);return(l>0?l+c:l)>=o}function K7(n,e,t={}){if(!e)return su(n,null,t)||Yy(n,null,t);const r=kp(e,n.schema);return r==="node"?su(n,e,t):r==="mark"?Yy(n,e,t):!1}function K1(n,e){const{nodeExtensions:t}=wp(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=he(Y(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function bp(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let s=!0;return n.content.forEach(i=>{s!==!1&&(bp(i,{ignoreWhitespace:t,checkChildren:e})||(s=!1))}),s}return!1}function G7(n){return n instanceof ee}function Q7(n,e,t){var r;const{selection:s}=e;let i=null;if(RR(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,h,p)=>{if(c)return!1;if(u.isInline){const m=!p||p.type.allowsMarkType(t),y=!!t.isInSet(u.marks)||!u.marks.some(v=>v.type.excludes(t));c=m&&y}return!c}),c})}const J7=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=bi(n,r.schema);if(s)if(o){const c=OR(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,h=c.$to.pos;r.doc.nodesBetween(u,h,(p,m)=>{const y=Math.max(m,u),v=Math.min(m+p.nodeSize,h);p.marks.find(k=>k.type===l)?p.marks.forEach(k=>{l===k.type&&t.addMark(y,v,l.create({...k.attrs,...e}))}):t.addMark(y,v,l.create(e))})});return Q7(r,t,l)},Y7=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),X7=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=gt(n,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),i.isTextblock?s().command(({commands:a})=>$1(i,{...o,...e})(t)?!0:a.clearNodes()).command(({state:a})=>$1(i,{...o,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Z7=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=Hi(n,0,r.content.size),i=ee.create(r,s);e.setSelection(i)}return!0},e8=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=ae.atStart(r).from,a=ae.atEnd(r).to,l=Hi(s,o,a),c=Hi(i,o,a),u=ae.create(r,l,c);e.setSelection(u)}return!0},t8=n=>({state:e,dispatch:t})=>{const r=gt(n,e.schema);return OW(r)(e,t)};function G1(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const n8=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,u=sh(c,a.node().type.name,a.node().attrs);if(i instanceof ee&&i.node.isBlock)return!a.parentOffset||!Gr(o,a.pos)?!1:(r&&(n&&G1(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:U7(a.node(-1).contentMatchAt(a.indexAfter(-1)));let m=h&&p?[{type:p,attrs:u}]:void 0,y=Gr(e.doc,e.mapping.map(a.pos),1,m);if(!m&&!y&&Gr(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(y=!0,m=p?[{type:p,attrs:u}]:void 0),r){if(y&&(i instanceof ae&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,m),p&&!h&&!a.parentOffset&&a.parent.type!==p)){const v=e.mapping.map(a.before()),w=e.doc.resolve(v);a.node(-1).canReplaceWith(w.index(),w.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}n&&G1(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return y},r8=(n,e={})=>({tr:t,state:r,dispatch:s,editor:i})=>{var o;const a=gt(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const h=l.node(-1);if(h.type!==a)return!1;const p=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let k=$.empty;const b=l.index(-1)?1:l.index(-2)?2:3;for(let E=l.depth-b;E>=l.depth-3;E-=1)k=$.from(l.node(E).copy(k));const T=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,C={...sh(p,l.node().type.name,l.node().attrs),...e},P=((o=a.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(C))||void 0;k=k.append($.from(a.createAndFill(null,P)||void 0));const D=l.before(l.depth-(b-1));t.replace(D,l.after(-T),new Q(k,4-b,0));let _=-1;t.doc.nodesBetween(D,t.doc.content.size,(E,S)=>{if(_>-1)return!1;E.isTextblock&&E.content.size===0&&(_=S+1)}),_>-1&&t.setSelection(ae.near(t.doc.resolve(_))),t.scrollIntoView()}return!0}const m=c.pos===l.end()?h.contentMatchAt(0).defaultType:null,y={...sh(p,h.type.name,h.attrs),...e},v={...sh(p,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const w=m?[{type:a,attrs:y},{type:m,attrs:v}]:[{type:a,attrs:y}];if(!Gr(t.doc,l.pos,2))return!1;if(s){const{selection:k,storedMarks:b}=r,{splittableMarks:T}=i.extensionManager,C=b||k.$to.parentOffset&&k.$from.marks();if(t.split(l.pos,2,w).scrollIntoView(),!C||!s)return!0;const P=C.filter(D=>T.includes(D.type.name));t.ensureMarks(P)}return!0},Jm=(n,e)=>{const t=kx(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Ei(n.doc,t.pos)&&n.join(t.pos),!0},Ym=(n,e)=>{const t=kx(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Ei(n.doc,r)&&n.join(r),!0},s8=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:h,splittableMarks:p}=s.extensionManager,m=gt(n,o.schema),y=gt(e,o.schema),{selection:v,storedMarks:w}=o,{$from:k,$to:b}=v,T=k.blockRange(b),C=w||v.$to.parentOffset&&v.$from.marks();if(!T)return!1;const P=kx(D=>K1(D.type.name,h))(v);if(T.depth>=1&&P&&T.depth-P.depth<=1){if(P.node.type===m)return c.liftListItem(y);if(K1(P.node.type.name,h)&&m.validContent(P.node.content)&&a)return l().command(()=>(i.setNodeMarkup(P.pos,m),!0)).command(()=>Jm(i,m)).command(()=>Ym(i,m)).run()}return!t||!C||!a?l().command(()=>u().wrapInList(m,r)?!0:c.clearNodes()).wrapInList(m,r).command(()=>Jm(i,m)).command(()=>Ym(i,m)).run():l().command(()=>{const D=u().wrapInList(m,r),_=C.filter(E=>p.includes(E.type.name));return i.ensureMarks(_),D?!0:c.clearNodes()}).wrapInList(m,r).command(()=>Jm(i,m)).command(()=>Ym(i,m)).run()},i8=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=bi(n,r.schema);return Yy(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},o8=(n,e,t={})=>({state:r,commands:s})=>{const i=gt(n,r.schema),o=gt(e,r.schema),a=su(r,i,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(o,l):s.setNode(i,{...l,...t})},a8=(n,e={})=>({state:t,commands:r})=>{const s=gt(n,t.schema);return su(t,s,e)?r.lift(s):r.wrapIn(s,e)},l8=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},c8=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},u8=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=bi(n,r.schema),{$from:c,empty:u,ranges:h}=a;if(!s)return!0;if(u&&o){let{from:p,to:m}=a;const y=(i=c.marks().find(w=>w.type===l))===null||i===void 0?void 0:i.attrs,v=_x(c,l,y);v&&(p=v.from,m=v.to),t.removeMark(p,m,l)}else h.forEach(p=>{t.removeMark(p.$from.pos,p.$to.pos,l)});return t.removeStoredMark(l),!0},d8=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=kp(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=gt(n,r.schema)),a==="mark"&&(o=bi(n,r.schema)),s&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let h,p,m,y;t.selection.empty?r.doc.nodesBetween(c,u,(v,w)=>{i&&i===v.type&&(m=Math.max(w,c),y=Math.min(w+v.nodeSize,u),h=w,p=v)}):r.doc.nodesBetween(c,u,(v,w)=>{w<c&&i&&i===v.type&&(m=Math.max(w,c),y=Math.min(w+v.nodeSize,u),h=w,p=v),w>=c&&w<=u&&(i&&i===v.type&&t.setNodeMarkup(w,void 0,{...v.attrs,...e}),o&&v.marks.length&&v.marks.forEach(k=>{if(o===k.type){const b=Math.max(w,c),T=Math.min(w+v.nodeSize,u);t.addMark(b,T,o.create({...k.attrs,...e}))}}))}),p&&(h!==void 0&&t.setNodeMarkup(h,void 0,{...p.attrs,...e}),o&&p.marks.length&&p.marks.forEach(v=>{o===v.type&&t.addMark(m,y,o.create({...v.attrs,...e}))}))}),!0):!1},h8=(n,e={})=>({state:t,dispatch:r})=>{const s=gt(n,t.schema);return NW(s,e)(t,r)},f8=(n,e={})=>({state:t,dispatch:r})=>{const s=gt(n,t.schema);return CW(s,e)(t,r)};var p8=Object.freeze({__proto__:null,blur:XW,clearContent:ZW,clearNodes:e7,command:t7,createParagraphNear:n7,cut:r7,deleteCurrentNode:s7,deleteNode:i7,deleteRange:o7,deleteSelection:a7,enter:l7,exitCode:c7,extendMarkRange:u7,first:d7,focus:f7,forEach:p7,insertContent:m7,insertContentAt:v7,joinBackward:_7,joinDown:w7,joinForward:E7,joinItemBackward:k7,joinItemForward:b7,joinTextblockBackward:T7,joinTextblockForward:S7,joinUp:x7,keyboardShortcut:N7,lift:C7,liftEmptyBlock:A7,liftListItem:R7,newlineInCode:P7,resetAttributes:D7,scrollIntoView:M7,selectAll:O7,selectNodeBackward:V7,selectNodeForward:j7,selectParentNode:L7,selectTextblockEnd:F7,selectTextblockStart:B7,setContent:$7,setMark:J7,setMeta:Y7,setNode:X7,setNodeSelection:Z7,setTextSelection:e8,sinkListItem:t8,splitBlock:n8,splitListItem:r8,toggleList:s8,toggleMark:i8,toggleNode:o8,toggleWrap:a8,undoInputRule:l8,unsetAllMarks:c8,unsetMark:u8,updateAttributes:d8,wrapIn:h8,wrapInList:f8});const m8=Ft.create({name:"commands",addCommands(){return{...p8}}}),g8=Ft.create({name:"drop",addProseMirrorPlugins(){return[new nn({key:new rr("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),y8=Ft.create({name:"editable",addProseMirrorPlugins(){return[new nn({key:new rr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),v8=new rr("focusEvents"),x8=Ft.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new nn({key:v8,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),w8=Ft.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:h}=l,{pos:p,parent:m}=h,y=h.parent.isTextblock&&p>0?a.doc.resolve(p-1):h,v=y.parent.type.spec.isolating,w=h.pos-h.parentOffset,k=v&&y.parent.childCount===1?w===h.pos:de.atStart(c).from===p;return!u||!m.type.isTextblock||m.textContent.length||!k||k&&h.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ex()||MR()?i:s},addProseMirrorPlugins(){return[new nn({key:new rr("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(v=>v.getMeta("composition")))return;const r=n.some(v=>v.docChanged)&&!e.doc.eq(t.doc),s=n.some(v=>v.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:o,to:a}=e.selection,l=de.atStart(e.doc).from,c=de.atEnd(e.doc).to;if(i||!(o===l&&a===c)||!bp(t.doc))return;const p=t.tr,m=vp({state:t,transaction:p}),{commands:y}=new xp({editor:this.editor,state:m});if(y.clearNodes(),!!p.steps.length)return p}})]}}),_8=Ft.create({name:"paste",addProseMirrorPlugins(){return[new nn({key:new rr("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),E8=Ft.create({name:"tabindex",addProseMirrorPlugins(){return[new nn({key:new rr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Bi{get name(){return this.node.type.name}constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Bi(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Bi(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Bi(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,o=this.pos+r+(i?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(o);if(!s&&a.depth<=this.depth)return;const l=new Bi(a,this.editor,s,s?t:null);s&&(l.actualDepth=this.depth+1),e.push(new Bi(a,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(t);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>t[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,t,r))))}),s}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const k8=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function b8(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}class T8 extends VW{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:s})=>this.options.onDrop(t,r,s)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=b8(k8,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=IR(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(o))}),t.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[y8,YW.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),m8,x8,w8,E8,g8,_8].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new pa(s,this)}createCommandManager(){this.commandManager=new xp({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=Jy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=Jy(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=PR(t,this.options.autofocus);this.view=new hR(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:fa.create({doc:t,selection:r||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return H7(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return K7(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return xx(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return W7(this.state.doc,{blockSeparator:t,textSerializers:{...CR(this.schema),...r}})}get isEmpty(){return bp(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Bi(t,this)}get $doc(){return this.$pos(0)}}function Ja(n){return new _p({find:n.find,handler:({state:e,range:t,match:r})=>{const s=he(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),u=c+o.length;if(VR(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(v=>v===n.type&&v!==m.mark.type)).filter(m=>m.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const p=t.from+l+o.length;i.addMark(t.from+l,p,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function S8(n){return new _p({find:n.find,handler:({state:e,range:t,match:r})=>{const s=he(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const h=r[0][r[0].length-1];i.insertText(h,o+r[0].length-1),i.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?o:o-1;i.insert(c,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a))}i.scrollIntoView()}})}function Xy(n){return new _p({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=he(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function iu(n){return new _p({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=he(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&rx(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:h,storedMarks:p}=e,{splittableMarks:m}=n.editor.extensionManager,y=p||h.$to.parentOffset&&h.$from.marks();if(y){const v=y.filter(w=>m.includes(w.type.name));o.ensureMarks(v)}}if(n.keepAttributes){const h=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(h,i).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Ei(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)}})}class hn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=he(Y(this,"addOptions",{name:this.name}))),this.storage=he(Y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new hn(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Ep(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new hn(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=he(Y(t,"addOptions",{name:t.name})),t.storage=he(Y(t,"addStorage",{name:t.name,options:t.options})),t}}function Ya(n){return new qW({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=he(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),h=t.from+l.indexOf(a),p=h+a.length;if(VR(t.from,t.to,e.doc).filter(y=>y.mark.type.excluded.find(w=>w===n.type&&w!==y.mark.type)).filter(y=>y.to>h).length)return null;p<t.to&&o.delete(p,t.to),h>t.from&&o.delete(t.from+u,h),c=t.from+u+a.length,o.addMark(t.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function I8(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof ee){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let s=r.depth;for(;s>=0;){const i=r.index(s);if(r.node(s).contentMatchAt(i).matchType(e))return!0;s-=1}return!1}function N8(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jR={exports:{}},Xm={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q1;function C8(){if(Q1)return Xm;Q1=1;var n=Et;function e(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,i=n.useLayoutEffect,o=n.useDebugValue;function a(h,p){var m=p(),y=r({inst:{value:m,getSnapshot:p}}),v=y[0].inst,w=y[1];return i(function(){v.value=m,v.getSnapshot=p,l(v)&&w({inst:v})},[h,m,p]),s(function(){return l(v)&&w({inst:v}),h(function(){l(v)&&w({inst:v})})},[h]),o(m),m}function l(h){var p=h.getSnapshot;h=h.value;try{var m=p();return!t(h,m)}catch{return!0}}function c(h,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Xm.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,Xm}jR.exports=C8();var bx=jR.exports;const A8=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},R8=({contentComponent:n})=>{const e=bx.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return Et.createElement(Et.Fragment,null,Object.values(e))};function P8(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:QM.createPortal(r.reactElement,r.element,t)},n.forEach(s=>s())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(s=>s())}}}class D8 extends Et.Component{constructor(e){var t;super(e),this.editorContentRef=Et.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=P8(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return Et.createElement(Et.Fragment,null,Et.createElement("div",{ref:A8(t,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&Et.createElement(R8,{contentComponent:e.contentComponent}))}}const M8=O.forwardRef((n,e)=>{const t=Et.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return Et.createElement(D8,{key:t,innerRef:e,...n})}),O8=Et.memo(M8);var V8=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,s,i;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!n(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!n(s[1],t.get(s[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[s]))return!1;for(s=r;s--!==0;){var o=i[s];if(!(o==="_owner"&&e.$$typeof)&&!n(e[o],t[o]))return!1}return!0}return e!==e&&t!==t},j8=N8(V8),LR={exports:{}},Zm={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J1;function L8(){if(J1)return Zm;J1=1;var n=Et,e=bx;function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,i=n.useRef,o=n.useEffect,a=n.useMemo,l=n.useDebugValue;return Zm.useSyncExternalStoreWithSelector=function(c,u,h,p,m){var y=i(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=a(function(){function k(D){if(!b){if(b=!0,T=D,D=p(D),m!==void 0&&v.hasValue){var _=v.value;if(m(_,D))return C=_}return C=D}if(_=C,r(T,D))return _;var E=p(D);return m!==void 0&&m(_,E)?_:(T=D,C=E)}var b=!1,T,C,P=h===void 0?null:h;return[function(){return k(u())},P===null?void 0:function(){return k(P())}]},[u,h,p,m]);var w=s(c,y[0],y[1]);return o(function(){v.hasValue=!0,v.value=w},[w]),l(w),w},Zm}LR.exports=L8();var F8=LR.exports;const B8=typeof window<"u"?O.useLayoutEffect:O.useEffect;class $8{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}}function U8(n){var e;const[t]=O.useState(()=>new $8(n.editor)),r=F8.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!==null&&e!==void 0?e:j8);return B8(()=>t.watch(n.editor),[n.editor,t]),O.useDebugValue(r),r}const z8=!1,Zy=typeof window>"u",W8=Zy||!!(typeof window<"u"&&window.next);class Tx{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Zy||W8?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)===null||i===void 0?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)===null||i===void 0?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)===null||i===void 0?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)===null||i===void 0?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)===null||i===void 0?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)===null||i===void 0?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)===null||i===void 0?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)===null||i===void 0?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)===null||i===void 0?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)===null||i===void 0?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)===null||i===void 0?void 0:i.call(s,...r)}};return new T8(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((s,i)=>{var o;return s===((o=t.extensions)===null||o===void 0?void 0:o[i])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Tx.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function q8(n={},e=[]){const t=O.useRef(n);t.current=n;const[r]=O.useState(()=>new Tx(t)),s=bx.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return O.useDebugValue(s),O.useEffect(r.onRender(e)),U8({editor:s,selector:({transactionNumber:i})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&i===0?0:i+1}),s}const H8=O.createContext({editor:null});H8.Consumer;const K8=O.createContext({onDragStart:void 0}),G8=()=>O.useContext(K8);Et.forwardRef((n,e)=>{const{onDragStart:t}=G8(),r=n.as||"div";return Et.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const Q8=/^\s*>\s$/,J8=hn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[iu({find:Q8,type:this.type})]}}),Y8=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,X8=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Z8=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,eq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,tq=is.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ja({find:Y8,type:this.type}),Ja({find:Z8,type:this.type})]},addPasteRules(){return[Ya({find:X8,type:this.type}),Ya({find:eq,type:this.type})]}}),nq="listItem",Y1="textStyle",X1=/^\s*([-+*])\s$/,rq=hn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(nq,this.editor.getAttributes(Y1)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=iu({find:X1,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=iu({find:X1,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Y1),editor:this.editor})),[n]}}),sq=/(^|[^`])`([^`]+)`(?!`)/,iq=/(^|[^`])`([^`]+)`(?!`)/g,oq=is.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ja({find:sq,type:this.type})]},addPasteRules(){return[Ya({find:iq,type:this.type})]}}),aq=/^```([a-z]+)?[\s\n]$/,lq=/^~~~([a-z]+)?[\s\n]$/,cq=hn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",Lt(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(de.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[Xy({find:aq,type:this.type,getAttributes:n=>({language:n[1]})}),Xy({find:lq,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new nn({key:new rr("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!t||!i)return!1;const{tr:o,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(ae.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),uq=hn.create({name:"doc",topNode:!0,content:"block+"});function dq(n={}){return new nn({view(e){return new hq(e,n)}})}class hq{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,s=this.editorView.dom,i=s.getBoundingClientRect(),o=i.width/s.offsetWidth,a=i.height/s.offsetHeight;if(t){let h=e.nodeBefore,p=e.nodeAfter;if(h||p){let m=this.editorView.nodeDOM(this.cursorPos-(h?h.nodeSize:0));if(m){let y=m.getBoundingClientRect(),v=h?y.bottom:y.top;h&&p&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*a;r={left:y.left,right:y.right,top:v-w,bottom:v+w}}}}if(!r){let h=this.editorView.coordsAtPos(this.cursorPos),p=this.width/2*o;r={left:h.left-p,right:h.left+p,top:h.top,bottom:h.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let h=l.getBoundingClientRect(),p=h.width/l.offsetWidth,m=h.height/l.offsetHeight;c=h.left-l.scrollLeft*p,u=h.top-l.scrollTop*m}this.element.style.left=(r.left-c)/o+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=SA(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const fq=Ft.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[dq(this.options)]}});class He extends de{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return He.valid(r)?new He(r):de.near(r)}content(){return Q.empty}eq(e){return e instanceof He&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new He(e.resolve(t.pos))}getBookmark(){return new Sx(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!pq(e)||!mq(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&He.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let l=e.doc.resolve(s);if(He.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!ee.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let a=e.doc.resolve(s);if(He.valid(a))return a}return null}}}He.prototype.visible=!1;He.findFrom=He.findGapCursorFrom;de.jsonID("gapcursor",He);class Sx{constructor(e){this.pos=e}map(e){return new Sx(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return He.valid(t)?new He(t):de.near(t)}}function FR(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function pq(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||FR(s.type))return!0;if(s.inlineContent)return!1}}return!0}function mq(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||FR(s.type))return!0;if(s.inlineContent)return!1}}return!0}function gq(){return new nn({props:{decorations:wq,createSelectionBetween(n,e,t){return e.pos==t.pos&&He.valid(t)?new He(t):null},handleClick:vq,handleKeyDown:yq,handleDOMEvents:{beforeinput:xq}}})}const yq=fR({ArrowLeft:Nd("horiz",-1),ArrowRight:Nd("horiz",1),ArrowUp:Nd("vert",-1),ArrowDown:Nd("vert",1)});function Nd(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ae){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=He.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new He(c))),!0):!1}}function vq(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!He.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&ee.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new He(r))),!0)}function xq(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof He))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=$.empty;for(let o=r.length-1;o>=0;o--)s=$.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new Q(s,0,0));return i.setSelection(ae.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function wq(n){if(!(n.selection instanceof He))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Xe.create(n.doc,[wn.widget(n.selection.head,e,{key:"gapcursor"})])}const _q=Ft.create({name:"gapCursor",addProseMirrorPlugins(){return[gq()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=he(Y(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),Eq=hn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Lt(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const h=l.filter(p=>a.includes(p.type.name));c.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),kq=hn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Lt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Xy({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var vf=200,mt=function(){};mt.prototype.append=function(e){return e.length?(e=mt.from(e),!this.length&&e||e.length<vf&&this.leafAppend(e)||this.length<vf&&e.leafPrepend(this)||this.appendInner(e)):this};mt.prototype.prepend=function(e){return e.length?mt.from(e).append(this):this};mt.prototype.appendInner=function(e){return new bq(this,e)};mt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?mt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};mt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};mt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};mt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};mt.from=function(e){return e instanceof mt?e:e&&e.length?new BR(e):mt.empty};var BR=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=vf)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=vf)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(mt);mt.empty=new BR([]);var bq=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(mt);const Tq=500;class Kn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((h,p)=>{if(!h.step){s||(s=this.remapping(r,p+1),i=s.maps.length),i--,u.push(h);return}if(s){u.push(new or(h.map));let m=h.step.map(s.slice(i)),y;m&&o.maybeStep(m).doc&&(y=o.mapping.maps[o.mapping.maps.length-1],c.push(new or(y,void 0,void 0,c.length+u.length))),i--,y&&s.appendMap(y,i)}else o.maybeStep(h.step);if(h.selection)return a=s?h.selection.map(s.slice(i)):h.selection,l=new Kn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let h=e.steps[u].invert(e.docs[u]),p=new or(e.mapping.maps[u],h,t),m;(m=l&&l.merge(p))&&(p=m,u?i.pop():a=a.slice(0,a.length-1)),i.push(p),t&&(o++,t=void 0),s||(l=p)}let c=o-r.depth;return c>Iq&&(a=Sq(a,c),o-=c),new Kn(a.append(i),o)}remapping(e,t){let r=new Xc;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new Kn(this.items.append(e.map(t=>new or(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(p=>{p.selection&&a--},s);let l=t;this.items.forEach(p=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let y=i.maps[m];if(p.step){let v=e.steps[m].invert(e.docs[m]),w=p.selection&&p.selection.map(i.slice(l+1,m));w&&a++,r.push(new or(y,v,w))}else r.push(new or(y))},s);let c=[];for(let p=t;p<o;p++)c.push(new or(i.maps[p]));let u=this.items.slice(0,s).append(c).append(r),h=new Kn(u,a);return h.emptyItemCount()>Tq&&(h=h.compress(this.items.length-r.length)),h}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&i++;let h=new or(c.invert(),l,u),p,m=s.length-1;(p=s.length&&s[m].merge(h))?s[m]=p:s.push(h)}}else o.map&&r--},this.items.length,0),new Kn(mt.from(s.reverse()),i)}}Kn.empty=new Kn(mt.empty,0);function Sq(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class or{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new or(t.getMap().invert(),t,this.selection)}}}class ks{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const Iq=20;function Nq(n,e,t,r){let s=t.getMeta(no),i;if(s)return s.historyState;t.getMeta(Rq)&&(n=new ks(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(no))return o.getMeta(no).redo?new ks(n.done.addTransform(t,void 0,r,ih(e)),n.undone,Z1(t.mapping.maps),n.prevTime,n.prevComposition):new ks(n.done,n.undone.addTransform(t,void 0,r,ih(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Cq(t,n.prevRanges)),c=o?eg(n.prevRanges,t.mapping):Z1(t.mapping.maps);return new ks(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,ih(e)),Kn.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new ks(n.done.rebased(t,i),n.undone.rebased(t,i),eg(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new ks(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),eg(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Cq(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function Z1(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,s,i,o)=>e.push(i,o));return e}function eg(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function Aq(n,e,t){let r=ih(e),s=no.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new ks(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(no,{redo:t,historyState:l})}let tg=!1,eb=null;function ih(n){let e=n.plugins;if(eb!=e){tg=!1,eb=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){tg=!0;break}}return tg}const no=new rr("history"),Rq=new rr("closeHistory");function Pq(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new nn({key:no,state:{init(){return new ks(Kn.empty,Kn.empty,null,0,-1)},apply(e,t,r){return Nq(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?UR:r=="historyRedo"?zR:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function $R(n,e){return(t,r)=>{let s=no.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=Aq(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const UR=$R(!1,!0),zR=$R(!0,!0),Dq=Ft.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>UR(n,e),redo:()=>({state:n,dispatch:e})=>zR(n,e)}},addProseMirrorPlugins(){return[Pq(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Mq=hn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Lt(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!I8(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$from:r,$to:s}=t,i=n();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):G7(t)?i.insertContentAt(s.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var l;if(a){const{$to:c}=o.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?o.setSelection(ae.create(o.doc,c.pos+1)):c.nodeAfter.isBlock?o.setSelection(ee.create(o.doc,c.pos)):o.setSelection(ae.create(o.doc,c.pos));else{const h=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();h&&(o.insert(u,h),o.setSelection(ae.create(o.doc,u+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[S8({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Oq=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Vq=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,jq=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Lq=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Fq=is.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ja({find:Oq,type:this.type}),Ja({find:jq,type:this.type})]},addPasteRules(){return[Ya({find:Vq,type:this.type}),Ya({find:Lq,type:this.type})]}}),Bq=hn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Lt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),$q="listItem",tb="textStyle",nb=/^(\d+)\.\s$/,Uq=hn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",Lt(this.options.HTMLAttributes,t),0]:["ol",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes($q,this.editor.getAttributes(tb)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=iu({find:nb,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=iu({find:nb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(tb)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),zq=hn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Wq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,qq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Hq=is.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ja({find:Wq,type:this.type})]},addPasteRules(){return[Ya({find:qq,type:this.type})]}}),Kq=hn.create({name:"text",group:"inline"}),Gq=Ft.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(tq.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(J8.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(rq.configure(this.options.bulletList)),this.options.code!==!1&&n.push(oq.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(cq.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(uq.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(fq.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(_q.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(Eq.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(kq.configure(this.options.heading)),this.options.history!==!1&&n.push(Dq.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(Mq.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(Fq.configure(this.options.italic)),this.options.listItem!==!1&&n.push(Bq.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(Uq.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(zq.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(Hq.configure(this.options.strike)),this.options.text!==!1&&n.push(Kq.configure(this.options.text)),n}}),Qq=Ft.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new nn({key:new rr("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!t)return null;const i=this.editor.isEmpty;return n.descendants((o,a)=>{const l=r>=a&&r<=a+o.nodeSize,c=!o.isLeaf&&bp(o);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];i&&u.push(this.options.emptyEditorClass);const h=wn.node(a,a+o.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:a,hasAnchor:l}):this.options.placeholder});s.push(h)}return this.options.includeChildren}),Xe.create(n,s)}}})]}}),Jq=is.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",Lt(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),rb=({entry:n=null,onSave:e,onCancel:t})=>{var D;const{currentUser:r}=fn(),[s,i]=O.useState((n==null?void 0:n.title)||""),[o,a]=O.useState((n==null?void 0:n.tags)||[]),[l,c]=O.useState((n==null?void 0:n.linkedGoals)||[]),[u,h]=O.useState([]),[p,m]=O.useState(!1),[y,v]=O.useState(!1),w=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"],k=q8({extensions:[Gq.configure({heading:{levels:[1,2,3]}}),Jq,Qq.configure({placeholder:"Start writing your journal entry...",emptyNodeClass:"is-editor-empty"})],content:(n==null?void 0:n.content)||"",editorProps:{attributes:{class:"tiptap prose dark:prose-invert max-w-none focus:outline-none min-h-[400px] p-4"}}});O.useEffect(()=>{b()},[r]);const b=async()=>{if(r)try{const _=Rn(An(xe,"goals"),dt("userId","==",r.uid),dt("status","==","active")),S=(await Pn(_)).docs.map(N=>({id:N.id.replace(`${r.uid}_`,""),...N.data()}));h(S)}catch(_){console.error("Error fetching goals:",_)}},T=_=>{a(E=>E.includes(_)?E.filter(S=>S!==_):[...E,_])},C=_=>{c(E=>E.includes(_)?E.filter(S=>S!==_):[...E,_])},P=async()=>{if(!s.trim()&&!(k!=null&&k.getText().trim()))return;v(!0);const _={title:s.trim()||"Untitled Entry",content:(k==null?void 0:k.getHTML())||"",tags:o,linkedGoals:l};await e(_),v(!1)};return k?f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n?"Edit Journal Entry":"New Journal Entry"}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:P,disabled:y,className:"btn-primary flex items-center",children:y?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Qc,{className:"h-4 w-4 mr-2"}),"Save Entry"]})}),f.jsx("button",{onClick:t,className:"btn-secondary",disabled:y,children:"Cancel"})]})]}),f.jsx("input",{type:"text",value:s,onChange:_=>i(_.target.value),placeholder:"Entry Title",className:"w-full text-xl font-semibold bg-transparent border-none outline-none text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-600 mb-4"}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center",children:[f.jsx(KC,{className:"h-4 w-4 mr-1"}),"Tags"]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(_=>f.jsx("button",{onClick:()=>T(_),className:`px-3 py-1 text-sm rounded-full transition-colors ${o.includes(_)?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:_},_))})]}),f.jsxs("div",{children:[f.jsxs("button",{onClick:()=>m(!p),className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center hover:text-primary-600 dark:hover:text-primary-400",children:[f.jsx(E$,{className:"h-4 w-4 mr-1"}),"Link to Goals (",l.length,")"]}),p&&f.jsx("div",{className:"mt-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg max-h-48 overflow-y-auto",children:u.length===0?f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No active goals available"}):f.jsx("div",{className:"space-y-2",children:u.map(_=>f.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded",children:[f.jsx("input",{type:"checkbox",checked:l.includes(_.id),onChange:()=>C(_.id),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),f.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:_.title}),f.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",_.subsection,")"]})]},_.id))})})]})]}),f.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>k.chain().focus().toggleBold().run(),className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${k.isActive("bold")?"bg-gray-200 dark:bg-gray-700":""}`,children:f.jsx(GB,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>k.chain().focus().toggleItalic().run(),className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${k.isActive("italic")?"bg-gray-200 dark:bg-gray-700":""}`,children:f.jsx(w$,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>k.chain().focus().toggleUnderline().run(),className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${k.isActive("underline")?"bg-gray-200 dark:bg-gray-700":""}`,children:f.jsx(uU,{className:"h-4 w-4"})}),f.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),f.jsx("button",{onClick:()=>k.chain().focus().toggleBulletList().run(),className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${k.isActive("bulletList")?"bg-gray-200 dark:bg-gray-700":""}`,children:f.jsx(qC,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>k.chain().focus().toggleOrderedList().run(),className:`p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${k.isActive("orderedList")?"bg-gray-200 dark:bg-gray-700":""}`,children:f.jsx(b$,{className:"h-4 w-4"})}),f.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),f.jsx("button",{onClick:()=>k.chain().focus().undo().run(),className:"p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",disabled:!k.can().undo(),children:f.jsx(hU,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>k.chain().focus().redo().run(),className:"p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",disabled:!k.can().redo(),children:f.jsx(j$,{className:"h-4 w-4"})}),f.jsx("div",{className:"flex-1"}),f.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[((D=k.storage.characterCount)==null?void 0:D.characters())||0," characters"]})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto bg-white dark:bg-gray-900",children:f.jsx(O8,{editor:k})})]}):null},Yq=()=>{const{currentUser:n}=fn(),[e,t]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(null),[a,l]=O.useState(!1),[c,u]=O.useState(!1),[h,p]=O.useState(!0),[m,y]=O.useState(!0),[v,w]=O.useState(""),[k,b]=O.useState([]),[T,C]=O.useState("all"),[P,D]=O.useState(""),[_,E]=O.useState(""),S=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"];O.useEffect(()=>{N()},[n]),O.useEffect(()=>{M()},[e,v,k,T,P,_]);const N=async()=>{if(n)try{const H=Rn(An(xe,"journalEntries"),dt("userId","==",n.uid),Wr("date","desc")),B=(await Pn(H)).docs.map(G=>({id:G.id.replace(`${n.uid}_`,""),...G.data()}));t(B),s(B),B.length>0&&!i&&o(B[0])}catch(H){console.error("Error fetching journal entries:",H),se.error("Failed to load journal entries")}finally{p(!1)}},M=()=>{let H=[...e];if(v&&(H=H.filter(te=>{var B,G;return((B=te.title)==null?void 0:B.toLowerCase().includes(v.toLowerCase()))||((G=te.content)==null?void 0:G.toLowerCase().includes(v.toLowerCase()))})),k.length>0&&(H=H.filter(te=>{var B;return(B=te.tags)==null?void 0:B.some(G=>k.includes(G))})),T!=="all"){const te=new Date;let B,G;switch(T){case"today":B=new Date(te.setHours(0,0,0,0)),G=new Date(te.setHours(23,59,59,999));break;case"week":B=new Date(te.setDate(te.getDate()-7)),G=new Date;break;case"month":B=sf(te),G=rf(te);break;case"three-months":B=th(te,3),G=new Date;break;case"custom":B=P?new Date(P):null,G=_?new Date(_):null;break}B&&G&&(H=H.filter(oe=>{var _e;const Ne=((_e=oe.date)==null?void 0:_e.toDate())||new Date;return Ne>=B&&Ne<=G}))}s(H)},R=async H=>{if(n)try{const te=`entry_${Date.now()}`,B={...H,userId:n.uid,date:new Date,createdAt:Yn(),updatedAt:Yn()};await xr(Qe(xe,"journalEntries",`${n.uid}_${te}`),B);const G={id:te,...B,date:{toDate:()=>new Date},createdAt:{toDate:()=>new Date},updatedAt:{toDate:()=>new Date}};t([G,...e]),o(G),l(!1),se.success("Journal entry created successfully")}catch(te){console.error("Error creating entry:",te),se.error("Failed to create journal entry")}},A=async H=>{if(!(!n||!i))try{const te={...H,updatedAt:Yn()};await xr(Qe(xe,"journalEntries",`${n.uid}_${i.id}`),te,{merge:!0});const B=e.map(G=>G.id===i.id?{...G,...te,updatedAt:{toDate:()=>new Date}}:G);t(B),o({...i,...te}),u(!1),se.success("Journal entry updated successfully")}catch(te){console.error("Error updating entry:",te),se.error("Failed to update journal entry")}},ce=async H=>{if(!(!n||!confirm("Are you sure you want to delete this entry?")))try{await qa(Qe(xe,"journalEntries",`${n.uid}_${H}`));const te=e.filter(B=>B.id!==H);t(te),(i==null?void 0:i.id)===H&&o(te[0]||null),se.success("Journal entry deleted successfully")}catch(te){console.error("Error deleting entry:",te),se.error("Failed to delete journal entry")}},ke=H=>{b(te=>te.includes(H)?te.filter(B=>B!==H):[...te,H])};return h?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"flex h-[calc(100vh-8rem)] -mx-4 sm:-mx-6 lg:-mx-8",children:[f.jsx("button",{onClick:()=>y(!m),className:"lg:hidden fixed bottom-4 right-4 z-40 btn-primary rounded-full p-3 shadow-lg",children:m?f.jsx(ss,{className:"h-6 w-6"}):f.jsx(Yi,{className:"h-6 w-6"})}),f.jsxs("div",{className:`${m?"translate-x-0":"-translate-x-full"} lg:translate-x-0 fixed lg:relative z-30 lg:z-auto w-80 lg:w-96 h-full bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-transform duration-300 overflow-hidden flex flex-col`,children:[f.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Journal Entries"}),f.jsx("button",{onClick:()=>{l(!0),o(null),y(!1)},className:"btn-primary p-2",children:f.jsx(tr,{className:"h-5 w-5"})})]}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"text",value:v,onChange:H=>w(H.target.value),placeholder:"Search entries...",className:"input pl-10"}),f.jsx(B$,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]})]}),f.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[f.jsxs("div",{className:"mb-3",children:[f.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2 block",children:"Time Period"}),f.jsxs("select",{value:T,onChange:H=>C(H.target.value),className:"input text-sm",children:[f.jsx("option",{value:"all",children:"All Time"}),f.jsx("option",{value:"today",children:"Today"}),f.jsx("option",{value:"week",children:"Past Week"}),f.jsx("option",{value:"month",children:"This Month"}),f.jsx("option",{value:"three-months",children:"Past 3 Months"}),f.jsx("option",{value:"custom",children:"Custom Range"})]})]}),T==="custom"&&f.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[f.jsx("input",{type:"date",value:P,onChange:H=>D(H.target.value),className:"input text-sm"}),f.jsx("input",{type:"date",value:_,onChange:H=>E(H.target.value),className:"input text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wider mb-2 block",children:"Tags"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:S.map(H=>f.jsx("button",{onClick:()=>ke(H),className:`px-2 py-1 text-xs rounded-full transition-colors ${k.includes(H)?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:H},H))})]})]}),f.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?f.jsxs("div",{className:"p-8 text-center",children:[f.jsx(Yi,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.length===0?"No journal entries yet":"No entries match your filters"})]}):f.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:r.map(H=>{var te;return f.jsxs("div",{onClick:()=>{o(H),l(!1),u(!1),y(!1)},className:`p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors ${(i==null?void 0:i.id)===H.id?"bg-primary-50 dark:bg-primary-900/20 border-l-4 border-primary-600":""}`,children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:H.title||"Untitled Entry"}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2 mb-2",children:[(te=H.content)==null?void 0:te.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400",children:[f.jsx(wo,{className:"h-3 w-3 mr-1"}),H.date&&qt(H.date.toDate(),"MMM d, yyyy")]}),H.tags&&H.tags.length>0&&f.jsxs("div",{className:"flex items-center space-x-1",children:[H.tags.slice(0,2).map(B=>f.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full",children:B},B)),H.tags.length>2&&f.jsxs("span",{className:"text-xs text-gray-500",children:["+",H.tags.length-2]})]})]})]},H.id)})})})]}),f.jsx("div",{className:"flex-1 bg-white dark:bg-gray-900 overflow-hidden",children:a?f.jsx(rb,{onSave:R,onCancel:()=>{l(!1),o(r[0]||null)}}):c&&i?f.jsx(rb,{entry:i,onSave:A,onCancel:()=>u(!1)}):i?f.jsxs("div",{className:"h-full flex flex-col",children:[f.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:i.title||"Untitled Entry"}),f.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(wo,{className:"h-4 w-4 mr-1"}),i.date&&qt(i.date.toDate(),"MMMM d, yyyy")]}),i.tags&&i.tags.length>0&&f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(KC,{className:"h-4 w-4"}),i.tags.map(H=>f.jsx("span",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded text-xs",children:H},H))]})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>u(!0),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:f.jsx(up,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),f.jsx("button",{onClick:()=>ce(i.id),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:f.jsx(_o,{className:"h-5 w-5 text-red-600 dark:text-red-400"})})]})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:f.jsx("div",{className:"prose dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:i.content}})})]}):f.jsx("div",{className:"h-full flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Yi,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 mb-4",children:"Select an entry to read or create a new one"}),f.jsxs("button",{onClick:()=>l(!0),className:"btn-primary inline-flex items-center",children:[f.jsx(tr,{className:"h-5 w-5 mr-2"}),"Create New Entry"]})]})})})]})},ma=({goal:n,onUpdate:e,onDelete:t})=>{var D;const{currentUser:r}=fn(),[s,i]=O.useState(!1),[o,a]=O.useState(!1),[l,c]=O.useState(n.actionSteps||[]),[u,h]=O.useState(!1),p=()=>{var E;const _=(E=n.actionSteps)==null?void 0:E.filter(S=>!S.completed);return _==null?void 0:_[0]},m=async _=>{const E=[...l];E[_].completed=!E[_].completed,E[_].targetValue&&(E[_].currentValue=E[_].completed?E[_].targetValue:0),await v(E)},y=_=>{if(!_||_.length===0)return 0;let E=0,S=0;return _.forEach(N=>{N.targetValue?(E+=N.targetValue,S+=N.currentValue||0):(E+=1,S+=N.completed?1:0)}),Math.round(S/E*100)},v=async _=>{h(!0);try{const E=y(_),S=E===100?"completed":"active";await OC(Qe(xe,"goals",`${r.uid}_${n.id}`),{actionSteps:_,progress:E,status:S,updatedAt:new Date}),c(_),e&&e({...n,actionSteps:_,progress:E,status:S}),se.success("Goal updated successfully"),a(!1)}catch(E){console.error("Error updating goal:",E),se.error("Failed to update goal")}finally{h(!1)}},w=async()=>{if(confirm("Are you sure you want to delete this goal?")){h(!0);try{await qa(Qe(xe,"goals",`${r.uid}_${n.id}`)),t&&t(n.id),se.success("Goal deleted successfully")}catch(_){console.error("Error deleting goal:",_),se.error("Failed to delete goal")}finally{h(!1)}}},k=()=>{c([...l,{id:Date.now().toString(),description:"",completed:!1,targetValue:null,currentValue:0}])},b=_=>{c(l.filter((E,S)=>S!==_))},T=(_,E,S)=>{const N=[...l];N[_][E]=S,c(N)},C=p(),P={weekly:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",monthly:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",yearly:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",custom:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"};return f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-start justify-between mb-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:n.title}),f.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P[n.timeframe]}`,children:n.timeframe}),f.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:n.subsection})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:()=>a(!o),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:u,children:f.jsx(up,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),f.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:u,children:f.jsx(_o,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Progress"}),f.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[n.progress||0,"%"]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar-fill",style:{width:`${n.progress||0}%`}})})]}),!s&&C&&f.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[f.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"Next Step:"}),f.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[C.description,C.targetValue&&f.jsxs("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:["(",C.currentValue||0,"/",C.targetValue,")"]})]})]}),f.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400 mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(wo,{className:"h-4 w-4 mr-1"}),"Start:"," ",n.startDate&&qt(n.startDate.toDate(),"MMM d, yyyy")]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(zC,{className:"h-4 w-4 mr-1"}),"End: ",n.endDate&&qt(n.endDate.toDate(),"MMM d, yyyy")]})]}),f.jsx("button",{onClick:()=>i(!s),className:"w-full flex items-center justify-center py-2 text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors",children:s?f.jsxs(f.Fragment,{children:[f.jsx(e$,{className:"h-4 w-4 mr-1"}),"Hide Details"]}):f.jsxs(f.Fragment,{children:[f.jsx(Yv,{className:"h-4 w-4 mr-1"}),"Show All Steps"]})}),s&&f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Action Steps"}),o?f.jsxs("div",{className:"space-y-3",children:[l.map((_,E)=>f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx("input",{type:"text",value:_.description,onChange:S=>T(E,"description",S.target.value),className:"input flex-1",placeholder:"Step description"}),f.jsx("input",{type:"number",value:_.targetValue||"",onChange:S=>T(E,"targetValue",S.target.value?parseInt(S.target.value):null),className:"input w-20",placeholder:"Target"}),f.jsx("button",{onClick:()=>b(E),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:f.jsx(_o,{className:"h-4 w-4"})})]},_.id)),f.jsxs("div",{className:"flex space-x-2 mt-4",children:[f.jsx("button",{onClick:k,className:"btn-secondary",children:"Add Step"}),f.jsx("button",{onClick:()=>v(l),className:"btn-primary",disabled:u,children:"Save Changes"}),f.jsx("button",{onClick:()=>{c(n.actionSteps||[]),a(!1)},className:"btn-secondary",children:"Cancel"})]})]}):f.jsx("div",{className:"space-y-2",children:(D=n.actionSteps)==null?void 0:D.map((_,E)=>f.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg cursor-pointer",onClick:()=>m(E),children:[_.completed?f.jsx(n$,{className:"h-5 w-5 text-green-600 flex-shrink-0"}):f.jsx(s$,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),f.jsx("span",{className:`flex-1 ${_.completed?"line-through text-gray-500":"text-gray-900 dark:text-white"}`,children:_.description}),_.targetValue&&f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[_.currentValue||0,"/",_.targetValue]})]},_.id))})]})]})},WR=({subsection:n,onClose:e,onGoalCreated:t,parentGoal:r=null})=>{const{currentUser:s}=fn(),[i,o]=O.useState(!1),[a,l]=O.useState(!1),[c,u]=O.useState({title:"",description:"",timeframe:"monthly",customStartDate:"",customEndDate:"",actionSteps:[{id:"1",description:"",completed:!1,targetValue:null,currentValue:0}],parentGoalId:(r==null?void 0:r.id)||null}),h=()=>{const w=new Date;let k,b;switch(c.timeframe){case"weekly":k=di(w),b=SU(w);break;case"monthly":k=sf(w),b=rf(w);break;case"yearly":k=YC(w),b=TU(w);break;case"custom":k=c.customStartDate?new Date(c.customStartDate):w,b=c.customEndDate?new Date(c.customEndDate):Py(w,30);break;default:k=w,b=Py(w,30)}return{startDate:k,endDate:b}},p=()=>{u({...c,actionSteps:[...c.actionSteps,{id:Date.now().toString(),description:"",completed:!1,targetValue:null,currentValue:0}]})},m=w=>{c.actionSteps.length>1&&u({...c,actionSteps:c.actionSteps.filter((k,b)=>b!==w)})},y=(w,k,b)=>{const T=[...c.actionSteps];k==="targetValue"?T[w][k]=b?parseInt(b):null:T[w][k]=b,u({...c,actionSteps:T})},v=async w=>{if(w.preventDefault(),!c.title.trim()){se.error("Please enter a goal title");return}if(c.actionSteps.every(k=>!k.description.trim())){se.error("Please add at least one action step");return}o(!0);try{const{startDate:k,endDate:b}=h(),T=`goal_${Date.now()}`,C=c.actionSteps.filter(D=>D.description.trim()),P={title:c.title,description:c.description,subsection:n,timeframe:c.timeframe,startDate:k,endDate:b,actionSteps:C,progress:0,status:"active",userId:s.uid,parentGoalId:c.parentGoalId,createdAt:Yn(),updatedAt:Yn()};await xr(Qe(xe,"goals",`${s.uid}_${T}`),P),se.success("Goal created successfully!"),t&&t({id:T,...P,startDate:{toDate:()=>k},endDate:{toDate:()=>b},createdAt:{toDate:()=>new Date},updatedAt:{toDate:()=>new Date}}),e()}catch(k){console.error("Error creating goal:",k),se.error("Failed to create goal")}finally{o(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Create New Goal"}),f.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:f.jsx(ss,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]}),r&&f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:["Creating sub-goal for: ",r.title]})]}),f.jsxs("form",{onSubmit:v,className:"p-6 space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Goal Title *"}),f.jsx("input",{type:"text",value:c.title,onChange:w=>u({...c,title:w.target.value}),className:"input",placeholder:"e.g., Attend 20 Jiu Jitsu classes this month",disabled:i})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Description (Optional)"}),f.jsx("textarea",{value:c.description,onChange:w=>u({...c,description:w.target.value}),className:"input min-h-[80px]",placeholder:"Add more details about this goal...",disabled:i})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Timeframe"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:["weekly","monthly","yearly","custom"].map(w=>f.jsx("button",{type:"button",onClick:()=>u({...c,timeframe:w}),className:`px-4 py-2 rounded-lg border-2 transition-colors ${c.timeframe===w?"border-primary-600 bg-primary-50 dark:bg-primary-900/20 text-primary-600":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,disabled:i,children:w.charAt(0).toUpperCase()+w.slice(1)},w))})]}),c.timeframe==="custom"&&f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Start Date"}),f.jsx("input",{type:"date",value:c.customStartDate,onChange:w=>u({...c,customStartDate:w.target.value}),className:"input",disabled:i})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"End Date"}),f.jsx("input",{type:"date",value:c.customEndDate,onChange:w=>u({...c,customEndDate:w.target.value}),className:"input",disabled:i})]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"label mb-3",children:["Action Steps *",f.jsx("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:"(Define the steps needed to achieve this goal)"})]}),f.jsx("div",{className:"space-y-3",children:c.actionSteps.map((w,k)=>f.jsxs("div",{className:"flex items-start space-x-2",children:[f.jsx("div",{className:"flex-1",children:f.jsx("input",{type:"text",value:w.description,onChange:b=>y(k,"description",b.target.value),className:"input",placeholder:`Step ${k+1}: e.g., Attend class #${k+1}`,disabled:i})}),f.jsx("div",{className:"w-24",children:f.jsx("input",{type:"number",value:w.targetValue||"",onChange:b=>y(k,"targetValue",b.target.value),className:"input",placeholder:"Target",disabled:i})}),c.actionSteps.length>1&&f.jsx("button",{type:"button",onClick:()=>m(k),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",disabled:i,children:f.jsx(_o,{className:"h-5 w-5"})})]},w.id))}),f.jsxs("button",{type:"button",onClick:p,className:"mt-3 btn-secondary flex items-center",disabled:i,children:[f.jsx(tr,{className:"h-4 w-4 mr-2"}),"Add Step"]})]}),f.jsxs("div",{children:[f.jsxs("button",{type:"button",onClick:()=>l(!a),className:"flex items-center text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200",children:[f.jsx(Yv,{className:`h-4 w-4 mr-1 transition-transform ${a?"rotate-180":""}`}),"Advanced Options"]}),a&&f.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Advanced options like goal dependencies, notifications, and custom metrics will be available soon."})})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[f.jsx("button",{type:"button",onClick:e,className:"btn-secondary",disabled:i,children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn-primary flex items-center",disabled:i,children:i?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):f.jsxs(f.Fragment,{children:[f.jsx(ui,{className:"h-4 w-4 mr-2"}),"Create Goal"]})})]})]})]})})},Xq=()=>{const{currentUser:n}=fn(),[e,t]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[a,l]=O.useState(!1),[c,u]=O.useState("all"),[h,p]=O.useState("all"),[m,y]=O.useState("active"),v=["general","finances","fitness","jiu-jitsu","women","attractiveness","nutrition","philosophy","languages"];O.useEffect(()=>{w()},[n]),O.useEffect(()=>{k()},[e,c,h,m]);const w=async()=>{if(n)try{const C=Rn(An(xe,"goals"),dt("userId","==",n.uid),Wr("createdAt","desc")),D=(await Pn(C)).docs.map(_=>({id:_.id.replace(`${n.uid}_`,""),..._.data()}));t(D)}catch(C){console.error("Error fetching goals:",C)}finally{o(!1)}},k=()=>{let C=[...e];m!=="all"&&(C=C.filter(P=>P.status===m)),c!=="all"&&(C=C.filter(P=>P.timeframe===c)),h!=="all"&&(C=C.filter(P=>P.subsection===h)),s(C)},b=C=>r.filter(P=>P.timeframe===C),T={total:e.length,active:e.filter(C=>C.status==="active").length,completed:e.filter(C=>C.status==="completed").length,thisWeek:e.filter(C=>{var D;const P=(D=C.startDate)==null?void 0:D.toDate();return P&&C5(P)}).length,thisMonth:e.filter(C=>{var D;const P=(D=C.startDate)==null?void 0:D.toDate();return P&&N5(P)}).length,thisYear:e.filter(C=>{var D;const P=(D=C.startDate)==null?void 0:D.toDate();return P&&A5(P)}).length};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Goals Overview"}),f.jsx("p",{className:"opacity-90",children:"Track and manage all your goals across different life areas"})]}),f.jsxs("button",{onClick:()=>l(!0),className:"bg-white text-primary-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(tr,{className:"h-5 w-5 mr-2"}),"New Goal"]})]})}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T.total}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Goals"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-primary-600",children:T.active}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.completed}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completed"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.thisWeek}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Week"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-purple-600",children:T.thisMonth}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Month"})]}),f.jsxs("div",{className:"card text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-orange-600",children:T.thisYear}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This Year"})]})]}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex flex-wrap gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Status"}),f.jsxs("select",{value:m,onChange:C=>y(C.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Status"}),f.jsx("option",{value:"active",children:"Active"}),f.jsx("option",{value:"completed",children:"Completed"}),f.jsx("option",{value:"paused",children:"Paused"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Timeframe"}),f.jsxs("select",{value:c,onChange:C=>u(C.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Timeframes"}),f.jsx("option",{value:"weekly",children:"Weekly"}),f.jsx("option",{value:"monthly",children:"Monthly"}),f.jsx("option",{value:"yearly",children:"Yearly"}),f.jsx("option",{value:"custom",children:"Custom"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Life Area"}),f.jsxs("select",{value:h,onChange:C=>p(C.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Areas"}),v.map(C=>f.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1)},C))]})]})]})}),c==="all"?f.jsxs(f.Fragment,{children:[b("yearly").length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Yearly Goals (",b("yearly").length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:b("yearly").map(C=>f.jsx(ma,{goal:C,onUpdate:P=>{t(e.map(D=>D.id===P.id?P:D))},onDelete:P=>{t(e.filter(D=>D.id!==P))}},C.id))})]}),b("monthly").length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Monthly Goals (",b("monthly").length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:b("monthly").map(C=>f.jsx(ma,{goal:C,onUpdate:P=>{t(e.map(D=>D.id===P.id?P:D))},onDelete:P=>{t(e.filter(D=>D.id!==P))}},C.id))})]}),b("weekly").length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Weekly Goals (",b("weekly").length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:b("weekly").map(C=>f.jsx(ma,{goal:C,onUpdate:P=>{t(e.map(D=>D.id===P.id?P:D))},onDelete:P=>{t(e.filter(D=>D.id!==P))}},C.id))})]})]}):f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Filtered Goals (",r.length,")"]}),r.length===0?f.jsxs("div",{className:"card text-center py-12",children:[f.jsx(ui,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No goals match your filters"})]}):f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:r.map(C=>f.jsx(ma,{goal:C,onUpdate:P=>{t(e.map(D=>D.id===P.id?P:D))},onDelete:P=>{t(e.filter(D=>D.id!==P))}},C.id))})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Access to Life Areas"}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:v.map(C=>f.jsxs(gn,{to:`/subsection/${C}`,className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:C.charAt(0).toUpperCase()+C.slice(1)}),f.jsx(Ny,{className:"h-4 w-4 text-gray-400"})]},C))})]}),a&&f.jsx(WR,{subsection:"general",onClose:()=>l(!1),onGoalCreated:C=>{t([C,...e]),l(!1)}})]})},Zq=()=>{const{currentUser:n}=fn(),[e,t]=O.useState(!0),[r,s]=O.useState("30"),[i,o]=O.useState({journalStreak:0,totalJournalEntries:0,goalsCompleted:0,goalsActive:0,avgGoalProgress:0,jiuJitsuClasses:0,workouts:0});O.useEffect(()=>{a()},[n,r]);const a=async()=>{if(n)try{const h=$k(new Date,parseInt(r)),p=Rn(An(xe,"journalEntries"),dt("userId","==",n.uid),dt("date",">=",h),Wr("date","desc")),m=await Pn(p),y=Rn(An(xe,"goals"),dt("userId","==",n.uid)),w=(await Pn(y)).docs.map(D=>D.data()),k=m.docs.map(D=>D.data()),b=w.filter(D=>D.status==="completed").length,T=w.filter(D=>D.status==="active").length,C=T>0?w.filter(D=>D.status==="active").reduce((D,_)=>D+(_.progress||0),0)/T:0,P=l(k);o({journalStreak:P,totalJournalEntries:k.length,goalsCompleted:b,goalsActive:T,avgGoalProgress:Math.round(C),jiuJitsuClasses:0,workouts:0})}catch(u){console.error("Error fetching stats:",u),se.error("Failed to load statistics")}finally{t(!1)}},l=u=>{if(u.length===0)return 0;let h=0;const p=new Date,m=u.map(y=>{var v,w;return((w=(v=y.date)==null?void 0:v.toDate)==null?void 0:w.call(v))||new Date}).sort((y,v)=>v-y);for(let y=0;y<m.length;y++){const v=$k(p,y),w=m[y];if(qt(w,"yyyy-MM-dd")===qt(v,"yyyy-MM-dd"))h++;else break}return h},c=()=>{const u=`
Date Range,${r} days
Journal Streak,${i.journalStreak}
Total Journal Entries,${i.totalJournalEntries}
Goals Completed,${i.goalsCompleted}
Goals Active,${i.goalsActive}
Average Goal Progress,${i.avgGoalProgress}%
    `.trim(),h=new Blob([u],{type:"text/csv"}),p=window.URL.createObjectURL(h),m=document.createElement("a");m.href=p,m.download=`stats-${qt(new Date,"yyyy-MM-dd")}.csv`,m.click(),se.success("Stats exported to CSV")};return e?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Statistics"}),f.jsx("p",{className:"opacity-90",children:"Track your progress and analyze your performance"})]}),f.jsxs("button",{onClick:c,className:"bg-white text-purple-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(WC,{className:"h-5 w-5 mr-2"}),"Export CSV"]})]})}),f.jsx("div",{className:"card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date Range"}),f.jsxs("select",{value:r,onChange:u=>s(u.target.value),className:"input w-auto",children:[f.jsx("option",{value:"7",children:"Last 7 days"}),f.jsx("option",{value:"30",children:"Last 30 days"}),f.jsx("option",{value:"90",children:"Last 90 days"}),f.jsx("option",{value:"365",children:"Last year"})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(Yi,{className:"h-8 w-8 text-purple-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.journalStreak})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Journal Streak"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Consecutive days"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(Yi,{className:"h-8 w-8 text-purple-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.totalJournalEntries})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Total Entries"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"In selected period"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(ui,{className:"h-8 w-8 text-green-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.goalsCompleted})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Goals Completed"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Successfully achieved"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(ui,{className:"h-8 w-8 text-blue-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.goalsActive})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Active Goals"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Currently pursuing"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(Zv,{className:"h-8 w-8 text-orange-600"}),f.jsxs("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i.avgGoalProgress,"%"]})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Avg Progress"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Across active goals"})]}),f.jsxs("div",{className:"card opacity-50",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx(wo,{className:"h-8 w-8 text-indigo-600"}),f.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"-"})]}),f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Jiu Jitsu Classes"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Coming soon"})]})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Progress Over Time"}),f.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50 dark:bg-gray-800 rounded-lg",children:f.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Chart visualization will be implemented with Chart.js"})})]}),f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Life Areas Overview"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:"Progress towards win states in each life area"}),f.jsx("div",{className:"space-y-4",children:["Finances","Fitness","Jiu Jitsu","Philosophy"].map(u=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:u}),f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[Math.floor(Math.random()*100),"%"]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar-fill",style:{width:`${Math.floor(Math.random()*100)}%`}})})]},u))})]})]})},eH=()=>{var b,T,C,P;const{currentUser:n,userProfile:e,updateUserSettings:t,logout:r,resetPassword:s}=fn(),{theme:i,toggleTheme:o}=$C(),[a,l]=O.useState(!1),[c,u]=O.useState(!1),[h,p]=O.useState((e==null?void 0:e.displayName)||""),[m,y]=O.useState({emailNotifications:((b=e==null?void 0:e.settings)==null?void 0:b.emailNotifications)||!1,journalReminders:((T=e==null?void 0:e.settings)==null?void 0:T.journalReminders)||!1,goalDeadlineAlerts:((C=e==null?void 0:e.settings)==null?void 0:C.goalDeadlineAlerts)||!0,weeklyReports:((P=e==null?void 0:e.settings)==null?void 0:P.weeklyReports)||!1});O.useEffect(()=>{e!=null&&e.displayName&&p(e.displayName),e!=null&&e.settings&&y({emailNotifications:e.settings.emailNotifications||!1,journalReminders:e.settings.journalReminders||!1,goalDeadlineAlerts:e.settings.goalDeadlineAlerts||!0,weeklyReports:e.settings.weeklyReports||!1})},[e]);const v=async()=>{l(!0);try{await t({...e==null?void 0:e.settings,...m,displayName:h,theme:i}),se.success("Settings saved successfully")}catch(D){console.error("Error saving settings:",D),se.error("Failed to save settings")}finally{l(!1)}},w=async()=>{if(n!=null&&n.email){u(!0);try{await s(n.email),se.success("Password reset email sent")}catch(D){console.error("Error sending reset email:",D),se.error("Failed to send reset email")}finally{u(!1)}}},k=async()=>{confirm("Are you sure you want to sign out?")&&await r()};return f.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[f.jsxs("div",{className:"bg-gradient-to-r from-gray-700 to-gray-800 dark:from-gray-800 dark:to-gray-900 rounded-lg p-6 text-white",children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Settings"}),f.jsx("p",{className:"opacity-90",children:"Manage your account and application preferences"})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(GC,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Profile Information"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Display Name"}),f.jsx("input",{type:"text",value:h,onChange:D=>p(D.target.value),placeholder:"Enter your name",className:"input"}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"This is how you'll be greeted in the app"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Email Address"}),f.jsx("input",{type:"email",value:(n==null?void 0:n.email)||"",disabled:!0,className:"input bg-gray-50 dark:bg-gray-800"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"User ID"}),f.jsx("input",{type:"text",value:(n==null?void 0:n.uid)||"",disabled:!0,className:"input bg-gray-50 dark:bg-gray-800 font-mono text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Member Since"}),f.jsx("input",{type:"text",value:e!=null&&e.createdAt?new Date(e.createdAt.seconds*1e3).toLocaleDateString():"N/A",disabled:!0,className:"input bg-gray-50 dark:bg-gray-800"})]})]}),f.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:f.jsx("button",{onClick:v,disabled:a,className:"btn-primary flex items-center",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Qc,{className:"h-4 w-4 mr-2"}),"Save Profile"]})})})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[i==="light"?f.jsx(tf,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}):f.jsx(Xv,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Appearance"})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Theme"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Choose your preferred color scheme"})]}),f.jsx("button",{onClick:o,className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i==="dark"?"translate-x-6":"translate-x-1"}`})})]})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(HB,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Notifications"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Email Notifications"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Receive updates about your goals and progress"})]}),f.jsx("button",{onClick:()=>y({...m,emailNotifications:!m.emailNotifications}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.emailNotifications?"translate-x-6":"translate-x-1"}`})})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Journal Reminders"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Daily reminders to write in your journal"})]}),f.jsx("button",{onClick:()=>y({...m,journalReminders:!m.journalReminders}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.journalReminders?"translate-x-6":"translate-x-1"}`})})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Goal Deadline Alerts"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Notifications when goals are approaching deadlines"})]}),f.jsx("button",{onClick:()=>y({...m,goalDeadlineAlerts:!m.goalDeadlineAlerts}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.goalDeadlineAlerts?"translate-x-6":"translate-x-1"}`})})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Weekly Progress Reports"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Weekly email summary of your progress"})]}),f.jsx("button",{onClick:()=>y({...m,weeklyReports:!m.weeklyReports}),className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-700 transition-colors",children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m.weeklyReports?"translate-x-6":"translate-x-1"}`})})]})]}),f.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:f.jsx("button",{onClick:v,disabled:a,className:"btn-primary flex items-center",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Qc,{className:"h-4 w-4 mr-2"}),"Save Notification Settings"]})})})]}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(W$,{className:"h-6 w-6 text-gray-600 dark:text-gray-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Security"})]}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Password Reset"}),f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Send a password reset link to your email address"}),f.jsx("button",{onClick:w,disabled:c,className:"btn-secondary flex items-center",children:c?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"}),"Sending..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Ry,{className:"h-4 w-4 mr-2"}),"Send Reset Email"]})})]})})]}),f.jsxs("div",{className:"card border-red-200 dark:border-red-900",children:[f.jsxs("div",{className:"flex items-center mb-6",children:[f.jsx(Ay,{className:"h-6 w-6 text-red-600 dark:text-red-400 mr-3"}),f.jsx("h2",{className:"text-xl font-semibold text-red-600 dark:text-red-400",children:"Danger Zone"})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Sign out of your account on this device"}),f.jsxs("button",{onClick:k,className:"btn-danger flex items-center",children:[f.jsx(Ay,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})]})},tH=()=>{const{subsectionName:n}=SO(),{currentUser:e}=fn(),[t,r]=O.useState(null),[s,i]=O.useState([]),[o,a]=O.useState(!1),[l,c]=O.useState(!1),[u,h]=O.useState(!0),[p,m]=O.useState({description:"",metrics:[]}),y={finances:{name:"Finances",icon:"",color:"bg-green-500",defaultMetrics:[{name:"Net Worth",unit:"$",targetValue:0,currentValue:0},{name:"Passive Income",unit:"$/month",targetValue:0,currentValue:0}]},fitness:{name:"Fitness",icon:"",color:"bg-blue-500",defaultMetrics:[{name:"Body Weight",unit:"lbs",targetValue:0,currentValue:0},{name:"Body Fat %",unit:"%",targetValue:0,currentValue:0},{name:"Bench Press",unit:"lbs",targetValue:0,currentValue:0}]},"jiu-jitsu":{name:"Jiu Jitsu",icon:"",color:"bg-purple-500",defaultMetrics:[{name:"Belt Level",unit:"",targetValue:0,currentValue:0},{name:"Classes Attended",unit:"classes",targetValue:0,currentValue:0},{name:"Competitions Won",unit:"wins",targetValue:0,currentValue:0}]},women:{name:"Women",icon:"",color:"bg-pink-500",defaultMetrics:[{name:"Relationship Quality",unit:"/10",targetValue:0,currentValue:0},{name:"Social Confidence",unit:"/10",targetValue:0,currentValue:0}]},attractiveness:{name:"Attractiveness",icon:"",color:"bg-yellow-500",defaultMetrics:[{name:"Physical Fitness",unit:"/10",targetValue:0,currentValue:0},{name:"Style & Grooming",unit:"/10",targetValue:0,currentValue:0},{name:"Charisma",unit:"/10",targetValue:0,currentValue:0}]},nutrition:{name:"Nutrition",icon:"",color:"bg-green-400",defaultMetrics:[{name:"Daily Calories",unit:"kcal",targetValue:0,currentValue:0},{name:"Protein Intake",unit:"g/day",targetValue:0,currentValue:0},{name:"Healthy Meals",unit:"/week",targetValue:0,currentValue:0}]},philosophy:{name:"Philosophy",icon:"",color:"bg-indigo-500",defaultMetrics:[{name:"Books Read",unit:"books",targetValue:0,currentValue:0},{name:"Meditation Practice",unit:"days/year",targetValue:0,currentValue:0},{name:"Life Satisfaction",unit:"/10",targetValue:0,currentValue:0}]},languages:{name:"Languages",icon:"",color:"bg-teal-500",defaultMetrics:[{name:"Languages Fluent",unit:"languages",targetValue:0,currentValue:0},{name:"Vocabulary Size",unit:"words",targetValue:0,currentValue:0},{name:"Practice Hours",unit:"hrs/week",targetValue:0,currentValue:0}]}},v=y[n]||y.fitness;O.useEffect(()=>{w()},[e,n]);const w=async()=>{var E,S;if(e)try{const N=await Gv(Qe(xe,"lifeSubsections",`${e.uid}_${n}`));if(N.exists()){const ce=N.data();r(ce.winState),m({description:((E=ce.winState)==null?void 0:E.description)||"",metrics:((S=ce.winState)==null?void 0:S.metrics)||v.defaultMetrics})}else m({description:"",metrics:v.defaultMetrics});const M=Rn(An(xe,"goals"),dt("userId","==",e.uid),dt("subsection","==",n),Wr("createdAt","desc")),A=(await Pn(M)).docs.map(ce=>({id:ce.id.replace(`${e.uid}_`,""),...ce.data()}));i(A)}catch(N){console.error("Error fetching subsection data:",N),se.error("Failed to load subsection data")}finally{h(!1)}},k=async()=>{if(e)try{await xr(Qe(xe,"lifeSubsections",`${e.uid}_${n}`),{name:n,userId:e.uid,winState:p,updatedAt:Yn()},{merge:!0}),r(p),a(!1),se.success("Win state updated successfully")}catch(E){console.error("Error saving win state:",E),se.error("Failed to save win state")}},b=()=>{m({...p,metrics:[...p.metrics,{name:"",unit:"",targetValue:0,currentValue:0}]})},T=(E,S,N)=>{const M=[...p.metrics];M[E][S]=S.includes("Value")?parseFloat(N)||0:N,m({...p,metrics:M})},C=E=>{m({...p,metrics:p.metrics.filter((S,N)=>N!==E)})},P=()=>{if(!(t!=null&&t.metrics)||t.metrics.length===0)return 0;let E=0,S=0;return t.metrics.forEach(N=>{if(N.targetValue>0){const M=N.currentValue/N.targetValue*100;E+=Math.min(M,100),S++}}),S>0?Math.round(E/S):0},D=s.filter(E=>E.status==="active"),_=s.filter(E=>E.status==="completed");return u?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-gray-800 to-gray-700 dark:from-gray-900 dark:to-gray-800 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:`w-16 h-16 ${v.color} rounded-full flex items-center justify-center text-3xl`,children:v.icon}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold",children:v.name}),f.jsx("p",{className:"text-gray-300 mt-1",children:"Track your progress and achieve your goals"})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-sm text-gray-400",children:"Overall Progress"}),f.jsxs("p",{className:"text-3xl font-bold",children:[P(),"%"]})]})]})}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center",children:[f.jsx(lU,{className:"h-6 w-6 mr-2 text-yellow-500"}),"Win State"]}),f.jsx("button",{onClick:()=>a(!o),className:"btn-secondary flex items-center",children:o?f.jsxs(f.Fragment,{children:[f.jsx(ss,{className:"h-4 w-4 mr-2"}),"Cancel"]}):f.jsxs(f.Fragment,{children:[f.jsx(up,{className:"h-4 w-4 mr-2"}),"Edit"]})})]}),o?f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Win State Description"}),f.jsx("textarea",{value:p.description,onChange:E=>m({...p,description:E.target.value}),className:"input min-h-[100px]",placeholder:"Describe what success looks like in this area..."})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Success Metrics"}),f.jsx("div",{className:"space-y-3",children:p.metrics.map((E,S)=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("input",{type:"text",value:E.name,onChange:N=>T(S,"name",N.target.value),className:"input flex-1",placeholder:"Metric name"}),f.jsx("input",{type:"text",value:E.unit,onChange:N=>T(S,"unit",N.target.value),className:"input w-24",placeholder:"Unit"}),f.jsx("input",{type:"number",value:E.currentValue,onChange:N=>T(S,"currentValue",N.target.value),className:"input w-32",placeholder:"Current"}),f.jsx("input",{type:"number",value:E.targetValue,onChange:N=>T(S,"targetValue",N.target.value),className:"input w-32",placeholder:"Target"}),f.jsx("button",{onClick:()=>C(S),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg",children:f.jsx(ss,{className:"h-4 w-4"})})]},S))}),f.jsxs("div",{className:"flex space-x-2 mt-4",children:[f.jsx("button",{onClick:b,className:"btn-secondary",children:"Add Metric"}),f.jsxs("button",{onClick:k,className:"btn-primary",children:[f.jsx(Qc,{className:"h-4 w-4 mr-2"}),"Save Win State"]})]})]})]}):f.jsxs("div",{children:[t!=null&&t.description?f.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:t.description}):f.jsx("p",{className:"text-gray-500 dark:text-gray-400 italic mb-4",children:"No win state defined yet. Click edit to define your success criteria."}),(t==null?void 0:t.metrics)&&t.metrics.length>0&&f.jsx("div",{className:"space-y-3",children:t.metrics.map((E,S)=>f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:E.name}),f.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[E.currentValue," / ",E.targetValue," ",E.unit]})]}),f.jsx("div",{className:"progress-bar",children:f.jsx("div",{className:"progress-bar-fill",style:{width:`${Math.min(E.currentValue/E.targetValue*100,100)}%`}})})]},S))})]})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Active Goals (",D.length,")"]}),f.jsxs("button",{onClick:()=>c(!0),className:"btn-primary flex items-center",children:[f.jsx(tr,{className:"h-4 w-4 mr-2"}),"Create Goal"]})]}),D.length===0?f.jsxs("div",{className:"card text-center py-12",children:[f.jsx(ui,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No active goals in this area yet"}),f.jsxs("button",{onClick:()=>c(!0),className:"btn-primary inline-flex items-center",children:[f.jsx(tr,{className:"h-4 w-4 mr-2"}),"Create Your First Goal"]})]}):f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:D.map(E=>f.jsx(ma,{goal:E,onUpdate:S=>{i(s.map(N=>N.id===S.id?S:N))},onDelete:S=>{i(s.filter(N=>N.id!==S))}},E.id))})]}),_.length>0&&f.jsxs("div",{children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:["Completed Goals (",_.length,")"]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:_.map(E=>f.jsx(ma,{goal:E,onUpdate:S=>{i(s.map(N=>N.id===S.id?S:N))},onDelete:S=>{i(s.filter(N=>N.id!==S))}},E.id))})]}),l&&f.jsx(WR,{subsection:n,onClose:()=>c(!1),onGoalCreated:E=>{i([E,...s]),c(!1)}})]})},nH=()=>{const{currentUser:n}=fn(),[e,t]=O.useState("grid"),[r,s]=O.useState(!1),[i,o]=O.useState(!0),[a,l]=O.useState(!1),c=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=["Early Morning","Morning","Late Morning","Afternoon","Late Afternoon","Evening","Night"],h={"Early Morning":f.jsx(J$,{className:"h-4 w-4 text-orange-500"}),Morning:f.jsx(a$,{className:"h-4 w-4 text-amber-600"}),"Late Morning":f.jsx(tf,{className:"h-4 w-4 text-yellow-500"}),Afternoon:f.jsx(tf,{className:"h-4 w-4 text-yellow-600"}),"Late Afternoon":f.jsx(X$,{className:"h-4 w-4 text-orange-600"}),Evening:f.jsx(Xv,{className:"h-4 w-4 text-indigo-600"}),Night:f.jsx(WB,{className:"h-4 w-4 text-purple-600"})},p={"Early Morning":"5:30-7:00",Morning:"7:00-10:00","Late Morning":"10:00-12:00",Afternoon:"12:00-3:30","Late Afternoon":"3:30-6:00",Evening:"6:00-8:30",Night:"8:30-10:00"},[m,y]=O.useState({}),[v,w]=O.useState({});O.useEffect(()=>{k()},[n]);const k=async()=>{if(n)try{const P=await Gv(Qe(xe,"weeklySchedule",n.uid));if(P.exists())y(P.data().schedule||{}),w(P.data().schedule||{});else{const D={};c.forEach(_=>{D[_]={},u.forEach(E=>{D[_][E]=""})}),y(D),w(D)}}catch(P){console.error("Error fetching schedule:",P),se.error("Failed to load schedule")}finally{o(!1)}},b=async()=>{if(n){l(!0);try{await xr(Qe(xe,"weeklySchedule",n.uid),{schedule:v,userId:n.uid,updatedAt:Yn()}),y(v),s(!1),se.success("Schedule saved successfully")}catch(P){console.error("Error saving schedule:",P),se.error("Failed to save schedule")}finally{l(!1)}}},T=(P,D,_)=>{w({...v,[P]:{...v[P],[D]:_}})},C=()=>{w(m),s(!1)};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"My Week"}),f.jsx("p",{className:"opacity-90",children:"Your typical weekly schedule template"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("div",{className:"bg-white/20 rounded-lg p-1 flex",children:[f.jsx("button",{onClick:()=>t("grid"),className:`p-2 rounded transition-colors ${e==="grid"?"bg-white text-blue-600":"text-white hover:bg-white/20"}`,title:"Grid View",children:f.jsx(v$,{className:"h-5 w-5"})}),f.jsx("button",{onClick:()=>t("list"),className:`p-2 rounded transition-colors ${e==="list"?"bg-white text-blue-600":"text-white hover:bg-white/20"}`,title:"List View",children:f.jsx(qC,{className:"h-5 w-5"})})]}),r?f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{onClick:b,disabled:a,className:"bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:a?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Qc,{className:"h-5 w-5 mr-2"}),"Save"]})}),f.jsx("button",{onClick:C,className:"bg-white/20 text-white px-4 py-2 rounded-lg font-medium hover:bg-white/30 transition-colors",children:f.jsx(ss,{className:"h-5 w-5"})})]}):f.jsxs("button",{onClick:()=>s(!0),className:"bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(up,{className:"h-5 w-5 mr-2"}),"Edit Schedule"]})]})]})}),e==="grid"?f.jsx("div",{className:"card overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{className:"text-left p-3 font-medium text-gray-700 dark:text-gray-300",children:"Time"}),c.map(P=>f.jsx("th",{className:"text-left p-3 font-medium text-gray-700 dark:text-gray-300 min-w-[120px]",children:P},P))]})}),f.jsx("tbody",{children:u.map(P=>f.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700",children:[f.jsx("td",{className:"p-3",children:f.jsxs("div",{className:"flex items-center space-x-2",children:[h[P],f.jsxs("div",{children:[f.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:P}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:p[P]})]})]})}),c.map(D=>{var _,E;return f.jsx("td",{className:"p-3",children:r?f.jsx("input",{type:"text",value:((_=v[D])==null?void 0:_[P])||"",onChange:S=>T(D,P,S.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-1 focus:ring-primary-500",placeholder:"Add activity..."}):f.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:((E=m[D])==null?void 0:E[P])||f.jsx("span",{className:"text-gray-400 dark:text-gray-600 italic",children:"Empty"})})},`${D}-${P}`)})]},P))})]})}):f.jsx("div",{className:"space-y-4",children:c.map(P=>f.jsxs("div",{className:"card",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:P}),f.jsx("div",{className:"space-y-3",children:u.map(D=>{var _,E;return f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsxs("div",{className:"flex items-center space-x-2 w-40 flex-shrink-0",children:[h[D],f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:D}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:p[D]})]})]}),r?f.jsx("input",{type:"text",value:((_=v[P])==null?void 0:_[D])||"",onChange:S=>T(P,D,S.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500",placeholder:"Add activity..."}):f.jsx("div",{className:"flex-1 px-3 py-2",children:(E=m[P])!=null&&E[D]?f.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:m[P][D]}):f.jsx("span",{className:"text-gray-400 dark:text-gray-600 italic",children:"No activity scheduled"})})]},`${P}-${D}`)})})]},P))}),r&&f.jsx("div",{className:"card bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx(wo,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-200 mb-1",children:"Editing Your Schedule"}),f.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Add your typical activities for each time slot. This template represents your ideal week and won't change unless you edit it. Use it as a reference for planning your actual week."})]})]})})]})},rH=()=>{const{currentUser:n}=fn(),[e,t]=O.useState([]),[r,s]=O.useState([]),[i,o]=O.useState(!0),[a,l]=O.useState(!1),[c,u]=O.useState({}),[h,p]=O.useState("all"),[m,y]=O.useState("all"),[v,w]=O.useState(""),[k,b]=O.useState(""),[T,C]=O.useState({date:qt(new Date,"yyyy-MM-dd"),amount:"",note:"",type:"expense"});O.useEffect(()=>{P()},[n]),O.useEffect(()=>{D()},[e,h,m,v,k]);const P=async()=>{if(n)try{const R=Rn(An(xe,"transactions"),dt("userId","==",n.uid),Wr("date","desc")),ce=(await Pn(R)).docs.map(ke=>({id:ke.id.replace(`${n.uid}_`,""),...ke.data()}));t(ce)}catch(R){console.error("Error fetching transactions:",R),se.error("Failed to load transactions")}finally{o(!1)}},D=()=>{let R=[...e];if(m!=="all"&&(R=R.filter(A=>A.type===m)),h!=="all"){const A=new Date;let ce,ke;switch(h){case"this-month":ce=sf(A),ke=rf(A);break;case"last-month":ce=sf(th(A,1)),ke=rf(th(A,1));break;case"last-3-months":ce=th(A,3),ke=A;break;case"custom":ce=v?new Date(v):null,ke=k?new Date(k):null;break}ce&&ke&&(R=R.filter(H=>{var B;const te=(B=H.date)!=null&&B.toDate?H.date.toDate():new Date(H.date);return te>=ce&&te<=ke}))}s(R)},_=async R=>{if(R.preventDefault(),!T.amount||!T.note){se.error("Please fill in all fields");return}const A=`transaction_${Date.now()}`,ce=parseFloat(T.amount);try{const ke={date:new Date(T.date),amount:T.type==="income"?Math.abs(ce):-Math.abs(ce),note:T.note,type:T.type,userId:n.uid,createdAt:Yn()};await xr(Qe(xe,"transactions",`${n.uid}_${A}`),ke);const H={id:A,...ke,date:{toDate:()=>new Date(T.date)},createdAt:{toDate:()=>new Date}};t([H,...e]),C({date:qt(new Date,"yyyy-MM-dd"),amount:"",note:"",type:"expense"}),l(!1),se.success("Transaction added successfully")}catch(ke){console.error("Error adding transaction:",ke),se.error("Failed to add transaction")}},E=R=>{c[R]==="pending"?S(R):(u({...c,[R]:"pending"}),setTimeout(()=>{u(A=>{const ce={...A};return ce[R]==="pending"&&delete ce[R],ce})},3e3))},S=async R=>{try{await qa(Qe(xe,"transactions",`${n.uid}_${R}`)),t(e.filter(A=>A.id!==R)),u(A=>{const ce={...A};return delete ce[R],ce}),se.success("Transaction deleted")}catch(A){console.error("Error deleting transaction:",A),se.error("Failed to delete transaction")}},N=async()=>{if(confirm("Are you sure you want to delete ALL transactions? This cannot be undone."))try{const R=e.map(A=>qa(Qe(xe,"transactions",`${n.uid}_${A.id}`)));await Promise.all(R),t([]),s([]),se.success("All transactions cleared")}catch(R){console.error("Error clearing transactions:",R),se.error("Failed to clear transactions")}},M=()=>{const R=[["Date","Type","Amount","Note"],...r.map(H=>{var te;return[qt((te=H.date)!=null&&te.toDate?H.date.toDate():new Date(H.date),"yyyy-MM-dd"),H.type,H.amount,H.note]})].map(H=>H.join(",")).join(`
`),A=new Blob([R],{type:"text/csv"}),ce=window.URL.createObjectURL(A),ke=document.createElement("a");ke.href=ce,ke.download=`transactions-${qt(new Date,"yyyy-MM-dd")}.csv`,ke.click(),se.success("Transactions exported to CSV")};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-green-600 to-emerald-600 rounded-lg p-6 text-white",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Expenses"}),f.jsx("p",{className:"opacity-90",children:"Track your income and expenses"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:M,className:"bg-white/20 text-white px-4 py-2 rounded-lg font-medium hover:bg-white/30 transition-colors flex items-center",children:[f.jsx(WC,{className:"h-5 w-5 mr-2"}),"Export"]}),f.jsxs("button",{onClick:()=>l(!0),className:"bg-white text-green-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center",children:[f.jsx(tr,{className:"h-5 w-5 mr-2"}),"Add Transaction"]})]})]})}),f.jsxs("div",{className:"card",children:[f.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Type"}),f.jsxs("select",{value:m,onChange:R=>y(R.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Transactions"}),f.jsx("option",{value:"expense",children:"Expenses Only"}),f.jsx("option",{value:"income",children:"Income Only"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Date Range"}),f.jsxs("select",{value:h,onChange:R=>p(R.target.value),className:"input",children:[f.jsx("option",{value:"all",children:"All Time"}),f.jsx("option",{value:"this-month",children:"This Month"}),f.jsx("option",{value:"last-month",children:"Last Month"}),f.jsx("option",{value:"last-3-months",children:"Last 3 Months"}),f.jsx("option",{value:"custom",children:"Custom Range"})]})]}),h==="custom"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"Start Date"}),f.jsx("input",{type:"date",value:v,onChange:R=>w(R.target.value),className:"input"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"End Date"}),f.jsx("input",{type:"date",value:k,onChange:R=>b(R.target.value),className:"input"})]})]})]}),e.length>0&&f.jsx("div",{className:"flex justify-end",children:f.jsxs("button",{onClick:N,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",children:[f.jsx(oU,{className:"h-4 w-4 mr-1"}),"Clear All Transactions"]})})]}),f.jsxs("div",{className:"card",children:[f.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Transactions (",r.length,")"]}),r.length===0?f.jsxs("div",{className:"text-center py-8",children:[f.jsx(c$,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No transactions found"})]}):f.jsx("div",{className:"space-y-2",children:r.map(R=>{var A;return f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors",children:[f.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[f.jsx("div",{className:`p-2 rounded-lg ${R.amount>0?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:R.amount>0?f.jsx(Zv,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):f.jsx(rU,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("span",{className:`font-semibold ${R.amount>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:["$",Math.abs(R.amount).toFixed(2)]}),f.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:R.type==="income"?"Income":"Expense"})]}),f.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:R.note}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500 dark:text-gray-400 mt-1",children:[f.jsx(wo,{className:"h-3 w-3 mr-1"}),qt((A=R.date)!=null&&A.toDate?R.date.toDate():new Date(R.date),"MMM d, yyyy")]})]})]}),f.jsx("button",{onClick:()=>E(R.id),className:`p-2 rounded-lg transition-all ${c[R.id]==="pending"?"bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,title:c[R.id]==="pending"?"Click again to confirm delete":"Delete transaction",children:f.jsx(_o,{className:`h-5 w-5 ${c[R.id]==="pending"?"text-red-600 dark:text-red-400":"text-gray-400 dark:text-gray-600"}`})})]},R.id)})})]}),a&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Add Transaction"}),f.jsx("button",{onClick:()=>l(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:f.jsx(ss,{className:"h-5 w-5 text-gray-500"})})]}),f.jsxs("form",{onSubmit:_,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Type"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("button",{type:"button",onClick:()=>C({...T,type:"expense"}),className:`p-2 rounded-lg border-2 transition-colors ${T.type==="expense"?"border-red-600 bg-red-50 dark:bg-red-900/20 text-red-600":"border-gray-300 dark:border-gray-600"}`,children:"Expense"}),f.jsx("button",{type:"button",onClick:()=>C({...T,type:"income"}),className:`p-2 rounded-lg border-2 transition-colors ${T.type==="income"?"border-green-600 bg-green-50 dark:bg-green-900/20 text-green-600":"border-gray-300 dark:border-gray-600"}`,children:"Income"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Date"}),f.jsx("input",{type:"date",value:T.date,onChange:R=>C({...T,date:R.target.value}),className:"input",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Amount"}),f.jsx("input",{type:"number",step:"0.01",value:T.amount,onChange:R=>C({...T,amount:R.target.value}),className:"input",placeholder:"0.00",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:"Note"}),f.jsx("input",{type:"text",value:T.note,onChange:R=>C({...T,note:R.target.value}),className:"input",placeholder:"What was this for?",required:!0})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>l(!1),className:"btn-secondary",children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn-primary",children:"Add Transaction"})]})]})]})})]})};function sH(){return f.jsx(QO,{children:f.jsx(OB,{children:f.jsxs(MB,{children:[f.jsx(B2,{position:"top-center",toastOptions:{duration:3e3,style:{background:"rgb(31 41 55)",color:"#fff"},success:{iconTheme:{primary:"rgb(34 197 94)",secondary:"#fff"}},error:{iconTheme:{primary:"rgb(239 68 68)",secondary:"#fff"}}}}),f.jsx(gU,{children:f.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col",children:[f.jsx(yU,{}),f.jsx("main",{className:"flex-1 max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8",children:f.jsxs(UO,{children:[f.jsx(Mr,{path:"/",element:f.jsx(R5,{})}),f.jsx(Mr,{path:"/journal",element:f.jsx(Yq,{})}),f.jsx(Mr,{path:"/goals",element:f.jsx(Xq,{})}),f.jsx(Mr,{path:"/stats",element:f.jsx(Zq,{})}),f.jsx(Mr,{path:"/my-week",element:f.jsx(nH,{})}),f.jsx(Mr,{path:"/expenses",element:f.jsx(rH,{})}),f.jsx(Mr,{path:"/settings",element:f.jsx(eH,{})}),f.jsx(Mr,{path:"/subsection/:subsectionName",element:f.jsx(tH,{})})]})})]})})]})})})}const iH="modulepreload",oH=function(n){return"/"+n},sb={},aH=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=oH(l),l in sb)return;sb[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":iH,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function lH(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=n;let a,l;const c=async(h=!0)=>{await l};async function u(){if("serviceWorker"in navigator){if(a=await aH(async()=>{const{Workbox:h}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:h}},[]).then(({Workbox:h})=>new h("/sw.js",{scope:"/",type:"classic"})).catch(h=>{o==null||o(h)}),!a)return;a.addEventListener("activated",h=>{(h.isUpdate||h.isExternal)&&window.location.reload()}),a.addEventListener("installed",h=>{h.isUpdate||r==null||r()}),a.register({immediate:e}).then(h=>{i?i("/sw.js",h):s==null||s(h)}).catch(h=>{o==null||o(h)})}}return l=u(),c}"serviceWorker"in navigator&&lH({onNeedRefresh(){confirm("New content available. Reload?")&&window.location.reload()},onOfflineReady(){console.log("App ready to work offline")}});ng.createRoot(document.getElementById("root")).render(f.jsx(Et.StrictMode,{children:f.jsx(sH,{})}));
